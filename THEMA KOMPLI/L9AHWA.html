<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Deutsch B2 Pr√ºfung - Komplett</title>
  <style>
    /* ===== GLOBAL STYLES ===== */
    :root {
      --primary-color: #1e3a5f;
      --secondary-color: #2c5282;
      --accent-color: #4da6ff;
      --light-color: #ebf8ff;
      --text-color: #2d3748;
      --white: #ffffff;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      --transition: all 0.3s ease;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      color: var(--white);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    button {
      cursor: pointer;
    }
    
    /* ===== START PAGE STYLES ===== */
    .start-container {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      padding: 20px;
      min-height: 100vh;
    }
    
    .start-content {
      max-width: 600px;
      width: 100%;
      background-color: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 40px;
      box-shadow: var(--shadow);
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .logo {
      margin-bottom: 20px;
    }
    
    .logo-icon {
      font-size: 48px;
      margin-bottom: 10px;
    }
    
    h1 {
      font-size: 32px;
      margin-bottom: 10px;
      font-weight: 700;
    }
    
    .subtitle {
      font-size: 18px;
      margin-bottom: 30px;
      opacity: 0.9;
    }
    
    .card {
      background-color: var(--white);
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: var(--shadow);
      color: var(--text-color);
    }
    
    .card h2 {
      font-size: 20px;
      margin-bottom: 15px;
      color: var(--primary-color);
    }
    
    .card p {
      margin-bottom: 20px;
      line-height: 1.5;
    }
    
    select {
      width: 100%;
      padding: 12px 16px;
      font-size: 16px;
      border-radius: 8px;
      border: 2px solid var(--accent-color);
      outline: none;
      background-color: var(--white);
      color: var(--text-color);
      cursor: pointer;
      transition: var(--transition);
    }
    
    select:focus {
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.3);
    }
    
    .timer-container {
      margin: 25px 0;
    }
    
    .timer-label {
      font-size: 16px;
      margin-bottom: 10px;
    }
    
    .timer {
      font-size: 48px;
      font-weight: 700;
      color: var(--accent-color);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }
    
    .progress-bar {
      height: 8px;
      width: 100%;
      background-color: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
      overflow: hidden;
      margin-top: 10px;
    }
    
    .progress {
      height: 100%;
      width: 100%;
      background-color: var(--accent-color);
      border-radius: 4px;
      transform: scaleX(1);
      transform-origin: left;
      transition: transform 1s linear;
    }
    
    .info-text {
      font-size: 14px;
      margin-top: 20px;
      opacity: 0.8;
    }
    
    .button-container {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }
    
    .btn {
      flex: 1;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      background-color: var(--accent-color);
      color: white;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }
    
    .btn:hover {
      background-color: #3399ff;
    }
    
    /* ===== EXAM PAGE STYLES ===== */
    .exam-body {
      background: #f5f5f5;
      color: #333;
      line-height: 1.45;
      -webkit-font-smoothing: antialiased;
    }
    
    /* Header Styles */
    header.topbar {
      background: #1e3a5f;
      color: #fff;
      padding: 12px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      min-height: 80px;
    }

    .brand {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .brand .logo {
      width: 80px;
      height: 40px;
      background: #e74c3c;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: white;
      font-size: 18px;
    }

    .meta .main-title {
      font-weight: 800;
      font-size: 18px;
    }

    .meta .sub-title {
      font-size: 13px;
      opacity: 0.9;
    }

    .timer {
      font-weight: 700;
      font-size: 18px;
      color: #fff;
      margin: 0 20px;
    }

    .buttons-grid {
      display: grid;
      grid-template-columns: repeat(2, auto);
      gap: 10px 20px;
    }

    .exam-btn {
      padding: 12px 20px;
      border-radius: 6px;
      border: none;
      background: #4da6ff;
      color: white;
      font-weight: 700;
      font-size: 15px;
      cursor: pointer;
      transition: background 0.2s ease-in-out;
      min-width: 150px;
      text-align: center;
    }

    .exam-btn:hover {
      background: #336fbf;
    }
    
    .exam-btn.save {
      background: #4da6ff;
      color: #000;
    }
    
    .exam-btn.save:hover {
      background: #3399ff;
    }
    
    .exam-btn.submit {
      background: #4da6ff;
    }
    
    .exam-btn.submit:hover {
      background: #3399ff;
    }
    
    .exam-btn.result {
      background: #4da6ff;
    }
    
    .exam-btn.result:hover {
      background: #3399ff;
    }
    
    .exam-btn.next {
      background: #4da6ff;
      color: #fff;
    }
    
    .exam-btn.next:hover {
      background: #3399ff;
    }
    
    .exam-btn.reset {
      background: #4da6ff;
    }
    
    .exam-btn.reset:hover {
      background: #3399ff;
    }
    
    .exam-btn.reset-section {
      background: #d35400;
      font-size: 12px;
      padding: 6px 10px;
      min-width: auto;
    }
    
    .exam-btn.reset-section:hover {
      background: #e67e22;
    }
    
    .exam-btn.no-match {
      background: #95a5a6;
      font-size: 12px;
      padding: 6px 10px;
      min-width: auto;
      margin-top: 5px;
    }
    
    .exam-btn.no-match:hover {
      background: #7f8c8d;
    }
    
    .exam-btn.no-match.selected {
      background: #e74c3c;
    }
    
    /* Top Tiles */
    .top-tiles {
      display: flex;
      justify-content: center;
      gap: 8px;
      padding: 8px 12px;
      background: #1e3a5f;
      border-bottom: 1px solid #0f223a;
    }
    
    .tile {
      flex: 1;
      max-width: 180px;
      text-align: center;
      padding: 12px;
      border-radius: 6px;
      border: 1px solid #ccc;
      background: #3b4a63;
      color: #fff;
      font-weight: 600;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 60px;
    }
    
    .tile:hover {
      background: #4a5b78;
    }
    
    .tile.active {
      background: #ffffff;
      color: #000;
      border-color: #bbb;
    }
    
    .tile.done {
      background: #2ecc71;
      color: #fff;
      border-color: #27ae60;
    }
    
    .tile.done::after {
      content: " ‚úÖ";
      margin-left: 5px;
    }
    
    .tile .points {
      background: rgba(255,255,255,0.2);
      padding: 4px 8px;
      border-radius: 12px;
      font-weight: 700;
      font-size: 11px;
      margin-top: 4px;
    }
    
    .tile.active .points {
      background: #e9eefc;
      color: #2c3e50;
    }
    
    /* Container Styles */
    .container {
      display: grid;
      grid-template-columns: 1fr 420px;
      gap: 16px;
      padding: 16px;
      max-width: 1200px;
      margin: 12px auto;
    }
    
    .container-full {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      padding: 16px;
      max-width: 1200px;
      margin: 12px auto;
    }
    
    .container-split {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      padding: 16px;
      max-width: 1200px;
      margin: 12px auto;
    }
    
    .left-panel {
      background: white;
      border-radius: 8px;
      padding: 18px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      max-height: 76vh;
      overflow: auto;
    }
    
    .left-panel .passage {
      font-size: 14px;
      color: #2c3e50;
      line-height: 1.8;
    }
    
    .left-panel h2 {
      font-size: 16px;
      margin-bottom: 10px;
    }
    
    .right-panel {
      background: white;
      border-radius: 8px;
      padding: 12px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      display: flex;
      flex-direction: column;
      gap: 12px;
      max-height: 76vh;
      overflow: auto;
    }
    
    .main-panel {
      background: white;
      border-radius: 8px;
      padding: 25px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      max-height: 76vh;
      overflow: auto;
    }
    
    .panel-title {
      font-size: 18px;
      margin-bottom: 15px;
      color: #1e3a5f;
      font-weight: 700;
    }
    
    /* Question Styles */
    .question-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }
    
    .question-body {
      margin-top: 8px;
    }
    
    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .option {
      background: #fbfdff;
      border: 1px solid #e1e8f6;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .option:hover {
      background: #f0f6ff;
    }
    
    .option.selected {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .option .radio {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      border: 2px solid #cfdff6;
      background: #fff;
      display: inline-block;
      flex-shrink: 0;
    }
    
    .option.selected .radio {
      background: #3498db;
      border-color: #3498db;
      box-shadow: inset 0 -3px 0 rgba(0,0,0,0.05);
    }
    
    .text-container {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
      position: relative;
      min-height: 120px;
    }
    
    .text-container:hover {
      background: #f0f6ff;
    }
    
    .text-title {
      font-weight: 700;
      margin-bottom: 8px;
      color: #2c3e50;
    }
    
    .text-content {
      font-size: 14px;
      color: #2c3e50;
      line-height: 1.6;
    }
    
    .title-slot {
      min-height: 40px;
      margin-top: 10px;
      padding: 8px;
      border: 2px dashed #c8d9f6;
      border-radius: 6px;
      background: #f8fbff;
    }
    
    .title-slot.has-title {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .title-slot.has-x {
      background: #f8d7da;
      border-color: #e74c3c;
      color: #c0392b;
      font-weight: bold;
    }
    
    .headings-bank {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 0;
    }
    
    .heading-item {
      padding: 10px;
      border: 1px solid #dbe7fb;
      border-radius: 8px;
      background: #f8fbff;
      cursor: grab;
    }
    
    .heading-item:hover {
      background: #e9f0ff;
    }
    
    .heading-item.used {
      opacity: 0.5;
      cursor: not-allowed;
      background: #f8d7da;
      border-color: #f5c6cb;
    }
    
    .result-correct {
      color: #27ae60;
      font-weight: bold;
    }
    
    .result-incorrect {
      color: #c0392b;
      font-weight: bold;
    }
    
    .result-item {
      margin: 10px 0;
      padding: 10px;
      border-radius: 6px;
      background: #f8f9fa;
    }
    
    .instructions {
      color: #7f8c8d;
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 15px;
    }
    
    .question-text {
      font-weight: 600;
      margin-bottom: 15px;
      font-size: 15px;
      color: #2c3e50;
    }
    
    .all-questions {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    
    .question-block {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .texts-list, .situations-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .text-item, .situation-item {
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .text-letter {
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 8px;
    }
    
    .situation-number {
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 8px;
    }
    
    .fill-blank-container {
      margin: 20px 0;
    }
    
    .blank-word {
      display: inline-block;
      min-width: 120px;
      padding: 4px 8px;
      margin: 0 6px;
      background: #fff;
      cursor: pointer;
      position: relative;
      border: 1px solid #dbe7fb;
      border-radius: 4px;
    }
    
    .blank-word.has-answer {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .options-popup {
      position: absolute;
      top: 100%;
      left: 0;
      background: white;
      border: 1px solid #dbe7fb;
      border-radius: 6px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      z-index: 100;
      min-width: 150px;
    }
    
    .option-item {
      padding: 8px 12px;
      cursor: pointer;
      border-bottom: 1px solid #f0f4fb;
    }
    
    .option-item:hover {
      background: #f0f6ff;
    }
    
    .option-item:last-child {
      border-bottom: none;
    }
    
    .horizontal-options {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .option-row {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 10px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .option-number {
      font-weight: bold;
      color: #2c3e50;
      min-width: 30px;
    }
    
    .option-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .option-btn {
      padding: 8px 16px;
      border: 1px solid #dbe7fb;
      border-radius: 6px;
      background: #f8fbff;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .option-btn:hover {
      background: #e9f0ff;
    }
    
    .option-btn.selected {
      background: #3498db;
      color: white;
      border-color: #3498db;
    }
    
    .word-bank-vertical {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .bank-word-vertical {
      padding: 10px;
      border: 1px solid #dbe7fb;
      border-radius: 6px;
      background: #f8fbff;
      text-align: center;
      cursor: grab;
    }
    
    .bank-word-vertical.used {
      opacity: 0.5;
      cursor: not-allowed;
      background: #f8d7da;
      border-color: #f5c6cb;
    }
    
    .blank-slot {
      display: inline-block;
      min-width: 100px;
      padding: 4px 8px;
      margin: 0 6px;
      background: #fff;
      min-height: 30px;
      vertical-align: middle;
      border: 1px solid #dbe7fb;
      border-radius: 4px;
      cursor: pointer;
    }
    
    .blank-slot.has-answer {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .footer-buttons {
      display: flex;
      gap: 10px;
    }
    
    .situation-item.used {
      opacity: 0.7;
      cursor: not-allowed;
      background: #f8d7da;
      border-color: #f5c6cb;
      color: #333;
    }
    
    /* Listening Section Styles */
    .listening-task {
      margin-bottom: 10px;
    }
    
    .true-false-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      font-size: 14px;
    }
    
    .true-false-table th {
      background: #3498db;
      color: white;
      padding: 15px;
      text-align: left;
      font-weight: 600;
      font-size: 14px;
    }
    
    .true-false-table td {
      padding: 15px;
      border-bottom: 1px solid #e1e8f6;
      vertical-align: top;
    }
    
    .true-false-table tr:nth-child(even) {
      background: #f8f9fa;
    }
    
    .true-false-table tr:hover {
      background: #e3f2fd;
    }
    
    .answer-options {
      display: flex;
      gap: 25px;
    }
    
    .answer-option {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      padding: 10px 15px;
      border-radius: 4px;
      transition: background 0.2s;
      font-weight: 500;
    }
    
    .answer-option:hover {
      background: #e3f2fd;
    }
    
    .answer-option input {
      margin: 0;
      transform: scale(1.2);
    }

    .correct-answer {
      background: #d4edda !important;
      border-left: 4px solid #28a745;
    }
    
    .incorrect-answer {
      background: #f8d7da !important;
      border-left: 4px solid #dc3545;
    }
    
    /* Writing Section Styles */
    .writing-task {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .writing-prompt {
      font-size: 14px;
      color: #2c3e50;
      line-height: 1.6;
      margin-bottom: 15px;
    }
    
    .writing-requirements {
      background: #f8f9fa;
      padding: 12px;
      border-radius: 6px;
      border-left: 4px solid #3498db;
      margin-bottom: 15px;
    }
    
    .writing-requirements h4 {
      margin: 0 0 8px 0;
      color: #2c3e50;
    }
    
    .writing-requirements ul {
      margin: 0;
      padding-left: 20px;
    }
    
    .writing-requirements li {
      margin-bottom: 5px;
      color: #2c3e50;
    }
    
    .writing-area {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    
    .writing-textarea {
      flex: 1;
      min-height: 500px;
      padding: 15px;
      border: 2px solid #e1e8f6;
      border-radius: 8px;
      font-size: 14px;
      line-height: 1.6;
      resize: vertical;
      font-family: Arial, sans-serif;
    }
    
    .writing-textarea:focus {
      outline: none;
      border-color: #3498db;
    }
    
    .word-counter {
      margin-top: 10px;
      text-align: right;
      font-size: 13px;
      color: #7f8c8d;
      padding: 8px 0;
    }
    
    .word-counter .count {
      font-weight: bold;
      color: #2c3e50;
    }
    
    /* Results Page Styles */
    .results-body {
      background: #f7fafc;
      color: #0f1724;
      line-height: 1.6;
    }
    
    .results-header {
      background: #1e3a5f;
      color: #fff;
      padding: 18px 20px;
      display: flex;
      align-items: center;
      gap: 16px;
    }
    
    .results-logo {
      background: #fff;
      color: #1e3a5f;
      padding: 8px 12px;
      border-radius: 6px;
      font-weight: 800;
    }
    
    .results-title {
      font-size: 18px;
      font-weight: 700;
    }
    
    .results-container {
      max-width: 1100px;
      margin: 22px auto;
      padding: 20px;
    }
    
    .results-tiles {
      display: flex;
      gap: 12px;
      margin: 18px 0;
    }
    
    .results-tile {
      flex: 1;
      background: #fff;
      border-radius: 10px;
      padding: 16px;
      box-shadow: 0 6px 18px rgba(2, 6, 23, 0.06);
      border-left: 6px solid #1e3a5f;
    }
    
    .results-tile h3 {
      margin: 0;
      font-size: 16px;
      color: #1e3a5f;
    }
    
    .results-tile .score {
      font-size: 20px;
      font-weight: 800;
      margin-top: 8px;
    }
    
    .section-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
    }
    
    .section-table th,
    .section-table td {
      padding: 8px;
      border-bottom: 1px solid #e6eef8;
      text-align: left;
      font-size: 14px;
    }
    
    .summary {
      background: #fff;
      padding: 16px;
      border-radius: 10px;
      margin-top: 18px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .summary .left {
      font-weight: 700;
    }
    
    .summary .right {
      text-align: right;
    }
    
    .controls {
      display: flex;
      gap: 10px;
      margin-top: 18px;
    }
    
    .results-btn {
      background: #4da6ff;
      border: none;
      color: #fff;
      padding: 10px 14px;
      border-radius: 8px;
      font-weight: 700;
      cursor: pointer;
      transition: background 0.3s;
    }
    
    .results-btn:hover {
      background: #3a8ce0;
    }
    
    .button-like {
      text-decoration: none;
    }
    
    .small-muted {
      color: #6b7280;
      font-size: 13px;
    }
    
    input[type="number"] {
      width: 90px;
      padding: 8px;
      border: 1px solid #d7e6fb;
      border-radius: 6px;
    }
    
    .note {
      font-size: 13px;
      color: #6b7280;
      margin-top: 8px;
    }
    
    /* Footer */
    footer.controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: white;
      border-top: 1px solid #e1e8f6;
      margin-top: 20px;
    }
    
    .status {
      font-size: 14px;
      color: #7f8c8d;
    }
    
    .ghost {
      background: transparent;
      border: 2px solid #2c3e50;
      color: #2c3e50;
    }
    
    .ghost:hover {
      background: #2c3e50;
      color: white;
    }

    /* Responsive Styles */
    @media (max-width: 980px) {
      .container {
        grid-template-columns: 1fr;
        padding: 12px;
      }
      
      .container-split {
        grid-template-columns: 1fr;
      }
      
      .right-panel {
        order: 2;
      }
      
      .top-tiles {
        padding-left: 8px;
        padding-right: 8px;
      }
      
      header.topbar {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }
      
      .buttons-grid {
        grid-template-columns: 1fr;
      }
      
      .answer-options {
        flex-direction: column;
        gap: 10px;
      }
      
      footer.controls {
        flex-direction: column;
        gap: 15px;
      }
      
      .results-tiles {
        flex-direction: column;
      }
      
      .summary {
        flex-direction: column;
        gap: 10px;
        text-align: center;
      }
      
      .controls {
        flex-direction: column;
      }
    }
    
    @media (max-width: 600px) {
      .start-content {
        padding: 25px 20px;
      }
      
      h1 {
        font-size: 28px;
      }
      
      .card {
        padding: 20px 15px;
      }
    }

    /* === ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿÆÿßÿµÿ© ŸÑŸÑŸáŸàÿßÿ™ŸÅ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© ÿ¨ÿØÿß === */
    @media (max-width: 480px) {
      /* 1. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ≠ÿßŸàŸäÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© */
      .container, .container-split, .container-full {
        grid-template-columns: 1fr !important;
        padding: 8px !important;
        gap: 10px !important;
      }
      
      /* 2. ÿ¨ÿπŸÑ ÿßŸÑŸÑŸàÿ≠ÿßÿ™ (panels) ÿ™ÿ£ÿÆÿ∞ ÿπÿ±ÿ∂ ŸÉÿßŸÖŸÑ */
      .left-panel, .right-panel, .main-panel {
        max-height: none !important;
        height: auto !important;
        overflow: visible !important;
        margin-bottom: 10px;
      }
      
      /* 3. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸáŸäÿØÿ± */
      .topbar {
        flex-direction: column !important;
        align-items: stretch !important;
        padding: 10px !important;
      }
      
      .brand {
        justify-content: center;
        margin-bottom: 10px;
      }
      
      /* 4. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ± ŸÅŸä ÿßŸÑŸáŸäÿØÿ± */
      .buttons-grid {
        grid-template-columns: 1fr !important;
        width: 100%;
      }
      
      .exam-btn {
        width: 100% !important;
        margin: 2px 0 !important;
        font-size: 14px !important;
        padding: 12px 8px !important;
      }
      
      /* 5. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ™ÿßŸäŸÑÿßÿ™ */
      .top-tiles {
        flex-wrap: wrap;
        justify-content: center;
      }
      
      .tile {
        flex: 0 0 calc(33% - 5px) !important;
        max-width: calc(33% - 5px) !important;
        margin: 2px;
        font-size: 11px !important;
        padding: 8px 4px !important;
      }
      
      /* 6. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÜÿµŸàÿµ */
      .passage, .text-content, .question-text {
        font-size: 15px !important;
        line-height: 1.5 !important;
      }
      
      /* 7. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™ */
      .option {
        padding: 12px 10px !important;
        margin: 4px 0 !important;
      }
      
      /* 8. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ¨ÿØÿßŸàŸÑ True/False */
      .true-false-table {
        display: block;
        overflow-x: auto;
        white-space: nowrap;
      }
      
      /* 9. ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑŸÉÿ™ÿßÿ®ÿ© */
      .writing-textarea {
        min-height: 300px !important;
        font-size: 16px !important;
      }
      
      /* 10. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÅŸàÿ™ÿ± */
      footer.controls {
        flex-direction: column !important;
        gap: 10px !important;
      }
      
      .footer-buttons {
        width: 100%;
        display: flex;
        gap: 5px;
      }
      
      .footer-buttons .exam-btn {
        flex: 1;
      }
      
      /* 11. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ */
      .results-tiles {
        flex-direction: column !important;
      }
      
      .results-tile {
        margin-bottom: 10px;
      }
    }

    /* === ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÑŸÑŸáŸàÿßÿ™ŸÅ ÿßŸÑŸÖÿ™Ÿàÿ≥ÿ∑ÿ© === */
    @media (min-width: 481px) and (max-width: 768px) {
      .container, .container-split {
        grid-template-columns: 1fr !important;
      }
      
      .tile {
        max-width: 180px !important;
      }
    }
  </style>
</head>
<body id="body">
  <!-- Start Page -->
  <div id="start-page" class="start-container">
    <div class="start-content">
      <div class="logo">
        <div class="logo-icon">üìù</div>
        <h1>Deutsch B2 Pr√ºfung</h1>
        <div class="subtitle">Bereiten Sie sich auf Ihre Pr√ºfung vor</div>
      </div>
      <div class="card">
        <h2>Pr√ºfungsbereich ausw√§hlen</h2>
        <p>W√§hlen Sie bitte den Bereich aus, den Sie √ºben m√∂chten. Die Pr√ºfung startet automatisch in <span id="time-display">30</span> Sekunden.</p>
        <select id="sectionSelect">
          <option value="lesen">Lesen</option>
          <option value="hoeren">H√∂ren</option>
          <option value="schreiben">Schreiben</option>
        </select>
        <div class="button-container">
          <button id="cancelBtn" class="btn">Abbrechen</button>
          <button id="startBtn" class="btn">Jetzt starten</button>
        </div>
      </div>
      <div class="timer-container">
        <div class="timer-label">Die Pr√ºfung startet in:</div>
        <div class="timer" id="countdown">30</div>
        <div class="progress-bar">
          <div class="progress" id="progress"></div>
        </div>
      </div>
      <div class="info-text">Stellen Sie sicher, dass Sie in einer ruhigen Umgebung sind und gen√ºgend Zeit haben.</div>
    </div>
  </div>

  <!-- Lesen Page -->
  <div id="lesen-page" class="exam-page" style="display: none;">
    <header class="topbar" role="banner">
      <div class="brand">
        <div class="logo">test</div>
        <div class="meta">
          <div class="main-title">Deutsch - B2 (√úbung)</div>
          <div class="sub-title">Lesen ‚Äî Testbeispiel</div>
        </div>
      </div>

      <div id="timer-lesen" class="timer" aria-live="polite">Verbleibende Zeit: 90:00</div>

      <div class="buttons-grid">
        <button id="resetBtn-lesen" class="exam-btn reset">üîÑ Von neu beginnen</button>
        <button id="saveBtn-lesen" class="exam-btn save">üìã Speichern</button>
        <button id="resultBtn-lesen" class="exam-btn result">üìä Ergebnis</button>
        <button id="submitBtn-lesen" class="exam-btn submit">üèÅ Abgabe</button>
        <button class="exam-btn next" id="nextBtn-lesen">‚û°Ô∏è N√§chste Pr√ºfung</button>
      </div>
    </header>

    <div class="top-tiles" id="topTiles-lesen" role="navigation" aria-label="Sections overview"></div>

    <div class="container">
      <main class="left-panel" id="leftPanel-lesen">
        <div class="passage" id="passage-lesen">
          <h2 id="passageTitle-lesen">Aufgabe</h2>
          <div id="passageContent-lesen"></div>
        </div>
      </main>

      <aside class="right-panel" id="rightPanel-lesen" aria-labelledby="questionTitle-lesen">
        <div class="question-head">
          <div>
            <div id="sectionName-lesen" style="font-weight:800"></div>
            <div id="questionTitle-lesen" style="font-size:13px;color:#55607a">Frage</div>
          </div>
          <button id="resetSectionBtn-lesen" class="exam-btn reset-section" style="display:none;">Teil zur√ºcksetzen</button>
        </div>
        <div class="question-body" id="questionBody-lesen"></div>
        <div id="headingsBankContainer-lesen"></div>
      </aside>
    </div>

    <footer class="controls">
      <div class="footer-buttons">
        <button id="prevBtn-lesen" class="exam-btn ghost">Zur√ºck</button>
        <button id="nextBtn-lesen" class="exam-btn ghost">Weiter</button>
      </div>
      <div class="status"><span id="statusText-lesen">Nicht gespeichert</span></div>
    </footer>
  </div>

  <!-- H√∂ren Page -->
  <div id="hoeren-page" class="exam-page" style="display: none;">
    <header class="topbar" role="banner">
      <div class="brand">
        <div class="logo">test</div>
        <div class="meta">
          <div class="main-title">Deutsch - B2 (√úbung)</div>
          <div class="sub-title">H√∂rverstehen ‚Äî Testbeispiel</div>
        </div>
      </div>

      <div id="timer-hoeren" class="timer" aria-live="polite">Verbleibende Zeit: 17:00</div>

      <div class="buttons-grid">
        <button id="resetBtn-hoeren" class="exam-btn reset">üîÑ Von neu beginnen</button>
        <button id="saveBtn-hoeren" class="exam-btn save">üìã Speichern</button>
        <button id="resultBtn-hoeren" class="exam-btn result">üìä Ergebnis</button>
        <button id="submitBtn-hoeren" class="exam-btn submit">üèÅ Abgabe</button>
        <button class="exam-btn next" id="nextBtn-hoeren">‚û°Ô∏è N√§chste Pr√ºfung</button>
      </div>
    </header>

    <div class="top-tiles" id="topTiles-hoeren" role="navigation" aria-label="Sections overview"></div>

    <div class="container-full">
      <main class="main-panel" id="mainPanel-hoeren">
        <div id="contentContainer-hoeren"></div>
      </main>
    </div>

    <footer class="controls">
      <div class="footer-buttons">
        <button id="prevBtn-hoeren" class="exam-btn ghost">Zur√ºck</button>
        <button id="nextBtn-hoeren" class="exam-btn ghost">Weiter</button>
      </div>
      <div class="status"><span id="statusText-hoeren">Nicht gespeichert</span></div>
    </footer>
  </div>

  <!-- Schreiben Page -->
  <div id="schreiben-page" class="exam-page" style="display: none;">
    <header class="topbar" role="banner">
      <div class="brand">
        <div class="logo">test</div>
        <div class="meta">
          <div class="main-title">Deutsch - B2 (√úbung)</div>
          <div class="sub-title">Schreiben ‚Äî Testbeispiel</div>
        </div>
      </div>

      <div id="timer-schreiben" class="timer" aria-live="polite">Verbleibende Zeit: 30:00</div>

      <div class="buttons-grid">
        <button id="resetBtn-schreiben" class="exam-btn reset">üîÑ Von neu beginnen</button>
        <button id="saveBtn-schreiben" class="exam-btn save">üìã Speichern</button>
        <button id="resultBtn-schreiben" class="exam-btn result">üìä Ergebnis</button>
        <button id="submitBtn-schreiben" class="exam-btn submit">üèÅ Abgabe</button>
        <button class="exam-btn next" id="nextBtn-schreiben">‚û°Ô∏è N√§chste Pr√ºfung</button>
      </div>
    </header>

    <div class="top-tiles" id="topTiles-schreiben" role="navigation" aria-label="Sections overview"></div>

    <div class="container-split">
      <main class="left-panel" id="leftPanel-schreiben">
        <div class="passage" id="passage-schreiben">
          <h2 id="passageTitle-schreiben">Aufgabe</h2>
          <div id="passageContent-schreiben"></div>
        </div>
      </main>

      <aside class="right-panel" id="rightPanel-schreiben">
        <div id="writingContainer-schreiben"></div>
      </aside>
    </div>

    <footer class="controls">
      <div class="footer-buttons">
        <button id="prevBtn-schreiben" class="exam-btn ghost">Zur√ºck</button>
        <button id="nextBtn-schreiben" class="exam-btn ghost">Weiter</button>
      </div>
      <div class="status"><span id="statusText-schreiben">Nicht gespeichert</span></div>
    </footer>
  </div>

  <!-- Ergebnisse Page -->
  <div id="ergebnisse-page" class="results-page" style="display: none;">
    <header class="results-header">
      <div class="results-logo">test</div>
      <div class="results-title">Gesamtergebnis ‚Äî Deutsch B2</div>
    </header>

    <div class="results-container">
      <div class="results-tiles" id="topTiles-ergebnisse"></div>
      <div id="details-ergebnisse"></div>
      <div class="summary" id="finalSummary-ergebnisse"></div>
      <div class="controls">
        <a class="button-like" href="#" id="backBtn-ergebnisse">
          <button class="results-btn">üîÅ Zur√ºck zur Startseite</button>
        </a>
        <button id="calcBtn-ergebnisse" class="results-btn">‚úÖ Ergebnisse anzeigen</button>
      </div>
      <div class="note">Hinweis: Schreiben (45 Punkte) wird manuell eingegeben, falls nicht automatisch vorhanden.</div>
    </div>
  </div>

  <script>
    // ===== PAGE NAVIGATION =====
    function showPage(pageId) {
      document.getElementById('start-page').style.display = 'none';
      document.getElementById('lesen-page').style.display = 'none';
      document.getElementById('hoeren-page').style.display = 'none';
      document.getElementById('schreiben-page').style.display = 'none';
      document.getElementById('ergebnisse-page').style.display = 'none';
      
      document.getElementById('body').className = '';
      if (pageId === 'ergebnisse-page') {
        document.getElementById('body').className = 'results-body';
      } else if (pageId !== 'start-page') {
        document.getElementById('body').className = 'exam-body';
      }
      
      document.getElementById(pageId).style.display = 'block';
      
      if (pageId === 'lesen-page' && typeof initLesenPage === 'function') {
        initLesenPage();
      } else if (pageId === 'hoeren-page' && typeof initHoerenPage === 'function') {
        initHoerenPage();
      } else if (pageId === 'schreiben-page' && typeof initSchreibenPage === 'function') {
        initSchreibenPage();
      } else if (pageId === 'ergebnisse-page' && typeof initErgebnissePage === 'function') {
        initErgebnissePage();
      }
    }

    // ===== START PAGE FUNCTIONALITY =====
    let initialCounter = 30;
    let counter = initialCounter;
    let countdownInterval;
    let countdownRunning = false;
    let examStarted = false;
    const timerEl = document.getElementById("countdown");
    const timeDisplayEl = document.getElementById("time-display");
    const progressEl = document.getElementById("progress");
    const selectEl = document.getElementById("sectionSelect");
    const startBtn = document.getElementById("startBtn");
    const cancelBtn = document.getElementById("cancelBtn");

    function startCountdown() {
      if (countdownRunning || examStarted) return;
      countdownRunning = true;
      try { startBtn.disabled = true; startBtn.setAttribute('aria-disabled','true'); } catch(e){}
      
      counter = initialCounter;
      timerEl.textContent = counter;
      timeDisplayEl.textContent = counter;
      progressEl.style.transform = "scaleX(0)";
      timerEl.style.color = "";

      countdownInterval = setInterval(() => {
        counter--;
        timerEl.textContent = counter;
        timeDisplayEl.textContent = counter;
        const progressValue = (initialCounter - counter) / initialCounter;
        progressEl.style.transform = `scaleX(${progressValue})`;
        if (counter <= 0) {
          clearInterval(countdownInterval);
          countdownInterval = null;
          countdownRunning = false;
          progressEl.style.transform = "scaleX(1)";
          if (!examStarted) {
            examStarted = true;
            startExam();
          }
          try { startBtn.disabled = false; startBtn.removeAttribute('aria-disabled'); } catch(e){}
        }
      }, 1000);
    }

    function stopCountdown(reset = true) {
      if (countdownInterval) {
        clearInterval(countdownInterval);
        countdownInterval = null;
      }
      countdownRunning = false;
      try { startBtn.disabled = false; startBtn.removeAttribute('aria-disabled'); } catch(e){}
      progressEl.style.transform = "scaleX(0)";
      if (reset) {
        counter = initialCounter;
        timerEl.textContent = counter;
        timeDisplayEl.textContent = counter;
      } else {
        timerEl.textContent = "Gestoppt";
      }
    }

    function startExam() {
      if (!examStarted) examStarted = true;
      const selectedSection = selectEl.value;
      if (selectedSection === 'lesen') {
        showPage('lesen-page');
      } else if (selectedSection === 'hoeren') {
        showPage('hoeren-page');
      } else if (selectedSection === 'schreiben') {
        showPage('schreiben-page');
      }
    }

    startBtn.addEventListener('click', startCountdown);

    cancelBtn.addEventListener('click', () => {
      stopCountdown(true);
      timerEl.textContent = "Abgebrochen";
      timerEl.style.color = "#e53e3e";
    });

    // ===== LESEN PAGE FUNCTIONALITY =====
    function initLesenPage() {
      const exam = {
        id: "exam-b2-pdf",
        durationSec: 90 * 60,
        sections: [
          { 
            id:"s1", 
            title:"Leseverstehen, Teil 1", 
            points:25,
            passageTitle:"Aufgabe: Ziehen Sie die passenden √úberschriften auf die Texte.",
            passage: `Lesen Sie zuerst die zehn √úberschriften. Lesen Sie dann die f√ºnf Texte und entscheiden Sie, welche √úberschrift (a‚Äìj) am besten zu welchem Text (1‚Äì5) passt.`,
            questions:[],
            texts: [
              {
                id: "text1",
                content: "Das erste Kaffehaus in Leipzig, Zum arabischen Coffee-Baum, √∂ffnete 1685 seine Pforten. Seitdem ist der Kaffee in Sachsen zum beliebten Getr√§nk geworden, das weder zu Hause auf Party und Feiern noch beim Ausgehen fehlen darf. Kaffeesachsen wurden fr√ºher die Bewohner des Landes zwischen Leipzig und polnischer Grenze auch deswegen scherzhaft von den anderen Deutschen genannt. Bevorzugt wird der Kaffee hei√ü und s√º√ü getrunken. S√º√üe Erg√§nzungen wie Dresdner Stollen oder Leipziger Lerchen, beides traditionell gebackene Kuchenspezialit√§ten, geh√∂ren zum Kaffee wie das T√ºpfelchen zum i. Dabei wird das Geb√§ck auf echt s√§chsische Art gedibbscht, das hei√üt: Es wird in den Kaffee getrunkt, bevor es gegessen wird. Die Sachsen schw√∂ren darauf, dass sowohl das Geb√§ck als auch der Kaffee so und nur so ihr volles Aroma entfalten. Wer es selbst ausprobieren m√∂chte: Zahlreiche Kaffeeh√§user laden in allen gr√∂√üeren und kleineren St√§dten Sachsens dazu ein, dies auszuprobieren.",
                correctAnswer: "j"
              },
              {
                id: "text2", 
                content: "Eppingen liegt etwa auf halbem Weg zwischen Karlsruhe und Heilbronn im Kraichgau, einer geschichtstr√§chtigen Region mit wundersch√∂ner Landschaft und bodenst√§ndiger Kultur, die von Erholung suchenden Menschenmassen noch nicht √ºberrollt ist. Oie Altstadt des St√§dtchens ist ein einziges Museum: √úber 100 Fachwerkh√§user mit ihrem rumantisch anmutenden Muster aus braunen Holzbalken und wei√ü get√ºnchtem Lehm k√∂nnen hier bewundert werden. Die bekanntesten davon sind das \"Baumannsche Haus\" (erbaut 1582), heute ein Hotel, und die \"Alte Universit√§t\", heute ein Museum. Hier befand sich 1564/1565 die Heidelberger Universit√§t, die, als in Heidelberg die Pest w√ºtete, hierhin ausgelagert wurde. Im heutigen Museum kann man die Fachwerkbaukunst studieren. Seit 1993 findet im Juli und August der Carillonsommer statt. Dann geben international bekannte Orgellinterpreten Glockenspielkonzerte, die vom achteckigen Turm der Stadtpfarrkirche erklingen. Eine lange Tradition in Eppingen hat die Bierbrauerei. Das hier gebraute Palmbr√§u- Bier kann an Ort und Stelle in der Brauereigastst√§tte probiert werden. Eppingen ist auch Ausgangspunkt zahlreicher Wanderwege, auf denen der Kraichgau zu Fu√ü erkundet werden kann.",
                correctAnswer: "b"
              },
              {
                id: "text3",
                content: "Das Kloster Maulbronn wurde 1147 von Zisterzienserm√∂nchen gegr√ºndet. Man sagt, ein Maulesel, den die M√∂nche auf ihren Wanderungen mitgef√ºhrt hatten, solle hier einen Brunnen gefunden haben und man habe daraufhin beschlossen, an dieser Stelle das Kloster zu bauen. Im 16. Jahrhundert wurde es im Verlauf der Reformation s√§kularisiert und zum Internat umfunktioniert. Heute von der UNESCO zum Weltkulturerbe der Menschheit erhoben, ist das Kloster ein Touristenmagnet. Selbst vom ber√ºchtigten Doktor Faust wird erz√§hlt, er sei einmal dort gewesen. Das Kloster soll einmal kein Geld mehr gehabt haben, und der sonst gottesf√ºrchtige Abt habe geglaubt, mit Hilfe des Doktor Faust und dessen Zauberk√ºnsten wieder zu Geld zu kommen. Maulbronn war besonders wegen seiner Klosterschule bekannt, die von namhaften Pers√∂nlichkeiten besucht wurde: Johannes Kepler lernte hier Latein und Mathematik, der Schriftsteller Hermann Hesse litt bekanntlich sehr unter der eisernen Disziplin und H√§rte, die hier nach seiner Meinung vorherrschte. Hermann Hesse hat die Klosteranlage sp√§ter in seinen Romanen \"unterm Rad\" und \"Narzii und Goldmund\" zum Schauplatz gemacht.",
                correctAnswer: "h"
              },
              {
                id: "text4",
                content: "Auf einer Anh√∂he oberhalb des Bodensees hegt, ca. 10 km vorn See entfernt in idyllischer l√§ndlicher Umgebung, das ehemalige Zisterzienserkoster Salem. Innerhalb der weitl√§ufigen Klosteranlage aus dem 12. Jahrhundert befinden sich heute mehrere Museen und das gotische M√ºnster. Im Feuerwehrmuseum findet der interessierte Besucher alte Feuerwehrwagen, die noch von Pferden gezogen wurden, alte Ger√§te, Spritzen und Pumpen sowie mehrere Modellanlagen. Im Weinbaumuseum bekommt man einer √úberblick √ºber die Weinproduktion der Bodenseeregion. Hier k√∂nnen regionale Weine probiert und auch gekauft werden. In den angrenzenden Geb√§uden kann man zuschauen, wie - noch in Handarbeit - Musikinstrumente gebaut werden, Glas gebasen oder Goldschmuck hergestellt wird. Ein kleiner aber feiner Park l√§dt zum Ausruhen und Verweilen ein. International bekannt ist jedoch das von Kurt Hahn und dem Prinzen Max von Baden 1920 gegr√ºndete Internat Salem, das von den S√∂hnen und Tochtern bekannter Familien aus ganz Europa besucht wurde und wird: Der erste deutsche Bundespr√§sident Theodor Heuss ging hier ebenso zur Schule wie der Ehemann der britischen K√∂nigin Elisabeth II., Prinz Philipp.",
                correctAnswer: "a"
              },
              {
                id: "text5",
                content: "Vermutlich vor fast 900 Jahren, irgendwann im dreizehnten Jahrhundert, sollen die Menschen herausgefunden haben, was es mit dem Kaffee auf sich hat. Eine Legende erz√§hlt von einem jemenitischen Ziegenhirten, dessen Ziegen sich nach dem Genuss der roten Beeren eines bestimmten Strauches merkw√ºrdig lebendig und aufgedreht benommen haben sollen. Im Dorf habe der Dorfgelehrte dann herausgefunden, dass die Fr√ºchte, die bisher nur den Ziegen zu viel \"Energie\" verholfen hatten, auch beim Menschen ihre Wirkung zeigten. Nach mehreren Experimenten habe man dann herausgefunden, dass die Beeren, wenn man sie trocknet und dann mit hei√üem Wasser aufkocht, am besten schmecken. Der Kaffee war erfunden. Wegen seiner berauschenden Wirkung, so eine Theorie, soll das Getr√§nk dann arabisch qahwa genannt worden sein, was auch einen Wein bezeichnen konnte. Nach einer anderen Theorie stammt der Kaffee aus der Region \"Kaffa\" im s√ºdwestlichen √Ñthiopien. Von hier aus nahm jedenfalls sein Siegeszug √ºber die ganze Welt seinen Ausgang. 1582 erreichte der Kaffee schlie√ülich Europa, wo er bis heute zu einem der beliebtesten Getr√§nke wurde.",
                correctAnswer: "f"
              }
            ],
            headings: [
              {id: "a", text: "Altes Handwerk und alte Technik anschaulich pr√§sentiert"},
              {id: "b", text: "Attraktive Kleinstadt - touristischer Geheimtipp"},
              {id: "c", text: "Ein Altes Kloster als Feuerwache"},
              {id: "d", text: "Eine Universit√§t mit langer Geschichte"},
              {id: "e", text: "Eliteschule f√ºr Schriftsteller"},
              {id: "f", text: "Entdeckung und Verbreitung des Kaffees"},
              {id: "g", text: "Kaffee macht die Leute s√º√ü"},
              {id: "h", text: "Kl√∂sterliche Strenge f√ºr ber√ºhmte Sch√ºler"},
              {id: "i", text: "Mehr Ziegenmilch dank Energy-Drink"},
              {id: "j", text: "Ohne Kaffee geht hier nichts"}
            ]
          },
          { 
            id:"s2", 
            title:"Leseverstehen, Teil 2", 
            points:25,
            passageTitle: "Mehrsprachige Erziehung",
            passage: `F√ºr viele Eltern sind Fremdsprachenkenntnisse die Basis einer ordentlichen Karriere f√ºr Ihre Kinder. Aus entwicklungspsychologischer Sicht bringt die Mehrsprachigkeit im Kindesalter tats√§chlich einige Vorteile mit sich: "Mehsprachig erzogene Kinder lernen sp√§ter auch andere Fremdsprachen leichter, weil sie schon fr√ºh ein Gef√ºhl f√ºr die Systematik hinter einer Sprache entwickeln", sagt Susanne Hilt, Psychologin f√ºr Sprachf√∂rderung in Neustadt. Au√üerdem falle es ihnen leichter, Dinge mit anderen Augen zu sehen und kreativ auf ihren Alltag zu reagieren. Auch die kommunikative Kompetenz ist laut Hilt bei mehrsprachig erzogenen Kindern meist ausgepr√§gter.

Doch nicht jeder Sprachimpuls in der Kindheit ist positiv. Die geb√ºrtige Schweizerin Hilt hat ihre eigenen Kinder dreisprachig erzogen. Sie ist sich sicher: "Die mehrsprachige Erziehung funktioniert nur dann, wenn das Kind eine emotionale Bindung zur jeweiligen Sprache aufbauen kann". Sie r√§t daher Eltern, sich ehrlich zu fragen, welche Sprache ihnen selbst am ehesten liegt. Denn wer sich in der Fremdsprache nicht wohlf√ºhle, k√∂nne sie auch nicht authentisch vermitteln.

Die Expertin Hilt ist daher skeptisch, wenn Eltern ihre Kinder aus rein intellektuellen Gr√ºnden mehrsprachig erziehen m√∂chten. "Schulische Erfolge sollte nicht der Hauptbeweggrund f√ºr die Multilingualit√§t sein. It ist viel wichtiger, dass die Sprache f√ºr das Child emotional und sozial relevant ist". So k√∂nnten zum Beispiel die Herkunft der Eltern, eine Tante in Frankreich oder eine fremdsprachige Erzieherin eine Basis bilden, durch die Kinder auch kulturell den Bezug zu einer weiteren Sprache finden.

Der Kontakt mit einer zweiten oder dritten Sprache muss nach Auffassung von Hilt nicht unbedingt schon im Babyalter erfolgen. Man kann mit der mehrsprachigen Erziehung auch erst im Kindergartenalter beginnen. "Das Zeitfenster, in dem ein Child eine Sprache noch durch zweisprachige Erziehung erlernen kann, ist nicht genau festlegbar. Aber ungef√§hr bis zum zehnten Lebensjahr sind die Chancen sehr gut", sagt die Psychologin.

Auch Sabine Filligrabe‚ÄìAmling, Leiterin einer deutsch‚Äìenglischen Kindertagesst√§tte in Hamburg, sieht den Einstieg in die Multilingualit√§t entspannt. In Hamburg gibt es in jeder Gruppe einen deutschen und einen englischen Muttersprachler unter den Erziehern, jeder wendet seine Sprache ganz selbstverst√§ndlich im Umgang mit den Kindern an. "Die meisten unserer Kinder nehmen die neue Sprache sehr gut an, weil sie eine starke emotionale Bindung zu den Erziehern haben", sagt Filligrabe‚ÄìAmling. Sie r√§t Eltern, die mehrsprachige Erziehung ihrer Kinder ebenfalls wie selbstverst√§ndlich in den Alltag zu integrieren. "Es bringt nichts, wenn man zu Kindern sagt 'Wiederhol das mal' oder 'Schau, Stuhl hei√üt auf Englisch chaii'. Auch der Erwerb der Muttersprache funktioniert ja nicht auf diese Art", sagt Filligrabe‚ÄìAmling. Die neue Sprache sollte ganz locker immer wieder auftauchen, so dass das Child sie langsam annehmen kann. "Am besten ist es, wenn eine bestimmte Bezugsperson sich immer nur in der anderen Sprache mit dem Kind unterh√§lt", sagt Filligrabe‚ÄìAmling.

Susanne Hilt h√§lt auch andere Methoden f√ºr sinnvoll. "Jeder muss da sein eigenes System entwickeln", sagt die Psychologin. It sei auch denkbar, dass beispielsweise die kroatische Mutter mit ihrem Child zu Hause immer nur Kroatisch spreche, unterwegs aber Deutsch. "Wichtig ist, dass eine Regelm√§√üigkeit f√ºr das Kind und f√ºr die Eltern erkennbar ist", sagt Hilt.

Eine Sprachverwirrung durch die Multilingualit√§t oder gar eine Verz√∂gerung in der Entwicklung des Kindes m√ºssen Eltern nicht bef√ºrchten, meint Hilt. "Auch wenn der Kontakt mit der anderen Sprache nur alle paar Tage stattfindet, wird das Kind keinen Schaden nehmen. Auch diese kleinen Impulse k√∂nnen zumindest das Interesse f√ºr weitere Sprachen f√∂rdern".`,
            questions: [
              {
                id: "s2q1",
                type: "single",
                text: "Mehrsprachig erzogene Kinder sind meist",
                options: [
                  {id: "s2q1o1", text: "kommunikativer"},
                  {id: "s2q1o2", text: "ideenreicher"},
                  {id: "s2q1o3", text: "sensibler"}
                ],
                correctAnswer: "s2q1o1"
              },
              {
                id: "s2q2",
                type: "single", 
                text: "Mehrsprachige Erziehung gelingt, wenn",
                options: [
                  {id: "s2q2o1", text: "das Kind einen emotionalen Bezug zur Sprache hat"},
                  {id: "s2q2o2", text: "die Eltern aus dem Zielsprachenland kommen"},
                  {id: "s2q2o3", text: "die Eltern die Bildungsziele konsequent verfolgen"}
                ],
                correctAnswer: "s2q2o1"
              },
              {
                id: "s2q3",
                type: "single",
                text: "Damit ein Kind eine weitere Sprache zweisprachig erlernt,",
                options: [
                  {id: "s2q3o1", text: "muss die Sprachvermittlung so fr√ºh wie m√∂glich anfangen"},
                  {id: "s2q3o2", text: "reicht it, im Grundschulalter mit der Zweitsprache zu beginnen"},
                  {id: "s2q3o3", text: "sollte im Kindergarten mit der Sprachvermittlung begonnen werden"}
                ],
                correctAnswer: "s2q3o3"
              },
              {
                id: "s2q4",
                type: "single",
                text: "Wechselt die Bezugsperson zwischen zwei Sprachen, lernt das Kind die Zweitsprache",
                options: [
                  {id: "s2q4o1", text: "bei systematischer Vermittlung der Sprache"},
                  {id: "s2q4o2", text: "sofern es versteht, wann die Sprachen gewechselt werden"},
                  {id: "s2q4o3", text: "wahrscheinlich nicht"}
                ],
                correctAnswer: "s2q4o1"
              },
              {
                id: "s2q5", 
                type: "single",
                text: "Sollten Kinder nur alle paar Tage Kontakt zur Zweitsprache haben,",
                options: [
                  {id: "s2q5o1", text: "ist eine Entwicklungsverz√∂gerung m√∂glich"},
                  {id: "s2q5o2", text: "kann das Interesse an anderen Sprachen verloren gehen"},
                  {id: "s2q5o3", text: "schadet dies der Entwicklung der Zweitsprache nicht"}
                ],
                correctAnswer: "s2q5o3"
              }
            ]
          },
          { 
            id:"s3", 
            title:"Leseverstehen, Teil 3", 
            points:25,
            passageTitle:"Aufgabe: Lesen Sie die zehn Situationen (11-20) und die zw√∂lf Texte (A-L). Welcher Text passt zu welcher Situation? Sie k√∂nnen jeden Text nur einmal verwenden. Manchmal passt kein Text. W√§hlen Sie dann 'x'.",
            passage: "",
            questions:[],
            texts: [
              {id: "A", text: "Wenn eine schwangere Frau erkrankt oder unter starken Schmerzen leidet, kann sie in den meisten F√§llen keine Medikamente einnehmen. Zu gro√ü w√§re die Gefahr f√ºr das noch ungeborene Kind, denn Schmerzmittel oder Antibiotika k√∂nnen das Baby sch√§digen. Als Ausweg empfehlen deutsche √Ñrzte und Krankenkassen daher alternative Heilmethoden wie die Akupunktur. Bei dieser uralten aus China stammenden Heilmethode werden kleine Nadeln in bestimmte Nervenbahnen gestochen. Dabei werden die Nerven gereizt und die √úbermittlung von Schmerzsignalen wird gehemmt. F√ºr das Kind besteht keine Gefahr.", correctAnswer: "19"},
              {id: "B", text: "Eine alte und h√∂chst effektive Methode zur Entspannung ist die Klangmassage. Sie stammt aus Tibet, kann leicht erlernt und jederzeit angewendet werden. Dabei werden tibetanische Klangschalen auf den K√∂rper gesetzt und mit einem weichen Kl√∂ppel aus Filz angeschlagen. Die auf diese Weise entstehende Vibration in der Klangschale √ºbertr√§gt sich auf den K√∂rper und vermittelt das Gef√ºhl einer wohltuenden Massage.", correctAnswer: null},
              {id: "C", text: "Die regelm√§√üige Ern√§hrung mit Tomaten senkt das Risiko von Krebserkrankungen um fast 50%. Zu diesem Ergebnis kommen Studien der Harvard University. F√ºr die Schutzwirkung verantwortlich ist die rote Farbe der Tomaten, die durch den Stoff Lycopin erzeugt wird. Dabei muss man jedoch beachten, dass die gesundheitsf√∂rdernde Wirkung nur eintritt, wenn die Tomaten gekocht und mit ein wenig Fett, z. B. Oliven√∂l, serviert werden. Aus rohen Tomaten kann der K√∂rper das Lycopin nicht verwerten. Spaghetti Bolognese ist demnach ges√ºnder als Tomatensalat. Tomaten sind in der Mittelmeerk√ºche ein beliebter und unverzichtbarer Bestandteil.", correctAnswer: "14"},
              {id: "D", text: "Dass zu langes In-der-Sonne-Lieben nicht gut ist, wissen im Prinzip alle. Trotzdem lassen sich Jahr f√ºr Jahr unz√§hlige Touristen an den Str√§nden des Mittelmeeres in der Sonne r√∂sten, bis sie einen Sonnenbrand oder schlimmstenfalls sogar schwere Verbrennungen bekommen haben. Doch auch der als harmlos geltende leichte Sonnenbrand ist nicht so ungef√§hrlich, wie viele meinen. Deshalb r√§t die Dermatologische Gesellschaft in Jena allen Sonnenanbetern, sich regelm√§√üig auf erste Anzeichen von Hautkrebs untersuchen zu lassen. Nur wenn der Krebs im Anfangsstadium entdeckt wird, best√ºnden gute Heilungsaussichten, so ein Sprecher der Gesellschaft.", correctAnswer: "12"},
              {id: "E", text: "In der Schwangerschaft haben Frauen einen stark erh√∂hten Bedarf an Vitaminen und Mineralstoffen. Schwangere Frauen sollten daher ihre Nahrung sorgf√§ltig aussuchen und naturbelassene Produkte bevorzugen. Obst, Gem√ºse und Getreide sollten zu den Grundbausteinen der Ern√§hrung geh√∂ren. Milchprodukte, besonders Butter und Sahne, liefern das f√ºr den Knochenaufbau des Babys wichtige Calcium. Auch Fleisch sollte auf dem Speiseplan nicht fehlen, da it das f√ºr den Blutaufbau wichtige Eisen enth√§lt. It sollte aber nicht zu fett sein. Auf keinen Fall sollte eine Frau w√§hrend der Schwangerschaft eine Abmagerungsdi√§t machen, der Verlust an Vitaminen und N√§hrstoffen k√∂nnte sich auf die Entwicklung negativ auswirken.", correctAnswer: "15"},
              {id: "F", text: "Ist Butter ges√ºnder oder Margarine? Ern√§hrungsberater betonen, dass es hinsichtlich Zusammensetzung und Geschmack keine Hinweise darauf gibt, welches der beiden Nahrungsmittel das bessere oder ges√ºndere ist. Da sowohl Butter als auch Margarine viel Fett enth√§lt, sollten sie sparsam benutzt werden. Insbesondere Personen, die an Fettstoffwechselerkrankungen leiden, sollten von beiden Nahrungsmitteln so wenig wie m√∂glich verwenden.", correctAnswer: null},
              {id: "G", text: "Damenschuhe mit hohen Abs√§tzen schaden der Gesundheit, insbesondere der R√ºcken, die Knie und die Wirbels√§ule w√ºrden gesch√§digt. So lautete viele Jahre lang das Urteil vieler Orthop√§den. Dass es sich hierbei nur um ein Vorurteil handelt, berichtet jetzt die britische Fachzeitschrift '√Ñrztliche Praxis'. In einer Langzeitstudie bewiesen die britischen Forscher, dass die H√§ufigkeit von Knie- oder R√ºckenerkrankungen bei Probandinnen, die √ºber mehrere Jahre keine bzw. ausschlie√ülich Schuhe mit hohen Abs√§tzen getragen hatten, nicht verschieden war. Die H√∂he der Schuhabs√§tze hat daher keinen Einfluss auf die Gesundheit.", correctAnswer: "17"},
              {id: "H", text: "In der Sonne liegen und eine braune Haut bekommen, das ist nach wie vor ein wichtiges Ziel vieler Urlauber, die ihre Ferien an den Mittelmeerstr√§nden verbringen. An zweiter Stelle stehen sportliche Aktivit√§ten und Fitnesstraining. Daf√ºr werden sogar Unannehmlichkeiten wie √ºberf√ºllte Str√§nde, √ºberteuerte Sportangebote und mittelm√§√üiges Essen in Kauf genommen. Die kulturelle Bildung, der Besuch von Museen und kulturellen Denkm√§lern in den Urlaubsl√§ndern, steht lediglich bei √§lteren Reisenden hoch im Kurs.", correctAnswer: null},
              {id: "I", text: "Die Fu√üreflexzonenmassage entwickelte im Jahr 1913 der amerikanische Arzt William Fitzgerald. Sie beruht auf der Vorstellung, dass bestimmten Regionen an der Fu√üsohle, an der Fu√üinnenseite und an den Zehen bestimmte Organe des K√∂rpers zugeordnet sind. Durch die Massage der entsprechenden Reflexzonen am Fu√ü werden Nervenreize ausgel√∂st, die Spannungen und Blockaden aufl√∂sen, und die Selbstheilungskraft des K√∂rpers wird aktiviert. Besonders bei Problemen mit der Verdauung, bei Kopf- und R√ºckenschmerzen hat sich die Fu√üreflexzonenmassage bew√§hrt.", correctAnswer: "20"},
              {id: "J", text: "√Ñltere Reisende bevorzugen am Urlaubsziel Ruhe und m√§√üige Aktivit√§t. Viele reisen deswegen in die Mittelgebirge und verbringen ihren Urlaub mit Wandern und ausgedehnten Spazierg√§ngen in der Natur. Sie legen jedoch auch gro√üen Wert auf eine angenehme und komfortable Unterkunft und auf gutes Essen. Beliebte Reiseziele sind in Deutschland der Schwarzwald, der Bayerische Wald, die Rh√∂n sowie Hunsr√ºck und Eifel. Ins Ausland zieht es die Senioren oft nach √ñsterreich, in die Schweiz oder nach Norditalien.", correctAnswer: "16"},
              {id: "K", text: "Tai Chi Chuan ist ein alter chinesischer Begriff. Er bedeutet '√ºber allem stehen'. Beim chinesischen Schattenboxen stehen langsame, weiche und flie√üende Bewegungen im Einklang mit den nat√ºrlichen Bewegungsabl√§ufen des K√∂rpers. Sie f√ºhren, wenn sie regelm√§√üig ge√ºbt werden, zu innerer Ruhe und Harmonie, zur Steigerung der Konzentration und der Ausdauer. Ein chinesischer Spruch lautet: 'Wer Tai Chi nutzt, wird beweglich wie ein Kind, stark wie ein Krieger und ruhig wie ein Weiser'.", correctAnswer: "18"},
              {id: "L", text: "Gute Schuhe m√ºssen nicht unbedingt teuer sein. Zu diesem Ergebnis kommt ein Test, der von einem deutschen Fernsehender durchgef√ºhrt wurde. Mehrere Schul- und Modespezialisten sollten unter √§hnlich aussehenden Modellen das jeweils am besten verarbeitete, das sch√∂nste und das teuerste Modell herausfinden. Dabei waren jeweils ein Designerschuhpaar, zwei Mittelklassemodelle und zwei Paar aus billigen Schuhketten. Im Ergebnis waren die Spezialisten oft nicht in der Lage, die Qualit√§t zu unterscheiden. In einem Fall wurde sogar das billigste Modell f√ºr einen Designerschuh gehalten.", correctAnswer: "13"}
            ],
            situations: [
              {id: "11", text: "Eine Bekannte ist schwanger und sucht Informationen, welche Sportarten erlaubt sind."},
              {id: "12", text: "Ein Bekannter fliegt im Urlaub ans Meer. Sie m√∂chten ihn √ºber m√∂gliche Risiken der Sonnenstrahlung informieren."},
              {id: "13", text: "Ein Bekannter m√∂chte sich modische Schuhe kaufen. Er wei√ü aber nicht, ob er sich das leisten kann."},
              {id: "14", text: "Sie m√∂chten durch pflanzliche Ern√§hrung Ihren K√∂rper vor schweren Krankheiten sch√ºtzen."},
              {id: "15", text: "Eine Bekannte, die ein Kind erwartet, sucht Ern√§hrungstipps."},
              {id: "16", text: "Ein √§lteres Ehepaar sucht Informationen √ºber einen ruhigen Urlaub am Meer."},
              {id: "17", text: "Ihre Freundin denkt dar√ºber nach, alle hochhackigen Schuhe wegzuwerfen, weil sie negative Auswirkungen auf ihre Gelenke bef√ºrchtet."},
              {id: "18", text: "Eine Freundin hat viel Stress und m√∂chte einen Ausgleich finden, der auch mit sportlichen Aktivit√§ten verbunden ist."},
              {id: "19", text: "Eine Freundin bekommt ein Baby. Sie hat oft Schmerzen. Welche M√∂glichkeit gibt es, ihr zu helfen?"},
              {id: "20", text: "Ein Bekannter hat oft Kopfschmerzen. Er m√∂chte jedoch keine Tabletten nehmen."}
            ]
          },
          { 
            id:"s4", 
            title:"Sprachbausteine, Teil 1", 
            points:15,
            passageTitle:"Aufgabe: Erg√§nzen Sie den Text. W√§hlen Sie f√ºr jede L√ºcke das passende Wort.",
            passage: "",
            questions:[],
            fillBlanks: [
              {
                id: "21",
                options: ["her", "hin", "vorbei"],
                correctAnswer: "her"
              },
              {
                id: "22",
                options: ["erkrankt", "gekr√§nkt", "kr√§nklich"],
                correctAnswer: "erkrankt"
              },
              {
                id: "23",
                options: ["als", "da", "wenn"],
                correctAnswer: "wenn"
              },
              {
                id: "24",
                options: ["nicht nur... sondern", "teils... teils", "zwar... aber"],
                correctAnswer: "zwar"
              },
              {
                id: "25",
                options: ["werde", "wollte", "w√ºrde"],
                correctAnswer: "werde"
              },
              {
                id: "26",
                options: ["Daf√ºr", "Danach", "Darauf"],
                correctAnswer: "Darauf"
              },
              {
                id: "27",
                options: ["dar√ºber", "davon", "dazu"],
                correctAnswer: "davon"
              },
              {
                id: "28",
                options: ["dich", "dir", "sich"],
                correctAnswer: "dir"
              },
              {
                id: "29",
                options: ["besch√§ftigen lassen", "besch√§ftigt zu sein", "zu besch√§ftigen"],
                correctAnswer: "zu besch√§ftigen"
              },
              {
                id: "30",
                options: ["weshalb", "wie", "wo"],
                correctAnswer: "wie"
              }
            ],
            fillText: `Liebe Agnieszka,

jetzt ist es schon bald ein halbes Jahr ________, dass ich dir das letzte Mal geschrieben habe. Bitte denke jetzt nicht, dass ich dich vergessen habe. Aber, wie du ja schon wei√üt, stehe ich vor der Abschlusspr√ºfung in Deutsch und das bedeutet jede Menge Arbeit und Stress.

Stell dir vor, ausgerechnet jetzt, nur zwei Wochen vor der Pr√ºfung, ist unsere Lehrerin, Frau Reuter, ________. Sie liegt sogar im Krankenhaus und kommt erst wieder zur√ºck, ________ unsere Pr√ºfung schon l√§ngst vorbei ist. Ihre Vertretung, Frau Eichhorn, ist ________ sehr nett, aber sie hat gerade erst mit dem Unterrichten angefangen und noch keine Erfahrung. Das macht uns alle ein bisschen unsicher. Aber in zwei Wochen ist hoffentlich alles geschafft. Und dann ________ ich alle B√ºcher und Hefte in die Ecke legen und erst einmal ein paar Tage gar nichts tun. ________ freue ich mich schon riesig. Wenn du Zeit und Lust hast, kannst du mich doch besuchen kommen und wir k√∂nnen zusammen etwas unternehmen. Wir wollten doch schon lange Bad Homburg besuchen und im Taunus wandern. Was h√§ltst du ________?

Was macht deine Au-pair-Familie? Musst du immer noch so viel Hausarbeit machen? H√∂ren "deine" Kinder auf dich oder tanzen sie ________ noch immer auf der Nase herum, wie du in deinem letzten Brief geschrieben hast? It ist bestimmt nicht so leicht, einen zweij√§hrigen Jungen und ein vierj√§hriges M√§dchen den ganzen Tag ________. Aber ich kenne dich: Du hast gute Ideen und bestimmt hast du schon einen Weg gefunden, ________ du mit den Kindern zurechtkommst.

So, jetzt muss ich mich wieder an meine Pr√ºfungsvorbereitung machen, sonst wird mir die Zeit zu knapp. Ich gr√º√üe dich ganz herzlich und w√ºnsche dir alles Gute.

Bis bald
Deine Louise`
          },
          { 
            id:"s5", 
            title:"Sprachbausteine, Teil 2", 
            points:15,
            passageTitle:"Aufgabe: Lesen Sie den Text und entscheiden Sie, welches Wort in welche L√ºcke passt. Sie k√∂nnen jedes Wort nur einmal verwenden. Nicht alle W√∂rter passen in den Text.",
            passage: "",
            questions:[],
            fillBlanks2: [
              {
                id: "31",
                options: ["AN", "AUF", "BEINAHE", "DANN", "DENN", "D√úRFEN", "FAST", "INNERHALB", "KAUM", "M√úSSEN", "SOLLEN", "STATT", "VOR", "VORBEI", "DAS"],
                correctAnswer: "KAUM"
              },
              {
                id: "32", 
                options: ["AN", "AUF", "BEINAHE", "DANN", "DENN", "D√úRFEN", "FAST", "INNERHALB", "KAUM", "M√úSSEN", "SOLLEN", "STATT", "VOR", "VORBEI", "DAS"],
                correctAnswer: "AUF"
              },
              {
                id: "33",
                options: ["AN", "AUF", "BEINAHE", "DANN", "DENN", "D√úRFEN", "FAST", "INNERHALB", "KAUM", "M√úSSEN", "SOLLEN", "STATT", "VOR", "VORBEI", "DAS"],
                correctAnswer: "VORBEI"
              },
              {
                id: "34",
                options: ["AN", "AUF", "BEINAHE", "DANN", "DENN", "D√úRFEN", "FAST", "INNERHALB", "KAUM", "M√úSSEN", "SOLLEN", "STATT", "VOR", "VORBEI", "DAS"],
                correctAnswer: "STATT"
              },
              {
                id: "35",
                options: ["AN", "AUF", "BEINAHE", "DANN", "DENN", "D√úRFEN", "FAST", "INNERHALB", "KAUM", "M√úSSEN", "SOLLEN", "STATT", "VOR", "VORBEI", "DAS"],
                correctAnswer: "INNERHALB"
              },
              {
                id: "36",
                options: ["AN", "AUF", "BEINAHE", "DANN", "DENN", "D√úRFEN", "FAST", "INNERHALB", "KAUM", "M√úSSEN", "SOLLEN", "STATT", "VOR", "VORBEI", "DAS"],
                correctAnswer: "M√úSSEN"
              },
              {
                id: "37",
                options: ["AN", "AUF", "BEINAHE", "DANN", "DENN", "D√úRFEN", "FAST", "INNERHALB", "KAUM", "M√úSSEN", "SOLLEN", "STATT", "VOR", "VORBEI", "DAS"],
                correctAnswer: "AN"
              },
              {
                id: "38",
                options: ["AN", "AUF", "BEINAHE", "DANN", "DENN", "D√úRFEN", "FAST", "INNERHALB", "KAUM", "M√úSSEN", "SOLLEN", "STATT", "VOR", "VORBEI", "DAS"],
                correctAnswer: "SOLLEN"
              },
              {
                id: "39",
                options: ["AN", "AUF", "BEINAHE", "DANN", "DENN", "D√úRFEN", "FAST", "INNERHALB", "KAUM", "M√úSSEN", "SOLLEN", "STATT", "VOR", "VORBEI", "DAS"],
                correctAnswer: "DANN"
              },
              {
                id: "40",
                options: ["AN", "AUF", "BEINAHE", "DANN", "DENN", "D√úRFEN", "FAST", "INNERHALB", "KAUM", "M√úSSEN", "SOLLEN", "STATT", "VOR", "VORBEI", "DAS"],
                correctAnswer: "DENN"
              }
            ],
            fillText2: `Das Fahrrad: ernsthafte Konkurrenz f√ºrs Auto?

Welches Fortbewegungsmittel, denken Sie, wird in Deutschland am h√§ufigsten benutzt? Nat√ºrlich das Automobil. Volkswagen, Porsche, Mercedes Benz, BMW, Audi: In ________ einem anderen Land gibt es so viele Automobilfabriken wie in Deutschland, spielt die Automobilindustrie eine so gro√üe Rolle. Nahezu jeder Haushalt verf√ºgt √ºber mindestens ein Auto, das Auto spielt im Leben der Deutschen eine gro√üe Rolle, sowohl als Fortbewegungsmittel zum Arbeitsplatz oder in den Urlaub als auch als Statussymbol: Zeig mir dein Auto und ich wei√ü, wer du bist.

Doch hat das Autofahren auch Schattenseiten. Mangelnde Bewegungsm√∂glichkeiten, gesundheitliche Probleme und Stress bringen zumindest in den Gro√üst√§dten immer more Autofahrer dazu, sich vom Automobil freizumachen und ________ ein anderes Verkehrsmittel umzusteigen, das in dem Ruf steht, ges√ºnder zu sein als das Auto: das Fahrrad. Nicht nur in der Freizeit, sondern auch auf dem Weg zum Arbeitsplatz wird das Rad benutzt. "Ich habe keine Lust, Morgen f√ºr Morgen im Stau zu stehen und Zeit zu verlieren", sagt Bettina Meier (25): "Da ist it viel entspannender, auf den zumeist gut ausgebauten Fahrradwegen an den im Stau wartenden Fahrzeugen ________ und ausgeruht am Arbeitsplatz anzukommen."

Dass Fahrradfahren um einiges ges√ºnder ist, als hinter dem Lenkrad zu sitzen, best√§tigen auch die Mediziner. Wer Fahrrad f√§hrt ________ zu sitzen, bringt seinen Blutkreislauf in Schwung, st√§rkt die Abwehrkr√§fte des K√∂rpers und trainiert seinen K√∂rper. Auch die Bewegung an der frischen Luft tut Menschen gut, die sich sonst die meiste Zeit ________ geschlossener R√§ume in B√ºros, Schulen oder Fabriken aufhalten ________.

Auch die Gesch√§ftswelt hat die Fahrradfahrer als Kunden entdeckt. Ein breites Angebot ________ Zubeh√∂r f√ºr Fahrr√§der von schicken Radfelgen √ºber sportliche Mehrganggetriebe, mit denen Berge kein Problem mehr darstellen, bis zur Designer-Trinkflasche machen aus dem einfachen Fahrrad ein exlusives Fahrzeug. Und nat√ºrlich darf bei keinem Fahrradfahrer eine aufw√§ndige Sicherheitsausstattung more fehlen: Schutzhelme, Ellenbogen- und Kniesch√ºtzer, die das Fahrrad im Falle eines Unfalls fast so sicher wie einen Panzer machen ________.

Nur wenn es regnet und das passiert in Deutschland leider nicht so selten -, ________ sind die Autoschlangen wieder l√§nger. ________ einen praktischen Wetterschutz f√ºr Radfahrer haben die Gesch√§fte noch nicht im Angebot.`
          }
        ]
      };

      let state = { 
        sectionIndex: 0, 
        questionIndex: 0, 
        answers: {}, 
        marked: {}, 
        remaining: exam.durationSec,
        showResults: false,
        timerStarted: false,
        timerInterval: null
      };
      const topTiles = document.getElementById('topTiles-lesen');
      const passageTitleEl = document.getElementById('passageTitle-lesen');
      const passageContentEl = document.getElementById('passageContent-lesen');
      const sectionNameEl = document.getElementById('sectionName-lesen');
      const questionTitleEl = document.getElementById('questionTitle-lesen');
      const questionBodyEl = document.getElementById('questionBody-lesen');
      const headingsBankContainer = document.getElementById('headingsBankContainer-lesen');
      const timerEl = document.getElementById('timer-lesen');
      const statusText = document.getElementById('statusText-lesen');
      const resultBtn = document.getElementById('resultBtn-lesen');
      const resetBtn = document.getElementById('resetBtn-lesen');
      const resetSectionBtn = document.getElementById('resetSectionBtn-lesen');

      function startTimer(){
        if(state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        
        state.timerStarted = true;
        state.timerInterval = setInterval(()=>{
          if(state.remaining <= 0){
            clearInterval(state.timerInterval);
            timerEl.textContent = 'Zeit abgelaufen';
            return;
          }
          state.remaining--;
          updateTimerDisplay();
        }, 1000);
      }

      function resetTimer(){
        if(state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        state.remaining = exam.durationSec;
        state.timerStarted = false;
        updateTimerDisplay();
        startTimer();
      }

      function updateTimerDisplay(){
        const min = Math.floor(state.remaining / 60);
        const sec = state.remaining % 60;
        timerEl.textContent = `Verbleibende Zeit: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
      }

      function resetCurrentSection() {
        const currentSection = exam.sections[state.sectionIndex];
        
        if (confirm(`M√∂chten Sie wirklich den Teil "${currentSection.title}" zur√ºcksetzen? Alle Antworten in diesem Teil werden gel√∂scht.`)) {
          if (currentSection.id === 's1') {
            currentSection.texts.forEach(text => {
              delete state.answers[text.id];
            });
          } else if (currentSection.id === 's2') {
            currentSection.questions.forEach(question => {
              delete state.answers[question.id];
            });
          } else if (currentSection.id === 's3') {
            currentSection.situations.forEach(situation => {
              delete state.answers[situation.id];
            });
          } else if (currentSection.id === 's4') {
            currentSection.fillBlanks.forEach(blank => {
              delete state.answers[blank.id];
            });
          } else if (currentSection.id === 's5') {
            currentSection.fillBlanks2.forEach(blank => {
              delete state.answers[blank.id];
            });
          }
          
          renderAll();
        }
      }

      function renderTopTiles(){ 
        topTiles.innerHTML=''; 
        exam.sections.forEach((sec,idx)=>{ 
          const div=document.createElement('div'); 
          div.className='tile'+(idx===state.sectionIndex?' active':'')+(isSectionDone(sec)?' done':''); 
          div.innerHTML=`<div>${sec.title}</div><div class="points">${sec.points} P</div>`; 
          div.onclick=()=>{state.sectionIndex=idx; state.questionIndex=0; state.showResults=false; renderAll();}; 
          topTiles.appendChild(div); 
        }); 
      }

      function isSectionDone(section){
        if(section.id==='s1') return section.texts.every(t=>state.answers[t.id]);
        if(section.id==='s2') return section.questions.every(q=>state.answers[q.id]);
        if(section.id==='s3') return section.situations.every(h=>state.answers[h.id] || state.answers[h.id] === 'X');
        if(section.id==='s4') return section.fillBlanks.every(b=>state.answers[b.id]);
        if(section.id==='s5') return section.fillBlanks2.every(b=>state.answers[b.id]);
        return false;
      }

      function renderAll(){
        renderTopTiles();
        const section = exam.sections[state.sectionIndex];
        sectionNameEl.textContent = section.title;
        passageTitleEl.textContent = section.passageTitle;
        
        resetSectionBtn.style.display = 'block';
        
        if(state.showResults){
          renderResults();
          return;
        }
        
        if(section.id === 's1'){
          renderPart1();
        } else if(section.id === 's2'){
          renderPart2();
        } else if(section.id === 's3'){
          renderPart3();
        } else if(section.id === 's4'){
          renderSprachbausteine1();
        } else if(section.id === 's5'){
          renderSprachbausteine2();
        }
      }

      function renderPart1(){
        const section = exam.sections[state.sectionIndex];
        
        let textsHTML = `<div class="instructions">Ziehen Sie die passenden √úberschriften auf die Texte. Sie k√∂nnen jede √úberschrift nur einmal verwenden.</div>`;
        
        section.texts.forEach((text, idx) => {
          const letter = String.fromCharCode(97 + idx);
          const selectedHeading = state.answers[text.id];
          
          textsHTML += `
            <div class="text-container">
              <div class="text-title">Text ${letter.toUpperCase()}</div>
              <div class="text-content">${text.content}</div>
              <div class="title-slot ${selectedHeading ? 'has-title' : ''}" data-text-id="${text.id}">
                ${selectedHeading ? getHeadingTextById(selectedHeading) : 'Ziehen Sie hier eine √úberschrift hin'}
              </div>
            </div>
          `;
        });
        
        passageContentEl.innerHTML = textsHTML;
        
        let headingsHTML = `<div class="headings-bank">`;
        section.headings.forEach(heading => {
          const isUsed = section.texts.some(text => state.answers[text.id] === heading.id);
          
          headingsHTML += `
            <div class="heading-item ${isUsed ? 'used' : ''}" draggable="${!isUsed}" data-heading-id="${heading.id}">
              ${heading.id}) ${heading.text}
            </div>
          `;
        });
        
        headingsHTML += `</div>`;
        
        headingsBankContainer.innerHTML = headingsHTML;
        
        setupDragAndDrop();
        
        questionBodyEl.innerHTML = '';
        questionTitleEl.textContent = '';
      }

      function getHeadingTextById(id){
        const section = exam.sections[state.sectionIndex];
        const heading = section.headings.find(h => h.id === id);
        return heading ? `${heading.id}) ${heading.text}` : '';
      }

      function setupDragAndDrop(){
        const headingItems = document.querySelectorAll('.heading-item:not(.used)');
        const titleSlots = document.querySelectorAll('.title-slot');
        
        headingItems.forEach(item => {
          item.addEventListener('dragstart', (e) => {
            e.dataTransfer.setData('text/plain', e.target.dataset.headingId);
          });
        });
        
        titleSlots.forEach(slot => {
          slot.addEventListener('dragover', (e) => {
            e.preventDefault();
            slot.style.background = '#e8f4ff';
          });
          
          slot.addEventListener('dragleave', (e) => {
            slot.style.background = slot.classList.contains('has-title') ? '#e8fbe9' : '#f8fbff';
          });
          
          slot.addEventListener('drop', (e) => {
            e.preventDefault();
            const headingId = e.dataTransfer.getData('text/plain');
            const textId = slot.dataset.textId;
            
            Object.keys(state.answers).forEach(key => {
              if(state.answers[key] === headingId) {
                delete state.answers[key];
              }
            });
            
            state.answers[textId] = headingId;
            renderAll();
          });
        });
      }

      function renderPart2(){
        const section = exam.sections[state.sectionIndex];
        
        passageContentEl.innerHTML = `<div class="passage">${section.passage}</div>`;
        
        let questionsHTML = `<div class="all-questions">`;
        
        section.questions.forEach((question, idx) => {
          const questionNumber = idx + 1;
          const userAnswer = state.answers[question.id];
          
          questionsHTML += `
            <div class="question-block">
              <div class="question-text">${questionNumber}. ${question.text}</div>
              <div class="options">
                ${question.options.map(opt => `
                  <div class="option ${userAnswer === opt.id ? 'selected' : ''}" 
                       onclick="window.lesenApp.selectOption('${question.id}', '${opt.id}')">
                    <div class="radio"></div>
                    <div>${opt.text}</div>
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        });
        
        questionsHTML += `</div>`;
        
        questionBodyEl.innerHTML = questionsHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';
      }

      function renderPart3(){
        const section = exam.sections[state.sectionIndex];
        
        let textsHTML = `
          <div class="instructions">Ziehen Sie die passenden Situationen auf die Texte. Sie k√∂nnen jede Situation nur einmal verwenden. Manchmal passt keine Situation.</div>
          <div class="texts-list">
            <h3>Texte (A-L)</h3>
        `;
        
        section.texts.forEach(text => {
          const userAnswer = Object.keys(state.answers).find(key => state.answers[key] === text.id);
          const selectedSituation = userAnswer ? section.situations.find(h => h.id === userAnswer) : null;
          
          textsHTML += `
            <div class="text-item" data-text-id="${text.id}">
              <div class="text-letter">${text.id})</div>
              <div class="text-content">${text.text}</div>
              <div class="title-slot ${userAnswer ? 'has-title' : ''} ${userAnswer === 'X' ? 'has-x' : ''}" data-text-id="${text.id}">
                ${selectedSituation ? selectedSituation.text : (userAnswer === 'X' ? 'X - Keine passende Situation' : 'Ziehen Sie hier eine Situation hin')}
              </div>
            </div>
          `;
        });
        
        textsHTML += `</div>`;
        
        passageContentEl.innerHTML = textsHTML;
        
        let situationsHTML = `
          <div class="situations-list">
            <h3>Situationen (11-20)</h3>
        `;
        
        section.situations.forEach((situation, idx) => {
          const situationNumber = parseInt(situation.id);
          const isUsed = state.answers[situation.id];
          const isX = state.answers[situation.id] === 'X';
          
          situationsHTML += `
            <div class="situation-item ${isUsed ? 'used' : ''}" draggable="${!isUsed}" data-situation-id="${situation.id}">
              <div class="situation-number">${situationNumber}.</div>
              <div class="situation-text">${situation.text}</div>
              ${!isUsed ? `<button class="exam-btn no-match ${isX ? 'selected' : ''}" onclick="window.lesenApp.markNoMatch('${situation.id}')">X - Kein passender Text</button>` : ''}
            </div>
          `;
        });
        
        situationsHTML += `</div>`;
        
        questionBodyEl.innerHTML = situationsHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';
        
        setupPart3DragAndDrop();
      }

      function markNoMatch(situationId) {
        Object.keys(state.answers).forEach(key => {
          if(state.answers[key] === situationId) {
            delete state.answers[key];
          }
        });
        
        state.answers[situationId] = 'X';
        try{ localStorage.setItem('lesenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        renderAll();
      }

      function setupPart3DragAndDrop(){
        const situationItems = document.querySelectorAll('.situation-item:not(.used)');
        const textSlots = document.querySelectorAll('.text-item .title-slot');
        
        situationItems.forEach(item => {
          item.addEventListener('dragstart', (e) => {
            e.dataTransfer.setData('text/plain', e.target.dataset.situationId);
          });
        });
        
        textSlots.forEach(slot => {
          slot.addEventListener('dragover', (e) => {
            e.preventDefault();
            slot.style.background = '#e8f4ff';
          });
          
          slot.addEventListener('dragleave', (e) => {
            const hasTitle = slot.classList.contains('has-title');
            const hasX = slot.classList.contains('has-x');
            slot.style.background = hasTitle ? '#e8fbe9' : (hasX ? '#f8d7da' : '#f8fbff');
          });
          
          slot.addEventListener('drop', (e) => {
            e.preventDefault();
            const situationId = e.dataTransfer.getData('text/plain');
            const textId = slot.dataset.textId;
            
            Object.keys(state.answers).forEach(key => {
              if(state.answers[key] === situationId) {
                delete state.answers[key];
              }
            });
            
            state.answers[situationId] = textId;
            renderAll();
          });
        });
      }

      function renderSprachbausteine1(){
        const section = exam.sections[state.sectionIndex];
        
        let textWithBlanks = section.fillText;
        
        const blankPlaceholders = [];
        section.fillBlanks.forEach(blank => {
          blankPlaceholders.push(`BLANK_${blank.id}`);
        });
        
        let tempText = textWithBlanks;
        blankPlaceholders.forEach((placeholder, index) => {
          tempText = tempText.replace('________', placeholder);
        });
        
        section.fillBlanks.forEach(blank => {
          const userAnswer = state.answers[blank.id];
          const displayText = userAnswer ? userAnswer : '________';
          tempText = tempText.replace(`BLANK_${blank.id}`, `<span class="blank-word ${userAnswer ? 'has-answer' : ''}" data-blank-id="${blank.id}">${displayText}</span>`);
        });
        
        passageContentEl.innerHTML = `
          <div class="instructions">Klicken Sie auf jede L√ºcke und w√§hlen Sie das passende Wort aus. Sie k√∂nnen die L√ºcken in beliebiger Reihenfolge ausf√ºllen.</div>
          <div class="fill-blank-container">${tempText}</div>
        `;
        
        document.querySelectorAll('.blank-word').forEach(blank => {
  blank.addEventListener('click', (e) => {
    // ŸÑŸÑÿÆŸäÿßÿ±ÿßÿ™ ÿßŸÑÿπÿßÿØŸäÿ©
    if (!blank.textContent.includes('...')) {
      showOptionsPopup(e.target);
    }
  });
});

// ŸÖÿπÿßŸÑÿ¨ÿ© ÿÆÿßÿµÿ© ŸÑŸÑÿÆŸäÿßÿ±ÿßÿ™ ÿßŸÑÿ™Ÿä ÿ™ÿ≠ÿ™ŸàŸä ÿπŸÑŸâ "..."
document.querySelectorAll('.option-btn').forEach(btn => {
  btn.addEventListener('click', function() {
    const optionText = this.textContent.trim();
    
    // ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑÿÆŸäÿßÿ± Ÿäÿ≠ÿ™ŸàŸä ÿπŸÑŸâ "..."
    if (optionText.includes('...')) {
      const blankId = this.closest('.option-row').querySelector('.option-number').textContent;
      const words = optionText.split('...');
      
      if (words.length === 2) {
        state.answers[blankId] = optionText;
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÅÿ¨Ÿàÿßÿ™ ŸÅŸä ÿßŸÑŸÜÿµ
        document.querySelectorAll('.blank-word[data-blank-id="' + blankId + '"]').forEach(blank => {
          blank.textContent = optionText;
          blank.classList.add('has-answer');
        });
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿ≤ÿ± ÿßŸÑÿÆŸäÿßÿ±
        this.closest('.option-buttons').querySelectorAll('.option-btn').forEach(b => {
          b.classList.remove('selected');
        });
        this.classList.add('selected');
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ÿßŸäŸÑÿßÿ™
        renderTopTiles();
      }
    }
  });
});
        
        let optionsHTML = `<div class="horizontal-options" style="gap: 8px;">`;
        
        section.fillBlanks.forEach(blank => {
          const userAnswer = state.answers[blank.id];
          
          optionsHTML += `
            <div class="option-row" style="padding: 8px; margin-bottom: 5px;">
              <div class="option-number">${blank.id}</div>
              <div class="option-buttons">
                ${blank.options.map(opt => `
                  <div class="option-btn ${userAnswer === opt ? 'selected' : ''}" 
                       onclick="window.lesenApp.selectSprachbausteine1('${blank.id}', '${opt}')" 
                       style="padding: 6px 12px; font-size: 12px;">
                    ${opt}
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        });
        
        optionsHTML += `</div>`;
        
        questionBodyEl.innerHTML = optionsHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';
      }

      function showOptionsPopup(blankElement){
        const existingPopup = document.querySelector('.options-popup');
        if(existingPopup) {
          existingPopup.remove();
        }
        
        const blankId = blankElement.getAttribute('data-blank-id');
        const section = exam.sections.find(s => s.id === 's4');
        const blank = section.fillBlanks.find(b => b.id === blankId);
        
        if(!blank) return;
        
        const popup = document.createElement('div');
        popup.className = 'options-popup';
        
        blank.options.forEach(opt => {
          const optionItem = document.createElement('div');
          optionItem.className = 'option-item';
          optionItem.textContent = opt;
          optionItem.onclick = () => {
            selectSprachbausteine1(blankId, opt);
            popup.remove();
          };
          popup.appendChild(optionItem);
        });
        
        blankElement.appendChild(popup);
      }

      function selectSprachbausteine1(blankId, answer){
  // ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑÿ¨Ÿàÿßÿ® Ÿäÿ≠ÿ™ŸàŸä ÿπŸÑŸâ "..."
  if (answer.includes('...')) {
    const words = answer.split('...');
    if (words.length === 2) {
      state.answers[blankId] = answer;
      
      // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÅÿ¨Ÿàÿßÿ™ ŸÅŸä ÿßŸÑŸÜÿµ
      document.querySelectorAll('.blank-word[data-blank-id="' + blankId + '"]').forEach(blank => {
        blank.textContent = answer;
        blank.classList.add('has-answer');
      });
      
      // ÿ™ÿ≠ÿØŸäÿ´ ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™
      document.querySelectorAll('.option-row').forEach(row => {
        const rowBlankId = row.querySelector('.option-number').textContent.trim();
        if (rowBlankId === blankId) {
          row.querySelectorAll('.option-btn').forEach(btn => {
            btn.classList.remove('selected');
            if (btn.textContent.trim() === answer) {
              btn.classList.add('selected');
            }
          });
        }
      });
      
      // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ÿßŸäŸÑÿßÿ™
      renderTopTiles();
      return;
    }
  }
  
  // ŸÑŸÑÿÆŸäÿßÿ±ÿßÿ™ ÿßŸÑÿπÿßÿØŸäÿ©
  state.answers[blankId] = answer;
  renderAll();
}

      function renderSprachbausteine2(){
        const section = exam.sections[state.sectionIndex];
        let textWithPlaceholders = section.fillText2;
        const placeholders = [];
        section.fillBlanks2.forEach(blank => {
          const ph = `BLANK_${blank.id}`;
          placeholders.push({id: blank.id, ph});
          textWithPlaceholders = textWithPlaceholders.replace('________', ph);
        });

        placeholders.forEach(item => {
          const userAnswer = state.answers[item.id];
          const displayText = userAnswer ? userAnswer : '________';
          const span = `<span class="blank-slot ${userAnswer ? 'has-answer' : ''}" data-blank-id="${item.id}">${displayText}</span>`;
          textWithPlaceholders = textWithPlaceholders.replace(item.ph, span);
        });

        passageContentEl.innerHTML = `
          <div class="instructions">Klicken Sie auf jede L√ºcke und w√§hlen Sie das passende Wort aus. Sie k√∂nnen jedes Wort nur einmal verwenden.</div>
          <div class="fill-blank-container">${textWithPlaceholders}</div>
        `;

        document.querySelectorAll('.blank-slot').forEach(slot => {
          slot.addEventListener('click', (e) => {
            showSprachbausteine2Options(slot);
          });
        });

        let wordBankHTML = `<div class="word-bank-vertical" style="gap: 8px;">`;
        const usedWords = Object.values(state.answers);
        const bank = section.wordBank && section.wordBank.length ? section.wordBank : (section.fillBlanks2[0] ? section.fillBlanks2[0].options : []);
        bank.forEach(word => {
          const isUsed = usedWords.includes(word);
          wordBankHTML += `
            <div class="bank-word-vertical ${isUsed ? 'used' : ''}" 
                 draggable="${!isUsed}" 
                 data-word="${word}"
                 ${!isUsed ? `onclick="window.lesenApp.selectSprachbausteine2FromBank('${word}')"` : ''}>
              ${word}
            </div>
          `;
        });
        wordBankHTML += `</div>`;
        questionBodyEl.innerHTML = wordBankHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';

        setupSprachbausteine2DragAndDrop();
      }

      let lastClickedSprachSlot = null;

      function setupSprachbausteine2DragAndDrop(){
        const bankWords = Array.from(document.querySelectorAll('.bank-word-vertical'));
        bankWords.forEach(el => {
          const word = el.dataset.word;
          if(!el.classList.contains('used')){
            el.setAttribute('draggable','true');
          } else {
            el.setAttribute('draggable','false');
          }
          el.removeEventListener('dragstart', el._dstart);
          el._dstart = (e) => {
            e.dataTransfer.setData('text/plain', word);
            e.dataTransfer.setData('source', 'bank');
          };
          el.addEventListener('dragstart', el._dstart);

          el.removeEventListener('click', el._onclick);
          el._onclick = () => {
            if(el.classList.contains('used')) return;
            selectSprachbausteine2FromBank(word);
          };
          el.addEventListener('click', el._onclick);
        });

        const slots = Array.from(document.querySelectorAll('.blank-slot'));
        slots.forEach(slot => {
          slot.addEventListener('dragover', (e) => {
            e.preventDefault();
            slot.classList.add('drag-over');
          });
          slot.addEventListener('dragleave', (e) => {
            slot.classList.remove('drag-over');
          });
          slot.addEventListener('drop', (e) => {
            e.preventDefault();
            slot.classList.remove('drag-over');
            const word = e.dataTransfer.getData('text/plain') || e.dataTransfer.getData('text/html');
            if(!word) return;
            const blankId = slot.dataset.blankId;
            if(!blankId) return;
            Object.keys(state.answers).forEach(k => {
              if(state.answers[k] === word){
                delete state.answers[k];
              }
            });
            const prev = state.answers[blankId];
            if(prev){
              const prevEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === prev);
              if(prevEl){
                prevEl.classList.remove('used');
                prevEl.setAttribute('draggable','true');
                prevEl.addEventListener('click', prevEl._onclick);
              }
            }
            const bankEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === word);
            if(bankEl){
              bankEl.classList.add('used');
              bankEl.setAttribute('draggable','false');
              bankEl.removeEventListener('click', bankEl._onclick);
            }
            state.answers[blankId] = word;
            renderAll();
          });
        });
      }

      function showSprachbausteine2Options(slot){
        document.querySelectorAll('.blank-slot').forEach(s => s.classList.remove('selected-sprach'));
        slot.classList.add('selected-sprach');
        lastClickedSprachSlot = slot;
      }

      function selectSprachbausteine2FromBank(word){
        let slot = lastClickedSprachSlot;
        if(!slot){
          slot = Array.from(document.querySelectorAll('.blank-slot')).find(s => {
            const id = s.dataset.blankId;
            return !state.answers[id];
          });
        }
        if(!slot) {
          return;
        }
        const blankId = slot.dataset.blankId;
        Object.keys(state.answers).forEach(k => {
          if(state.answers[k] === word){
            delete state.answers[k];
          }
        });
        const prev = state.answers[blankId];
        if(prev){
          const prevEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === prev);
          if(prevEl){
            prevEl.classList.remove('used');
            prevEl.setAttribute('draggable','true');
            if(prevEl._onclick) prevEl.addEventListener('click', prevEl._onclick);
          }
        }
        const bankEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === word);
        if(bankEl){
          bankEl.classList.add('used');
          bankEl.setAttribute('draggable','false');
          if(bankEl._onclick) try{ bankEl.removeEventListener('click', bankEl._onclick); }catch(e){}
        }
        state.answers[blankId] = word;
        try{ localStorage.setItem('lesenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        lastClickedSprachSlot = null;
        renderAll();
      }

      function selectOption(questionId, optionId){
        state.answers[questionId] = optionId;
        try{ localStorage.setItem('lesenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        renderAll();
      }

      function renderResults(){
        let resultsHTML = `<h2>Ergebnisse</h2>`;
        let totalCorrect = 0;
        let totalQuestions = 0;
        
        exam.sections.forEach(section => {
          resultsHTML += `<div class="result-item"><h3>${section.title}</h3>`;
          
          if(section.id === 's1'){
            section.texts.forEach(text => {
              totalQuestions++;
              const userAnswer = state.answers[text.id];
              const isCorrect = userAnswer === text.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>Text ${text.id}: ${userAnswer || '-'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's2'){
            section.questions.forEach(question => {
              totalQuestions++;
              const userAnswer = state.answers[question.id];
              const isCorrect = userAnswer === question.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>${question.text}: ${userAnswer || '-'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's3'){
            section.situations.forEach(situation => {
              totalQuestions++;
              const userAnswer = state.answers[situation.id];
              const correctText = section.texts.find(t => t.correctAnswer === situation.id);
              const isCorrect = userAnswer === (correctText ? correctText.id : null);
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>Situation ${situation.id}: ${userAnswer || '-'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's4'){
            section.fillBlanks.forEach(blank => {
              totalQuestions++;
              const userAnswer = state.answers[blank.id];
              const isCorrect = userAnswer === blank.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>L√ºcke ${blank.id}: ${userAnswer || '-'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's5'){
            section.fillBlanks2.forEach(blank => {
              totalQuestions++;
              const userAnswer = state.answers[blank.id];
              const isCorrect = userAnswer === blank.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>L√ºcke ${blank.id}: ${userAnswer || '-'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          }
          
          resultsHTML += `</div>`;
        });
        
        const percentage = totalQuestions > 0 ? Math.round((totalCorrect / totalQuestions) * 100) : 0;
        resultsHTML += `<div class="result-item"><h3>Gesamtergebnis: ${totalCorrect}/${totalQuestions} (${percentage}%)</h3></div>`;
        
        passageContentEl.innerHTML = resultsHTML;
        questionBodyEl.innerHTML = '';
        sectionNameEl.textContent = 'Ergebnisse';
        questionTitleEl.textContent = '';
      }

      document.getElementById('prevBtn-lesen').addEventListener('click', ()=>{
        if(state.sectionIndex > 0){
          state.sectionIndex--;
          state.questionIndex = 0;
          renderAll();
        }
      });

      document.getElementById('nextBtn-lesen').addEventListener('click', ()=>{
        if(state.sectionIndex < exam.sections.length - 1){
          state.sectionIndex++;
          state.questionIndex = 0;
          renderAll();
        }
      });

      resultBtn.addEventListener('click', ()=>{
        state.showResults = !state.showResults;
        renderAll();
      });

      resetBtn.addEventListener('click', ()=>{
        if(confirm('M√∂chten Sie wirklich von neu beginnen? Alle Antworten werden gel√∂scht.')){
          state.answers = {};
          state.marked = {};
          state.showResults = false;
          resetTimer();
          renderAll();
        }
      });

      resetSectionBtn.addEventListener('click', resetCurrentSection);

      document.getElementById('saveBtn-lesen').addEventListener('click', ()=>{
        statusText.textContent = 'Gespeichert';
        setTimeout(()=>{statusText.textContent = 'Nicht gespeichert'}, 2000);
      });

      document.getElementById('submitBtn-lesen').addEventListener('click', ()=>{
        if(confirm('M√∂chten Sie die Pr√ºfung wirklich abgeben?')){
          state.showResults = true;
          renderAll();
        }
      });

      document.getElementById('nextBtn-lesen').addEventListener('click', ()=>{
        showPage('hoeren-page');
      });

      updateTimerDisplay();
      renderAll();
      startTimer();
      
      window._lesenState = state;
      window.lesenApp = {
        selectOption,
        markNoMatch,
        selectSprachbausteine1,
        selectSprachbausteine2FromBank
      };
    }

    // ===== H√ñREN PAGE FUNCTIONALITY =====
    function initHoerenPage() {
      const exam = {
        id: "exam-h√∂rverstehen",
        durationSec: 17 * 60,
        sections: [
          { 
            id: "h√∂rverstehen1", 
            title: "H√∂rverstehen, Teil 1", 
            points: 25,
            correctAnswers: { "41": "falsch", "42": "richtig", "43": "richtig", "44": "falsch", "45": "richtig" },
            questions: [
              {
                id: "41",
                text: "Die Stadt Friedrichsberg l√§dt zu einer Preisverleihung ein"
              },
              {
                id: "42", 
                text: "Die Alte Br√ºcke ist zum Jahresbeginn wieder befahrbar"
              },
              {
                id: "43",
                text: "Der Wanderer wurde verarztet und in Sicherheit gebracht"
              },
              {
                id: "44",
                text: "In dem Unternehmen kommt es zu K√ºndigungen"
              },
              {
                id: "45",
                text: "Man kann nach einer Registrierung an einem Gruppenlauf teilnehmen"
              }
            ]
          },
          { 
            id: "h√∂rverstehen2", 
            title: "H√∂rverstehen, Teil 2", 
            points: 25,
            correctAnswers: { "46": "richtig", "47": "falsch", "48": "richtig", "49": "richtig", "50": "richtig", "51": "falsch", "52": "falsch", "53": "richtig", "54": "falsch", "55": "falsch" },
            questions: [
              {
                id: "46",
                text: "Der Berufseinstieg ist in anderen L√§ndern nicht leicht"
              },
              {
                id: "47",
                text: "Carina ist ihr Beruf wichtiger als ihr Privatleben"
              },
              {
                id: "48", 
                text: "Carina hat sich der Agentur mit einem Film pr√§sentiert"
              },
              {
                id: "49",
                text: "Carina musste f√ºr einen Film ihr Gewicht stark ver√§ndern"
              },
              {
                id: "50",
                text: "Carina macht lieber gef√ºhlvolle Filme als Action-Filme"
              },
              {
                id: "51",
                text: "Wegen der vielen Fehlstunden hatte Carina Probleme mit dem Direktor der Schule"
              },
              {
                id: "52",
                text: "Carinas Eltern haben ihre Tochter von Anfang an unterst√ºtzt"
              },
              {
                id: "53",
                text: "Carina findet den Wechsel zwischen Schule und Drehterminen nicht leicht"
              },
              {
                id: "54",
                text: "Bei Dialogen darf man auch selbst etwas erfinden"
              },
              {
                id: "55",
                text: "Carina empfiehlt, sich andere Schauspieler im Theater und in Filmen anzusehen"
              }
            ]
          },
          { 
            id: "h√∂rverstehen3", 
            title: "H√∂rverstehen, Teil 3", 
            points: 25,
            correctAnswers: { "56": "richtig", "57": "falsch", "58": "falsch", "59": "falsch", "60": "richtig" },
            questions: [
              {
                id: "56",
                text: "Man kann am 'Tag des Ehrenamts' probeweise mithelfen"
              },
              {
                id: "57",
                text: "Die Skateboard-Vorf√ºhrung f√§llt dieses Mal aus"
              },
              {
                id: "58",
                text: "Vor Passwort-Programmen wird gewarnt"
              },
              {
                id: "59",
                text: "Es wird empfohlen, mit dem Fahrrad zum Volkspark zu fahren"
              },
              {
                id: "60",
                text: "Wenn man das Training ausprobieren m√∂chte, muss man vorher Bescheid sagen"
              }
            ]
          }
        ]
      };

      let state = { 
        sectionIndex: 0, 
        answers: {}, 
        remaining: exam.durationSec,
        showResults: false,
        timerStarted: false,
        timerInterval: null
      };
      
      const topTiles = document.getElementById('topTiles-hoeren');
      const contentContainer = document.getElementById('contentContainer-hoeren');
      const timerEl = document.getElementById('timer-hoeren');
      const statusText = document.getElementById('statusText-hoeren');

      function startTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        
        state.timerStarted = true;
        state.timerInterval = setInterval(() => {
          if (state.remaining <= 0) {
            clearInterval(state.timerInterval);
            timerEl.textContent = 'Zeit abgelaufen';
            return;
          }
          state.remaining--;
          updateTimerDisplay();
        }, 1000);
      }

      function resetTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        state.remaining = exam.durationSec;
        state.timerStarted = false;
        updateTimerDisplay();
        startTimer();
      }

      function updateTimerDisplay() {
        const min = Math.floor(state.remaining / 60);
        const sec = state.remaining % 60;
        timerEl.textContent = `Verbleibende Zeit: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
      }

      function renderTopTiles() { 
        topTiles.innerHTML = ''; 
        exam.sections.forEach((sec, idx) => { 
          const div = document.createElement('div'); 
          div.className = 'tile' + (idx === state.sectionIndex ? ' active' : '') + (isSectionDone(sec) ? ' done' : ''); 
          div.innerHTML = `<div>${sec.title}</div><div class="points">${sec.points} P</div>`; 
          div.onclick = () => { state.sectionIndex = idx; state.showResults = false; renderAll(); }; 
          topTiles.appendChild(div); 
        }); 
      }

      function isSectionDone(section) {
        const answers = state.answers[section.id];
        if (!answers) return false;
        const answeredQuestions = Object.keys(answers).length;
        const totalQuestions = section.questions.length;
        return answeredQuestions === totalQuestions;
      }

      function renderAll() {
        renderTopTiles();
        
        if (state.showResults) {
          renderResults();
          return;
        }
        
        renderListeningSection();
      }

      function renderListeningSection() {
        const section = exam.sections[state.sectionIndex];
        const currentAnswers = state.answers[section.id] || {};
        
        let contentHTML = `
          <div class="panel-title">${section.title}</div>
          <div class="instructions">
            Sie h√∂ren die Nachrichten. Entscheiden Sie beim H√∂ren, ob die Aussagen richtig oder falsch sind. 
            Sie h√∂ren die Nachrichten nur einmal. Sie haben jetzt 30 Sekunden, um die Aussagen zu lesen.
          </div>
          
          <div class="listening-task">
            <table class="true-false-table">
              <thead>
                <tr>
                  <th style="width: 10%">Nr.</th>
                  <th style="width: 60%">Aussage</th>
                  <th style="width: 30%">Ihre Antwort</th>
                </tr>
              </thead>
              <tbody>
        `;
        
        section.questions.forEach((question, index) => {
          const currentAnswer = currentAnswers[question.id] || '';
          contentHTML += `
            <tr>
              <td><strong>${question.id}</strong></td>
              <td class="question-text">${question.text}</td>
              <td>
                <div class="answer-options">
                  <label class="answer-option">
                    <input 
                      type="radio" 
                      name="q${section.id}_${question.id}" 
                      value="richtig" 
                      ${currentAnswer === 'richtig' ? 'checked' : ''}
                      onchange="window.hoerenApp.updateListeningAnswer('${section.id}', '${question.id}', this.value)"
                    >
                    Richtig
                  </label>
                  <label class="answer-option">
                    <input 
                      type="radio" 
                      name="q${section.id}_${question.id}" 
                      value="falsch" 
                      ${currentAnswer === 'falsch' ? 'checked' : ''}
                      onchange="window.hoerenApp.updateListeningAnswer('${section.id}', '${question.id}', this.value)"
                    >
                    Falsch
                  </label>
                </div>
              </td>
            </tr>
          `;
        });
        
        contentHTML += `
              </tbody>
            </table>
          </div>
        `;
        
        contentContainer.innerHTML = contentHTML;
      }

      function updateListeningAnswer(sectionId, questionId, answer) {
        if (!state.answers[sectionId]) {
          state.answers[sectionId] = {};
        }
        state.answers[sectionId][questionId] = answer;
        try{ localStorage.setItem('hoerenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        renderTopTiles();
      }

      function renderResults() {
        let resultsHTML = `<div class="panel-title">Ergebnisse - H√∂rverstehen</div>`;
        
        exam.sections.forEach(section => {
          const userAnswers = state.answers[section.id] || {};
          let correctCount = 0;
          
          resultsHTML += `
            <div class="listening-task">
              <h3>${section.title} (${section.points} Punkte)</h3>
              <table class="true-false-table">
                <thead>
                  <tr>
                    <th style="width: 10%">Nr.</th>
                    <th style="width: 50%">Aussage</th>
                    <th style="width: 15%">Ihre Antwort</th>
                    <th style="width: 15%">Richtige Antwort</th>
                    <th style="width: 10%">Punkte</th>
                  </tr>
                </thead>
                <tbody>
          `;
          
          section.questions.forEach((question) => {
            const userAnswer = userAnswers[question.id] || '-';
            const correctAnswer = section.correctAnswers[question.id];
            const gotCorrect = userAnswer === correctAnswer;
            const points = gotCorrect ? "1" : "0";
            
            if (gotCorrect) correctCount++;
            
            const rowClass = gotCorrect ? 'correct-answer' : 'incorrect-answer';
            
            resultsHTML += `
              <tr class="${rowClass}">
                <td><strong>${question.id}</strong></td>
                <td class="question-text">${question.text}</td>
                <td>${userAnswer}</td>
                <td>${correctAnswer}</td>
                <td><strong>${points}</strong></td>
              </tr>
            `;
          });
          
          const totalPoints = Math.round((correctCount / section.questions.length) * section.points);
          
          resultsHTML += `
                </tbody>
              </table>
              <div style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 6px;">
                <strong>Erreichte Punkte: ${correctCount}/${section.questions.length} richtig = ${totalPoints}/${section.points} Punkten</strong>
              </div>
            </div>
          `;
        });
        
        contentContainer.innerHTML = resultsHTML;
      }

      document.getElementById('prevBtn-hoeren').addEventListener('click', () => {
        if (state.sectionIndex > 0) {
          state.sectionIndex--;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('nextBtn-hoeren').addEventListener('click', () => {
        if (state.sectionIndex < exam.sections.length - 1) {
          state.sectionIndex++;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('resultBtn-hoeren').addEventListener('click', () => {
        state.showResults = !state.showResults;
        renderAll();
      });

      document.getElementById('resetBtn-hoeren').addEventListener('click', () => {
        if (confirm('M√∂chten Sie wirklich von neu beginnen? Alle Antworten werden gel√∂scht.')) {
          state.answers = {};
          state.showResults = false;
          resetTimer();
          renderAll();
        }
      });

      document.getElementById('saveBtn-hoeren').addEventListener('click', () => {
        statusText.textContent = 'Gespeichert';
        setTimeout(() => { statusText.textContent = 'Nicht gespeichert' }, 2000);
      });

      document.getElementById('submitBtn-hoeren').addEventListener('click', () => {
        if (confirm('M√∂chten Sie die Pr√ºfung wirklich abgeben?')) {
          state.showResults = true;
          renderAll();
        }
      });

      document.getElementById('nextBtn-hoeren').addEventListener('click', () => {
        showPage('schreiben-page');
      });

      updateTimerDisplay();
      renderAll();
      startTimer();
      
        window._hoerenState = state;
        window.hoerenApp = {
        updateListeningAnswer
      };
    }

    // ===== SCHREIBEN PAGE FUNCTIONALITY =====
    function initSchreibenPage() {
      const exam = {
        id: "exam-002",
        durationSec: 30 * 60,
        sections: [
          { 
            id: "s1", 
            title: "Schreiben, Teil 1", 
            points: 45,
            passageTitle: "Aufgabe: Schreiben Sie eine E-Mail",
            passage: "",
            writingTask: {
              prompt: `Mehr bewegen ‚Äì aber wie?

Es ist in aller Munde: Wir bewegen uns zu wenig. Das schadet unserer Gesundheit! 
Was k√∂nnen wir also tun? Wir haben die L√∂sung!

Jeden Abend und am Wochenende auch tags√ºber bieten wir ‚ÄûRadeln mit Spa√ü" an. 
Freundliche junge Trainer begleiten Sie bei den Radtouren und gehen dabei gern auf 
Ihre Fragen rund um Sport und Gesundheit ein. 

Ein gro√ües Angebot an modernen R√§dern steht bereit ‚Äì falls Sie kein eigenes Fahrrad haben. 

Wir treffen uns jeden Abend ab 18 Uhr, am Samstag und am Sonstag ab 10 Uhr, auf unserem 
Vereinsgel√§nde auf der Heidewiese. Einst√ºndige Touren mit Trainer kosten 5 Euro, 
oder Sie werden gleich Mitglied f√ºr 25 Euro pro Monat ‚Äì dann entfallen weitere Kosten.

Am Ende einer Tour werden Sie sp√ºren, wie anstrengend es war. Aber gerade das ist gut f√ºr Ihre Gesundheit!

Also auf zum:
Radel dich munter e.V.
Heidewiese 1
44777 Heimerst√§dt
info@radeldichmunter.de`,
              requirements: [
                "Warum Sie das Angebot sehr interessant fanden.",
                "Beschreiben Sie detailliert die Probleme.",
                "Was Ihnen an der Fahrradtour gefallen hat.",
                "Beschreiben Sie genau die Reaktion des Trainers auf Ihre Fragen."
              ],
              wordCount: 0
            }
          }
        ]
      };

      let state = { 
        sectionIndex: 0, 
        answers: {}, 
        remaining: exam.durationSec,
        showResults: false,
        timerStarted: false,
        timerInterval: null
      };
      
      const topTiles = document.getElementById('topTiles-schreiben');
      const passageTitleEl = document.getElementById('passageTitle-schreiben');
      const passageContentEl = document.getElementById('passageContent-schreiben');
      const writingContainer = document.getElementById('writingContainer-schreiben');
      const timerEl = document.getElementById('timer-schreiben');
      const statusText = document.getElementById('statusText-schreiben');

      function startTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        
        state.timerStarted = true;
        state.timerInterval = setInterval(() => {
          if (state.remaining <= 0) {
            clearInterval(state.timerInterval);
            timerEl.textContent = 'Zeit abgelaufen';
            return;
          }
          state.remaining--;
          updateTimerDisplay();
        }, 1000);
      }

      function resetTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        state.remaining = exam.durationSec;
        state.timerStarted = false;
        updateTimerDisplay();
        startTimer();
      }

      function updateTimerDisplay() {
        const min = Math.floor(state.remaining / 60);
        const sec = state.remaining % 60;
        timerEl.textContent = `Verbleibende Zeit: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
      }

      function renderTopTiles() { 
        topTiles.innerHTML = ''; 
        exam.sections.forEach((sec, idx) => { 
          const div = document.createElement('div'); 
          div.className = 'tile' + (idx === state.sectionIndex ? ' active' : '') + (isSectionDone(sec) ? ' done' : ''); 
          div.innerHTML = `<div>${sec.title}</div><div class="points">${sec.points} P</div>`; 
          div.onclick = () => { state.sectionIndex = idx; state.showResults = false; renderAll(); }; 
          topTiles.appendChild(div); 
        }); 
      }

      function isSectionDone(section) {
        return state.answers[section.id] && state.answers[section.id].length > 0;
      }

      function renderAll() {
        renderTopTiles();
        const section = exam.sections[state.sectionIndex];
        passageTitleEl.textContent = section.passageTitle;
        
        if (state.showResults) {
          renderResults();
          return;
        }
        
        renderWritingSection();
      }

      function renderWritingSection() {
        const section = exam.sections[state.sectionIndex];
        
        passageContentEl.innerHTML = `
          <div class="writing-task">
            <div class="writing-prompt">${section.writingTask.prompt}</div>
            <div class="instructions" style="border:1px solid #e1e8f6; padding:10px; margin:10px 0; border-radius:6px; background:#ffffff;">Sie haben an einer Fahrradtour mit Trainer teilgenommen. Leider waren Sie nicht zufrieden. 
Schreiben Sie eine Beschwerde an den Verein ‚ÄûRadel dich munter e.V.".</div>
            <div class="writing-requirements">
              <h4>Schreiben Sie in Ihrer E-Mail:</h4>
              <ul>
                ${section.writingTask.requirements.map(req => `<li>${req}</li>`).join('')}
              </ul>
            </div>
            <div class="instructions">
              Schreiben Sie eine E-Mail (ca. 150-200 W√∂rter). Achten Sie auf den Textaufbau (Anrede, Einleitung, Hauptteil, Schluss) und eine angemessene Formulierung.
            </div>
          </div>
        `;
        
        const currentAnswer = state.answers[section.id] || '';
        const wordCount = countWords(currentAnswer);
        
        writingContainer.innerHTML = `
          <div class="writing-area">
            <textarea 
              class="writing-textarea" 
              placeholder="Schreiben Sie hier Ihre E-Mail..."
              oninput="window.schreibenApp.updateWritingAnswer('${section.id}', this.value)"
            >${currentAnswer}</textarea>
            <div class="word-counter">
              W√∂rter: <span class="count">${wordCount}</span>
            </div>
          </div>
        `;
      }

      function countWords(text) {
        return text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
      }

      function updateWritingAnswer(sectionId, text) {
        state.answers[sectionId] = text;
        try{ localStorage.setItem('schreibenAnswers', JSON.stringify({content: state.answers[sectionId], wordCount: (state.answers[sectionId]||'').trim().split(/\s+/).filter(Boolean).length})); }catch(e){}
        
        const wordCount = countWords(text);
        document.querySelector('.word-counter .count').textContent = wordCount;
      }

      function renderResults() {
        let resultsHTML = `<h2>Ergebnisse</h2>`;
        
        exam.sections.forEach(section => {
          resultsHTML += `<div class="writing-task"><h3>${section.title}</h3>`;
          
          const userAnswer = state.answers[section.id];
          const wordCount = countWords(userAnswer);
          
          resultsHTML += `
            <div class="writing-requirements">
              <h4>Ihre Antwort (${wordCount} W√∂rter):</h4>
              <div style="white-space: pre-wrap; background: white; padding: 15px; border-radius: 6px; border: 1px solid #e1e8f6; margin-top: 10px;">${userAnswer || '-'}</div>
            </div>
          `;
          
          resultsHTML += `</div>`;
        });
        
        passageContentEl.innerHTML = resultsHTML;
        writingContainer.innerHTML = '';
      }

      document.getElementById('prevBtn-schreiben').addEventListener('click', () => {
        if (state.sectionIndex > 0) {
          state.sectionIndex--;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('nextBtn-schreiben').addEventListener('click', () => {
        if (state.sectionIndex < exam.sections.length - 1) {
          state.sectionIndex++;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('resultBtn-schreiben').addEventListener('click', () => {
        state.showResults = !state.showResults;
        renderAll();
      });

      document.getElementById('resetBtn-schreiben').addEventListener('click', () => {
        if (confirm('M√∂chten Sie wirklich von neu beginnen? Alle Antworten werden gel√∂schÿ™.')) {
          state.answers = {};
          state.showResults = false;
          resetTimer();
          renderAll();
        }
      });

      document.getElementById('saveBtn-schreiben').addEventListener('click', () => {
        statusText.textContent = 'Gespeichert';
        setTimeout(() => { statusText.textContent = 'Nicht gespeicherÿ™' }, 2000);
      });

      document.getElementById('submitBtn-schreiben').addEventListener('click', () => {
        if (confirm('M√∂chten Sie die Pr√ºfung wirklich abgeben?')) {
          state.showResults = true;
          renderAll();
        }
      });

      document.getElementById('nextBtn-schreiben').addEventListener('click', () => {
        showPage('ergebnisse-page');
      });

      updateTimerDisplay();
      renderAll();
      startTimer();
      
        window._schreibenState = state;
        window.schreibenApp = {
        updateWritingAnswer
      };
    }

    // ===== ERGEBNISSE PAGE FUNCTIONALITY =====
    function initErgebnissePage() {
      // ÿßŸÑÿ•ÿ¨ÿßÿ®ÿßÿ™ ÿßŸÑÿµÿ≠Ÿäÿ≠ÿ© ÿßŸÑŸÖÿ±ŸÉÿ≤Ÿäÿ©
      const CORRECT_ANSWERS = {
        lesen: {
          // ÿßŸÑÿ¨ÿ≤ÿ° ÿßŸÑÿ£ŸàŸÑ: √úberschriften zuordnen
          "text1": "j",
          "text2": "b", 
          "text3": "h",
          "text4": "a",
          "text5": "f",
          
          // ÿßŸÑÿ¨ÿ≤ÿ° ÿßŸÑÿ´ÿßŸÜŸä: Fragen zum Text
          "s2q1": "s2q1o1",
          "s2q2": "s2q2o1",
          "s2q3": "s2q3o3",
          "s2q4": "s2q4o1",
          "s2q5": "s2q5o3",
          
          // ÿßŸÑÿ¨ÿ≤ÿ° ÿßŸÑÿ´ÿßŸÑÿ´: Texte zuordnen
          "11": "X",
          "12": "D",
          "13": "L",
          "14": "C",
          "15": "E",
          "16": "X",
          "17": "G",
          "18": "K",
          "19": "A",
          "20": "I",
          
          // Sprachbausteine Teil 1
          "21": "her",
          "22": "erkrankt",
          "23": "wenn",
          "24": "zwar",
          "25": "werde",
          "26": "Darauf",
          "27": "davon",
          "28": "dir",
          "29": "zu besch√§ftigen",
          "30": "wie",
          
          // Sprachbausteine Teil 2
          "31": "KAUM",
          "32": "AUF",
          "33": "VORBEI",
          "34": "STATT",
          "35": "INNERHALB",
          "36": "M√úSSEN",
          "37": "AN",
          "38": "SOLLEN",
          "39": "DANN",
          "40": "DENN"
        },
        
        hoeren: {
          // H√∂ren Teil 1
          "41": "falsch",
          "42": "richtig",
          "43": "richtig",
          "44": "falsch",
          "45": "richtig",
          
          // H√∂ren Teil 2
          "46": "richtig",
          "47": "falsch",
          "48": "richtig",
          "49": "richtig",
          "50": "falsch",
          "51": "falsch",
          "52": "falsch",
          "53": "richtig",
          "54": "richtig",
          "55": "richtig",
          
          // H√∂ren Teil 3
          "56": "richtig",
          "57": "falsch",
          "58": "falsch",
          "59": "falsch",
          "60": "richtig"
        }
      };

      const CONFIG = {
        totals: { 
          lesen: 105, 
          hoeren: 75, 
          schreiben: 45, 
          gesamt: 225 
        },
        counts: { 
          lesen: 40, 
          hoeren: 20 
        },
        hoerenCorrect: CORRECT_ANSWERS.hoeren,
        lesenCorrect: CORRECT_ANSWERS.lesen
      };

      // ÿßŸÑÿØŸàÿßŸÑ ÿßŸÑŸÖÿ≥ÿßÿπÿØÿ©
      function getHeadingText(headingId) {
        if (!headingId || headingId === '-') return '-';
        const headings = {
          "a": "Altes Handwerk und alte Technik anschaulich pr√§sentiert",
          "b": "Attraktive Kleinstadt - touristischer Geheimtipp",
          "c": "Ein Altes Kloster als Feuerwache",
          "d": "Eine Universit√§t mit langer Geschichte",
          "e": "Eliteschule f√ºr Schriftsteller",
          "f": "Entdeckung und Verbreitung des Kaffees",
          "g": "Kaffee macht die Leute s√º√ü",
          "h": "Kl√∂sterliche Strenge f√ºr ber√ºhmte Sch√ºler",
          "i": "Mehr Ziegenmilch dank Energy-Drink",
          "j": "Ohne Kaffee geht hier nichts"
        };
        return headings[headingId] || headingId;
      }

      function getOptionText(questionId, optionId) {
        if (!optionId || optionId === '-') return '-';
        const options = {
          "s2q1o1": "kommunikativer",
          "s2q1o2": "ideenreicher",
          "s2q1o3": "sensibler",
          "s2q2o1": "das Kind einen emotionalen Bezug zur Sprache hat",
          "s2q2o2": "die Eltern aus dem Zielsprachenland kommen",
          "s2q2o3": "die Eltern die Bildungsziele konsequent verfolgen",
          "s2q3o1": "muss die Sprachvermittlung so fr√ºh wie m√∂glich anfangen",
          "s2q3o2": "reicht it, im Grundschulalter mit der Zweitsprache zu beginnen",
          "s2q3o3": "sollte im Kindergarten mit der Sprachvermittlung begonnen werden",
          "s2q4o1": "bei systematischer Vermittlung der Sprache",
          "s2q4o2": "sofern es versteht, wann die Sprachen gewechselt werden",
          "s2q4o3": "wahrscheinlich nicht",
          "s2q5o1": "ist eine Entwicklungsverz√∂gerung m√∂glich",
          "s2q5o2": "kann das Interesse an anderen Sprachen verloren gehen",
          "s2q5o3": "schadet dies der Entwicklung der Zweitsprache nicht"
        };
        return options[optionId] || optionId;
      }

      function getSituationText(id) {
        const situations = {
          "11": "Eine Bekannte ist schwanger und sucht Informationen, welche Sportarten erlaubt sind.",
          "12": "Ein Bekannter fliegt im Urlaub ans Meer. Sie m√∂chten ihn √ºber m√∂gliche Risiken der Sonnenstrahlung informieren.",
          "13": "Ein Bekannter m√∂chte sich modische Schuhe kaufen. Er wei√ü aber nicht, ob er sich das leisten kann.",
          "14": "Sie m√∂chten durch pflanzliche Ern√§hrung Ihren K√∂rper vor schweren Krankheiten sch√ºtzen.",
          "15": "Eine Bekannte, die ein Kind erwartet, sucht Ern√§hrungstipps.",
          "16": "Ein √§lteres Ehepaar sucht Informationen √ºber einen ruhigen Urlaub am Meer.",
          "17": "Ihre Freundin denkt dar√ºber nach, alle hochhackigen Schuhe wegzuwerfen, weil sie negative Auswirkungen auf ihre Gelenke bef√ºrchtet.",
          "18": "Eine Freundin hat viel Stress und m√∂chte einen Ausgleich finden, der auch mit sportlichen Aktivit√§ten verbunden ist.",
          "19": "Eine Freundin bekommt ein Baby. Sie hat oft Schmerzen. Welche M√∂glichkeit gibt es, ihr zu helfen?",
          "20": "Ein Bekannter hat oft Kopfschmerzen. Er m√∂chte jedoch keine Tabletten nehmen."
        };
        return situations[id] || id;
      }

      function escapeHtml(s) {
        return String(s)
          .replace(/&/g, '&amp;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;')
          .replace(/"/g, '&quot;')
          .replace(/'/g, '&#039;');
      }

      function normalizeAnswer(a) {
        if (a === null || a === undefined) return '';
        let s = String(a).trim();
        if (s === '') return '';
        const low = s.toLowerCase();
        if (["richtig", "true", "yes", "ja"].includes(low)) return 'richtig';
        if (["falsch", "false", "no", "nein"].includes(low)) return 'falsch';
        return s;
      }

      function buildTable(title, dets, total, max) {
        let html = `<div class="result-item">
                      <h3>${title} - ${total.toFixed(2)}/${max} Punkte</h3>
                      <div class="section-table">
                        <table class="true-false-table">
                          <thead>
                            <tr>
                              <th style="width: 10%">Frage</th>
                              <th style="width: 40%">Ihre Antwort</th>
                              <th style="width: 40%">Richtige Antwort</th>
                              <th style="width: 10%">Ergebnis</th>
                            </tr>
                          </thead>
                          <tbody>`;
        
        dets.forEach(x => {
          const isCorrect = x.richtig;
          const rowClass = isCorrect ? 'correct-answer' : 'incorrect-answer';
          const resultIcon = isCorrect ? '‚úÖ Richtig' : '‚ùå Falsch';
          const userAnswer = x.user === '-' ? '-' : escapeHtml(x.user);
          const correctAnswer = x.correct === '-' ? '-' : escapeHtml(x.correct);
          
          html += `<tr class="${rowClass}">
                    <td><strong>${x.frage}</strong></td>
                    <td>${userAnswer}</td>
                    <td>${correctAnswer}</td>
                    <td><strong>${resultIcon}</strong></td>
                  </tr>`;
        });
        
        html += `</tbody>
                </table>
                <div style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 6px;">
                  <strong>Erreichte Punkte: ${total.toFixed(2)}/${max} (${((total/max)*100).toFixed(1)}%)</strong>
                </div>
              </div></div>`;
        return html;
      }

      function renderLesenDetails(answers) {
        let html = `<div class="result-item">
                    <h3>üìñ Leseverstehen - Detaillierte Auswertung</h3>`;
        
        // 1. √úberschriften zuordnen
        html += `<h4>Teil 1: √úberschriften zuordnen</h4>
                 <table class="true-false-table">
                   <thead>
                     <tr>
                       <th>Text</th>
                       <th>Ihre Antwort</th>
                       <th>Richtige Antwort</th>
                       <th>Ergebnis</th>
                     </tr>
                   </thead>
                   <tbody>`;
        
        for (let i = 1; i <= 5; i++) {
          const id = `text${i}`;
          const userAnswer = answers[id] || '-';
          const correctAnswer = CORRECT_ANSWERS.lesen[id] || '-';
          const isCorrect = userAnswer === correctAnswer;
          const rowClass = isCorrect ? 'correct-answer' : 'incorrect-answer';
          const resultIcon = isCorrect ? '‚úÖ' : '‚ùå';
          const userText = userAnswer === '-' ? '-' : getHeadingText(userAnswer);
          const correctText = correctAnswer === '-' ? '-' : getHeadingText(correctAnswer);
          
          html += `<tr class="${rowClass}">
                    <td><strong>Text ${String.fromCharCode(64 + i)}</strong></td>
                    <td>${escapeHtml(userText)}</td>
                    <td>${escapeHtml(correctText)}</td>
                    <td><strong>${resultIcon}</strong></td>
                  </tr>`;
        }
        
        html += `</tbody></table>`;
        
        // 2. Fragen zum Text
        html += `<h4 style="margin-top: 20px;">Teil 2: Fragen zum Text</h4>
                 <table class="true-false-table">
                   <thead>
                     <tr>
                       <th>Frage</th>
                       <th>Ihre Antwort</th>
                       <th>Richtige Antwort</th>
                       <th>Ergebnis</th>
                     </tr>
                   </thead>
                   <tbody>`;
        
        for (let i = 1; i <= 5; i++) {
          const id = `s2q${i}`;
          const userAnswer = answers[id] || '-';
          const correctAnswer = CORRECT_ANSWERS.lesen[id] || '-';
          const isCorrect = userAnswer === correctAnswer;
          const rowClass = isCorrect ? 'correct-answer' : 'incorrect-answer';
          const resultIcon = isCorrect ? '‚úÖ' : '‚ùå';
          const userText = getOptionText(id, userAnswer);
          const correctText = getOptionText(id, correctAnswer);
          
          html += `<tr class="${rowClass}">
                    <td><strong>${i}</strong></td>
                    <td>${escapeHtml(userText)}</td>
                    <td>${escapeHtml(correctText)}</td>
                    <td><strong>${resultIcon}</strong></td>
                  </tr>`;
        }
        
        html += `</tbody></table>`;
        
        // 3. Texte zuordnen
        html += `<h4 style="margin-top: 20px;">Teil 3: Texte zuordnen</h4>
                 <table class="true-false-table">
                   <thead>
                     <tr>
                       <th>Situation</th>
                       <th>Ihre Antwort</th>
                       <th>Richtige Antwort</th>
                       <th>Ergebnis</th>
                     </tr>
                   </thead>
                   <tbody>`;
        
        for (let i = 11; i <= 20; i++) {
          const id = i.toString();
          const userAnswer = answers[id] || '-';
          const correctAnswer = CORRECT_ANSWERS.lesen[id] || '-';
          const isCorrect = userAnswer === correctAnswer;
          const rowClass = isCorrect ? 'correct-answer' : 'incorrect-answer';
          const resultIcon = isCorrect ? '‚úÖ' : '‚ùå';
          const situationText = getSituationText(id);
          
          html += `<tr class="${rowClass}">
                    <td><strong>${id}</strong><br><small>${situationText}</small></td>
                    <td>${userAnswer === 'X' ? 'X - Kein passender Text' : userAnswer}</td>
                    <td>${correctAnswer === 'X' ? 'X - Kein passender Text' : (correctAnswer || '-')}</td>
                    <td><strong>${resultIcon}</strong></td>
                  </tr>`;
        }
        
        html += `</tbody></table>`;
        
        // 4. Sprachbausteine Teil 1
        html += `<h4 style="margin-top: 20px;">Sprachbausteine Teil 1</h4>
                 <table class="true-false-table">
                   <thead>
                     <tr>
                       <th>L√ºcke</th>
                       <th>Ihre Antwort</th>
                       <th>Richtige Antwort</th>
                       <th>Ergebnis</th>
                     </tr>
                   </thead>
                   <tbody>`;
        
        for (let i = 21; i <= 30; i++) {
          const id = i.toString();
          const userAnswer = answers[id] || '-';
          const correctAnswer = CORRECT_ANSWERS.lesen[id] || '-';
          const isCorrect = userAnswer === correctAnswer;
          const rowClass = isCorrect ? 'correct-answer' : 'incorrect-answer';
          const resultIcon = isCorrect ? '‚úÖ' : '‚ùå';
          
          html += `<tr class="${rowClass}">
                    <td><strong>${id}</strong></td>
                    <td>${escapeHtml(userAnswer)}</td>
                    <td>${escapeHtml(correctAnswer)}</td>
                    <td><strong>${resultIcon}</strong></td>
                  </tr>`;
        }
        
        html += `</tbody></table>`;
        
        // 5. Sprachbausteine Teil 2
        html += `<h4 style="margin-top: 20px;">Sprachbausteine Teil 2</h4>
                 <table class="true-false-table">
                   <thead>
                     <tr>
                       <th>L√ºcke</th>
                       <th>Ihre Antwort</th>
                       <th>Richtige Antwort</th>
                       <th>Ergebnis</th>
                     </tr>
                   </thead>
                   <tbody>`;
        
        for (let i = 31; i <= 40; i++) {
          const id = i.toString();
          const userAnswer = answers[id] || '-';
          const correctAnswer = CORRECT_ANSWERS.lesen[id] || '-';
          const isCorrect = userAnswer === correctAnswer;
          const rowClass = isCorrect ? 'correct-answer' : 'incorrect-answer';
          const resultIcon = isCorrect ? '‚úÖ' : '‚ùå';
          
          html += `<tr class="${rowClass}">
                    <td><strong>${id}</strong></td>
                    <td>${escapeHtml(userAnswer)}</td>
                    <td>${escapeHtml(correctAnswer)}</td>
                    <td><strong>${resultIcon}</strong></td>
                  </tr>`;
        }
        
        html += `</tbody></table></div>`;
        
        return html;
      }

      function buildHoerenDetails(answers) {
        let html = `<table class="true-false-table">
                      <thead>
                        <tr>
                          <th>Frage</th>
                          <th>Ihre Antwort</th>
                          <th>Richtige Antwort</th>
                          <th>Ergebnis</th>
                        </tr>
                      </thead>
                      <tbody>`;
        
        for (let i = 41; i <= 60; i++) {
          const id = i.toString();
          const userAnswer = normalizeAnswer(answers[id] || '-');
          const correctAnswer = CORRECT_ANSWERS.hoeren[id] || '-';
          const isCorrect = userAnswer === correctAnswer;
          const rowClass = isCorrect ? 'correct-answer' : 'incorrect-answer';
          const resultIcon = isCorrect ? '‚úÖ' : '‚ùå';
          
          html += `<tr class="${rowClass}">
                    <td><strong>${id}</strong></td>
                    <td>${userAnswer}</td>
                    <td>${correctAnswer}</td>
                    <td><strong>${resultIcon}</strong></td>
                  </tr>`;
        }
        
        html += `</tbody></table>`;
        return html;
      }

      function readExamResults() {
        try {
          const lesen = {};
          const hoeren = {};
          const schreiben = { content: '', wordCount: 0 };

          try {
            if (window._lesenState && window._lesenState.answers) {
              Object.keys(window._lesenState.answers).forEach(k => {
                lesen[k] = window._lesenState.answers[k];
              });
            }
          } catch (e) {}

          try {
            if (window._hoerenState && window._hoerenState.answers) {
              Object.keys(window._hoerenState.answers).forEach(sectionId => {
                const sec = window._hoerenState.answers[sectionId] || {};
                Object.keys(sec).forEach(q => {
                  hoeren[q] = sec[q];
                });
              });
            }
          } catch (e) {}

          try {
            if (window._schreibenState && window._schreibenState.answers) {
              const answers = window._schreibenState.answers;
              if (answers['s1']) {
                schreiben.content = answers['s1'];
              } else {
                const keys = Object.keys(answers);
                if (keys.length > 0) schreiben.content = answers[keys[0]] || '';
              }
              schreiben.wordCount = (schreiben.content && schreiben.content.trim()) ? String(schreiben.content).trim().split(/\s+/).filter(Boolean).length : 0;
            }
          } catch (e) {}

          try {
            if (Object.keys(lesen).length === 0) {
              const storedL = localStorage.getItem('lesenAnswers');
              if (storedL) Object.assign(lesen, JSON.parse(storedL));
            }
          } catch (e) {}

          try {
            if (Object.keys(hoeren).length === 0) {
              const storedH = localStorage.getItem('hoerenAnswers');
              if (storedH) Object.assign(hoeren, JSON.parse(storedH));
            }
          } catch (e) {}

          try {
            if (!schreiben.content) {
              const storedS = localStorage.getItem('schreibenAnswers');
              if (storedS) {
                const obj = JSON.parse(storedS);
                schreiben.content = obj.content || '';
                schreiben.wordCount = obj.wordCount || (schreiben.content.trim() ? String(schreiben.content).trim().split(/\s+/).filter(Boolean).length : 0);
              }
            }
          } catch (e) {}

          return { hoeren, lesen, schreiben };
        } catch (e) {
          return { hoeren: {}, lesen: {}, schreiben: {} };
        }
      }

      function gradeHoeren(u) {
        const c = CORRECT_ANSWERS.hoeren;
        let okCount = 0;
        const d = [];
        
        for (let q = 41; q <= 60; q++) {
          const k = String(q);
          const uA = normalizeAnswer(u[k] || '-');
          const exp = normalizeAnswer(c[k] || '-');
          const ok = (uA !== '-' && uA.toLowerCase() === exp.toLowerCase());
          if (ok) okCount++;
          const ptsPer = CONFIG.totals.hoeren / CONFIG.counts.hoeren;
          d.push({
            frage: k,
            user: uA || '-',
            correct: exp || '-',
            richtig: ok,
            punkte: ok ? ptsPer.toFixed(2) : '0'
          });
        }
        
        const total = Number((okCount * (CONFIG.totals.hoeren / CONFIG.counts.hoeren)).toFixed(2));
        return { okCount, total, details: d };
      }

      function gradeLesen(u) {
        const c = CORRECT_ANSWERS.lesen;
        let okCount = 0;
        const d = [];
        
        Object.keys(c).forEach(k => {
          const exp = normalizeAnswer(c[k]);
          const uA = normalizeAnswer(u[k] || '-');
          const ok = (uA !== '-' && uA.toLowerCase() === exp.toLowerCase());
          if (ok) okCount++;
          const ptsPer = CONFIG.totals.lesen / CONFIG.counts.lesen;
          d.push({
            frage: k,
            user: uA || '-',
            correct: exp || '-',
            richtig: ok,
            punkte: ok ? ptsPer.toFixed(2) : '0'
          });
        });
        
        const total = Number((okCount * (CONFIG.totals.lesen / CONFIG.counts.lesen)).toFixed(2));
        return { okCount, total, details: d };
      }

      function renderResults() {
        const st = readExamResults() || { hoeren: {}, lesen: {}, schreiben: {} };
        const h = gradeHoeren(st.hoeren || {});
        const l = gradeLesen(st.lesen || {});
        const details = document.getElementById('details-ergebnisse');
        const tiles = document.getElementById('topTiles-ergebnisse');
        const sScoreRaw = localStorage.getItem('schreibenScore');
        const sScore = sScoreRaw ? Number(sScoreRaw) : 0;

        details.innerHTML = '';
        tiles.innerHTML = '';

        const tL = `<div class="results-tile">
                    <h3>Lesen</h3>
                    <div class="score">${l.total.toFixed(2)} / ${CONFIG.totals.lesen} Punkte</div>
                    <div class="small-muted">(${(l.total / CONFIG.totals.lesen * 100).toFixed(2)} %)</div>
                  </div>`;
                  
        const tH = `<div class="results-tile">
                    <h3>H√∂ren</h3>
                    <div class="score">${h.total.toFixed(2)} / ${CONFIG.totals.hoeren} Punkte</div>
                    <div class="small-muted">(${(h.total / CONFIG.totals.hoeren * 100).toFixed(2)} %)</div>
                  </div>`;
                  
        const tS = `<div class="results-tile">
                    <h3>Schreiben</h3>
                    <div class="score" id="schreibenScoreDisplay">${sScore.toFixed(2)} / ${CONFIG.totals.schreiben} Punkte</div>
                    <div class="small-muted">Manuelle Eingabe</div>
                  </div>`;
                  
        tiles.innerHTML = tL + tH + tS;

        details.innerHTML += `<h2>üìä Detaillierte Ergebnisse</h2>
                            <div class="instructions">Hier sehen Sie Ihre Antworten im Vergleich mit den richtigen L√∂sungen. 
                            Gr√ºne Zeilen zeigen richtige Antworten, rote Zeilen falsche Antworten.</div>`;
        
        details.innerHTML += renderLesenDetails(st.lesen);
        
        details.innerHTML += `
          <div class="result-item">
            <h3>üëÇ H√∂rverstehen - Detaillierte Auswertung</h3>
            ${buildHoerenDetails(st.hoeren)}
          </div>`;
        
        let sHtml = '<div class="result-item"><h3>‚úçÔ∏è Schreiben - Ihre Antwort</h3>';
        const txt = st.schreiben.content ? escapeHtml(st.schreiben.content) : '<span class="small-muted">-</span>';
        const wc = st.schreiben.wordCount || '-';
        
        sHtml += `<div class="small-muted">W√∂rter: ${wc}</div>
                <div style="margin-top:10px;padding:12px;background:#fff;border-radius:8px;border:1px solid #eef6ff;min-height:80px">${txt}</div>
                <div style="margin-top:10px;display:flex;gap:10px;align-items:center">
                  Punkte (0‚Äì45): 
                  <input id="sInput" type="number" min="0" max="45" step="0.5" value="${sScore}"> 
                  <button id="saveS" class="results-btn">Speichern</button>
                </div></div>`;
                
        details.innerHTML += sHtml;

        const total = (l.total + h.total + sScore).toFixed(2);
        const percent = ((total / CONFIG.totals.gesamt) * 100).toFixed(2);
        
        document.getElementById('finalSummary-ergebnisse').innerHTML = `
          <div class="left">
            Gesamtpunktzahl: <strong>${total}</strong> / ${CONFIG.totals.gesamt} Punkte<br>
            <span class="small-muted">Lesen + H√∂ren + Schreiben</span>
          </div>
          <div class="right">
            Prozentsatz: <strong>${percent} %</strong>
          </div>`;

        document.getElementById('saveS').onclick = () => {
          const v = Number(document.getElementById('sInput').value) || 0;
          localStorage.setItem('schreibenScore', v);
          document.getElementById('schreibenScoreDisplay').textContent = `${v.toFixed(2)} / ${CONFIG.totals.schreiben} Punkte`;
          
          const newTotal = (l.total + h.total + v).toFixed(2);
          const newPercent = ((newTotal / CONFIG.totals.gesamt) * 100).toFixed(2);
          
          document.getElementById('finalSummary-ergebnisse').innerHTML = `
            <div class="left">
              Gesamtpunktzahl: <strong>${newTotal}</strong> / ${CONFIG.totals.gesamt} Punkte<br>
              <span class="small-muted">Lesen + H√∂ren + Schreiben</span>
            </div>
            <div class="right">
              Prozentsatz: <strong>${newPercent} %</strong>
            </div>`;
        };
      }

      document.getElementById('calcBtn-ergebnisse').onclick = () => renderResults();
      document.getElementById('backBtn-ergebnisse').onclick = (e) => {
        e.preventDefault();
        showPage('start-page');
      };
      
      renderResults();
    }

    // ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ≥ÿ≠ÿ® ŸàÿßŸÑÿ•ŸÅŸÑÿßÿ™ ŸÑŸÑÿ¥ÿßÿ¥ÿßÿ™ ÿßŸÑÿ™Ÿä ÿ™ÿπŸÖŸÑ ÿ®ÿßŸÑŸÑŸÖÿ≥
    document.addEventListener('DOMContentLoaded', function() {
      if ('ontouchstart' in window) {
        // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿπÿßŸÑÿ¨ÿßÿ™ ÿßŸÑŸÑŸÖÿ≥ ŸÑŸÑÿπŸÜÿßÿµÿ± ÿßŸÑŸÇÿßÿ®ŸÑÿ© ŸÑŸÑÿ≥ÿ≠ÿ®
        document.addEventListener('touchstart', function(e) {
          const target = e.target.closest('[draggable="true"]');
          if (target) {
            e.preventDefault();
            // ŸäŸÖŸÉŸÜ ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸÜÿ∑ŸÇ ÿßŸÑÿ≥ÿ≠ÿ® ÿ®ÿßŸÑŸÑŸÖÿ≥ ŸáŸÜÿß
          }
        });
      }
    });
  </script>
</body>
</html>