<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Deutsch B2 Pr√ºfung - Komplett</title>
  <style>
    /* ===== GLOBAL STYLES ===== */
    :root {
      --primary-color: #1e3a5f;
      --secondary-color: #2c5282;
      --accent-color: #4da6ff;
      --light-color: #ebf8ff;
      --text-color: #2d3748;
      --white: #ffffff;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      --transition: all 0.3s ease;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      color: var(--white);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    button {
      cursor: pointer;
    }
    
    /* ===== START PAGE STYLES ===== */
    .start-container {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      padding: 20px;
      min-height: 100vh;
    }
    
    .start-content {
      max-width: 600px;
      width: 100%;
      background-color: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 40px;
      box-shadow: var(--shadow);
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .logo {
      margin-bottom: 20px;
    }
    
    .logo-icon {
      font-size: 48px;
      margin-bottom: 10px;
    }
    
    h1 {
      font-size: 32px;
      margin-bottom: 10px;
      font-weight: 700;
    }
    
    .subtitle {
      font-size: 18px;
      margin-bottom: 30px;
      opacity: 0.9;
    }
    
    .card {
      background-color: var(--white);
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: var(--shadow);
      color: var(--text-color);
    }
    
    .card h2 {
      font-size: 20px;
      margin-bottom: 15px;
      color: var(--primary-color);
    }
    
    .card p {
      margin-bottom: 20px;
      line-height: 1.5;
    }
    
    select {
      width: 100%;
      padding: 12px 16px;
      font-size: 16px;
      border-radius: 8px;
      border: 2px solid var(--accent-color);
      outline: none;
      background-color: var(--white);
      color: var(--text-color);
      cursor: pointer;
      transition: var(--transition);
    }
    
    select:focus {
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.3);
    }
    
    .timer-container {
      margin: 25px 0;
    }
    
    .timer-label {
      font-size: 16px;
      margin-bottom: 10px;
    }
    
    .timer {
      font-size: 48px;
      font-weight: 700;
      color: var(--accent-color);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }
    
    .progress-bar {
      height: 8px;
      width: 100%;
      background-color: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
      overflow: hidden;
      margin-top: 10px;
    }
    
    .progress {
      height: 100%;
      width: 100%;
      background-color: var(--accent-color);
      border-radius: 4px;
      transform: scaleX(1);
      transform-origin: left;
      transition: transform 1s linear;
    }
    
    .info-text {
      font-size: 14px;
      margin-top: 20px;
      opacity: 0.8;
    }
    
    .button-container {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }
    
    .btn {
      flex: 1;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      background-color: var(--accent-color);
      color: white;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }
    
    .btn:hover {
      background-color: #3399ff;
    }
    
    /* ===== EXAM PAGE STYLES ===== */
    .exam-body {
      background: #f5f5f5;
      color: #333;
      line-height: 1.45;
      -webkit-font-smoothing: antialiased;
    }
    
    /* Header Styles */
    header.topbar {
      background: #1e3a5f;
      color: #fff;
      padding: 12px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      min-height: 80px;
    }

    .brand {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .brand .logo {
      width: 80px;
      height: 40px;
      background: #e74c3c;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: white;
      font-size: 18px;
    }

    .meta .main-title {
      font-weight: 800;
      font-size: 18px;
    }

    .meta .sub-title {
      font-size: 13px;
      opacity: 0.9;
    }

    .timer {
      font-weight: 700;
      font-size: 18px;
      color: #fff;
      margin: 0 20px;
    }

    .buttons-grid {
      display: grid;
      grid-template-columns: repeat(2, auto);
      gap: 10px 20px;
    }

    .exam-btn {
      padding: 12px 20px;
      border-radius: 6px;
      border: none;
      background: #4da6ff;
      color: white;
      font-weight: 700;
      font-size: 15px;
      cursor: pointer;
      transition: background 0.2s ease-in-out;
      min-width: 150px;
      text-align: center;
    }

    .exam-btn:hover {
      background: #336fbf;
    }
    
    .exam-btn.save {
      background: #4da6ff;
      color: #000;
    }
    
    .exam-btn.save:hover {
      background: #3399ff;
    }
    
    .exam-btn.submit {
      background: #4da6ff;
    }
    
    .exam-btn.submit:hover {
      background: #3399ff;
    }
    
    .exam-btn.result {
      background: #4da6ff;
    }
    
    .exam-btn.result:hover {
      background: #3399ff;
    }
    
    .exam-btn.next {
      background: #4da6ff;
      color: #fff;
    }
    
    .exam-btn.next:hover {
      background: #3399ff;
    }
    
    .exam-btn.reset {
      background: #4da6ff;
    }
    
    .exam-btn.reset:hover {
      background: #3399ff;
    }
    
    .exam-btn.reset-section {
      background: #d35400;
      font-size: 12px;
      padding: 6px 10px;
      min-width: auto;
    }
    
    .exam-btn.reset-section:hover {
      background: #e67e22;
    }
    
    .exam-btn.no-match {
      background: #95a5a6;
      font-size: 12px;
      padding: 6px 10px;
      min-width: auto;
      margin-top: 5px;
    }
    
    .exam-btn.no-match:hover {
      background: #7f8c8d;
    }
    
    .exam-btn.no-match.selected {
      background: #e74c3c;
    }
    
    /* Top Tiles */
    .top-tiles {
      display: flex;
      justify-content: center;
      gap: 8px;
      padding: 8px 12px;
      background: #1e3a5f;
      border-bottom: 1px solid #0f223a;
    }
    
    .tile {
      flex: 1;
      max-width: 180px;
      text-align: center;
      padding: 12px;
      border-radius: 6px;
      border: 1px solid #ccc;
      background: #3b4a63;
      color: #fff;
      font-weight: 600;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 60px;
    }
    
    .tile:hover {
      background: #4a5b78;
    }
    
    .tile.active {
      background: #ffffff;
      color: #000;
      border-color: #bbb;
    }
    
    .tile.done {
      background: #2ecc71;
      color: #fff;
      border-color: #27ae60;
    }
    
    .tile.done::after {
      content: " ‚úÖ";
      margin-left: 5px;
    }
    
    .tile .points {
      background: rgba(255,255,255,0.2);
      padding: 4px 8px;
      border-radius: 12px;
      font-weight: 700;
      font-size: 11px;
      margin-top: 4px;
    }
    
    .tile.active .points {
      background: #e9eefc;
      color: #2c3e50;
    }
    
    /* Container Styles */
    .container {
      display: grid;
      grid-template-columns: 1fr 420px;
      gap: 16px;
      padding: 16px;
      max-width: 1200px;
      margin: 12px auto;
    }
    
    .container-full {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      padding: 16px;
      max-width: 1200px;
      margin: 12px auto;
    }
    
    .container-split {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      padding: 16px;
      max-width: 1200px;
      margin: 12px auto;
    }
    
    .left-panel {
      background: white;
      border-radius: 8px;
      padding: 18px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      max-height: 76vh;
      overflow: auto;
    }
    
    .left-panel .passage {
      font-size: 14px;
      color: #2c3e50;
      line-height: 1.8;
    }
    
    .left-panel h2 {
      font-size: 16px;
      margin-bottom: 10px;
    }
    
    .right-panel {
      background: white;
      border-radius: 8px;
      padding: 12px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      display: flex;
      flex-direction: column;
      gap: 12px;
      max-height: 76vh;
      overflow: auto;
    }
    
    .main-panel {
      background: white;
      border-radius: 8px;
      padding: 25px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      max-height: 76vh;
      overflow: auto;
    }
    
    .panel-title {
      font-size: 18px;
      margin-bottom: 15px;
      color: #1e3a5f;
      font-weight: 700;
    }
    
    /* Question Styles */
    .question-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }
    
    .question-body {
      margin-top: 8px;
    }
    
    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .option {
      background: #fbfdff;
      border: 1px solid #e1e8f6;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .option:hover {
      background: #f0f6ff;
    }
    
    .option.selected {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .option .radio {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      border: 2px solid #cfdff6;
      background: #fff;
      display: inline-block;
      flex-shrink: 0;
    }
    
    .option.selected .radio {
      background: #3498db;
      border-color: #3498db;
      box-shadow: inset 0 -3px 0 rgba(0,0,0,0.05);
    }
    
    .text-container {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
      position: relative;
      min-height: 120px;
    }
    
    .text-container:hover {
      background: #f0f6ff;
    }
    
    .text-title {
      font-weight: 700;
      margin-bottom: 8px;
      color: #2c3e50;
    }
    
    .text-content {
      font-size: 14px;
      color: #2c3e50;
      line-height: 1.6;
    }
    
    .title-slot {
      min-height: 40px;
      margin-top: 10px;
      padding: 8px;
      border: 2px dashed #c8d9f6;
      border-radius: 6px;
      background: #f8fbff;
    }
    
    .title-slot.has-title {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .title-slot.has-x {
      background: #f8d7da;
      border-color: #e74c3c;
      color: #c0392b;
      font-weight: bold;
    }
    
    .headings-bank {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 0;
    }
    
    .heading-item {
      padding: 10px;
      border: 1px solid #dbe7fb;
      border-radius: 8px;
      background: #f8fbff;
      cursor: grab;
    }
    
    .heading-item:hover {
      background: #e9f0ff;
    }
    
    .heading-item.used {
      opacity: 0.5;
      cursor: not-allowed;
      background: #f8d7da;
      border-color: #f5c6cb;
    }
    
    .result-correct {
      color: #27ae60;
      font-weight: bold;
    }
    
    .result-incorrect {
      color: #c0392b;
      font-weight: bold;
    }
    
    .result-item {
      margin: 10px 0;
      padding: 10px;
      border-radius: 6px;
      background: #f8f9fa;
    }
    
    .instructions {
      color: #7f8c8d;
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 15px;
    }
    
    .question-text {
      font-weight: 600;
      margin-bottom: 15px;
      font-size: 15px;
      color: #2c3e50;
    }
    
    .all-questions {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    
    .question-block {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .texts-list, .situations-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .text-item, .situation-item {
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .text-letter {
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 8px;
    }
    
    .situation-number {
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 8px;
    }
    
    .fill-blank-container {
      margin: 20px 0;
    }
    
    .blank-word {
      display: inline-block;
      min-width: 120px;
      padding: 4px 8px;
      margin: 0 6px;
      background: #fff;
      cursor: pointer;
      position: relative;
      border: 1px solid #dbe7fb;
      border-radius: 4px;
    }
    
    .blank-word.has-answer {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .options-popup {
      position: absolute;
      top: 100%;
      left: 0;
      background: white;
      border: 1px solid #dbe7fb;
      border-radius: 6px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      z-index: 100;
      min-width: 150px;
    }
    
    .option-item {
      padding: 8px 12px;
      cursor: pointer;
      border-bottom: 1px solid #f0f4fb;
    }
    
    .option-item:hover {
      background: #f0f6ff;
    }
    
    .option-item:last-child {
      border-bottom: none;
    }
    
    .horizontal-options {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .option-row {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 10px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .option-number {
      font-weight: bold;
      color: #2c3e50;
      min-width: 30px;
    }
    
    .option-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .option-btn {
      padding: 8px 16px;
      border: 1px solid #dbe7fb;
      border-radius: 6px;
      background: #f8fbff;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .option-btn:hover {
      background: #e9f0ff;
    }
    
    .option-btn.selected {
      background: #3498db;
      color: white;
      border-color: #3498db;
    }
    
    .word-bank-vertical {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .bank-word-vertical {
      padding: 10px;
      border: 1px solid #dbe7fb;
      border-radius: 6px;
      background: #f8fbff;
      text-align: center;
      cursor: grab;
    }
    
    .bank-word-vertical.used {
      opacity: 0.5;
      cursor: not-allowed;
      background: #f8d7da;
      border-color: #f5c6cb;
    }
    
    .blank-slot {
      display: inline-block;
      min-width: 100px;
      padding: 4px 8px;
      margin: 0 6px;
      background: #fff;
      min-height: 30px;
      vertical-align: middle;
      border: 1px solid #dbe7fb;
      border-radius: 4px;
      cursor: pointer;
    }
    
    .blank-slot.has-answer {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .footer-buttons {
      display: flex;
      gap: 10px;
    }
    
    .situation-item.used {
      opacity: 0.7;
      cursor: not-allowed;
      background: #f8d7da;
      border-color: #f5c6cb;
      color: #333;
    }
    
    /* Listening Section Styles */
    .listening-task {
      margin-bottom: 10px;
    }
    
    .true-false-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      font-size: 14px;
    }
    
    .true-false-table th {
      background: #3498db;
      color: white;
      padding: 15px;
      text-align: left;
      font-weight: 600;
      font-size: 14px;
    }
    
    .true-false-table td {
      padding: 15px;
      border-bottom: 1px solid #e1e8f6;
      vertical-align: top;
    }
    
    .true-false-table tr:nth-child(even) {
      background: #f8f9fa;
    }
    
    .true-false-table tr:hover {
      background: #e3f2fd;
    }
    
    .answer-options {
      display: flex;
      gap: 25px;
    }
    
    .answer-option {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      padding: 10px 15px;
      border-radius: 4px;
      transition: background 0.2s;
      font-weight: 500;
    }
    
    .answer-option:hover {
      background: #e3f2fd;
    }
    
    .answer-option input {
      margin: 0;
      transform: scale(1.2);
    }

    .correct-answer {
      background: #d4edda !important;
      border-left: 4px solid #28a745;
    }
    
    .incorrect-answer {
      background: #f8d7da !important;
      border-left: 4px solid #dc3545;
    }
    
    /* Writing Section Styles */
    .writing-task {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .writing-prompt {
      font-size: 14px;
      color: #2c3e50;
      line-height: 1.6;
      margin-bottom: 15px;
    }
    
    .writing-requirements {
      background: #f8f9fa;
      padding: 12px;
      border-radius: 6px;
      border-left: 4px solid #3498db;
      margin-bottom: 15px;
    }
    
    .writing-requirements h4 {
      margin: 0 0 8px 0;
      color: #2c3e50;
    }
    
    .writing-requirements ul {
      margin: 0;
      padding-left: 20px;
    }
    
    .writing-requirements li {
      margin-bottom: 5px;
      color: #2c3e50;
    }
    
    .writing-area {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    
    .writing-textarea {
      flex: 1;
      min-height: 500px;
      padding: 15px;
      border: 2px solid #e1e8f6;
      border-radius: 8px;
      font-size: 14px;
      line-height: 1.6;
      resize: vertical;
      font-family: Arial, sans-serif;
    }
    
    .writing-textarea:focus {
      outline: none;
      border-color: #3498db;
    }
    
    .word-counter {
      margin-top: 10px;
      text-align: right;
      font-size: 13px;
      color: #7f8c8d;
      padding: 8px 0;
    }
    
    .word-counter .count {
      font-weight: bold;
      color: #2c3e50;
    }
    
    /* Results Page Styles */
    .results-body {
      background: #f7fafc;
      color: #0f1724;
      line-height: 1.6;
    }
    
    .results-header {
      background: #1e3a5f;
      color: #fff;
      padding: 18px 20px;
      display: flex;
      align-items: center;
      gap: 16px;
    }
    
    .results-logo {
      background: #fff;
      color: #1e3a5f;
      padding: 8px 12px;
      border-radius: 6px;
      font-weight: 800;
    }
    
    .results-title {
      font-size: 18px;
      font-weight: 700;
    }
    
    .results-container {
      max-width: 1100px;
      margin: 22px auto;
      padding: 20px;
    }
    
    .results-tiles {
      display: flex;
      gap: 12px;
      margin: 18px 0;
    }
    
    .results-tile {
      flex: 1;
      background: #fff;
      border-radius: 10px;
      padding: 16px;
      box-shadow: 0 6px 18px rgba(2, 6, 23, 0.06);
      border-left: 6px solid #1e3a5f;
    }
    
    .results-tile h3 {
      margin: 0;
      font-size: 16px;
      color: #1e3a5f;
    }
    
    .results-tile .score {
      font-size: 20px;
      font-weight: 800;
      margin-top: 8px;
    }
    
    .section-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
    }
    
    .section-table th,
    .section-table td {
      padding: 8px;
      border-bottom: 1px solid #e6eef8;
      text-align: left;
      font-size: 14px;
    }
    
    .summary {
      background: #fff;
      padding: 16px;
      border-radius: 10px;
      margin-top: 18px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .summary .left {
      font-weight: 700;
    }
    
    .summary .right {
      text-align: right;
    }
    
    .controls {
      display: flex;
      gap: 10px;
      margin-top: 18px;
    }
    
    .results-btn {
      background: #4da6ff;
      border: none;
      color: #fff;
      padding: 10px 14px;
      border-radius: 8px;
      font-weight: 700;
      cursor: pointer;
      transition: background 0.3s;
    }
    
    .results-btn:hover {
      background: #3a8ce0;
    }
    
    .button-like {
      text-decoration: none;
    }
    
    .small-muted {
      color: #6b7280;
      font-size: 13px;
    }
    
    input[type="number"] {
      width: 90px;
      padding: 8px;
      border: 1px solid #d7e6fb;
      border-radius: 6px;
    }
    
    .note {
      font-size: 13px;
      color: #6b7280;
      margin-top: 8px;
    }
    
    /* Footer */
    footer.controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: white;
      border-top: 1px solid #e1e8f6;
      margin-top: 20px;
    }
    
    .status {
      font-size: 14px;
      color: #7f8c8d;
    }
    
    .ghost {
      background: transparent;
      border: 2px solid #2c3e50;
      color: #2c3e50;
    }
    
    .ghost:hover {
      background: #2c3e50;
      color: white;
    }

    /* Responsive Styles */
    @media (max-width: 980px) {
      .container {
        grid-template-columns: 1fr;
        padding: 12px;
      }
      
      .container-split {
        grid-template-columns: 1fr;
      }
      
      .right-panel {
        order: 2;
      }
      
      .top-tiles {
        padding-left: 8px;
        padding-right: 8px;
      }
      
      header.topbar {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }
      
      .buttons-grid {
        grid-template-columns: 1fr;
      }
      
      .answer-options {
        flex-direction: column;
        gap: 10px;
      }
      
      footer.controls {
        flex-direction: column;
        gap: 15px;
      }
      
      .results-tiles {
        flex-direction: column;
      }
      
      .summary {
        flex-direction: column;
        gap: 10px;
        text-align: center;
      }
      
      .controls {
        flex-direction: column;
      }
    }
    
    @media (max-width: 600px) {
      .start-content {
        padding: 25px 20px;
      }
      
      h1 {
        font-size: 28px;
      }
      
      .card {
        padding: 20px 15px;
      }
    }

    /* === ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿÆÿßÿµÿ© ŸÑŸÑŸáŸàÿßÿ™ŸÅ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© ÿ¨ÿØÿß === */
    @media (max-width: 480px) {
      /* 1. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ≠ÿßŸàŸäÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© */
      .container, .container-split, .container-full {
        grid-template-columns: 1fr !important;
        padding: 8px !important;
        gap: 10px !important;
      }
      
      /* 2. ÿ¨ÿπŸÑ ÿßŸÑŸÑŸàÿ≠ÿßÿ™ (panels) ÿ™ÿ£ÿÆÿ∞ ÿπÿ±ÿ∂ ŸÉÿßŸÖŸÑ */
      .left-panel, .right-panel, .main-panel {
        max-height: none !important;
        height: auto !important;
        overflow: visible !important;
        margin-bottom: 10px;
      }
      
      /* 3. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸáŸäÿØÿ± */
      .topbar {
        flex-direction: column !important;
        align-items: stretch !important;
        padding: 10px !important;
      }
      
      .brand {
        justify-content: center;
        margin-bottom: 10px;
      }
      
      /* 4. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ± ŸÅŸä ÿßŸÑŸáŸäÿØÿ± */
      .buttons-grid {
        grid-template-columns: 1fr !important;
        width: 100%;
      }
      
      .exam-btn {
        width: 100% !important;
        margin: 2px 0 !important;
        font-size: 14px !important;
        padding: 12px 8px !important;
      }
      
      /* 5. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ™ÿßŸäŸÑÿßÿ™ */
      .top-tiles {
        flex-wrap: wrap;
        justify-content: center;
      }
      
      .tile {
        flex: 0 0 calc(33% - 5px) !important;
        max-width: calc(33% - 5px) !important;
        margin: 2px;
        font-size: 11px !important;
        padding: 8px 4px !important;
      }
      
      /* 6. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÜÿµŸàÿµ */
      .passage, .text-content, .question-text {
        font-size: 15px !important;
        line-height: 1.5 !important;
      }
      
      /* 7. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™ */
      .option {
        padding: 12px 10px !important;
        margin: 4px 0 !important;
      }
      
      /* 8. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ¨ÿØÿßŸàŸÑ True/False */
      .true-false-table {
        display: block;
        overflow-x: auto;
        white-space: nowrap;
      }
      
      /* 9. ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑŸÉÿ™ÿßÿ®ÿ© */
      .writing-textarea {
        min-height: 300px !important;
        font-size: 16px !important;
      }
      
      /* 10. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÅŸàÿ™ÿ± */
      footer.controls {
        flex-direction: column !important;
        gap: 10px !important;
      }
      
      .footer-buttons {
        width: 100%;
        display: flex;
        gap: 5px;
      }
      
      .footer-buttons .exam-btn {
        flex: 1;
      }
      
      /* 11. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ */
      .results-tiles {
        flex-direction: column !important;
      }
      
      .results-tile {
        margin-bottom: 10px;
      }
    }

    /* === ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÑŸÑŸáŸàÿßÿ™ŸÅ ÿßŸÑŸÖÿ™Ÿàÿ≥ÿ∑ÿ© === */
    @media (min-width: 481px) and (max-width: 768px) {
      .container, .container-split {
        grid-template-columns: 1fr !important;
      }
      
      .tile {
        max-width: 180px !important;
      }
    }
  </style>
</head>
<body id="body">
  <!-- Start Page -->
  <div id="start-page" class="start-container">
    <div class="start-content">
      <div class="logo">
        <div class="logo-icon">üìù</div>
        <h1>Deutsch B2 Pr√ºfung</h1>
        <div class="subtitle">Bereiten Sie sich auf Ihre Pr√ºfung vor</div>
      </div>
      <div class="card">
        <h2>Pr√ºfungsbereich ausw√§hlen</h2>
        <p>W√§hlen Sie bitte den Bereich aus, den Sie √ºben m√∂chten. Die Pr√ºfung startet automatisch in <span id="time-display">30</span> Sekunden.</p>
        <select id="sectionSelect">
          <option value="lesen">Lesen</option>
          <option value="hoeren">H√∂ren</option>
          <option value="schreiben">Schreiben</option>
        </select>
        <div class="button-container">
          <button id="cancelBtn" class="btn">Abbrechen</button>
          <button id="startBtn" class="btn">Jetzt starten</button>
        </div>
      </div>
      <div class="timer-container">
        <div class="timer-label">Die Pr√ºfung startet in:</div>
        <div class="timer" id="countdown">30</div>
        <div class="progress-bar">
          <div class="progress" id="progress"></div>
        </div>
      </div>
      <div class="info-text">Stellen Sie sicher, dass Sie in einer ruhigen Umgebung sind und gen√ºgend Zeit haben.</div>
    </div>
  </div>

  <!-- Lesen Page -->
  <div id="lesen-page" class="exam-page" style="display: none;">
    <header class="topbar" role="banner">
      <div class="brand">
        <div class="logo">test</div>
        <div class="meta">
          <div class="main-title">Deutsch - B2 (√úbung)</div>
          <div class="sub-title">Lesen ‚Äî Testbeispiel</div>
        </div>
      </div>

      <div id="timer-lesen" class="timer" aria-live="polite">Verbleibende Zeit: 90:00</div>

      <div class="buttons-grid">
        <button id="resetBtn-lesen" class="exam-btn reset">üîÑ Von neu beginnen</button>
        <button id="saveBtn-lesen" class="exam-btn save">üìã Speichern</button>
        <button id="resultBtn-lesen" class="exam-btn result">üìä Ergebnis</button>
        <button id="submitBtn-lesen" class="exam-btn submit">üèÅ Abgabe</button>
        <button class="exam-btn next" id="nextBtn-lesen">‚û°Ô∏è N√§chste Pr√ºfung</button>
      </div>
    </header>

    <div class="top-tiles" id="topTiles-lesen" role="navigation" aria-label="Sections overview"></div>

    <div class="container">
      <main class="left-panel" id="leftPanel-lesen">
        <div class="passage" id="passage-lesen">
          <h2 id="passageTitle-lesen">Aufgabe</h2>
          <div id="passageContent-lesen"></div>
        </div>
      </main>

      <aside class="right-panel" id="rightPanel-lesen" aria-labelledby="questionTitle-lesen">
        <div class="question-head">
          <div>
            <div id="sectionName-lesen" style="font-weight:800"></div>
            <div id="questionTitle-lesen" style="font-size:13px;color:#55607a">Frage</div>
          </div>
          <button id="resetSectionBtn-lesen" class="exam-btn reset-section" style="display:none;">Teil zur√ºcksetzen</button>
        </div>
        <div class="question-body" id="questionBody-lesen"></div>
        <div id="headingsBankContainer-lesen"></div>
      </aside>
    </div>

    <footer class="controls">
      <div class="footer-buttons">
        <button id="prevBtn-lesen" class="exam-btn ghost">Zur√ºck</button>
        <button id="nextBtn-lesen" class="exam-btn ghost">Weiter</button>
      </div>
      <div class="status"><span id="statusText-lesen">Nicht gespeichert</span></div>
    </footer>
  </div>

  <!-- H√∂ren Page -->
  <div id="hoeren-page" class="exam-page" style="display: none;">
    <header class="topbar" role="banner">
      <div class="brand">
        <div class="logo">test</div>
        <div class="meta">
          <div class="main-title">Deutsch - B2 (√úbung)</div>
          <div class="sub-title">H√∂rverstehen ‚Äî Testbeispiel</div>
        </div>
      </div>

      <div id="timer-hoeren" class="timer" aria-live="polite">Verbleibende Zeit: 17:00</div>

      <div class="buttons-grid">
        <button id="resetBtn-hoeren" class="exam-btn reset">üîÑ Von neu beginnen</button>
        <button id="saveBtn-hoeren" class="exam-btn save">üìã Speichern</button>
        <button id="resultBtn-hoeren" class="exam-btn result">üìä Ergebnis</button>
        <button id="submitBtn-hoeren" class="exam-btn submit">üèÅ Abgabe</button>
        <button class="exam-btn next" id="nextBtn-hoeren">‚û°Ô∏è N√§chste Pr√ºfung</button>
      </div>
    </header>

    <div class="top-tiles" id="topTiles-hoeren" role="navigation" aria-label="Sections overview"></div>

    <div class="container-full">
      <main class="main-panel" id="mainPanel-hoeren">
        <div id="contentContainer-hoeren"></div>
      </main>
    </div>

    <footer class="controls">
      <div class="footer-buttons">
        <button id="prevBtn-hoeren" class="exam-btn ghost">Zur√ºck</button>
        <button id="nextBtn-hoeren" class="exam-btn ghost">Weiter</button>
      </div>
      <div class="status"><span id="statusText-hoeren">Nicht gespeichert</span></div>
    </footer>
  </div>

  <!-- Schreiben Page -->
  <div id="schreiben-page" class="exam-page" style="display: none;">
    <header class="topbar" role="banner">
      <div class="brand">
        <div class="logo">test</div>
        <div class="meta">
          <div class="main-title">Deutsch - B2 (√úbung)</div>
          <div class="sub-title">Schreiben ‚Äî Testbeispiel</div>
        </div>
      </div>

      <div id="timer-schreiben" class="timer" aria-live="polite">Verbleibende Zeit: 30:00</div>

      <div class="buttons-grid">
        <button id="resetBtn-schreiben" class="exam-btn reset">üîÑ Von neu beginnen</button>
        <button id="saveBtn-schreiben" class="exam-btn save">üìã Speichern</button>
        <button id="resultBtn-schreiben" class="exam-btn result">üìä Ergebnis</button>
        <button id="submitBtn-schreiben" class="exam-btn submit">üèÅ Abgabe</button>
        <button class="exam-btn next" id="nextBtn-schreiben">‚û°Ô∏è N√§chste Pr√ºfung</button>
      </div>
    </header>

    <div class="top-tiles" id="topTiles-schreiben" role="navigation" aria-label="Sections overview"></div>

    <div class="container-split">
      <main class="left-panel" id="leftPanel-schreiben">
        <div class="passage" id="passage-schreiben">
          <h2 id="passageTitle-schreiben">Aufgabe</h2>
          <div id="passageContent-schreiben"></div>
        </div>
      </main>

      <aside class="right-panel" id="rightPanel-schreiben">
        <div id="writingContainer-schreiben"></div>
      </aside>
    </div>

    <footer class="controls">
      <div class="footer-buttons">
        <button id="prevBtn-schreiben" class="exam-btn ghost">Zur√ºck</button>
        <button id="nextBtn-schreiben" class="exam-btn ghost">Weiter</button>
      </div>
      <div class="status"><span id="statusText-schreiben">Nicht gespeichert</span></div>
    </footer>
  </div>

  <!-- Ergebnisse Page -->
  <div id="ergebnisse-page" class="results-page" style="display: none;">
    <header class="results-header">
      <div class="results-logo">test</div>
      <div class="results-title">Gesamtergebnis ‚Äî Deutsch B2</div>
    </header>

    <div class="results-container">
      <div class="results-tiles" id="topTiles-ergebnisse"></div>
      <div id="details-ergebnisse"></div>
      <div class="summary" id="finalSummary-ergebnisse"></div>
      <div class="controls">
        <a class="button-like" href="#" id="backBtn-ergebnisse">
          <button class="results-btn">üîÅ Zur√ºck zur Startseite</button>
        </a>
        <button id="calcBtn-ergebnisse" class="results-btn">‚úÖ Ergebnisse anzeigen</button>
      </div>
      <div class="note">Hinweis: Schreiben (45 Punkte) wird manuell eingegeben, falls nicht automatisch vorhanden.</div>
    </div>
  </div>

  <script>
    // ===== PAGE NAVIGATION =====
    function showPage(pageId) {
      // Hide all pages
      document.getElementById('start-page').style.display = 'none';
      document.getElementById('lesen-page').style.display = 'none';
      document.getElementById('hoeren-page').style.display = 'none';
      document.getElementById('schreiben-page').style.display = 'none';
      document.getElementById('ergebnisse-page').style.display = 'none';
      
      // Change body class based on page
      document.getElementById('body').className = '';
      if (pageId === 'ergebnisse-page') {
        document.getElementById('body').className = 'results-body';
      } else if (pageId !== 'start-page') {
        document.getElementById('body').className = 'exam-body';
      }
      
      // Show selected page
      document.getElementById(pageId).style.display = 'block';
      
      // Initialize the page if needed
      if (pageId === 'lesen-page' && typeof initLesenPage === 'function') {
        initLesenPage();
      } else if (pageId === 'hoeren-page' && typeof initHoerenPage === 'function') {
        initHoerenPage();
      } else if (pageId === 'schreiben-page' && typeof initSchreibenPage === 'function') {
        initSchreibenPage();
      } else if (pageId === 'ergebnisse-page' && typeof initErgebnissePage === 'function') {
        initErgebnissePage();
      }
    }

    // ===== START PAGE FUNCTIONALITY =====
    let initialCounter = 30;
    let counter = initialCounter;
    let countdownInterval;
    let countdownRunning = false;
    let examStarted = false;
    const timerEl = document.getElementById("countdown");
    const timeDisplayEl = document.getElementById("time-display");
    const progressEl = document.getElementById("progress");
    const selectEl = document.getElementById("sectionSelect");
    const startBtn = document.getElementById("startBtn");
    const cancelBtn = document.getElementById("cancelBtn");

    function startCountdown() {
      // prevent double-starts or starting after exam already began
      if (countdownRunning || examStarted) return;
      countdownRunning = true;
      // disable start button while counting
      try { startBtn.disabled = true; startBtn.setAttribute('aria-disabled','true'); } catch(e){}
      // reset counter & UI
      counter = initialCounter;
      timerEl.textContent = counter;
      timeDisplayEl.textContent = counter;
      progressEl.style.transform = "scaleX(0)";
      timerEl.style.color = "";

      countdownInterval = setInterval(() => {
        counter--;
        timerEl.textContent = counter;
        timeDisplayEl.textContent = counter;
        const progressValue = (initialCounter - counter) / initialCounter;
        progressEl.style.transform = `scaleX(${progressValue})`;
        if (counter <= 0) {
          clearInterval(countdownInterval);
          countdownInterval = null;
          countdownRunning = false;
          progressEl.style.transform = "scaleX(1)";
          // ensure exam starts only once
          if (!examStarted) {
            examStarted = true;
            startExam();
          }
          // safety: re-enable start button (page usually navigates away)
          try { startBtn.disabled = false; startBtn.removeAttribute('aria-disabled'); } catch(e){}
        }
      }, 1000);
    }

    function stopCountdown(reset = true) {
      if (countdownInterval) {
        clearInterval(countdownInterval);
        countdownInterval = null;
      }
      countdownRunning = false;
      try { startBtn.disabled = false; startBtn.removeAttribute('aria-disabled'); } catch(e){}
      progressEl.style.transform = "scaleX(0)";
      if (reset) {
        counter = initialCounter;
        timerEl.textContent = counter;
        timeDisplayEl.textContent = counter;
      } else {
        timerEl.textContent = "Gestoppt";
      }
    }

    function startExam() {
      // guard to ensure startExam is triggered once
      if (!examStarted) examStarted = true;
      const selectedSection = selectEl.value;
      if (selectedSection === 'lesen') {
        showPage('lesen-page');
      } else if (selectedSection === 'hoeren') {
        showPage('hoeren-page');
      } else if (selectedSection === 'schreiben') {
        showPage('schreiben-page');
      }
    }

    // wire buttons: start will now start the countdown (not the exam directly)
    startBtn.addEventListener('click', startCountdown);

    cancelBtn.addEventListener('click', () => {
      stopCountdown(true);
      timerEl.textContent = "Abgebrochen";
      timerEl.style.color = "#e53e3e";
    });

    // Start countdown automatically when page loads
    window.addEventListener('load', startCountdown);

    // ===== CORRECT ANSWERS OBJECT =====
    const CORRECT_ANSWERS = {
      lesen: {
        // Leseverstehen, Teil 1
        "1": "f",
        "2": "g",
        "3": "e",
        "4": "c",
        "5": "a",
        
        // Leseverstehen, Teil 2
        "s2q1": "s2q1o2",
        "s2q2": "s2q2o2",
        "s2q3": "s2q3o2",
        "s2q4": "s2q4o1",
        "s2q5": "s2q5o1",
        
        // Leseverstehen, Teil 3
        "11": "A",
        "12": "B",
        "13": "C",
        "14": "G",
        "15": "D",
        "16": "H",
        "17": "I",
        "18": "J",
        "19": "X",
        "20": "X",
        
        // Sprachbausteine, Teil 1
        "21": "zu",
        "22": "kommenden",
        "23": "nach",
        "24": "bieten",
        "25": "so dass",
        "26": "Gemeinsam mit",
        "27": "der Besuch",
        "28": "is geplant",
        "29": "besprochen",
        "30": "haben",
        
        // Sprachbausteine, Teil 2
        "31": "MIT",
        "32": "BEI",
        "33": "DAS",
        "34": "DAF√úR",
        "35": "SONDERN",
        "36": "OBWOHL",
        "37": "WEIL",
        "38": "DASS",
        "39": "AUF",
        "40": "VON"
      },
      
      hoeren: {
        // H√∂rverstehen, Teil 1
        "41": "richtig",
        "42": "richtig",
        "43": "falsch",
        "44": "falsch",
        "45": "richtig",
        
        // H√∂rverstehen, Teil 2
        "46": "richtig",
        "47": "falsch",
        "48": "richtig",
        "49": "richtig",
        "50": "richtig",
        "51": "falsch",
        "52": "falsch",
        "53": "richtig",
        "54": "falsch",
        "55": "falsch",
        
        // H√∂rverstehen, Teil 3
        "56": "richtig",
        "57": "falsch",
        "58": "falsch",
        "59": "richtig",
        "60": "falsch"
      }
    };

    // ===== HELPER FUNCTIONS =====
    function normalizeAnswer(a) {
      if (a === null || a === undefined || a === '') return '-';
      let s = String(a).trim();
      if (s === '') return '-';
      const low = s.toLowerCase();
      if (["richtig", "true", "yes", "ja"].includes(low)) return 'richtig';
      if (["falsch", "false", "no", "nein"].includes(low)) return 'falsch';
      return s;
    }

    function getHeadingText(headingId) {
      if (!headingId || headingId === '-') return '-';
      const headings = {
        "a": "An deutschen Grundschulen sind m√§nnliche Lehrkr√§fte selten",
        "b": "Bildungsexperten warnen: Deutsche Lehrer sind schlecht ausgebildet",
        "c": "Bildungsforscher: Lehrermangel wird in Deutschland nicht eintreten",
        "d": "Die Zahl der m√§nnlichen Lehrkr√§fte an Grundschulen nimmt zu",
        "e": "Experten bef√ºrchten zunehmenden Lehrermangel in Deutschland",
        "f": "Gewerkschaft erwartet Lehrermangel in Berlin",
        "g": "GEW bef√ºrchtet Abwanderung von gut ausgebildeten Lehrkr√§ften aus Berlin",
        "h": "Immer mehr Berliner wandern aus",
        "i": "Immer weniger Frauen machen ein Grundschullehrer-Studium",
        "j": "Vorausschauende Politiker verhindern Lehrermangel in Berlin"
      };
      return headings[headingId] || headingId;
    }

    function getOptionText(questionId, optionId) {
      if (!optionId || optionId === '-') return '-';
      const options = {
        "s2q1o1": "damit sie die Jahre bis zur Arbeit in der Fabrik √ºberbr√ºcken konnten.",
        "s2q1o2": "damit sie lernten, einen Haushalt zu f√ºhren.",
        "s2q1o3": "damit sie besser beaufsichtigt waren als zu Hause.",
        "s2q2o1": "durch Vermittler, die ins Dorf kamen.",
        "s2q2o2": "alleine.",
        "s2q2o3": "mit Hilfe ihrer Eltern.",
        "s2q3o1": "fast nur bei reicheren Leuten.",
        "s2q3o2": "auch bei den weniger reichen Leuten.",
        "s2q3o3": "in jedem Haus in der Stadt.",
        "s2q4o1": "mussten l√§nger arbeiten als Fabrikarbeiter.",
        "s2q4o2": "hatten feste Arbeitszeiten.",
        "s2q4o3": "hatten keine geregelten Arbeitszeiten.",
        "s2q5o1": "blieben bis zu ihrer Rente in diesem Beruf.",
        "s2q5o2": "heirateten und wurden Hausfrauen.",
        "s2q5o3": "wechselten sp√§ter in eine Fabrik."
      };
      return options[optionId] || optionId;
    }

    function getSituationText(id) {
      const situations = {
        "11": "Sie m√∂chten Ihren Eltern zur Silberhochzeit eine besondere Schiffsreise auf dem Meer schenken.",
        "12": "Ihre Freundin m√∂chte mit ihrem Mann Silvester und Neujahr im Urlaub feiern, aber nicht schon wieder im Gebirge.",
        "13": "Ein Bekannter m√∂chte im Winter ein besinnliches Wochenende in den Bergen verbringen, denn er mag es, durch die verschneite Natur zu laufen.",
        "14": "Eine Bekannte aus dem Rhein-Main-Gebiet sucht Vorschl√§ge f√ºr Ein-Tages-Ausfl√ºge, denn sie √ºbernachtet nicht gern in fremden Betten.",
        "15": "Sie wollen wie jedes Jahr in der zweiten Jahresh√§lfte eine zirka einw√∂chige organisierte Urlaubsreise in Europa machen und sich dabei viel mit dem Fahrrad fortbewegen.",
        "16": "Sie m√∂chten einen netten Abend mit Freunden bei gutem Essen und au√üergew√∂hnlichem Unterhaltungsprogramm verleben.",
        "17": "Sie suchen f√ºr eine prunkvolle Hochzeitsfeier geeignete festliche R√§umlichkeiten in einer stimmungsvollen kl√∂sterlichen Umgebung f√ºr zirka 50 Personen.",
        "18": "Sie sind neu in Frankfurt a. M. und suchen deshalb nach n√ºtzlichen Informationen und praktischen Tipps, um sich schnell in der neuen Umgebung einzuleben.",
        "19": "Sie interessieren sich f√ºr B√ºcher √ºber Architektur und Gartenarchitektur deutscher Klosteranlagen.",
        "20": "Sie suchen gute Kriminalromane, deren Handlung im Rhein-Main-Gebiet und besonders in Frankfurt spielt."
      };
      return situations[id] || id;
    }

    function escapeHtml(s) {
      return String(s)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;');
    }

    function buildTable(title, dets, total, max) {
      let html = `<div class="result-item">
                    <h3>${title} - ${total.toFixed(2)}/${max} Punkte</h3>
                    <div class="section-table">
                      <table class="true-false-table">
                        <thead>
                          <tr>
                            <th style="width: 10%">Frage</th>
                            <th style="width: 40%">Ihre Antwort</th>
                            <th style="width: 40%">Richtige Antwort</th>
                            <th style="width: 10%">Ergebnis</th>
                          </tr>
                        </thead>
                        <tbody>`;
      
      dets.forEach(x => {
        const isCorrect = x.richtig;
        const rowClass = isCorrect ? 'correct-answer' : 'incorrect-answer';
        const resultIcon = isCorrect ? '‚úÖ Richtig' : '‚ùå Falsch';
        
        html += `<tr class="${rowClass}">
                  <td><strong>${x.frage}</strong></td>
                  <td>${escapeHtml(x.user)}</td>
                  <td>${escapeHtml(x.correct)}</td>
                  <td><strong>${resultIcon}</strong></td>
                </tr>`;
      });
      
      html += `</tbody>
              </table>
              <div style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 6px;">
                <strong>Erreichte Punkte: ${total.toFixed(2)}/${max} (${((total/max)*100).toFixed(1)}%)</strong>
              </div>
            </div></div>`;
      return html;
    }

    // ===== LESEN PAGE FUNCTIONALITY =====
    function initLesenPage() {
      /* ===== Self-contained exam (embedded) ===== */
      const exam = {
        id: "exam-001",
        durationSec: 90 * 60,
        sections: [
          { 
            id: "s1", 
            title: "Leseverstehen, Teil 1", 
            points: 25,
            passageTitle: "Aufgabe: Ziehen Sie die passenden √úberschriften auf die Texte.",
            passage: "",
            questions: [],
            texts: [
              {
                id: "1",
                content: "Berlin wird in 10 Jahren rund 5.000 Lehrkr√§fte weniger brauchen als derzeit. F√ºr den Unterricht an den Schulen werden dann, wie die Gewerkschaft Erziehung und Wissenschaft (GEW) errechnet hat, noch etwa 25.500 von heute 30.000 P√§dagogen ben√∂tigt. Die Gewerkschaft bef√ºrchtet zugleich, dass bis zu diesem Zeitpunkt zu wenig Nachwuchskr√§fte ausgebildet werden und es deshalb zu einer dramatischer Unterversorgung kommt. Nach Meinung der GEW steuert die Hauptstadt bei der Personalausstattung der Schulen auf ein Fiasko zu, weil in den n√§chsten 10 Jahren mehr als 10.000 Lehrkr√§fte aus Altersgr√ºnden in den Ruhestand gehen. Au√üerdem w√ºrden j√§hrlich zirka 400 Lehrer die Berliner Schulen verlassen, so dass nach Ansicht der GEW letzlich 9.000 Stellen fehlen. Wenn die Zahl der Studienanf√§nger nicht kr√§ftig gesteigert werde, k√∂nne langfristig nicht einmal die H√§lfte des prognostizierten Einstellungsbedarf gedeckt werden. Au√üerdem sei die Hauptstadt f√ºr Berufseinsteiger nicht so attraktiv wie andere Bundesl√§nder, da sie selbst f√ºr Mangelf√§cher nur befristete Vertr√§ge anbietet.",
                correctAnswer: "f"
              },
              {
                id: "2", 
                content: "Wer sich in Berlin um eine Stelle als Lehrer bewirbt, muss hart im Nehmen sein. 'W√§hrend man in Hamburg respektvoll behandelt wird, rechnen Vertreter der Berliner Schulverwaltung den Bewerbern vor, wie teuer Lehrer sind. Da f√ºhlt man sich nicht richtig gewollt', sagt Maria Sch√ºtz. Die 27-j√§hrige geh√∂rt zu den rund 500 Referendaren, die in zwei Wochen mit ihrem Studium fertig werden. Maria Sch√ºtz, die ihr Exam mit der Note 1,5 bestanden hat und unbefingt in Berlin unterrichten wollte, hat mit ihrer Bewerbung leidvolle Erfahrungen hinter Sich. 'W√§hrend man in Hamburg sofort eine feste Stelle im Beamtenverh√§ltnis angeboten hat, konnte mir in Berlin keiner zusagen, dass ich im n√§chsten Schuljahr gebraucht werde.' Die junge Frau hat das gute Angebot aus Hamburg einer unsicheren Zukunft in Berlin vorgezogen. F√ºr Anna Richter, Vorsitzende der Lehrergewerkschaft GEW, ist Marias Geschichte nur eine von vielen. Ihre Organisation ist besorgt dar√ºber, dass Berlin auf diese Weise viele gut qualifizierte Lehrer an andere Bundesl√§nder verlieren k√∂nnte.",
                correctAnswer: "g"
              },
              {
                id: "3",
                content: "Die Hilferufe aus den Schulen wollen nicht verstummen: Sch√ºler klagen √ºber st√§ndigen Lehrerwechsel, Eltern √ºber Stundenausfall und Schulleiter √ºber fehlende Bewerber. Doch es k√∂nnte noch schlimmer werden. Der Verband Bildung und Erziehung (VBE) rechnet in den n√§chsten 15 Jahren mit einem 'gewaltigen Lehrermangel' in Deutschland. Der Verbandsvorsitzende Ludwig Eckinger sagte am Donnerstag, er gehe f√ºr diesen Zeitraum von bis zu 400.000 Lehrern aus, die aus Altersgr√ºnden aus dem Schuldienst ausscheiden. F√ºr 100 pensionierte Lehrer k√§men jedoch nur 50 neue Kollegen. Der Lehrernotstand kommt nicht √ºberraschend, Forscher sagten ihn l√§ngst voraus. Und auch die Konferenz der Kultusminister pr√§sentierte schon vor f√ºnf Jahren beunruhigende Zahlen: Es werden an deutschen Schulen 70.000 P√§dagogen fehlen, denn fast die H√§lfte der 800.000 Lehrer geht in Pension. Deshalb fordern Experten seit langem einen bundesweiten Entwicklungsplan, denn Untersuchungen des Lehrerarbeitsmarkt zeigten eher 'Chaos als systematische Planung'. Deutschland steuere auf Zust√§nde wie in den Niederlanden zu. Dort ist der Lehrermangel so gro√ü, dass sich Schulen gegenseitig Lehrer ausspannen.",
                correctAnswer: "e"
              },
              {
                id: "4",
                content: "Bildungspolitiker und Lehrervertreter wollen Abiturienten scharenweise in den Lehrerberuf locken. Sie sollen gro√üe L√ºcken schlie√üen, die durch Pensionierungen entstehen. Doch das Versprechen vom sicheren Job l√§sst sich wom√∂glich nicht einl√∂sen - es basiere auf falschen Annahmen, sagen Essener Bildungsforscher. Die Arbeitsgruppe Bildungsforschung/Bildungsplanung unter der Leitung des Wissenschaftlers Klaus Klemm kommt in ihrem Bericht zu einem ganz anderen Ergebnis. W√§hrend die Kultusministerkonferenz mit 70.000 fehlenden Lehrern rechnet und der Philologenverband gar mit 80.000, errechnete die Forschungsgruppe, dass it zu einer insgesamt ausgeglichenen Bilanz zwischen Nachfrage und Angebot auf dem Lehrer-Arbeitsmarkt kommen werde. Wenn sich die 'Einstellungspolitik der Bundesl√§nder nicht √§ndert, d√ºrfen wir sogar einen Lehrer√ºberschuss bekommen', sagte Klemm. Er warnt Abiturienten, ihre Studienentscheidung von den angeblich rosigen Aussichten f√ºr Lehrer abh√§ngig zu machen. 'Die Abiturienten h√∂ren, es werden Lehrer gesucht, und schon studieren sie Germanistik f√ºrs Gymnasium. Das ist ein Fehler', sagt Klemm. Denn schon jetzt zeichne sich ab, dass es Deutsch-, Geschichts- und Fremdsprachenlehrer eher schwer haben werden.",
                correctAnswer: "c"
              },
              {
                id: "5",
                content: "M√§dchen haben tendenziell bessere Noten und stellen 56 Prozent der Abiturienten. Dagegen sind zwei Drittel der Schulabbrecher und drei Viertel der Sondersch√ºler Jungen. Liegt die Ursache in der Grundschule, wo von den knapp 200.000 Lehrkr√§ften nur rund 26.000 m√§nnlich sind? An der Grundschule sind M√§nner eine Rarit√§t. Wer sich dorthin verirrt, arbeitet allein unter Frauen. Im Schuljahr 1990/1991 unterrichtete noch ein Drittel M√§nner an Grundschulen, im Schuljahr 2006/2007 liegt der Frauenanteil an den Grundschullehrern bei 86,9 Prozent, w√§hrend an weiterf√ºhrenden Schulen das Geschlechterverh√§ltnis nahezu ausgeglichen ist. Im Extremfall kann das bedeuten, dass Jungen bis zum Alter von 10 oder 12 Jahren in Krippe, Kindergarten und Grundschule ausschlie√ülich von Frauen betreut und unterrichtet werden. Auch die Familienministerin vermisst die M√§nner an den Grundschulen. 'In den wichtigen fr√ºhen Jahren fehlen den Jungen m√§nnliche Vorbilder, an denen sie sich im Alltag ausrichten k√∂nnen', sagte sie in einem Interview. Das gelte gerade f√ºr Kinder mit Migrationshintergrund. Gr√ºnde daf√ºr sieht sie in der gesellschaftlichen Anerkennung des Berufs und in den Gehaltsstrukturen.",
                correctAnswer: "a"
              }
            ],
            headings: [
              {id: "a", text: "An deutschen Grundschulen sind m√§nnliche Lehrkr√§fte selten"},
              {id: "b", text: "Bildungsexperten warnen: Deutsche Lehrer sind schlecht ausgebildet"},
              {id: "c", text: "Bildungsforscher: Lehrermangel wird in Deutschland nicht eintreten"},
              {id: "d", text: "Die Zahl der m√§nnlichen Lehrkr√§fte an Grundschulen nimmt zu"},
              {id: "e", text: "Experten bef√ºrchten zunehmenden Lehrermangel in Deutschland"},
              {id: "f", text: "Gewerkschaft erwartet Lehrermangel in Berlin"},
              {id: "g", text: "GEW bef√ºrchtet Abwanderung von gut ausgebildeten Lehrkr√§ften aus Berlin"},
              {id: "h", text: "Immer mehr Berliner wandern aus"},
              {id: "i", text: "Immer weniger Frauen machen ein Grundschullehrer-Studium"},
              {id: "j", text: "Vorausschauende Politiker verhindern Lehrermangel in Berlin"}
            ]
          },
          { 
            id: "s2", 
            title: "Leseverstehen, Teil 2", 
            points: 25,
            passageTitle: "Geschichte des Hauspersonals",
            passage: `Dienstm√§dchen war um1900 der am weitesten verbreitete Beruf f√ºr Frauen. Aus heutiger Perspektive ist das verwunderlich, denn der Alltag eines Dienstm√§dchens war sehr hart. Was trieb also Frauen in diesen Beruf?

Es waren vor allem M√§dchen vom Land, die von ihren Eltern in die Stadt geschickt wurden, um dort zu arbeiten. Auf dem Land gab es kaum Stellen f√ºr M√§dchen. Als Dienstm√§dchen, so hofften die Eltern, w√ºrden ihre T√∂chter wenigstens das Hauswirtschaften lernen ‚Äì eine wichtige Fertigkeit als sp√§tere Haus ‚Äì und Ehefrau. Dabei war das enge Leben eines Dienstm√§dchens ohne viel Zeit genau das, was den Eltern gut an diesem Beruf erschien: da die M√§dchen oft erst 14 oder 15 Jahre alt waren, waren sie in einer Familie beh√ºteter als beispielsweise in der Fabrik. Allerdings kam es nicht selten vor, dass die Hoffnung auf eine Ausbildung entt√§uscht wurde. Viele M√§dchen wurden nicht eingearbeitet und angelemt, sondern mussten selber zusehen, wie sie das Arbeitspensum bew√§ltigten.

Leider verf√ºgten die Eltern meist nicht √ºber Kontakte in der Stadt. Die M√§dchen fuhren mit dem Zug in die Fremde und mussten dann auf eigene Faust eine Stellung finden. Das machten sich auch dubiose Stellenvermittler an den Bahn√∂fen zu Nutze und verschafften den M√§dchen Stellen in Kneipen als Kellnerinnen ‚Äì damals eine Arbeit mit sehr schlechtem Ruf. Um diesen Missstand zu beenden, gr√ºndeten sich √ºbrigens die Bahnhofsmissionen, die damals konfessions√ºbergreifend von den katholischen, evangelischen und j√ºdischen Gemeinden den ankommenden M√§dchen erst einmal ein Bett bieten sollten.

Wer etwas auf sich hielt, besch√§ftigte um 1900 ein Dienstm√§dchen: sowohl kleinb√ºrgerliche Haushalte als auch gro√üb√ºrgerliche. Die unteren Schichten, also Handwerkerfamilien, eiferten den gehobeneren nach. Nach au√üen durfte es an nichts fehlen, auch wenn das Budget daf√ºr knapp war. Gespart wurde da, waar es nicht sichtbar war: bei der Unterbringung und Ern√§hrung der Dienstm√§dchen. In gehobeneren Schichten gab es gerne auch mehr Personal ‚Äì ein Vorteil und Nachteil zugleich. Einerseits hatte das Dienstm√§dchen so mehr Gesellschaft und war weniger isoliert, anderseits gab es auch unter den Dienstboten eine Hierarchie und das Dienstm√§dchen war das unterste Glied.

Anders als Fabrikarbeiter hatten Dienstboten keine geregelte Arbeitszeiten. Sie mussten, wenn n√∂tig, ihren Dienstherren rund um die Uhr zur Verf√ºgung stehen. Das Dienstm√§dchen stand als Erste auf, befeuerte den Ofen, machte das Wasser zum Waschen und f√ºrs Fr√ºhst√ºck warm, servierte die Mahlzeiten, r√§umte wieder ab, sp√ºlte und putzte. Das Einkaufen geh√∂rte zu den beliebten T√§tigkeiten, denn das erlaubte es den M√§dchen, einmal ohne Aufsicht in der Stadt unterwegs zu sein, andere Dienstm√§dchen zu treffen und sich auszutauschen. Flie√üendes Wasser geh√∂rte um die Jahrhundertwende nicht zum Standard, so musste das Dienstm√§dchen auch Wasser schleppen. Erst wenn alle Arbeit erledigt war, konnte das Dienstm√§dchen schlafen gehen. Die wenige freie Zeit am Abend reichte oft nur, um die eigene Kleidung auszubessern. Alle vierzehn Tage durften die M√§dchen sonntags f√ºr zwei Stunden das Haus verlassen, das war der einzige Ausgang, den sie hatten.

Der Lohn bestand im Wesentlichen aus Kost und Unterkunft. Etwas zur√ºcklegen f√ºr sp√§ter konnte kaum ein M√§dchen. Auch die Unterbringung lie√ü zu w√ºnschen √ºbrig. Von Berliner Dienstm√§dchen wei√ü man, dass sie oft noch nicht einmal eine eigene Kammer hatten, sondern auf so genannten H√§ngeb√∂den schliefen, eine kleine Fl√§che von vielleicht mal zwei Metern bei einer Raumh√∂he von etwa 1,50 Meter. Wenig Schlaf, und dann auch noch schlechter Schlaf: Vielen M√§dchen waren die Strapazen trotz ihres jungen Alters anzusehen. F√ºr die meisten war es nur eine Zwischenstation. Heirateten sie, beendeten die jungen M√§dchen dieses Arbeitsverh√§ltnis und stattdessen war die junge Frau selbser Hausfrau und Herrin eines eigenen Haushalts.`,
            questions: [
              {
                id: "s2q1",
                type: "single",
                text: "Die Eltern lie√üen ihre T√∂chter als Dienstm√§dchen arbeiten,",
                options: [
                  {id: "s2q1o1", text: "damit sie die Jahre bis zur Arbeit in der Fabrik √ºberbr√ºcken konnten."},
                  {id: "s2q1o2", text: "damit sie lernten, einen Haushalt zu f√ºhren."},
                  {id: "s2q1o3", text: "damit sie besser beaufsichtigt waren als zu Hause."}
                ],
                correctAnswer: "s2q1o2"
              },
              {
                id: "s2q2",
                type: "single", 
                text: "Die Stellen fanden die M√§dchen zumeist",
                options: [
                  {id: "s2q2o1", text: "durch Vermittler, die ins Dorf kamen."},
                  {id: "s2q2o2", text: "alleine."},
                  {id: "s2q2o3", text: "mit Hilfe ihrer Eltern."}
                ],
                correctAnswer: "s2q2o2"
              },
              {
                id: "s2q3",
                type: "single",
                text: "Dienstm√§dchen gab es",
                options: [
                  {id: "s2q3o1", text: "fast nur bei reicheren Leuten."},
                  {id: "s2q3o2", text: "auch bei den weniger reichen Leuten."},
                  {id: "s2q3o3", text: "in jedem Haus in der Stadt."}
                ],
                correctAnswer: "s2q3o2"
              },
              {
                id: "s2q4",
                type: "single",
                text: "Dienstm√§dchen",
                options: [
                  {id: "s2q4o1", text: "mussten l√§nger arbeiten als Fabrikarbeiter."},
                  {id: "s2q4o2", text: "hatten feste Arbeitszeiten."},
                  {id: "s2q4o3", text: "hatten keine geregelten Arbeitszeiten."}
                ],
                correctAnswer: "s2q4o1"
              },
              {
                id: "s2q5", 
                type: "single",
                text: "Die meisten Dienstm√§dchen",
                options: [
                  {id: "s2q5o1", text: "blieben bis zu ihrer Rente in diesem Beruf."},
                  {id: "s2q5o2", text: "heirateten und wurden Hausfrauen."},
                  {id: "s2q5o3", text: "wechselten sp√§ter in eine Fabrik."}
                ],
                correctAnswer: "s2q5o1"
              }
            ]
          },
          { 
            id: "s3", 
            title: "Leseverstehen, Teil 3", 
            points: 25,
            passageTitle:"Aufgabe: Lesen Sie die zehn Situationen (11-20) und die zw√∂lf Texte (A-L). Welcher Text passt zu welcher Situation? Sie k√∂nnen jeden Text nur einmal verwenden. Manchmal passt kein Text. W√§hlen Sie dann 'x'.",
            passage: "",
            questions:[],
            texts: [
              {id: "A", text: "Norwegen: Kirkenes-BergenDie sch√∂nste Seereise der Welt - von Anfang April bis Ende Oktober. 6-Tage-Seereise 2009 ab 699,- ‚Ç¨ p. P. Eindrucksvolle Landschaften entdecken. Die Seele baumeln lassen. Natur mit allen Sinnen genie√üen. Mit einer Postschiffreise k√∂nnen Sie das unglaubliche Panorama, das Ihnen die norwegische K√ºste wie im Bilderbuch darbietet, genie√üen. Erleben Sie die Einzigartigkeit der atemberaubenden Gebirgsketten, der artenreichen Tierwelt und der idyllisch gelegenen Hafenst√§dte, die wir im Liniendienst anfahren. Buchen Sie innerhalb der n√§chsten 6 Wochen - und sichern Sie sich Ihre Wunschkabine und einen Fr√ºhbucher-Bonus bis 25%. Information, aktueller Katalog und Buchung unter: Tel.: (040) 367 53-496, E-Mail: info@eiligruten.de, www.eiligruten.de.", correctAnswer: "11"},
              {id: "B", text: "Mal was ganz anderes machen Winterurlaub am Meer. Denn Nord- und Ostseek√ºste bieten auch in der cold Jahreszeit Aktivit√§ten, die der ganzen Familie Spa√ü machen. Zum Beispiel Bo√üeln. Welche Mannschaft kullert die bleigef√ºllte Holzkugel auf den gefrorenen Wegen am weitesten? Zwischendurch gibt es hei√üen Fr√ºchtetee oder Gl√ºhwein, hinterher traditionell Gr√ºnkohl f√ºr alle. Tierfreunde k√∂nnen auf einer Robbensafari zusehen, wie die Robbenm√ºtter ihre Babys s√§ugen. Wer will, kann die Winterlandschaft dick eingemummt von der Pferdekutsche aus genie√üen. Gleichm√§√üig stapfen die Hufe im Sand, der Leuchtturm ist das ferne Ziel. Und danach aufw√§rmen am knisternden Kamin, mit s√º√üem Punsch und Bratapfel. Braucht da noch jemand Berge? Infos unter: www.schleswig-holstein.de.", correctAnswer: "12"},
              {id: "C", text: "Meditation im Schnee Nur die Schritte knirschen gleichm√§√üig im Schnee. Sonst ist es absolut still. Rechts und links ragen die Berge schroff in den blauen Himmel. Strahlend wei√ü glitzert die Landschaft wie von Tausenden kleiner Diamanten. Wer in meditativer Stimmung durch den Schnee stapfen m√∂chte, ist auf einer Schneeschuhwanderung in den Ostschweizer Bergen richtig. Beim Schneeschuh-Wochenende wandert man mit gro√üfl√§chigen Schuhen ausger√ºstet durch den Tiefschnee. Sp√§ter fahren dann alle mit dem Schlitten ins Tal, wo im Gasthaus schon eine hei√üe Suppe auf dem Herd dampft und ein warmes Bett wartet. F√ºr mehr Informationen besuchen Sie unsere Internet-Seite: www.meditation-im-schnee.ch.", correctAnswer: null},
              {id: "D", text: "Fluss- und Radreise durch Belgien 8 Tage Fluss- und Radreise durch Belgien. Abseits der Hauptstra√üen fahren Sie mit Schiff und Rad durch die flache Polderlandschaft Belgiens, die daf√ºr ideal geeignet ist. Die St√§dte Br√ºgge und Br√ºssel bilden den Anfangs- und Endpunkt der Reise. Im Reisepreis enthalten: Bahnreise in der 2. Klasse ab Frankfurt, Transfers vom Bahnhof zum Schiff und zur√ºck. 7 N√§chte in Au√üenkabinen an Board der Quo Vadis, Fr√ºhst√ºck, Mittagessen oder Lunchpaket f√ºr Fahrradtouren, Abendessen. T√§gliche Tourenbesprechungen, Landkarten, alle Hafen-, Schleusen- und Br√ºckengeb√ºhren, Leihgeb√ºhr f√ºr ein 7-Gang-Unisex-Rad, qualifizierte, ortskundige Reiseleitung. Die Radstrecke betr√§gt ca. 296 km. Termin: 19. bis 26. September. Preis: 1199 ‚Ç¨ p. P. in Zweibettkabine.", correctAnswer: "13"},
              {id: "E", text: "Radwandern durch das Veneto 8 Tage Radwandern durch das Veneto. Sogar Goethe war sprachlos - so sch√∂n ist Norditalien. Ruhige, flache Wege geleiten Sie vom Gardasee √ºber Verona nach Vicenza. Durchs Etschtal und √ºber die Lagunen kommen Sie nach Venedig. Im Reisepreis enthalten: Bahnreise 2. Klasse von Frankfurt nach Verona und zur√ºck von Venedig inklusive Schafwagen. Tranfer von und zum Bahnhof in Verona und Venedig. 6 √úbernachtungen in ausgew√§hlten Hotels inkl. Fr√ºhst√ºck, 6 Abendessen, Picknickservice, Leih-Tourenrad mit 8-Gang-Schaltung, s√§mtliche Eintritte laut Programm, qualifizierte, ortskundige Reiseleitung, Kleinbus als Begleitfahrzeug, Gep√§cktransport. Termin: 5. bis 12. April. Preis: 1399 ‚Ç¨ p. P. im DZ.", correctAnswer: "14"},
              {id: "F", text: "√úbernachten Im Namen der Rose Ber√ºhmt wurde Kloster Eberbach 1988 als Schauplatz f√ºr die Innenaufnahmen zum Film Der Name der Rose. Zwar gibt es heute kein kl√∂sterliches Leben mehr, aber das in seinen Bauk√∂rpern erhaltene Kloster gilt als das bedeutendste mittelalterliche Gesamtkunstwerk Hessens. Die jahrhundertealte Weinbautradition hat sich bis heute fortgesetzt. Wer v√∂llig unbeschwert die Weinverkostungen erleben m√∂chte, kann das Herbst-Winter-Wochenend-Spezial nutzen, das die Gastronomiebetriebe im Kloster Eberbach zusammengestellt haben. Das Angebot umfasst auch eine √úbernachtung im Doppelzimmer von Samstag auf Sonntag. Es beinhaltet zudem ein reichhaltiges Fr√ºst√ºcksbuffet und ein Vier-G√§nge-√úberraschungsmen√º am Abend. Der Preis pro Person betr√§gt 97,- ‚Ç¨. Weitere Informationen gibt es bei den Gastronomiebetrieben im Kloster Eberbach, Eltville, unter Telefon 06723/993-0. ", correctAnswer: "15"},
              {id: "G", text: "Tagestouren in Rheinhessen und im Rheingau Mit der Zahnstangenbahn auf den Wiesbadener Neroberg fahren, in Geisenheim mediterran kochen lernen, wandern mit Lamas und Alpakas als Begleiter, in Siefersheim mit Kr√§uterfrauen nach vergessenen Pflanzen suchen oder eine F√ºhrung durch Kloster Eberrbach mit anschlie√üender Weinprobe ‚Äî 111 Tipps f√ºr Tagestouren in Rheinhessen und im Rheingau stellt der neue Band \"Ein sch√∂ner Tag\" vor. Darunter sind auch echte Geheimtipps. Zum Beispiel, wie Besucher im Mainzer Dom ins Innere der Orgel steigen k√∂nnen oder wo die \"Nacht der Verf√ºhrung\" stattfindet.", correctAnswer: "16"},
              {id: "H", text: "Abend im Palladio Wenn die Tage k√ºrzer und die N√§chte k√§lter werden, ist es Zeit f√ºr Artistik, Comedy und Gaumenfreuden. Magier, Jongleure, Akrobaten und ein Vier-Gang-Gourmet-Men√º im Schein hunderter Kerzen: Ein Abend im Palladio verspricht unterhaltsame Stunden mit perfektem Genuss im stilvollen Ambiente des traumhaft sch√∂nen, nostalgischen Spiegelpalastes. Das Gourmet-Theater Palladio serviert Ihnen seine charmante Mixtur aus hochkar√§tigem Entertainmente und exquisiter Kochkunst. Freuen Sie sich auf k√∂stliche Men√ºkreationen und erleben Sie dreieinhalb Stunden voller Humor und Lebensfreude. Lassen Sie sich verw√∂hnen und verzaubern! Dienstags bis sonntags sind wir f√ºr Sie da: Beginn ist jeweils um 20.00 Uhr. Foyer und Bar sind bereits 90 Minuten vor Showbeginn ge√∂ffnet.", correctAnswer: null},
              {id: "I", text: "Kloster Eberbach Kloster Eberbach mit seinen eindrucksvollen mittelalterlichen und barocken Bauten bietet seinen G√§sten einzigartige Voraussetzungen f√ºr eine stilvolle Veranstaltung in altehrw√ºrdigen Klostermauern. Sie k√∂nnen viele unserer repr√§sentativen S√§le und prachtvollen R√§ume f√ºr Veranstaltungen anmieten. Ob Sie einen festlichen Empfang oder ein nobles Bankett planen oder ob Ihnen eine stilvolle Produktpr√§sentation vorschwebt: Hier l√§sst sich all dies hervorragend inszenieren. Die breite Palette unserer R√§umlichkeiten und G√§rten gibt Raum f√ºr Gesellschaften von 20 bis 1.000 Personen und l√§sst im Zusammenspiel mit dem Ambiente der Klosteranlage jede Veranstaltung zu einem ganz besonderen Ereignis werden. Hier finden Sie den richtigen Rahmen f√ºr Ihre Familienfeier, Ihr Seminar, Ihren Betriebsausflug, ein festliches Bankett oder eine Vortragsveranstaltung. Einige R√§ume sind zudem f√ºr Hochzeiten, Konzerte und Lesungen geeignet.", correctAnswer: "17"},
              {id: "J", text: "Stadt-F√ºhrer Frankfurt am Main. Kultur & mehr Viel Lob von der Lokalpresse f√ºr einen neuen Stadt-F√ºhrer √ºber die Mainmetropole: Anne Sch√ºtz: Frankfurt am Main. Kultur & mehr. Paul M√ºller Verlag, 15,95 ‚Ç¨. Dieser umfangreiche Reise-F√ºhrer wartet mit einer ganz besonderen Mischung auf: Rundg√§nge zur Stadtgeschichte stehen neben einer geballten Ladung an praktischen Informationen. Besonders gelungen ist es, wie die Autorin historische Details mit Spazierg√§ngen verzahnt. Sie rennt keinen Trends hinterher, sondern f√ºhrt als kenntnisreiche Begleiterin durch ihre Stadt. Ein praktischer Stadtkulturf√ºhrer f√ºr Einheimische und Besucher mit Hunderten von Tipps, Adressen, √ñffnungszeiten und Preisen von Parks und B√§dern √ºber sch√∂ne Lokale bis zu Museen, Theatern und Veranstaltungsorten..", correctAnswer: "18"},
              {id: "K", text: "Tour zu Schaupl√§tzen der ber√ºhmtesten Kriminalf√§lle Frankfurts Der Historiker und Stadtf√ºher Peter Glock begleitet Sie auf einer interessanten zweist√ºndigen Tour durch die Innenstadt zu Schaupl√§tzen der ber√ºhmtesten Kriminalf√§lle in der Geschichte Frankfurts. Sie erfahren alles √ºber spektakul√§re Verbrechen, wie z. B. den Mord an Rosemarie Nitribitt, die Hinrichtung von Vinzenz Fettmilch im Jahre 1616 oder die Ermordung des Klavierh√§ndlers Lichtenstein im Jahre 1904, als erstmals ein Mordfall durch die Abnahme von Fingerabdr√ºcken aufgekl√§rt wurde. Die F√ºhrung findet jeden Sonntag ab 14.00 Uhr statt. Treffpunkt: ", correctAnswer: "19"},
              {id: "L", text: "Statistisches Jahrbuch der Stadt Frankfurt An einem durchschnittlichen Tag in Frankfurt werden 19 Babya geboren, sieben Brautpaare heiraten, aber f√ºnf Ehepaare lassen sich scheiden. 136 Frankfurter ziehen im Stadtgebiet um, sechs neue Wohnungen werden fertiggestellt und acht Ausl√§nder eingeb√ºrgert. Im Statistischen Jahrbuch der Stadt Frankfurt werden alle wichtigen Zahlen zum Leben, Arbeiten und Wohnen in der Stadt erfasst. Das B√ºrgeramt, Zeil 3, gibt den Bericht allj√§hrlich heraus. Interessierte k√∂nnen das Statistische Jahrbuch im Internet herunterladen (www.frankfurt.de). Der Download ist kostenfrei.", correctAnswer: "20"}
            ],
            situations: [
              {id: "11", text: "Sie m√∂chten Ihren Eltern zur Silberhochzeit eine besondere Schiffsreise auf dem Meer schenken."},
              {id: "12", text: "Ihre Freundin m√∂chte mit ihrem Mann Silvester und Neujahr im Urlaub feiern, aber nicht schon wieder im Gebirge."},
              {id: "13", text: "Ein Bekannter m√∂chte im Winter ein besinnliches Wochenende in den Bergen verbringen, denn er mag es, durch die verschneite Natur zu laufen."},
              {id: "14", text: "Eine Bekannte aus dem Rhein-Main-Gebiet sucht Vorschl√§ge f√ºr Ein-Tages-Ausfl√ºge, denn sie √ºbernachtet nicht gern in fremden Betten."},
              {id: "15", text: "Sie wollen wie jedes Jahr in der zweiten Jahresh√§lfte eine zirka einw√∂chige organisierte Urlaubsreise in Europa machen und sich dabei viel mit dem Fahrrad fortbewegen."},
              {id: "16", text: "Sie m√∂chten einen netten Abend mit Freunden bei gutem Essen und au√üergew√∂hnlichem Unterhaltungsprogramm verleben."},
              {id: "17", text: "Sie suchen f√ºr eine prunkvolle Hochzeitsfeier geeignete festliche R√§umlichkeiten in einer stimmungsvollen kl√∂sterlichen Umgebung f√ºr zirka 50 Personen."},
              {id: "18", text: "Sie sind neu in Frankfurt a. M. und suchen deshalb nach n√ºtzlichen Informationen und praktischen Tipps, um sich schnell in der neuen Umgebung einzuleben."},
              {id: "19", text: "Sie interessieren sich f√ºr B√ºcher √ºber Architektur und Gartenarchitektur deutscher Klosteranlagen."},
              {id: "20", text: "Sie suchen gute Kriminalromane, deren Handlung im Rhein-Main-Gebiet und besonders in Frankfurt spielt."}
            ]
          },
          { 
            id:"s4", 
            title:"Sprachbausteine, Teil 1", 
            points:15,
            passageTitle:"Aufgabe: Erg√§nzen Sie den Text. W√§hlen Sie f√ºr jede L√ºcke das passende Wort.",
            passage: "",
            questions:[],
            fillBlanks: [
              {
                id: "21",
                options: ["an", "von", "zu"],
                correctAnswer: "zu"
              },
              {
                id: "22",
                options: ["ankommenden", "gekommenen", "kommenden"],
                correctAnswer: "kommenden"
              },
              {
                id: "23",
                options: ["aus", "mit", "nach"],
                correctAnswer: "nach"
              },
              {
                id: "24",
                options: ["bieten", "fordern", "nehmen"],
                correctAnswer: "bieten"
              },
              {
                id: "25",
                options: ["so dass", "weil", "wenn"],
                correctAnswer: "so dass"
              },
              {
                id: "26",
                options: ["Gemeinsam mit", "Verbunden von", "Zusammen neben"],
                correctAnswer: "Gemeinsam mit"
              },
              {
                id: "27",
                options: ["die Ansicht", "der Besuch", "das Betrachten"],
                correctAnswer: "der Besuch"
              },
              {
                id: "28",
                options: ["hat geplant", "is geplant", "wird geplant haben"],
                correctAnswer: "is geplant"
              },
              {
                id: "29",
                options: ["besprochen", "gesprochen", "versprochen"],
                correctAnswer: "besprochen"
              },
              {
                id: "30",
                options: ["haben", "hatten", "h√§tten"],
                correctAnswer: "haben"
              }
            ],
            fillText: `Sehr geehrter Herr Martini,

vielen Dank f√ºr Ihre Anfrage vom 16. Juni ________ der Studienreise Ihrer Schulklasse nach Frankfurt am Main im ________ Oktober.

Die Unterkunft bei deutschen Gastfamilien ist prinzipiell m√∂glich. Die Familien werden von uns sorgf√§ltig ________ strengen Kriterien ausgew√§hlt, die Sie in der beiliegenden Informationsbrosch√ºre auf den Seiten 15 bis 17 finden. Pro Gastfamilie k√∂nnen ein oder zwei Sch√ºlerinnen bzw. Sch√ºler untergebracht werden. Unsere Gastfamilien ________ Halbpension, d. h. in der Regel Fr√ºhst√ºck und Abendessen, an. Alle Familien wohnen im n√§heren Umkreis der Schule, ________ der Weg von der Unterkunft zum Unterricht innerhalb von maximal 10 Minuten zu Fu√ü zur√ºckgelegt werden kann.

Zweimal pro Woche ist die Teilnahme am Schulunterricht Ihrer Partnerschule in Frankfurt, der Heinrich-B√∂ll-Schule, in den F√§chern Geografie, Kunst und Deutsch vorgesehen. Die Unterrichtssprache ist Deutsch. ________ Sch√ºlerinnen und Sch√ºlern der Partnerschule wird das Freizeit- und Kulturprogramm durchgef√ºhrt.

Dazu geh√∂rt z. B. ________ der Gem√§ldegalerie "St√§del", des Museums f√ºr Kunsthandwerk und des Deutschen Postmuseums. Auch ein Besuch beim Hessischen Rundfunk ________ Jeweils dienstags und freitags werden Kulturabende veranstaltet, an denen die verschiedenen Aspekte und Unterschiede der deutschen und der italienischen Kultur ________ werden sollen. Weitere Informationen finden Sie in der beiliegende Brosch√ºre. Wir hoffen, dass Sie und Ihre Klasse einen erlebnisreichen und unvergesslichen Aufenthalt in Frankfurt ________ werden. Bei weiteren Fragen setzen Sie sich bitte mit uns in Verbindung.

Mit freundlichen Gr√º√üen

Sibylle Lauterbacher

Stiftung Sch√ºleraustausch Frankfurt`
          },
          { 
            id:"s5", 
            title:"Sprachbausteine, Teil 2", 
            points:15,
            passageTitle:"Aufgabe: Lesen Sie den Text und entscheiden Sie, welches Wort in welche L√ºcke passt. Sie k√∂nnen jedes Wort nur einmal verwenden. Nicht alle W√∂rter passen in den Text.",
            passage: "",
            questions:[],
            fillBlanks2: [
              {
                id: "31",
                options: ["AUF", "BEI", "DABEI", "DAF√úR", "DASS", "DENN", "DOCH", "JEDOCH", "MIT", "OBWOHL", "DAS", "SONDERN", "VON", "WEIL"],
                correctAnswer: "MIT"
              },
              {
                id: "32", 
                options: ["AUF", "BEI", "DABEI", "DAF√úR", "DASS", "DENN", "DOCH", "JEDOCH", "MIT", "OBWOHL", "DAS", "SONDERN", "VON", "WEIL"],
                correctAnswer: "BEI"
              },
              {
                id: "33",
                options: ["AUF", "BEI", "DABEI", "DAF√úR", "DASS", "DENN", "DOCH", "JEDOCH", "MIT", "OBWOHL", "DAS", "SONDERN", "VON", "WEIL"],
                correctAnswer: "DAS"
              },
              {
                id: "34",
                options: ["AUF", "BEI", "DABEI", "DAF√úR", "DASS", "DENN", "DOCH", "JEDOCH", "MIT", "OBWOHL", "DAS", "SONDERN", "VON", "WEIL"],
                correctAnswer: "DAF√úR"
              },
              {
                id: "35",
                options: ["AUF", "BEI", "DABEI", "DAF√úR", "DASS", "DENN", "DOCH", "JEDOCH", "MIT", "OBWOHL", "DAS", "SONDERN", "VON", "WEIL"],
                correctAnswer: "SONDERN"
              },
              {
                id: "36",
                options: ["AUF", "BEI", "DABEI", "DAF√úR", "DASS", "DENN", "DOCH", "JEDOCH", "MIT", "OBWOHL", "DAS", "SONDERN", "VON", "WEIL"],
                correctAnswer: "OBWOHL"
              },
              {
                id: "37",
                options: ["AUF", "BEI", "DABEI", "DAF√úR", "DASS", "DENN", "DOCH", "JEDOCH", "MIT", "OBWOHL", "DAS", "SONDERN", "VON", "WEIL"],
                correctAnswer: "WEIL"
              },
              {
                id: "38",
                options: ["AUF", "BEI", "DABEI", "DAF√úR", "DASS", "DENN", "DOCH", "JEDOCH", "MIT", "OBWOHL", "DAS", "SONDERN", "VON", "WEIL"],
                correctAnswer: "DASS"
              },
              {
                id: "39",
                options: ["AUF", "BEI", "DABEI", "DAF√úR", "DASS", "DENN", "DOCH", "JEDOCH", "MIT", "OBWOHL", "DAS", "SONDERN", "VON", "WEIL"],
                correctAnswer: "AUF"
              },
              {
                id: "40",
                options: ["AUF", "BEI", "DABEI", "DAF√úR", "DASS", "DENN", "DOCH", "JEDOCH", "MIT", "OBWOHL", "DAS", "SONDERN", "VON", "WEIL"],
                correctAnswer: "VON"
              }
            ],
            fillText2: `Deutschland- ein Paradies f√ºr Kinder?

17 Millionen Kinder leben in Deutschland. Verglichen ________ der Bev√∂lkerungszahl von ungef√§hr 80 Millionen ist das fast ein Viertel der Einwohner. Doch nur f√ºr jedes zehnte Kind unter drei Jahren steht ein Betreuungsplatz in einer Kindertagesst√§tte zur Verf√ºgung. Die Folge: Nur etwas mehr als die H√§lfte der M√ºtter dieser Kinder ist berufst√§tig - und nur ein Viertel kann ganzt√§gig zur Arbeit gehen.

Um dem entgegenzuwirken, gibt es in Deutschland die dreij√§hrige Elternzeit, die es einem Elternteil erm√∂glichen soll, drei Jahre ________ dem Kind zu Hause zu bleiben, ________ hat den Vorteil, dass der zu Hause bleibende Elternteil seinen Arbeitsplatz nicht verliert. Dennoch wird die Elternzeit f√ºr viele Eltern in finanzieller Hinsicht zu einem gravierenden Problem. Au√üerdem gilt die Elternzeit nur f√ºr Angestellte. M√ºtter zum Beispiel, die vor der Geburt ihres Kindes selbst√§ndig waren und mit dem Baby zu Hause bleiben wollen, stehen weit schlechter da. Kind und Karriere zu vereinbaren ist daher in Deutschland f√ºr die meisten M√ºtter so gut wie unm√∂glich. Dies scheinen die Hauptgr√ºnde ________ zu sein, warum in Deutschland zurzeit weltweit die wenigsten Kinder geboren werden.

Doch auch andere Dinge machen Familien mit Kindern in Deutschland das Leben schwer: In Restaurants zum Beispiel sind Kinder selten willkommen. Sie sitzen eben nicht still am Tisch, ________ st√∂ren mit ihrem Lachen und lauten Sprechen die anderen (kinderlosen) G√§ste. Bei den kinderlosen Erwachsenen werden andere Ma√üst√§be angelegt. ________ diese selbst h√§ufig lautstark telefonieren, st√∂rt das niemanden: Telefonate sind eben wichtiger als Kinder. In zahlreichen deutschen St√§dten wie Mainz strengen Anwohner Prozesse gegen Kinderg√§rten und Spielpl√§tze an, ________ die Kinder die Ruhe der benachbarten (kinderlosen) Hausbewohner st√∂ren. Die Folge: Spielpl√§tze werden von Gerichts wegen geschlossen. An Wiesen, auf denen fr√ºher Kinder tobten und Ball spielten, stehen nun Schilder: Betreten und spielen verboten. Bei Zuwiderhandlung drohen Geldstrafen.

Eltern, die mit der deutschen Bahn mit ihren Kindern verreisen m√∂chten, haben schlechte Karten. In den meisten Z√ºgen sind die G√§nge so angeordnet, ________ mit einem Kinderwagen kein Durchkommen ist. Und in den Mutter-Kind-Abteilen haben sich schon andere Reisende breitgemacht, die nicht einsehen, warum sie M√ºttern mit Kind Platz machen sollten. Schlie√ülich h√§tten sie ja eine Fahrkarte gekauft und damit Anspruch ________ einen Platz. In vielen Berichten in Zeitungen oder im Fernsehen, die sich mit Kindern, ihrer Erziehung oder mit dem Schulsystem befassen, spricht man in Deutschland gerne ________ "Problemen". Man meint damit die Kinder. Kann eine Gesellschaft, in der ein Kind als ein Problemfall angesehen wird, ein Paradies f√ºr Kinder sein?`
          }
        ]
      };

      /* ===== State & DOM refs ===== */
      let state = { 
        sectionIndex: 0, 
        questionIndex: 0, 
        answers: {}, 
        marked: {}, 
        remaining: exam.durationSec,
        showResults: false,
        timerStarted: false,
        timerInterval: null
      };
      const topTiles = document.getElementById('topTiles-lesen');
      const passageTitleEl = document.getElementById('passageTitle-lesen');
      const passageContentEl = document.getElementById('passageContent-lesen');
      const sectionNameEl = document.getElementById('sectionName-lesen');
      const questionTitleEl = document.getElementById('questionTitle-lesen');
      const questionBodyEl = document.getElementById('questionBody-lesen');
      const headingsBankContainer = document.getElementById('headingsBankContainer-lesen');
      const timerEl = document.getElementById('timer-lesen');
      const statusText = document.getElementById('statusText-lesen');
      const resultBtn = document.getElementById('resultBtn-lesen');
      const resetBtn = document.getElementById('resetBtn-lesen');
      const resetSectionBtn = document.getElementById('resetSectionBtn-lesen');

      /* ===== Timer Functions ===== */
      function startTimer(){
        if(state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        
        state.timerStarted = true;
        state.timerInterval = setInterval(()=>{
          if(state.remaining <= 0){
            clearInterval(state.timerInterval);
            timerEl.textContent = 'Zeit abgelaufen';
            return;
          }
          state.remaining--;
          updateTimerDisplay();
        }, 1000);
      }

      function resetTimer(){
        if(state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        state.remaining = exam.durationSec;
        state.timerStarted = false;
        updateTimerDisplay();
        startTimer();
      }

      function updateTimerDisplay(){
        const min = Math.floor(state.remaining / 60);
        const sec = state.remaining % 60;
        timerEl.textContent = `Verbleibende Zeit: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
      }

      /* ===== Reset Section Function ===== */
      function resetCurrentSection() {
        const currentSection = exam.sections[state.sectionIndex];
        
        if (confirm(`M√∂chten Sie wirklich den Teil "${currentSection.title}" zur√ºcksetzen? Alle Antworten in diesem Teil werden gel√∂scht.`)) {
          if (currentSection.id === 's1') {
            currentSection.texts.forEach(text => {
              delete state.answers[text.id];
            });
          } else if (currentSection.id === 's2') {
            currentSection.questions.forEach(question => {
              delete state.answers[question.id];
            });
          } else if (currentSection.id === 's3') {
            currentSection.situations.forEach(situation => {
              delete state.answers[situation.id];
            });
          } else if (currentSection.id === 's4') {
            currentSection.fillBlanks.forEach(blank => {
              delete state.answers[blank.id];
            });
          } else if (currentSection.id === 's5') {
            currentSection.fillBlanks2.forEach(blank => {
              delete state.answers[blank.id];
            });
          }
          
          renderAll();
        }
      }

      /* ===== Render ===== */
      function renderTopTiles(){ 
        topTiles.innerHTML=''; 
        exam.sections.forEach((sec,idx)=>{ 
          const div=document.createElement('div'); 
          div.className='tile'+(idx===state.sectionIndex?' active':'')+(isSectionDone(sec)?' done':''); 
          div.innerHTML=`<div>${sec.title}</div><div class="points">${sec.points} P</div>`; 
          div.onclick=()=>{state.sectionIndex=idx; state.questionIndex=0; state.showResults=false; renderAll();}; 
          topTiles.appendChild(div); 
        }); 
      }

      function isSectionDone(section){
        if(section.id==='s1') return section.texts.every(t=>state.answers[t.id]);
        if(section.id==='s2') return section.questions.every(q=>state.answers[q.id]);
        if(section.id==='s3') return section.situations.every(h=>state.answers[h.id] || state.answers[h.id] === 'X');
        if(section.id==='s4') return section.fillBlanks.every(b=>state.answers[b.id]);
        if(section.id==='s5') return section.fillBlanks2.every(b=>state.answers[b.id]);
        return false;
      }

      function renderAll(){
        renderTopTiles();
        const section = exam.sections[state.sectionIndex];
        sectionNameEl.textContent = section.title;
        passageTitleEl.textContent = section.passageTitle;
        
        resetSectionBtn.style.display = 'block';
        
        if(state.showResults){
          renderResults();
          return;
        }
        
        if(section.id === 's1'){
          renderPart1();
        } else if(section.id === 's2'){
          renderPart2();
        } else if(section.id === 's3'){
          renderPart3();
        } else if(section.id === 's4'){
          renderSprachbausteine1();
        } else if(section.id === 's5'){
          renderSprachbausteine2();
        }
      }

      function renderPart1(){
        const section = exam.sections[state.sectionIndex];
        
        let textsHTML = `<div class="instructions">Ziehen Sie die passenden √úberschriften auf die Texte. Sie k√∂nnen jede √úberschrift nur einmal verwenden.</div>`;
        
        section.texts.forEach((text, idx) => {
          const letter = String.fromCharCode(97 + idx);
          const selectedHeading = state.answers[text.id];
          
          textsHTML += `
            <div class="text-container">
              <div class="text-title">Text ${letter.toUpperCase()}</div>
              <div class="text-content">${text.content}</div>
              <div class="title-slot ${selectedHeading ? 'has-title' : ''}" data-text-id="${text.id}">
                ${selectedHeading ? getHeadingText(selectedHeading) : 'Ziehen Sie hier eine √úberschrift hin'}
              </div>
            </div>
          `;
        });
        
        passageContentEl.innerHTML = textsHTML;
        
        let headingsHTML = `<div class="headings-bank">`;
        section.headings.forEach(heading => {
          const isUsed = section.texts.some(text => state.answers[text.id] === heading.id);
          
          headingsHTML += `
            <div class="heading-item ${isUsed ? 'used' : ''}" draggable="${!isUsed}" data-heading-id="${heading.id}">
              ${heading.id}) ${heading.text}
            </div>
          `;
        });
        
        headingsHTML += `</div>`;
        
        headingsBankContainer.innerHTML = headingsHTML;
        
        setupDragAndDrop();
        
        questionBodyEl.innerHTML = '';
        questionTitleEl.textContent = '';
      }

      function setupDragAndDrop(){
        const headingItems = document.querySelectorAll('.heading-item:not(.used)');
        const titleSlots = document.querySelectorAll('.title-slot');
        
        headingItems.forEach(item => {
          item.addEventListener('dragstart', (e) => {
            e.dataTransfer.setData('text/plain', e.target.dataset.headingId);
          });
        });
        
        titleSlots.forEach(slot => {
          slot.addEventListener('dragover', (e) => {
            e.preventDefault();
            slot.style.background = '#e8f4ff';
          });
          
          slot.addEventListener('dragleave', (e) => {
            slot.style.background = slot.classList.contains('has-title') ? '#e8fbe9' : '#f8fbff';
          });
          
          slot.addEventListener('drop', (e) => {
            e.preventDefault();
            const headingId = e.dataTransfer.getData('text/plain');
            const textId = slot.dataset.textId;
            
            Object.keys(state.answers).forEach(key => {
              if(state.answers[key] === headingId) {
                delete state.answers[key];
              }
            });
            
            state.answers[textId] = headingId;
            renderAll();
          });
        });
      }

      function renderPart2(){
        const section = exam.sections[state.sectionIndex];
        
        passageContentEl.innerHTML = `<div class="passage">${section.passage}</div>`;
        
        let questionsHTML = `<div class="all-questions">`;
        
        section.questions.forEach((question, idx) => {
          const questionNumber = idx + 1;
          const userAnswer = state.answers[question.id];
          
          questionsHTML += `
            <div class="question-block">
              <div class="question-text">${questionNumber}. ${question.text}</div>
              <div class="options">
                ${question.options.map(opt => `
                  <div class="option ${userAnswer === opt.id ? 'selected' : ''}" 
                       onclick="window.lesenApp.selectOption('${question.id}', '${opt.id}')">
                    <div class="radio"></div>
                    <div>${opt.text}</div>
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        });
        
        questionsHTML += `</div>`;
        
        questionBodyEl.innerHTML = questionsHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';
      }

      function renderPart3(){
        const section = exam.sections[state.sectionIndex];
        
        let textsHTML = `
          <div class="instructions">Ziehen Sie die passenden Situationen auf die Texte. Sie k√∂nnen jede Situation nur einmal verwenden. Manchmal passt keine Situation.</div>
          <div class="texts-list">
            <h3>Texte (A-L)</h3>
        `;
        
        section.texts.forEach(text => {
          const userAnswer = Object.keys(state.answers).find(key => state.answers[key] === text.id);
          const selectedSituation = userAnswer ? section.situations.find(h => h.id === userAnswer) : null;
          
          textsHTML += `
            <div class="text-item" data-text-id="${text.id}">
              <div class="text-letter">${text.id})</div>
              <div class="text-content">${text.text}</div>
              <div class="title-slot ${userAnswer ? 'has-title' : ''} ${userAnswer === 'X' ? 'has-x' : ''}" data-text-id="${text.id}">
                ${selectedSituation ? selectedSituation.text : (userAnswer === 'X' ? 'X - Keine passende Situation' : 'Ziehen Sie hier eine Situation hin')}
              </div>
            </div>
          `;
        });
        
        textsHTML += `</div>`;
        
        passageContentEl.innerHTML = textsHTML;
        
        let situationsHTML = `
          <div class="situations-list">
            <h3>Situationen (11-20)</h3>
        `;
        
        section.situations.forEach((situation, idx) => {
          const situationNumber = parseInt(situation.id);
          const isUsed = state.answers[situation.id];
          const isX = state.answers[situation.id] === 'X';
          
          situationsHTML += `
            <div class="situation-item ${isUsed ? 'used' : ''}" draggable="${!isUsed}" data-situation-id="${situation.id}">
              <div class="situation-number">${situationNumber}.</div>
              <div class="situation-text">${situation.text}</div>
              ${!isUsed ? `<button class="exam-btn no-match ${isX ? 'selected' : ''}" onclick="window.lesenApp.markNoMatch('${situation.id}')">X - Kein passender Text</button>` : ''}
            </div>
          `;
        });
        
        situationsHTML += `</div>`;
        
        questionBodyEl.innerHTML = situationsHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';
        
        setupPart3DragAndDrop();
      }

      function markNoMatch(situationId) {
        Object.keys(state.answers).forEach(key => {
          if(state.answers[key] === situationId) {
            delete state.answers[key];
          }
        });
        
        state.answers[situationId] = 'X';
        try{ localStorage.setItem('lesenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        renderAll();
      }

      function setupPart3DragAndDrop(){
        const situationItems = document.querySelectorAll('.situation-item:not(.used)');
        const textSlots = document.querySelectorAll('.text-item .title-slot');
        
        situationItems.forEach(item => {
          item.addEventListener('dragstart', (e) => {
            e.dataTransfer.setData('text/plain', e.target.dataset.situationId);
          });
        });
        
        textSlots.forEach(slot => {
          slot.addEventListener('dragover', (e) => {
            e.preventDefault();
            slot.style.background = '#e8f4ff';
          });
          
          slot.addEventListener('dragleave', (e) => {
            const hasTitle = slot.classList.contains('has-title');
            const hasX = slot.classList.contains('has-x');
            slot.style.background = hasTitle ? '#e8fbe9' : (hasX ? '#f8d7da' : '#f8fbff');
          });
          
          slot.addEventListener('drop', (e) => {
            e.preventDefault();
            const situationId = e.dataTransfer.getData('text/plain');
            const textId = slot.dataset.textId;
            
            Object.keys(state.answers).forEach(key => {
              if(state.answers[key] === situationId) {
                delete state.answers[key];
              }
            });
            
            state.answers[situationId] = textId;
            renderAll();
          });
        });
      }

      function renderSprachbausteine1(){
        const section = exam.sections[state.sectionIndex];
        
        let textWithBlanks = section.fillText;
        
        const blankPlaceholders = [];
        section.fillBlanks.forEach(blank => {
          blankPlaceholders.push(`BLANK_${blank.id}`);
        });
        
        let tempText = textWithBlanks;
        blankPlaceholders.forEach((placeholder, index) => {
          tempText = tempText.replace('________', placeholder);
        });
        
        section.fillBlanks.forEach(blank => {
          const userAnswer = state.answers[blank.id];
          const displayText = userAnswer ? userAnswer : '________';
          tempText = tempText.replace(`BLANK_${blank.id}`, `<span class="blank-word ${userAnswer ? 'has-answer' : ''}" data-blank-id="${blank.id}">${displayText}</span>`);
        });
        
        passageContentEl.innerHTML = `
          <div class="instructions">Klicken Sie auf jede L√ºcke und w√§hlen Sie das passende Wort aus. Sie k√∂nnen die L√ºcken ŸÅŸä beliebiger Reihenfolge ausf√ºllen.</div>
          <div class="fill-blank-container">${tempText}</div>
        `;
        
        document.querySelectorAll('.blank-word').forEach(blank => {
          blank.addEventListener('click', (e) => {
            showOptionsPopup(e.target);
          });
        });
        
        let optionsHTML = `<div class="horizontal-options" style="gap: 8px;">`;
        
        section.fillBlanks.forEach(blank => {
          const userAnswer = state.answers[blank.id];
          
          optionsHTML += `
            <div class="option-row" style="padding: 8px; margin-bottom: 5px;">
              <div class="option-number">${blank.id}</div>
              <div class="option-buttons">
                ${blank.options.map(opt => `
                  <div class="option-btn ${userAnswer === opt ? 'selected' : ''}" 
                       onclick="window.lesenApp.selectSprachbausteine1('${blank.id}', '${opt}')" 
                       style="padding: 6px 12px; font-size: 12px;">
                    ${opt}
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        });
        
        optionsHTML += `</div>`;
        
        questionBodyEl.innerHTML = optionsHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';
      }

      function showOptionsPopup(blankElement){
        const existingPopup = document.querySelector('.options-popup');
        if(existingPopup) {
          existingPopup.remove();
        }
        
        const blankId = blankElement.getAttribute('data-blank-id');
        const section = exam.sections.find(s => s.id === 's4');
        const blank = section.fillBlanks.find(b => b.id === blankId);
        
        if(!blank) return;
        
        const popup = document.createElement('div');
        popup.className = 'options-popup';
        
        blank.options.forEach(opt => {
          const optionItem = document.createElement('div');
          optionItem.className = 'option-item';
          optionItem.textContent = opt;
          optionItem.onclick = () => {
            selectSprachbausteine1(blankId, opt);
            popup.remove();
          };
          popup.appendChild(optionItem);
        });
        
        blankElement.appendChild(popup);
      }

      function selectSprachbausteine1(blankId, answer){
        state.answers[blankId] = answer;
        renderAll();
      }

      function renderSprachbausteine2(){
        const section = exam.sections[state.sectionIndex];
        let textWithPlaceholders = section.fillText2;
        const placeholders = [];
        section.fillBlanks2.forEach(blank => {
          const ph = `BLANK_${blank.id}`;
          placeholders.push({id: blank.id, ph});
          textWithPlaceholders = textWithPlaceholders.replace('________', ph);
        });

        placeholders.forEach(item => {
          const userAnswer = state.answers[item.id];
          const displayText = userAnswer ? userAnswer : '________';
          const span = `<span class="blank-slot ${userAnswer ? 'has-answer' : ''}" data-blank-id="${item.id}">${displayText}</span>`;
          textWithPlaceholders = textWithPlaceholders.replace(item.ph, span);
        });

        passageContentEl.innerHTML = `
          <div class="instructions">Klicken Sie auf jede L√ºcke und w√§hlen Sie das passende Wort aus. Sie k√∂nnen jedes Wort nur einmal verwenden.</div>
          <div class="fill-blank-container">${textWithPlaceholders}</div>
        `;

        document.querySelectorAll('.blank-slot').forEach(slot => {
          slot.addEventListener('click', (e) => {
            showSprachbausteine2Options(slot);
          });
        });

        let wordBankHTML = `<div class="word-bank-vertical" style="gap: 8px;">`;
        const usedWords = Object.values(state.answers);
        const bank = section.fillBlanks2[0] ? section.fillBlanks2[0].options : [];
        bank.forEach(word => {
          const isUsed = usedWords.includes(word);
          wordBankHTML += `
            <div class="bank-word-vertical ${isUsed ? 'used' : ''}" 
                 draggable="${!isUsed}" 
                 data-word="${word}"
                 ${!isUsed ? `onclick="window.lesenApp.selectSprachbausteine2FromBank('${word}')"` : ''}>
              ${word}
            </div>
          `;
        });
        wordBankHTML += `</div>`;
        questionBodyEl.innerHTML = wordBankHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';

        setupSprachbausteine2DragAndDrop();
      }

      let lastClickedSprachSlot = null;

      function setupSprachbausteine2DragAndDrop(){
        const bankWords = Array.from(document.querySelectorAll('.bank-word-vertical'));
        bankWords.forEach(el => {
          const word = el.dataset.word;
          if(!el.classList.contains('used')){
            el.setAttribute('draggable','true');
          } else {
            el.setAttribute('draggable','false');
          }
          el.removeEventListener('dragstart', el._dstart);
          el._dstart = (e) => {
            e.dataTransfer.setData('text/plain', word);
            e.dataTransfer.setData('source', 'bank');
          };
          el.addEventListener('dragstart', el._dstart);

          el.removeEventListener('click', el._onclick);
          el._onclick = () => {
            if(el.classList.contains('used')) return;
            selectSprachbausteine2FromBank(word);
          };
          el.addEventListener('click', el._onclick);
        });

        const slots = Array.from(document.querySelectorAll('.blank-slot'));
        slots.forEach(slot => {
          slot.addEventListener('dragover', (e) => {
            e.preventDefault();
            slot.classList.add('drag-over');
          });
          slot.addEventListener('dragleave', (e) => {
            slot.classList.remove('drag-over');
          });
          slot.addEventListener('drop', (e) => {
            e.preventDefault();
            slot.classList.remove('drag-over');
            const word = e.dataTransfer.getData('text/plain') || e.dataTransfer.getData('text/html');
            if(!word) return;
            const blankId = slot.dataset.blankId;
            if(!blankId) return;
            Object.keys(state.answers).forEach(k => {
              if(state.answers[k] === word){
                delete state.answers[k];
              }
            });
            const prev = state.answers[blankId];
            if(prev){
              const prevEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === prev);
              if(prevEl){
                prevEl.classList.remove('used');
                prevEl.setAttribute('draggable','true');
                prevEl.addEventListener('click', prevEl._onclick);
              }
            }
            const bankEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === word);
            if(bankEl){
              bankEl.classList.add('used');
              bankEl.setAttribute('draggable','false');
              bankEl.removeEventListener('click', bankEl._onclick);
            }
            state.answers[blankId] = word;
            renderAll();
          });
        });
      }

      function showSprachbausteine2Options(slot){
        document.querySelectorAll('.blank-slot').forEach(s => s.classList.remove('selected-sprach'));
        slot.classList.add('selected-sprach');
        lastClickedSprachSlot = slot;
      }

      function selectSprachbausteine2FromBank(word){
        let slot = lastClickedSprachSlot;
        if(!slot){
          slot = Array.from(document.querySelectorAll('.blank-slot')).find(s => {
            const id = s.dataset.blankId;
            return !state.answers[id];
          });
        }
        if(!slot) {
          return;
        }
        const blankId = slot.dataset.blankId;
        Object.keys(state.answers).forEach(k => {
          if(state.answers[k] === word){
            delete state.answers[k];
          }
        });
        const prev = state.answers[blankId];
        if(prev){
          const prevEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === prev);
          if(prevEl){
            prevEl.classList.remove('used');
            prevEl.setAttribute('draggable','true');
            if(prevEl._onclick) prevEl.addEventListener('click', prevEl._onclick);
          }
        }
        const bankEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === word);
        if(bankEl){
          bankEl.classList.add('used');
          bankEl.setAttribute('draggable','false');
          if(bankEl._onclick) try{ bankEl.removeEventListener('click', bankEl._onclick); }catch(e){}
        }
        state.answers[blankId] = word;
        try{ localStorage.setItem('lesenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        lastClickedSprachSlot = null;
        renderAll();
      }

      function selectOption(questionId, optionId){
        state.answers[questionId] = optionId;
        try{ localStorage.setItem('lesenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        renderAll();
      }

      function renderResults(){
        let resultsHTML = `<h2>Ergebnisse</h2>`;
        let totalCorrect = 0;
        let totalQuestions = 0;
        
        exam.sections.forEach(section => {
          resultsHTML += `<div class="result-item"><h3>${section.title}</h3>`;
          
          if(section.id === 's1'){
            section.texts.forEach(text => {
              totalQuestions++;
              const userAnswer = state.answers[text.id];
              const isCorrect = userAnswer === text.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>Text ${text.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's2'){
            section.questions.forEach(question => {
              totalQuestions++;
              const userAnswer = state.answers[question.id];
              const isCorrect = userAnswer === question.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>${question.text}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's3'){
            section.situations.forEach(situation => {
              totalQuestions++;
              const userAnswer = state.answers[situation.id];
              const correctText = section.texts.find(t => t.correctAnswer === situation.id);
              const isCorrect = userAnswer === (correctText ? correctText.id : null);
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>Situation ${situation.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's4'){
            section.fillBlanks.forEach(blank => {
              totalQuestions++;
              const userAnswer = state.answers[blank.id];
              const isCorrect = userAnswer === blank.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>L√ºcke ${blank.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's5'){
            section.fillBlanks2.forEach(blank => {
              totalQuestions++;
              const userAnswer = state.answers[blank.id];
              const isCorrect = userAnswer === blank.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>L√ºcke ${blank.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          }
          
          resultsHTML += `</div>`;
        });
        
        const percentage = totalQuestions > 0 ? Math.round((totalCorrect / totalQuestions) * 100) : 0;
        resultsHTML += `<div class="result-item"><h3>Gesamtergebnis: ${totalCorrect}/${totalQuestions} (${percentage}%)</h3></div>`;
        
        passageContentEl.innerHTML = resultsHTML;
        questionBodyEl.innerHTML = '';
        sectionNameEl.textContent = 'Ergebnisse';
        questionTitleEl.textContent = '';
      }

      /* ===== Event Listeners ===== */
      document.getElementById('prevBtn-lesen').addEventListener('click', ()=>{
        if(state.sectionIndex > 0){
          state.sectionIndex--;
          state.questionIndex = 0;
          renderAll();
        }
      });

      document.getElementById('nextBtn-lesen').addEventListener('click', ()=>{
        if(state.sectionIndex < exam.sections.length - 1){
          state.sectionIndex++;
          state.questionIndex = 0;
          renderAll();
        }
      });

      resultBtn.addEventListener('click', ()=>{
        state.showResults = !state.showResults;
        renderAll();
      });

      resetBtn.addEventListener('click', ()=>{
        if(confirm('M√∂chten Sie wirklich von neu beginnen? Alle Antworten werden gel√∂scht.')){
          state.answers = {};
          state.marked = {};
          state.showResults = false;
          resetTimer();
          renderAll();
        }
      });

      resetSectionBtn.addEventListener('click', resetCurrentSection);

      document.getElementById('saveBtn-lesen').addEventListener('click', ()=>{
        statusText.textContent = 'Gespeichert';
        setTimeout(()=>{statusText.textContent = 'Nicht gespeichert'}, 2000);
      });

      document.getElementById('submitBtn-lesen').addEventListener('click', ()=>{
        if(confirm('M√∂chten Sie die Pr√ºfung wirklich abgeben?')){
          state.showResults = true;
          renderAll();
        }
      });

      document.getElementById('nextBtn-lesen').addEventListener('click', ()=>{
        showPage('hoeren-page');
      });

      /* ===== Initialize ===== */
      updateTimerDisplay();
      renderAll();
      startTimer();
      
      window._lesenState = state;
      window.lesenApp = {
        selectOption,
        markNoMatch,
        selectSprachbausteine1,
        selectSprachbausteine2FromBank
      };
    }

    // ===== H√ñREN PAGE FUNCTIONALITY =====
    function initHoerenPage() {
      /* ===== Self-contained exam (embedded) ===== */
      const exam = {
        id: "exam-h√∂rverstehen",
        durationSec: 17 * 60,
        sections: [
          { 
            id: "h√∂rverstehen1", 
            title: "H√∂rverstehen, Teil 1", 
            points: 25,
            questions: [
              {
                id: "41",
                text: "Ein deutsches Schiff ist am S√ºdpol eingetroffen, aber Menschen kamen nicht zu Schaden."
              },
              {
                id: "42", 
                text: "Die Firma Brain International ist in wirtschaftliche Schwierigkeiten geraten."
              },
              {
                id: "43",
                text: "Die Europ√§ische Union will Gesetze zur Kontrolle sozialer Netzwerke erlassen."
              },
              {
                id: "44",
                text: "Mit einem neuen Gesetz wollen die √∂sterreichischen Banken Sparkonten wieder attraktiver machen."
              },
              {
                id: "45",
                text: "Nach den B√ºrgermeisterwahlen in Bensberg bleibt die CDU weiterhin an der Regierung."
              }
            ]
          },
          { 
            id: "h√∂rverstehen2", 
            title: "H√∂rverstehen, Teil 2", 
            points: 25,
            questions: [
              {
                id: "46",
                text: "Julia hatte an einem Sch√ºleraustausch kein Interesse."
              },
              {
                id: "47",
                text: "Die Lehrer in Julias Schule weigerten sich, mit dem Austauschsch√ºler Englisch zu sprechen."
              },
              {
                id: "48", 
                text: "Frankreich ist als Aufenthaltsland bei Au-pairs nicht sehr gefragt."
              },
              {
                id: "49",
                text: "Julia hatte auch dar√ºber nachgedacht, in die Schweiz zu fahren."
              },
              {
                id: "50",
                text: "Julia empfiehlt, mit der Gastfamilie einen Vertrag zu schlie√üen."
              },
              {
                id: "51",
                text: "Zu Beginn der Au-pair-Bewegung schickten Familien ihre Kinder zum Sprachunterricht in die Schweiz."
              },
              {
                id: "52",
                text: "Julia ist der Meinung, dass die Vermittlungskosten zu hoch sind."
              },
              {
                id: "53",
                text: "Julia verbrachte mit den Kindern auch Zeit in Paris."
              },
              {
                id: "54",
                text: "Es gab am Anfang Momente, in denen sich Julia der Gastfamilie nicht zugeh√∂rig f√ºhlte."
              },
              {
                id: "55",
                text: "Julia lernt im Sprachkurs mehr Franz√∂sisch als durch den Kontakt mit der Gastfamilie."
              }
            ]
          },
          { 
            id: "h√∂rverstehen3", 
            title: "H√∂rverstehen, Teil 3", 
            points: 25,
            questions: [
              {
                id: "56",
                text: "Im S√ºden Deutschlands wird es nachmittags regnen."
              },
              {
                id: "57",
                text: "Die Busse verkehren zu anderen Zeiten als die Regionalz√ºge."
              },
              {
                id: "58",
                text: "Auf der A3 von W√ºrzburg nach Frankfurt gibt es aufgrund eines Unfalls eine Vollsperrung."
              },
              {
                id: "59",
                text: "Wenn Sie √ºber Ihre Autoversicherung sprechen wollen, m√ºssen Sie die 1 w√§hlen."
              },
              {
                id: "60",
                text: "Ihr Bekannter ist jederzeit telefonisch erreichbar."
              }
            ]
          }
        ]
      };

      let state = { 
        sectionIndex: 0, 
        answers: {}, 
        remaining: exam.durationSec,
        showResults: false,
        timerStarted: false,
        timerInterval: null
      };
      
      const topTiles = document.getElementById('topTiles-hoeren');
      const contentContainer = document.getElementById('contentContainer-hoeren');
      const timerEl = document.getElementById('timer-hoeren');
      const statusText = document.getElementById('statusText-hoeren');

      function startTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        
        state.timerStarted = true;
        state.timerInterval = setInterval(() => {
          if (state.remaining <= 0) {
            clearInterval(state.timerInterval);
            timerEl.textContent = 'Zeit abgelaufen';
            return;
          }
          state.remaining--;
          updateTimerDisplay();
        }, 1000);
      }

      function resetTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        state.remaining = exam.durationSec;
        state.timerStarted = false;
        updateTimerDisplay();
        startTimer();
      }

      function updateTimerDisplay() {
        const min = Math.floor(state.remaining / 60);
        const sec = state.remaining % 60;
        timerEl.textContent = `Verbleibende Zeit: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
      }

      function renderTopTiles() { 
        topTiles.innerHTML = ''; 
        exam.sections.forEach((sec, idx) => { 
          const div = document.createElement('div'); 
          div.className = 'tile' + (idx === state.sectionIndex ? ' active' : '') + (isSectionDone(sec) ? ' done' : ''); 
          div.innerHTML = `<div>${sec.title}</div><div class="points">${sec.points} P</div>`; 
          div.onclick = () => { state.sectionIndex = idx; state.showResults = false; renderAll(); }; 
          topTiles.appendChild(div); 
        }); 
      }

      function isSectionDone(section) {
        const answers = state.answers[section.id];
        if (!answers) return false;
        const answeredQuestions = Object.keys(answers).length;
        const totalQuestions = section.questions.length;
        return answeredQuestions === totalQuestions;
      }

      function renderAll() {
        renderTopTiles();
        
        if (state.showResults) {
          renderResults();
          return;
        }
        
        renderListeningSection();
      }

      function renderListeningSection() {
        const section = exam.sections[state.sectionIndex];
        const currentAnswers = state.answers[section.id] || {};
        
        let contentHTML = `
          <div class="panel-title">${section.title}</div>
          <div class="instructions">
            Sie h√∂ren die Nachrichten. Entscheiden Sie beim H√∂ren, ob die Aussagen richtig oder falsch sind. 
            Sie h√∂ren die Nachrichten nur einmal. Sie haben jetzt 30 Sekunden, um die Aussagen zu lesen.
          </div>
          
          <div class="listening-task">
            <table class="true-false-table">
              <thead>
                <tr>
                  <th style="width: 10%">Nr.</th>
                  <th style="width: 60%">Aussage</th>
                  <th style="width: 30%">Ihre Antwort</th>
                </tr>
              </thead>
              <tbody>
        `;
        
        section.questions.forEach((question, index) => {
          const currentAnswer = currentAnswers[question.id] || '';
          contentHTML += `
            <tr>
              <td><strong>${question.id}</strong></td>
              <td class="question-text">${question.text}</td>
              <td>
                <div class="answer-options">
                  <label class="answer-option">
                    <input 
                      type="radio" 
                      name="q${section.id}_${question.id}" 
                      value="richtig" 
                      ${currentAnswer === 'richtig' ? 'checked' : ''}
                      onchange="window.hoerenApp.updateListeningAnswer('${section.id}', '${question.id}', this.value)"
                    >
                    Richtig
                  </label>
                  <label class="answer-option">
                    <input 
                      type="radio" 
                      name="q${section.id}_${question.id}" 
                      value="falsch" 
                      ${currentAnswer === 'falsch' ? 'checked' : ''}
                      onchange="window.hoerenApp.updateListeningAnswer('${section.id}', '${question.id}', this.value)"
                    >
                    Falsch
                  </label>
                </div>
              </td>
            </tr>
          `;
        });
        
        contentHTML += `
              </tbody>
            </table>
          </div>
        `;
        
        contentContainer.innerHTML = contentHTML;
      }

      function updateListeningAnswer(sectionId, questionId, answer) {
        if (!state.answers[sectionId]) {
          state.answers[sectionId] = {};
        }
        state.answers[sectionId][questionId] = answer;
        try{ localStorage.setItem('hoerenAnswers', JSON.stringify(state.answers)); }catch(e){}
        renderTopTiles();
      }

      function renderResults() {
        let resultsHTML = `<div class="panel-title">Ergebnisse - H√∂rverstehen</div>`;
        
        exam.sections.forEach(section => {
          const userAnswers = state.answers[section.id] || {};
          let correctCount = 0;
          
          resultsHTML += `
            <div class="listening-task">
              <h3>${section.title} (${section.points} Punkte)</h3>
              <table class="true-false-table">
                <thead>
                  <tr>
                    <th style="width: 10%">Nr.</th>
                    <th style="width: 50%">Aussage</th>
                    <th style="width: 15%">Ihre Antwort</th>
                    <th style="width: 15%">Richtige Antwort</th>
                    <th style="width: 10%">Punkte</th>
                  </tr>
                </thead>
                <tbody>
          `;
          
          section.questions.forEach((question) => {
            const userAnswer = normalizeAnswer(userAnswers[question.id] || '');
            const correctAnswer = CORRECT_ANSWERS.hoeren[question.id];
            const gotCorrect = userAnswer === correctAnswer;
            const points = gotCorrect ? "1" : "0";
            
            if (gotCorrect) correctCount++;
            
            const rowClass = gotCorrect ? 'correct-answer' : 'incorrect-answer';
            
            resultsHTML += `
              <tr class="${rowClass}">
                <td><strong>${question.id}</strong></td>
                <td class="question-text">${question.text}</td>
                <td>${userAnswer}</td>
                <td>${correctAnswer}</td>
                <td><strong>${points}</strong></td>
              </tr>
            `;
          });
          
          const totalPoints = Math.round((correctCount / section.questions.length) * section.points);
          
          resultsHTML += `
                </tbody>
              </table>
              <div style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 6px;">
                <strong>Erreichte Punkte: ${correctCount}/${section.questions.length} richtig = ${totalPoints}/${section.points} Punkten</strong>
              </div>
            </div>
          `;
        });
        
        contentContainer.innerHTML = resultsHTML;
      }

      document.getElementById('prevBtn-hoeren').addEventListener('click', () => {
        if (state.sectionIndex > 0) {
          state.sectionIndex--;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('nextBtn-hoeren').addEventListener('click', () => {
        if (state.sectionIndex < exam.sections.length - 1) {
          state.sectionIndex++;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('resultBtn-hoeren').addEventListener('click', () => {
        state.showResults = !state.showResults;
        renderAll();
      });

      document.getElementById('resetBtn-hoeren').addEventListener('click', () => {
        if (confirm('M√∂chten Sie wirklich von neu beginnen? Alle Antworten werden gel√∂scht.')) {
          state.answers = {};
          state.showResults = false;
          resetTimer();
          renderAll();
        }
      });

      document.getElementById('saveBtn-hoeren').addEventListener('click', () => {
        statusText.textContent = 'Gespeichert';
        setTimeout(() => { statusText.textContent = 'Nicht gespeichert' }, 2000);
      });

      document.getElementById('submitBtn-hoeren').addEventListener('click', () => {
        if (confirm('M√∂chten Sie die Pr√ºfung wirklich abgeben?')) {
          state.showResults = true;
          renderAll();
        }
      });

      document.getElementById('nextBtn-hoeren').addEventListener('click', () => {
        showPage('schreiben-page');
      });

      updateTimerDisplay();
      renderAll();
      startTimer();
      
      window._hoerenState = state;
      window.hoerenApp = {
        updateListeningAnswer
      };
    }

    // ===== SCHREIBEN PAGE FUNCTIONALITY =====
    function initSchreibenPage() {
      const exam = {
        id: "exam-002",
        durationSec: 30 * 60,
        sections: [
          { 
            id: "s1", 
            title: "Schreiben, Teil 1", 
            points: 45,
            passageTitle: "Aufgabe: Schreiben Sie eine E-Mail",
            passage: "",
            writingTask: {
              prompt: `Nie mehr schlaflos in Deutschland!

G√∂nnen Sie sich ein neues Bett mit einer Komfort-Matratze und schlafen Sie wie auf Wolken!
Kommen Sie zum Probeliegen in unsere Showrooms in 20 deutschen Innenst√§dten 
oder bestellen Sie gleich online unter: www.baumeister-betten.de

Wir bieten Ihnen eine gro√üe Auswahl an Betten, Lattenrosten und Matratzen ‚Äì wegen R√§umung unserer Lager zu Sonderpreisen!

Bettgestelle: aus Holz oder Metall, Einzel- oder Doppelbetten von 110 Euro bis 2000 Euro
Matratzen: Taschenfederkern, Komfortschaum oder Kaltschaum ‚Äì je nach Gr√∂√üe 80/200 cm, 90/200 cm oder 100/200 cm 
f√ºr nur 69 Euro bis 489 Euro.

Beim Kauf einer Matratze entsorgen wir auf Wunsch Ihre alte gleich mit! 
Bei der kostenlosen Lieferung Ihrer Bestellung nimmt der Fahrer Ihre gebrauchten Teile im Tausch 1:1 gerne mit.
Die Kostenpauschale in H√∂he von 15 Euro pro St√ºck f√ºr Mitnahme und Entsorgung zahlen Sie bitte in bar bei unserem Fahrer.

Baumeister Service Hotline: 0800-222333444 
E-Mail: baumeister-betten@info.de`,
              requirements: [
                "Beschreiben Sie, warum Sie sich f√ºr Produkte dieser Firma entschieden haben.",
                "Erkl√§ren Sie, warum Sie mit der Warenqualit√§t unzufrieden sind.",
                "Beschreiben Sie Ihre Erfahrungen mit dem Service und der Service-Hotline.",
                "Machen Sie Vorschl√§ge, wie Baumeister-Betten kundenfreundlicher werden kann."
              ],
              wordCount: 0
            }
          }
        ]
      };

      let state = { 
        sectionIndex: 0, 
        answers: {}, 
        remaining: exam.durationSec,
        showResults: false,
        timerStarted: false,
        timerInterval: null
      };
      
      const topTiles = document.getElementById('topTiles-schreiben');
      const passageTitleEl = document.getElementById('passageTitle-schreiben');
      const passageContentEl = document.getElementById('passageContent-schreiben');
      const writingContainer = document.getElementById('writingContainer-schreiben');
      const timerEl = document.getElementById('timer-schreiben');
      const statusText = document.getElementById('statusText-schreiben');

      function startTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        
        state.timerStarted = true;
        state.timerInterval = setInterval(() => {
          if (state.remaining <= 0) {
            clearInterval(state.timerInterval);
            timerEl.textContent = 'Zeit abgelaufen';
            return;
          }
          state.remaining--;
          updateTimerDisplay();
        }, 1000);
      }

      function resetTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        state.remaining = exam.durationSec;
        state.timerStarted = false;
        updateTimerDisplay();
        startTimer();
      }

      function updateTimerDisplay() {
        const min = Math.floor(state.remaining / 60);
        const sec = state.remaining % 60;
        timerEl.textContent = `Verbleibende Zeit: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
      }

      function renderTopTiles() { 
        topTiles.innerHTML = ''; 
        exam.sections.forEach((sec, idx) => { 
          const div = document.createElement('div'); 
          div.className = 'tile' + (idx === state.sectionIndex ? ' active' : '') + (isSectionDone(sec) ? ' done' : ''); 
          div.innerHTML = `<div>${sec.title}</div><div class="points">${sec.points} P</div>`; 
          div.onclick = () => { state.sectionIndex = idx; state.showResults = false; renderAll(); }; 
          topTiles.appendChild(div); 
        }); 
      }

      function isSectionDone(section) {
        return state.answers[section.id] && state.answers[section.id].length > 0;
      }

      function renderAll() {
        renderTopTiles();
        const section = exam.sections[state.sectionIndex];
        passageTitleEl.textContent = section.passageTitle;
        
        if (state.showResults) {
          renderResults();
          return;
        }
        
        renderWritingSection();
      }

      function renderWritingSection() {
        const section = exam.sections[state.sectionIndex];
        
        passageContentEl.innerHTML = `
          <div class="writing-task">
            <div class="writing-prompt">${section.writingTask.prompt}</div>
            <div class="instructions" style="border:1px solid #e1e8f6; padding:10px; margin:10px 0; border-radius:6px; background:#ffffff;">Sie haben bei der Firma Baumeister-Betten eingekauft. 
Sie sind mit der Qualit√§t und dem Service unzufrieden. 
Schreiben Sie eine Beschwerde an die Firma.</div>
            <div class="writing-requirements">
              <h4>Schreiben Sie in Ihrer E-Mail:</h4>
              <ul>
                ${section.writingTask.requirements.map(req => `<li>${req}</li>`).join('')}
              </ul>
            </div>
            <div class="instructions">
              Schreiben Sie eine E-Mail (ca. 150-200 W√∂rter). Achten Sie auf den Textaufbau (Anrede, Einleitung, Hauptteil, Schluss) und eine angemessene Formulierung.
            </div>
          </div>
        `;
        
        const currentAnswer = state.answers[section.id] || '';
        const wordCount = countWords(currentAnswer);
        
        writingContainer.innerHTML = `
          <div class="writing-area">
            <textarea 
              class="writing-textarea" 
              placeholder="Schreiben Sie hier Ihre E-Mail..."
              oninput="window.schreibenApp.updateWritingAnswer('${section.id}', this.value)"
            >${currentAnswer}</textarea>
            <div class="word-counter">
              W√∂rter: <span class="count">${wordCount}</span>
            </div>
          </div>
        `;
      }

      function countWords(text) {
        return text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
      }

      function updateWritingAnswer(sectionId, text) {
        state.answers[sectionId] = text;
        try{ localStorage.setItem('schreibenAnswers', JSON.stringify({content: state.answers[sectionId], wordCount: (state.answers[sectionId]||'').trim().split(/\s+/).filter(Boolean).length})); }catch(e){}
        
        const wordCount = countWords(text);
        document.querySelector('.word-counter .count').textContent = wordCount;
      }

      function renderResults() {
        let resultsHTML = `<h2>Ergebnisse</h2>`;
        
        exam.sections.forEach(section => {
          resultsHTML += `<div class="writing-task"><h3>${section.title}</h3>`;
          
          const userAnswer = state.answers[section.id];
          const wordCount = countWords(userAnswer);
          
          resultsHTML += `
            <div class="writing-requirements">
              <h4>Ihre Antwort (${wordCount} W√∂rter):</h4>
              <div style="white-space: pre-wrap; background: white; padding: 15px; border-radius: 6px; border: 1px solid #e1e8f6; margin-top: 10px;">${userAnswer || 'Keine Antwort'}</div>
            </div>
          `;
          
          resultsHTML += `</div>`;
        });
        
        passageContentEl.innerHTML = resultsHTML;
        writingContainer.innerHTML = '';
      }

      document.getElementById('prevBtn-schreiben').addEventListener('click', () => {
        if (state.sectionIndex > 0) {
          state.sectionIndex--;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('nextBtn-schreiben').addEventListener('click', () => {
        if (state.sectionIndex < exam.sections.length - 1) {
          state.sectionIndex++;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('resultBtn-schreiben').addEventListener('click', () => {
        state.showResults = !state.showResults;
        renderAll();
      });

      document.getElementById('resetBtn-schreiben').addEventListener('click', () => {
        if (confirm('M√∂chten Sie wirklich von neu beginnen? Alle Antworten werden gel√∂scht.')) {
          state.answers = {};
          state.showResults = false;
          resetTimer();
          renderAll();
        }
      });

      document.getElementById('saveBtn-schreiben').addEventListener('click', () => {
        statusText.textContent = 'Gespeichert';
        setTimeout(() => { statusText.textContent = 'Nicht gespeichert' }, 2000);
      });

      document.getElementById('submitBtn-schreiben').addEventListener('click', () => {
        if (confirm('M√∂chten Sie die Pr√ºfung wirklich abgeben?')) {
          state.showResults = true;
          renderAll();
        }
      });

      document.getElementById('nextBtn-schreiben').addEventListener('click', () => {
        showPage('ergebnisse-page');
      });

      updateTimerDisplay();
      renderAll();
      startTimer();
      
      window._schreibenState = state;
      window.schreibenApp = {
        updateWritingAnswer
      };
    }

    // ===== ERGEBNISSE PAGE FUNCTIONALITY =====
    function initErgebnissePage() {
      const CONFIG = {
        totals: { 
          lesen: 105, 
          hoeren: 75, 
          schreiben: 45, 
          gesamt: 225 
        },
        counts: { 
          lesen: 40, 
          hoeren: 20 
        }
      };

      function readExamResults() {
        try {
          const lesen = {};
          const hoeren = {};
          const schreiben = { content: '', wordCount: 0 };

          try {
            if (window._lesenState && window._lesenState.answers) {
              Object.keys(window._lesenState.answers).forEach(k => {
                lesen[k] = window._lesenState.answers[k];
              });
            }
          } catch (e) {}

          try {
            if (window._hoerenState && window._hoerenState.answers) {
              Object.keys(window._hoerenState.answers).forEach(sectionId => {
                const sec = window._hoerenState.answers[sectionId] || {};
                Object.keys(sec).forEach(q => {
                  hoeren[q] = sec[q];
                });
              });
            }
          } catch (e) {}

          try {
            if (window._schreibenState && window._schreibenState.answers) {
              const answers = window._schreibenState.answers;
              if (answers['s1']) {
                schreiben.content = answers['s1'];
              } else {
                const keys = Object.keys(answers);
                if (keys.length > 0) schreiben.content = answers[keys[0]] || '';
              }
              schreiben.wordCount = (schreiben.content && schreiben.content.trim()) ? String(schreiben.content).trim().split(/\s+/).filter(Boolean).length : 0;
            }
          } catch (e) {}

          try {
            if (Object.keys(lesen).length === 0) {
              const storedL = localStorage.getItem('lesenAnswers');
              if (storedL) Object.assign(lesen, JSON.parse(storedL));
            }
          } catch (e) {}

          try {
            if (Object.keys(hoeren).length === 0) {
              const storedH = localStorage.getItem('hoerenAnswers');
              if (storedH) Object.assign(hoeren, JSON.parse(storedH));
            }
          } catch (e) {}

          try {
            if (!schreiben.content) {
              const storedS = localStorage.getItem('schreibenAnswers');
              if (storedS) {
                const obj = JSON.parse(storedS);
                schreiben.content = obj.content || '';
                schreiben.wordCount = obj.wordCount || (schreiben.content.trim() ? String(schreiben.content).trim().split(/\s+/).filter(Boolean).length : 0);
              }
            }
          } catch (e) {}

          return { hoeren, lesen, schreiben };
        } catch (e) {
          return { hoeren: {}, lesen: {}, schreiben: {} };
        }
      }

      function gradeHoeren(u) {
        const c = CORRECT_ANSWERS.hoeren;
        let okCount = 0;
        const d = [];
        
        for (let q = 41; q <= 60; q++) {
          const k = String(q);
          const uA = normalizeAnswer(u[k] || '');
          const exp = normalizeAnswer(c[k] || '');
          const ok = (uA !== '-' && uA.toLowerCase() === exp.toLowerCase());
          if (ok) okCount++;
          const ptsPer = CONFIG.totals.hoeren / CONFIG.counts.hoeren;
          d.push({
            frage: k,
            user: uA,
            correct: exp || '-',
            richtig: ok,
            punkte: ok ? ptsPer.toFixed(2) : '0'
          });
        }
        
        const total = Number((okCount * (CONFIG.totals.hoeren / CONFIG.counts.hoeren)).toFixed(2));
        return { okCount, total, details: d };
      }

      function gradeLesen(u) {
        const c = CORRECT_ANSWERS.lesen;
        let okCount = 0;
        const d = [];
        
        Object.keys(c).forEach(k => {
          const exp = normalizeAnswer(c[k]);
          const uA = normalizeAnswer(u[k] || '');
          const ok = (uA !== '-' && uA.toLowerCase() === exp.toLowerCase());
          if (ok) okCount++;
          const ptsPer = CONFIG.totals.lesen / CONFIG.counts.lesen;
          d.push({
            frage: k,
            user: uA,
            correct: exp || '-',
            richtig: ok,
            punkte: ok ? ptsPer.toFixed(2) : '0'
          });
        });
        
        const total = Number((okCount * (CONFIG.totals.lesen / CONFIG.counts.lesen)).toFixed(2));
        return { okCount, total, details: d };
      }

      function renderLesenDetails(answers) {
        const c = CORRECT_ANSWERS.lesen;
        let html = `<div class="result-item">
                      <h3>üìñ Leseverstehen - Detaillierte Auswertung</h3>`;
        
        html += `<h4>Teil 1: √úberschriften zuordnen</h4>
                 <table class="true-false-table">
                   <thead>
                     <tr>
                       <th style="width: 10%">Text</th>
                       <th style="width: 40%">Ihre Antwort</th>
                       <th style="width: 40%">Richtige Antwort</th>
                       <th style="width: 10%">Ergebnis</th>
                     </tr>
                   </thead>
                   <tbody>`;
        
        for (let i = 1; i <= 5; i++) {
          const k = String(i);
          const uA = answers[k] || '-';
          const exp = c[k] || '-';
          const expText = getHeadingText(exp);
          const ok = uA === exp;
          const rowClass = ok ? 'correct-answer' : 'incorrect-answer';
          const resultIcon = ok ? '‚úÖ' : '‚ùå';
          
          html += `<tr class="${rowClass}">
                     <td><strong>Text ${k}</strong></td>
                     <td>${getHeadingText(uA)}</td>
                     <td>${expText}</td>
                     <td><strong>${resultIcon}</strong></td>
                   </tr>`;
        }
        
        html += `</tbody></table>`;
        
        html += `<h4 style="margin-top: 20px;">Teil 2: Fragen zum Text</h4>
                 <table class="true-false-table">
                   <thead>
                     <tr>
                       <th style="width: 10%">Frage</th>
                       <th style="width: 40%">Ihre Antwort</th>
                       <th style="width: 40%">Richtige Antwort</th>
                       <th style="width: 10%">Ergebnis</th>
                     </tr>
                   </thead>
                   <tbody>`;
        
        for (let i = 1; i <= 5; i++) {
          const k = `s2q${i}`;
          const uA = answers[k] || '-';
          const exp = c[k] || '-';
          const ok = uA === exp;
          const rowClass = ok ? 'correct-answer' : 'incorrect-answer';
          const resultIcon = ok ? '‚úÖ' : '‚ùå';
          
          html += `<tr class="${rowClass}">
                     <td><strong>${i}</strong></td>
                     <td>${getOptionText(k, uA)}</td>
                     <td>${getOptionText(k, exp)}</td>
                     <td><strong>${resultIcon}</strong></td>
                   </tr>`;
        }
        
        html += `</tbody></table>`;
        
        html += `<h4 style="margin-top: 20px;">Teil 3: Texte zuordnen</h4>
                 <table class="true-false-table">
                   <thead>
                     <tr>
                       <th style="width: 10%">Situation</th>
                       <th style="width: 40%">Ihre Antwort</th>
                       <th style="width: 40%">Richtige Antwort</th>
                       <th style="width: 10%">Ergebnis</th>
                     </tr>
                   </thead>
                   <tbody>`;
        
        for (let i = 11; i <= 20; i++) {
          const k = String(i);
          const uA = answers[k] || '-';
          const exp = c[k] || '-';
          const ok = uA === exp;
          const rowClass = ok ? 'correct-answer' : 'incorrect-answer';
          const resultIcon = ok ? '‚úÖ' : '‚ùå';
          
          html += `<tr class="${rowClass}">
                     <td><strong>${k}</strong></td>
                     <td>${uA === 'X' ? 'X - Kein passender Text' : uA}</td>
                     <td>${exp === null ? 'X - Kein passender Text' : exp}</td>
                     <td><strong>${resultIcon}</strong></td>
                   </tr>`;
        }
        
        html += `</tbody></table>`;
        
        html += `<h4 style="margin-top: 20px;">Sprachbausteine Teil 1</h4>
                 <table class="true-false-table">
                   <thead>
                     <tr>
                       <th style="width: 10%">L√ºcke</th>
                       <th style="width: 40%">Ihre Antwort</th>
                       <th style="width: 40%">Richtige Antwort</th>
                       <th style="width: 10%">Ergebnis</th>
                     </tr>
                   </thead>
                   <tbody>`;
        
        for (let i = 21; i <= 30; i++) {
          const k = String(i);
          const uA = answers[k] || '-';
          const exp = c[k] || '-';
          const ok = uA === exp;
          const rowClass = ok ? 'correct-answer' : 'incorrect-answer';
          const resultIcon = ok ? '‚úÖ' : '‚ùå';
          
          html += `<tr class="${rowClass}">
                     <td><strong>${k}</strong></td>
                     <td>${uA}</td>
                     <td>${exp}</td>
                     <td><strong>${resultIcon}</strong></td>
                   </tr>`;
        }
        
        html += `</tbody></table>`;
        
        html += `<h4 style="margin-top: 20px;">Sprachbausteine Teil 2</h4>
                 <table class="true-false-table">
                   <thead>
                     <tr>
                       <th style="width: 10%">L√ºcke</th>
                       <th style="width: 40%">Ihre Antwort</th>
                       <th style="width: 40%">Richtige Antwort</th>
                       <th style="width: 10%">Ergebnis</th>
                     </tr>
                   </thead>
                   <tbody>`;
        
        for (let i = 31; i <= 40; i++) {
          const k = String(i);
          const uA = answers[k] || '-';
          const exp = c[k] || '-';
          const ok = uA === exp;
          const rowClass = ok ? 'correct-answer' : 'incorrect-answer';
          const resultIcon = ok ? '‚úÖ' : '‚ùå';
          
          html += `<tr class="${rowClass}">
                     <td><strong>${k}</strong></td>
                     <td>${uA}</td>
                     <td>${exp}</td>
                     <td><strong>${resultIcon}</strong></td>
                   </tr>`;
        }
        
        html += `</tbody></table></div>`;
        
        return html;
      }

      function buildHoerenDetails(answers) {
        const c = CORRECT_ANSWERS.hoeren;
        let html = `<table class="true-false-table">
                      <thead>
                        <tr>
                          <th>Frage</th>
                          <th>Ihre Antwort</th>
                          <th>Richtige Antwort</th>
                          <th>Ergebnis</th>
                        </tr>
                      </thead>
                      <tbody>`;
        
        for (let i = 41; i <= 60; i++) {
          const id = i.toString();
          const userAnswer = normalizeAnswer(answers[id] || '');
          const correctAnswer = c[id];
          const isCorrect = userAnswer === correctAnswer;
          const rowClass = isCorrect ? 'correct-answer' : 'incorrect-answer';
          const resultIcon = isCorrect ? '‚úÖ' : '‚ùå';
          
          html += `<tr class="${rowClass}">
                    <td><strong>${id}</strong></td>
                    <td>${userAnswer}</td>
                    <td>${correctAnswer}</td>
                    <td><strong>${resultIcon}</strong></td>
                  </tr>`;
        }
        
        html += `</tbody></table>`;
        return html;
      }

      function renderResults() {
        const st = readExamResults() || { hoeren: {}, lesen: {}, schreiben: {} };
        const h = gradeHoeren(st.hoeren || {});
        const l = gradeLesen(st.lesen || {});
        const details = document.getElementById('details-ergebnisse');
        const tiles = document.getElementById('topTiles-ergebnisse');
        const sScoreRaw = localStorage.getItem('schreibenScore');
        const sScore = sScoreRaw ? Number(sScoreRaw) : 0;

        details.innerHTML = '';
        tiles.innerHTML = '';

        const tL = `<div class="results-tile">
                    <h3>Lesen</h3>
                    <div class="score">${l.total.toFixed(2)} / ${CONFIG.totals.lesen} Punkte</div>
                    <div class="small-muted">(${(l.total / CONFIG.totals.lesen * 100).toFixed(2)} %)</div>
                  </div>`;
                  
        const tH = `<div class="results-tile">
                    <h3>H√∂ren</h3>
                    <div class="score">${h.total.toFixed(2)} / ${CONFIG.totals.hoeren} Punkte</div>
                    <div class="small-muted">(${(h.total / CONFIG.totals.hoeren * 100).toFixed(2)} %)</div>
                  </div>`;
                  
        const tS = `<div class="results-tile">
                    <h3>Schreiben</h3>
                    <div class="score" id="schreibenScoreDisplay">${sScore.toFixed(2)} / ${CONFIG.totals.schreiben} Punkte</div>
                    <div class="small-muted">Manuelle Eingabe</div>
                  </div>`;
                  
        tiles.innerHTML = tL + tH + tS;

        details.innerHTML += `<div class="result-item">
                                <h2>üìä Detaillierte Ergebnisse</h2>
                                <div class="instructions">Hier sehen Sie Ihre Antworten im Vergleich zu den richtigen L√∂sungen.</div>
                              </div>`;
        
        details.innerHTML += buildTable('H√∂ren ‚Äî Detail', h.details, h.total, CONFIG.totals.hoeren);
        details.innerHTML += renderLesenDetails(st.lesen || {});

        details.innerHTML += `<div class="result-item">
                                <h3>üëÇ H√∂rverstehen - Detaillierte Auswertung</h3>
                                ${buildHoerenDetails(st.hoeren || {})}
                              </div>`;

        let sHtml = '<div class="result-item"><h3>‚úçÔ∏è Schreiben - Ihre Antwort</h3>';
        const txt = st.schreiben.content ? escapeHtml(st.schreiben.content) : '<span class="small-muted">Kein Text gefunden.</span>';
        const wc = st.schreiben.wordCount || '-';
        
        sHtml += `<div class="small-muted">W√∂rter: ${wc}</div>
                <div style="margin-top:10px;padding:12px;background:#fff;border-radius:8px;border:1px solid #eef6ff;min-height:80px; white-space: pre-wrap;">${txt}</div>
                <div style="margin-top:10px;display:flex;gap:10px;align-items:center">
                  Punkte (0‚Äì45): 
                  <input id="sInput" type="number" min="0" max="45" step="0.5" value="${sScore}"> 
                  <button id="saveS" class="results-btn">Speichern</button>
                </div></div>`;
                
        details.innerHTML += sHtml;

        const total = (l.total + h.total + sScore).toFixed(2);
        const percent = ((total / CONFIG.totals.gesamt) * 100).toFixed(2);
        
        document.getElementById('finalSummary-ergebnisse').innerHTML = `
          <div class="left">
            Gesamtpunktzahl: <strong>${total}</strong> / ${CONFIG.totals.gesamt} Punkte<br>
            <span class="small-muted">Lesen + H√∂ren + Schreiben</span>
          </div>
          <div class="right">
            Prozentsatz: <strong>${percent} %</strong>
          </div>`;

        document.getElementById('saveS').onclick = () => {
          const v = Number(document.getElementById('sInput').value) || 0;
          localStorage.setItem('schreibenScore', v);
          document.getElementById('schreibenScoreDisplay').textContent = `${v.toFixed(2)} / ${CONFIG.totals.schreiben} Punkte`;
          
          const newTotal = (l.total + h.total + v).toFixed(2);
          const newPercent = ((newTotal / CONFIG.totals.gesamt) * 100).toFixed(2);
          
          document.getElementById('finalSummary-ergebnisse').innerHTML = `
            <div class="left">
              Gesamtpunktzahl: <strong>${newTotal}</strong> / ${CONFIG.totals.gesamt} Punkte<br>
              <span class="small-muted">Lesen + H√∂ren + Schreiben</span>
            </div>
            <div class="right">
              Prozentsatz: <strong>${newPercent} %</strong>
            </div>`;
        };
      }

      document.getElementById('calcBtn-ergebnisse').onclick = () => renderResults();
      document.getElementById('backBtn-ergebnisse').onclick = (e) => {
        e.preventDefault();
        showPage('start-page');
      };
      
      renderResults();
    }
  </script>
</body>
</html>