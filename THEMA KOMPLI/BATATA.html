<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Deutsch B2 Pr√ºfung - Komplett</title>
  <style>
    /* ===== GLOBAL STYLES ===== */
    :root {
      --primary-color: #1e3a5f;
      --secondary-color: #2c5282;
      --accent-color: #4da6ff;
      --light-color: #ebf8ff;
      --text-color: #2d3748;
      --white: #ffffff;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      --transition: all 0.3s ease;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      color: var(--white);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    button {
      cursor: pointer;
    }
    
    /* ===== START PAGE STYLES ===== */
    .start-container {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      padding: 20px;
      min-height: 100vh;
    }
    
    .start-content {
      max-width: 600px;
      width: 100%;
      background-color: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 40px;
      box-shadow: var(--shadow);
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .logo {
      margin-bottom: 20px;
    }
    
    .logo-icon {
      font-size: 48px;
      margin-bottom: 10px;
    }
    
    h1 {
      font-size: 32px;
      margin-bottom: 10px;
      font-weight: 700;
    }
    
    .subtitle {
      font-size: 18px;
      margin-bottom: 30px;
      opacity: 0.9;
    }
    
    .card {
      background-color: var(--white);
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: var(--shadow);
      color: var(--text-color);
    }
    
    .card h2 {
      font-size: 20px;
      margin-bottom: 15px;
      color: var(--primary-color);
    }
    
    .card p {
      margin-bottom: 20px;
      line-height: 1.5;
    }
    
    select {
      width: 100%;
      padding: 12px 16px;
      font-size: 16px;
      border-radius: 8px;
      border: 2px solid var(--accent-color);
      outline: none;
      background-color: var(--white);
      color: var(--text-color);
      cursor: pointer;
      transition: var(--transition);
    }
    
    select:focus {
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.3);
    }
    
    .timer-container {
      margin: 25px 0;
    }
    
    .timer-label {
      font-size: 16px;
      margin-bottom: 10px;
    }
    
    .timer {
      font-size: 48px;
      font-weight: 700;
      color: var(--accent-color);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }
    
    .progress-bar {
      height: 8px;
      width: 100%;
      background-color: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
      overflow: hidden;
      margin-top: 10px;
    }
    
    .progress {
      height: 100%;
      width: 100%;
      background-color: var(--accent-color);
      border-radius: 4px;
      transform: scaleX(1);
      transform-origin: left;
      transition: transform 1s linear;
    }
    
    .info-text {
      font-size: 14px;
      margin-top: 20px;
      opacity: 0.8;
    }
    
    .button-container {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }
    
    .btn {
      flex: 1;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      background-color: var(--accent-color);
      color: white;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }
    
    .btn:hover {
      background-color: #3399ff;
    }
    
    /* ===== EXAM PAGE STYLES ===== */
    .exam-body {
      background: #f5f5f5;
      color: #333;
      line-height: 1.45;
      -webkit-font-smoothing: antialiased;
    }
    
    /* Header Styles */
    header.topbar {
      background: #1e3a5f;
      color: #fff;
      padding: 12px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      min-height: 80px;
    }

    .brand {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .brand .logo {
      width: 80px;
      height: 40px;
      background: #e74c3c;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: white;
      font-size: 18px;
    }

    .meta .main-title {
      font-weight: 800;
      font-size: 18px;
    }

    .meta .sub-title {
      font-size: 13px;
      opacity: 0.9;
    }

    .timer {
      font-weight: 700;
      font-size: 18px;
      color: #fff;
      margin: 0 20px;
    }

    .buttons-grid {
      display: grid;
      grid-template-columns: repeat(2, auto);
      gap: 10px 20px;
    }

    .exam-btn {
      padding: 12px 20px;
      border-radius: 6px;
      border: none;
      background: #4da6ff;
      color: white;
      font-weight: 700;
      font-size: 15px;
      cursor: pointer;
      transition: background 0.2s ease-in-out;
      min-width: 150px;
      text-align: center;
    }

    .exam-btn:hover {
      background: #336fbf;
    }
    
    .exam-btn.save {
      background: #4da6ff;
      color: #000;
    }
    
    .exam-btn.save:hover {
      background: #3399ff;
    }
    
    .exam-btn.submit {
      background: #4da6ff;
    }
    
    .exam-btn.submit:hover {
      background: #3399ff;
    }
    
    .exam-btn.result {
      background: #4da6ff;
    }
    
    .exam-btn.result:hover {
      background: #3399ff;
    }
    
    .exam-btn.next {
      background: #4da6ff;
      color: #fff;
    }
    
    .exam-btn.next:hover {
      background: #3399ff;
    }
    
    .exam-btn.reset {
      background: #4da6ff;
    }
    
    .exam-btn.reset:hover {
      background: #3399ff;
    }
    
    .exam-btn.reset-section {
      background: #d35400;
      font-size: 12px;
      padding: 6px 10px;
      min-width: auto;
    }
    
    .exam-btn.reset-section:hover {
      background: #e67e22;
    }
    
    .exam-btn.no-match {
      background: #95a5a6;
      font-size: 12px;
      padding: 6px 10px;
      min-width: auto;
      margin-top: 5px;
    }
    
    .exam-btn.no-match:hover {
      background: #7f8c8d;
    }
    
    .exam-btn.no-match.selected {
      background: #e74c3c;
    }
    
    /* Top Tiles */
    .top-tiles {
      display: flex;
      justify-content: center;
      gap: 8px;
      padding: 8px 12px;
      background: #1e3a5f;
      border-bottom: 1px solid #0f223a;
    }
    
    .tile {
      flex: 1;
      max-width: 180px;
      text-align: center;
      padding: 12px;
      border-radius: 6px;
      border: 1px solid #ccc;
      background: #3b4a63;
      color: #fff;
      font-weight: 600;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 60px;
    }
    
    .tile:hover {
      background: #4a5b78;
    }
    
    .tile.active {
      background: #ffffff;
      color: #000;
      border-color: #bbb;
    }
    
    .tile.done {
      background: #2ecc71;
      color: #fff;
      border-color: #27ae60;
    }
    
    .tile.done::after {
      content: " ‚úÖ";
      margin-left: 5px;
    }
    
    .tile .points {
      background: rgba(255,255,255,0.2);
      padding: 4px 8px;
      border-radius: 12px;
      font-weight: 700;
      font-size: 11px;
      margin-top: 4px;
    }
    
    .tile.active .points {
      background: #e9eefc;
      color: #2c3e50;
    }
    
    /* Container Styles */
    .container {
      display: grid;
      grid-template-columns: 1fr 420px;
      gap: 16px;
      padding: 16px;
      max-width: 1200px;
      margin: 12px auto;
    }
    
    .container-full {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      padding: 16px;
      max-width: 1200px;
      margin: 12px auto;
    }
    
    .container-split {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      padding: 16px;
      max-width: 1200px;
      margin: 12px auto;
    }
    
    .left-panel {
      background: white;
      border-radius: 8px;
      padding: 18px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      max-height: 76vh;
      overflow: auto;
    }
    
    .left-panel .passage {
      font-size: 14px;
      color: #2c3e50;
      line-height: 1.8;
    }
    
    .left-panel h2 {
      font-size: 16px;
      margin-bottom: 10px;
    }
    
    .right-panel {
      background: white;
      border-radius: 8px;
      padding: 12px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      display: flex;
      flex-direction: column;
      gap: 12px;
      max-height: 76vh;
      overflow: auto;
    }
    
    .main-panel {
      background: white;
      border-radius: 8px;
      padding: 25px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      max-height: 76vh;
      overflow: auto;
    }
    
    .panel-title {
      font-size: 18px;
      margin-bottom: 15px;
      color: #1e3a5f;
      font-weight: 700;
    }
    
    /* Question Styles */
    .question-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }
    
    .question-body {
      margin-top: 8px;
    }
    
    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .option {
      background: #fbfdff;
      border: 1px solid #e1e8f6;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .option:hover {
      background: #f0f6ff;
    }
    
    .option.selected {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .option .radio {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      border: 2px solid #cfdff6;
      background: #fff;
      display: inline-block;
      flex-shrink: 0;
    }
    
    .option.selected .radio {
      background: #3498db;
      border-color: #3498db;
      box-shadow: inset 0 -3px 0 rgba(0,0,0,0.05);
    }
    
    .text-container {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
      position: relative;
      min-height: 120px;
    }
    
    .text-container:hover {
      background: #f0f6ff;
    }
    
    .text-title {
      font-weight: 700;
      margin-bottom: 8px;
      color: #2c3e50;
    }
    
    .text-content {
      font-size: 14px;
      color: #2c3e50;
      line-height: 1.6;
    }
    
    .title-slot {
      min-height: 40px;
      margin-top: 10px;
      padding: 8px;
      border: 2px dashed #c8d9f6;
      border-radius: 6px;
      background: #f8fbff;
    }
    
    .title-slot.has-title {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .title-slot.has-x {
      background: #f8d7da;
      border-color: #e74c3c;
      color: #c0392b;
      font-weight: bold;
    }
    
    .headings-bank {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 0;
    }
    
    .heading-item {
      padding: 10px;
      border: 1px solid #dbe7fb;
      border-radius: 8px;
      background: #f8fbff;
      cursor: grab;
    }
    
    .heading-item:hover {
      background: #e9f0ff;
    }
    
    .heading-item.used {
      opacity: 0.5;
      cursor: not-allowed;
      background: #f8d7da;
      border-color: #f5c6cb;
    }
    
    .result-correct {
      color: #27ae60;
      font-weight: bold;
    }
    
    .result-incorrect {
      color: #c0392b;
      font-weight: bold;
    }
    
    .result-item {
      margin: 10px 0;
      padding: 10px;
      border-radius: 6px;
      background: #f8f9fa;
    }
    
    .instructions {
      color: #7f8c8d;
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 15px;
    }
    
    .question-text {
      font-weight: 600;
      margin-bottom: 15px;
      font-size: 15px;
      color: #2c3e50;
    }
    
    .all-questions {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    
    .question-block {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .texts-list, .situations-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .text-item, .situation-item {
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .text-letter {
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 8px;
    }
    
    .situation-number {
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 8px;
    }
    
    .fill-blank-container {
      margin: 20px 0;
    }
    
    .blank-word {
      display: inline-block;
      min-width: 120px;
      padding: 4px 8px;
      margin: 0 6px;
      background: #fff;
      cursor: pointer;
      position: relative;
      border: 1px solid #dbe7fb;
      border-radius: 4px;
    }
    
    .blank-word.has-answer {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .options-popup {
      position: absolute;
      top: 100%;
      left: 0;
      background: white;
      border: 1px solid #dbe7fb;
      border-radius: 6px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      z-index: 100;
      min-width: 150px;
    }
    
    .option-item {
      padding: 8px 12px;
      cursor: pointer;
      border-bottom: 1px solid #f0f4fb;
    }
    
    .option-item:hover {
      background: #f0f6ff;
    }
    
    .option-item:last-child {
      border-bottom: none;
    }
    
    .horizontal-options {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .option-row {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 10px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .option-number {
      font-weight: bold;
      color: #2c3e50;
      min-width: 30px;
    }
    
    .option-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .option-btn {
      padding: 8px 16px;
      border: 1px solid #dbe7fb;
      border-radius: 6px;
      background: #f8fbff;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .option-btn:hover {
      background: #e9f0ff;
    }
    
    .option-btn.selected {
      background: #3498db;
      color: white;
      border-color: #3498db;
    }
    
    .word-bank-vertical {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .bank-word-vertical {
      padding: 10px;
      border: 1px solid #dbe7fb;
      border-radius: 6px;
      background: #f8fbff;
      text-align: center;
      cursor: grab;
    }
    
    .bank-word-vertical.used {
      opacity: 0.5;
      cursor: not-allowed;
      background: #f8d7da;
      border-color: #f5c6cb;
    }
    
    .blank-slot {
      display: inline-block;
      min-width: 100px;
      padding: 4px 8px;
      margin: 0 6px;
      background: #fff;
      min-height: 30px;
      vertical-align: middle;
      border: 1px solid #dbe7fb;
      border-radius: 4px;
      cursor: pointer;
    }
    
    .blank-slot.has-answer {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .footer-buttons {
      display: flex;
      gap: 10px;
    }
    
    .situation-item.used {
      opacity: 0.7;
      cursor: not-allowed;
      background: #f8d7da;
      border-color: #f5c6cb;
      color: #333;
    }
    
    /* Listening Section Styles */
    .listening-task {
      margin-bottom: 10px;
    }
    
    .true-false-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      font-size: 14px;
    }
    
    .true-false-table th {
      background: #3498db;
      color: white;
      padding: 15px;
      text-align: left;
      font-weight: 600;
      font-size: 14px;
    }
    
    .true-false-table td {
      padding: 15px;
      border-bottom: 1px solid #e1e8f6;
      vertical-align: top;
    }
    
    .true-false-table tr:nth-child(even) {
      background: #f8f9fa;
    }
    
    .true-false-table tr:hover {
      background: #e3f2fd;
    }
    
    .answer-options {
      display: flex;
      gap: 25px;
    }
    
    .answer-option {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      padding: 10px 15px;
      border-radius: 4px;
      transition: background 0.2s;
      font-weight: 500;
    }
    
    .answer-option:hover {
      background: #e3f2fd;
    }
    
    .answer-option input {
      margin: 0;
      transform: scale(1.2);
    }

    /* Results Page Styles */
    .correct-answer {
      background: #d4edda !important;
      border-left: 4px solid #28a745;
    }
    
    .incorrect-answer {
      background: #f8d7da !important;
      border-left: 4px solid #dc3545;
    }
    
    /* Writing Section Styles */
    .writing-task {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .writing-prompt {
      font-size: 14px;
      color: #2c3e50;
      line-height: 1.6;
      margin-bottom: 15px;
    }
    
    .writing-requirements {
      background: #f8f9fa;
      padding: 12px;
      border-radius: 6px;
      border-left: 4px solid #3498db;
      margin-bottom: 15px;
    }
    
    .writing-requirements h4 {
      margin: 0 0 8px 0;
      color: #2c3e50;
    }
    
    .writing-requirements ul {
      margin: 0;
      padding-left: 20px;
    }
    
    .writing-requirements li {
      margin-bottom: 5px;
      color: #2c3e50;
    }
    
    .writing-area {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    
    .writing-textarea {
      flex: 1;
      min-height: 500px;
      padding: 15px;
      border: 2px solid #e1e8f6;
      border-radius: 8px;
      font-size: 14px;
      line-height: 1.6;
      resize: vertical;
      font-family: Arial, sans-serif;
    }
    
    .writing-textarea:focus {
      outline: none;
      border-color: #3498db;
    }
    
    .word-counter {
      margin-top: 10px;
      text-align: right;
      font-size: 13px;
      color: #7f8c8d;
      padding: 8px 0;
    }
    
    .word-counter .count {
      font-weight: bold;
      color: #2c3e50;
    }
    
    /* Results Page Styles */
    .results-body {
      background: #f7fafc;
      color: #0f1724;
      line-height: 1.6;
    }
    
    .results-header {
      background: #1e3a5f;
      color: #fff;
      padding: 18px 20px;
      display: flex;
      align-items: center;
      gap: 16px;
    }
    
    .results-logo {
      background: #fff;
      color: #1e3a5f;
      padding: 8px 12px;
      border-radius: 6px;
      font-weight: 800;
    }
    
    .results-title {
      font-size: 18px;
      font-weight: 700;
    }
    
    .results-container {
      max-width: 1100px;
      margin: 22px auto;
      padding: 20px;
    }
    
    .results-tiles {
      display: flex;
      gap: 12px;
      margin: 18px 0;
    }
    
    .results-tile {
      flex: 1;
      background: #fff;
      border-radius: 10px;
      padding: 16px;
      box-shadow: 0 6px 18px rgba(2, 6, 23, 0.06);
      border-left: 6px solid #1e3a5f;
    }
    
    .results-tile h3 {
      margin: 0;
      font-size: 16px;
      color: #1e3a5f;
    }
    
    .results-tile .score {
      font-size: 20px;
      font-weight: 800;
      margin-top: 8px;
    }
    
    .section-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
    }
    
    .section-table th,
    .section-table td {
      padding: 8px;
      border-bottom: 1px solid #e6eef8;
      text-align: left;
      font-size: 14px;
    }
    
    .summary {
      background: #fff;
      padding: 16px;
      border-radius: 10px;
      margin-top: 18px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .summary .left {
      font-weight: 700;
    }
    
    .summary .right {
      text-align: right;
    }
    
    .controls {
      display: flex;
      gap: 10px;
      margin-top: 18px;
    }
    
    .results-btn {
      background: #4da6ff;
      border: none;
      color: #fff;
      padding: 10px 14px;
      border-radius: 8px;
      font-weight: 700;
      cursor: pointer;
      transition: background 0.3s;
    }
    
    .results-btn:hover {
      background: #3a8ce0;
    }
    
    .button-like {
      text-decoration: none;
    }
    
    .small-muted {
      color: #6b7280;
      font-size: 13px;
    }
    
    input[type="number"] {
      width: 90px;
      padding: 8px;
      border: 1px solid #d7e6fb;
      border-radius: 6px;
    }
    
    .note {
      font-size: 13px;
      color: #6b7280;
      margin-top: 8px;
    }
    
    /* Footer */
    footer.controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: white;
      border-top: 1px solid #e1e8f6;
      margin-top: 20px;
    }
    
    .status {
      font-size: 14px;
      color: #7f8c8d;
    }
    
    .ghost {
      background: transparent;
      border: 2px solid #2c3e50;
      color: #2c3e50;
    }
    
    .ghost:hover {
      background: #2c3e50;
      color: white;
    }

    /* Responsive Styles */
    @media (max-width: 980px) {
      .container {
        grid-template-columns: 1fr;
        padding: 12px;
      }
      
      .container-split {
        grid-template-columns: 1fr;
      }
      
      .right-panel {
        order: 2;
      }
      
      .top-tiles {
        padding-left: 8px;
        padding-right: 8px;
      }
      
      header.topbar {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }
      
      .buttons-grid {
        grid-template-columns: 1fr;
      }
      
      .answer-options {
        flex-direction: column;
        gap: 10px;
      }
      
      footer.controls {
        flex-direction: column;
        gap: 15px;
      }
      
      .results-tiles {
        flex-direction: column;
      }
      
      .summary {
        flex-direction: column;
        gap: 10px;
        text-align: center;
      }
      
      .controls {
        flex-direction: column;
      }
    }
    
    @media (max-width: 600px) {
      .start-content {
        padding: 25px 20px;
      }
      
      h1 {
        font-size: 28px;
      }
      
      .card {
        padding: 20px 15px;
      }
    }

    /* === ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿÆÿßÿµÿ© ŸÑŸÑŸáŸàÿßÿ™ŸÅ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© ÿ¨ÿØÿß === */
    @media (max-width: 480px) {
      /* 1. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ≠ÿßŸàŸäÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© */
      .container, .container-split, .container-full {
        grid-template-columns: 1fr !important;
        padding: 8px !important;
        gap: 10px !important;
      }
      
      /* 2. ÿ¨ÿπŸÑ ÿßŸÑŸÑŸàÿ≠ÿßÿ™ (panels) ÿ™ÿ£ÿÆÿ∞ ÿπÿ±ÿ∂ ŸÉÿßŸÖŸÑ */
      .left-panel, .right-panel, .main-panel {
        max-height: none !important;
        height: auto !important;
        overflow: visible !important;
        margin-bottom: 10px;
      }
      
      /* 3. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸáŸäÿØÿ± */
      .topbar {
        flex-direction: column !important;
        align-items: stretch !important;
        padding: 10px !important;
      }
      
      .brand {
        justify-content: center;
        margin-bottom: 10px;
      }
      
      /* 4. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ± ŸÅŸä ÿßŸÑŸáŸäÿØÿ± */
      .buttons-grid {
        grid-template-columns: 1fr !important;
        width: 100%;
      }
      
      .exam-btn {
        width: 100% !important;
        margin: 2px 0 !important;
        font-size: 14px !important;
        padding: 12px 8px !important;
      }
      
      /* 5. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ™ÿßŸäŸÑÿßÿ™ */
      .top-tiles {
        flex-wrap: wrap;
        justify-content: center;
      }
      
      .tile {
        flex: 0 0 calc(33% - 5px) !important;
        max-width: calc(33% - 5px) !important;
        margin: 2px;
        font-size: 11px !important;
        padding: 8px 4px !important;
      }
      
      /* 6. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÜÿµŸàÿµ */
      .passage, .text-content, .question-text {
        font-size: 15px !important;
        line-height: 1.5 !important;
      }
      
      /* 7. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™ */
      .option {
        padding: 12px 10px !important;
        margin: 4px 0 !important;
      }
      
      /* 8. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ¨ÿØÿßŸàŸÑ True/False */
      .true-false-table {
        display: block;
        overflow-x: auto;
        white-space: nowrap;
      }
      
      /* 9. ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑŸÉÿ™ÿßÿ®ÿ© */
      .writing-textarea {
        min-height: 300px !important;
        font-size: 16px !important;
      }
      
      /* 10. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÅŸàÿ™ÿ± */
      footer.controls {
        flex-direction: column !important;
        gap: 10px !important;
      }
      
      .footer-buttons {
        width: 100%;
        display: flex;
        gap: 5px;
      }
      
      .footer-buttons .exam-btn {
        flex: 1;
      }
      
      /* 11. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ */
      .results-tiles {
        flex-direction: column !important;
      }
      
      .results-tile {
        margin-bottom: 10px;
      }
    }

    /* === ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÑŸÑŸáŸàÿßÿ™ŸÅ ÿßŸÑŸÖÿ™Ÿàÿ≥ÿ∑ÿ© === */
    @media (min-width: 481px) and (max-width: 768px) {
      .container, .container-split {
        grid-template-columns: 1fr !important;
      }
      
      .tile {
        max-width: 180px !important;
      }
    }
  </style>
</head>
<body id="body">
  <!-- Start Page -->
  <div id="start-page" class="start-container">
    <div class="start-content">
      <div class="logo">
        <div class="logo-icon">üìù</div>
        <h1>Deutsch B2 Pr√ºfung</h1>
        <div class="subtitle">Bereiten Sie sich auf Ihre Pr√ºfung vor</div>
      </div>
      <div class="card">
        <h2>Pr√ºfungsbereich ausw√§hlen</h2>
        <p>W√§hlen Sie bitte den Bereich aus, den Sie √ºben m√∂chten. Die Pr√ºfung startet automatisch in <span id="time-display">30</span> Sekunden.</p>
        <select id="sectionSelect">
          <option value="lesen">Lesen</option>
          <option value="hoeren">H√∂ren</option>
          <option value="schreiben">Schreiben</option>
        </select>
        <div class="button-container">
          <button id="cancelBtn" class="btn">Abbrechen</button>
          <button id="startBtn" class="btn">Jetzt starten</button>
        </div>
      </div>
      <div class="timer-container">
        <div class="timer-label">Die Pr√ºfung startet in:</div>
        <div class="timer" id="countdown">30</div>
        <div class="progress-bar">
          <div class="progress" id="progress"></div>
        </div>
      </div>
      <div class="info-text">Stellen Sie sicher, dass Sie in einer ruhigen Umgebung sind und gen√ºgend Zeit haben.</div>
    </div>
  </div>

  <!-- Lesen Page -->
  <div id="lesen-page" class="exam-page" style="display: none;">
    <header class="topbar" role="banner">
      <div class="brand">
        <div class="logo">test</div>
        <div class="meta">
          <div class="main-title">Deutsch - B2 (√úbung)</div>
          <div class="sub-title">Lesen ‚Äî Testbeispiel</div>
        </div>
      </div>

      <div id="timer-lesen" class="timer" aria-live="polite">Verbleibende Zeit: 90:00</div>

      <div class="buttons-grid">
        <button id="resetBtn-lesen" class="exam-btn reset">üîÑ Von neu beginnen</button>
        <button id="saveBtn-lesen" class="exam-btn save">üìã Speichern</button>
        <button id="resultBtn-lesen" class="exam-btn result">üìä Ergebnis</button>
        <button id="submitBtn-lesen" class="exam-btn submit">üèÅ Abgabe</button>
        <button class="exam-btn next" id="nextBtn-lesen">‚û°Ô∏è N√§chste Pr√ºfung</button>
      </div>
    </header>

    <div class="top-tiles" id="topTiles-lesen" role="navigation" aria-label="Sections overview"></div>

    <div class="container">
      <main class="left-panel" id="leftPanel-lesen">
        <div class="passage" id="passage-lesen">
          <h2 id="passageTitle-lesen">Aufgabe</h2>
          <div id="passageContent-lesen"></div>
        </div>
      </main>

      <aside class="right-panel" id="rightPanel-lesen" aria-labelledby="questionTitle-lesen">
        <div class="question-head">
          <div>
            <div id="sectionName-lesen" style="font-weight:800"></div>
            <div id="questionTitle-lesen" style="font-size:13px;color:#55607a">Frage</div>
          </div>
          <button id="resetSectionBtn-lesen" class="exam-btn reset-section" style="display:none;">Teil zur√ºcksetzen</button>
        </div>
        <div class="question-body" id="questionBody-lesen"></div>
        <div id="headingsBankContainer-lesen"></div>
      </aside>
    </div>

    <footer class="controls">
      <div class="footer-buttons">
        <button id="prevBtn-lesen" class="exam-btn ghost">Zur√ºck</button>
        <button id="nextBtn-lesen" class="exam-btn ghost">Weiter</button>
      </div>
      <div class="status"><span id="statusText-lesen">Nicht gespeichert</span></div>
    </footer>
  </div>

  <!-- H√∂ren Page -->
  <div id="hoeren-page" class="exam-page" style="display: none;">
    <header class="topbar" role="banner">
      <div class="brand">
        <div class="logo">test</div>
        <div class="meta">
          <div class="main-title">Deutsch - B2 (√úbung)</div>
          <div class="sub-title">H√∂rverstehen ‚Äî Testbeispiel</div>
        </div>
      </div>

      <div id="timer-hoeren" class="timer" aria-live="polite">Verbleibende Zeit: 17:00</div>

      <div class="buttons-grid">
        <button id="resetBtn-hoeren" class="exam-btn reset">üîÑ Von neu beginnen</button>
        <button id="saveBtn-hoeren" class="exam-btn save">üìã Speichern</button>
        <button id="resultBtn-hoeren" class="exam-btn result">üìä Ergebnis</button>
        <button id="submitBtn-hoeren" class="exam-btn submit">üèÅ Abgabe</button>
        <button class="exam-btn next" id="nextBtn-hoeren">‚û°Ô∏è N√§chste Pr√ºfung</button>
      </div>
    </header>

    <div class="top-tiles" id="topTiles-hoeren" role="navigation" aria-label="Sections overview"></div>

    <div class="container-full">
      <main class="main-panel" id="mainPanel-hoeren">
        <div id="contentContainer-hoeren"></div>
      </main>
    </div>

    <footer class="controls">
      <div class="footer-buttons">
        <button id="prevBtn-hoeren" class="exam-btn ghost">Zur√ºck</button>
        <button id="nextBtn-hoeren" class="exam-btn ghost">Weiter</button>
      </div>
      <div class="status"><span id="statusText-hoeren">Nicht gespeichert</span></div>
    </footer>
  </div>

  <!-- Schreiben Page -->
  <div id="schreiben-page" class="exam-page" style="display: none;">
    <header class="topbar" role="banner">
      <div class="brand">
        <div class="logo">test</div>
        <div class="meta">
          <div class="main-title">Deutsch - B2 (√úbung)</div>
          <div class="sub-title">Schreiben ‚Äî Testbeispiel</div>
        </div>
      </div>

      <div id="timer-schreiben" class="timer" aria-live="polite">Verbleibende Zeit: 30:00</div>

      <div class="buttons-grid">
        <button id="resetBtn-schreiben" class="exam-btn reset">üîÑ Von neu beginnen</button>
        <button id="saveBtn-schreiben" class="exam-btn save">üìã Speichern</button>
        <button id="resultBtn-schreiben" class="exam-btn result">üìä Ergebnis</button>
        <button id="submitBtn-schreiben" class="exam-btn submit">üèÅ Abgabe</button>
        <button class="exam-btn next" id="nextBtn-schreiben">‚û°Ô∏è N√§chste Pr√ºfung</button>
      </div>
    </header>

    <div class="top-tiles" id="topTiles-schreiben" role="navigation" aria-label="Sections overview"></div>

    <div class="container-split">
      <main class="left-panel" id="leftPanel-schreiben">
        <div class="passage" id="passage-schreiben">
          <h2 id="passageTitle-schreiben">Aufgabe</h2>
          <div id="passageContent-schreiben"></div>
        </div>
      </main>

      <aside class="right-panel" id="rightPanel-schreiben">
        <div id="writingContainer-schreiben"></div>
      </aside>
    </div>

    <footer class="controls">
      <div class="footer-buttons">
        <button id="prevBtn-schreiben" class="exam-btn ghost">Zur√ºck</button>
        <button id="nextBtn-schreiben" class="exam-btn ghost">Weiter</button>
      </div>
      <div class="status"><span id="statusText-schreiben">Nicht gespeichert</span></div>
    </footer>
  </div>

  <!-- Ergebnisse Page -->
  <div id="ergebnisse-page" class="results-page" style="display: none;">
    <header class="results-header">
      <div class="results-logo">test</div>
      <div class="results-title">Gesamtergebnis ‚Äî Deutsch B2</div>
    </header>

    <div class="results-container">
      <div class="results-tiles" id="topTiles-ergebnisse"></div>
      <div id="details-ergebnisse"></div>
      <div class="summary" id="finalSummary-ergebnisse"></div>
      <div class="controls">
        <a class="button-like" href="#" id="backBtn-ergebnisse">
          <button class="results-btn">üîÅ Zur√ºck zur Startseite</button>
        </a>
        <button id="calcBtn-ergebnisse" class="results-btn">‚úÖ Ergebnisse anzeigen</button>
      </div>
      <div class="note">Hinweis: Schreiben (45 Punkte) wird manuell eingegeben, falls nicht automatisch vorhanden.</div>
    </div>
  </div>

  <script>
    // ===== PAGE NAVIGATION =====
    function showPage(pageId) {
      // Hide all pages
      document.getElementById('start-page').style.display = 'none';
      document.getElementById('lesen-page').style.display = 'none';
      document.getElementById('hoeren-page').style.display = 'none';
      document.getElementById('schreiben-page').style.display = 'none';
      document.getElementById('ergebnisse-page').style.display = 'none';
      
      // Change body class based on page
      document.getElementById('body').className = '';
      if (pageId === 'ergebnisse-page') {
        document.getElementById('body').className = 'results-body';
      } else if (pageId !== 'start-page') {
        document.getElementById('body').className = 'exam-body';
      }
      
      // Show selected page
      document.getElementById(pageId).style.display = 'block';
      
      // Initialize the page if needed
      if (pageId === 'lesen-page' && typeof initLesenPage === 'function') {
        initLesenPage();
      } else if (pageId === 'hoeren-page' && typeof initHoerenPage === 'function') {
        initHoerenPage();
      } else if (pageId === 'schreiben-page' && typeof initSchreibenPage === 'function') {
        initSchreibenPage();
      } else if (pageId === 'ergebnisse-page' && typeof initErgebnissePage === 'function') {
        initErgebnissePage();
      }
    }

    // ===== START PAGE FUNCTIONALITY =====
    let initialCounter = 30;
    let counter = initialCounter;
    let countdownInterval;
    let countdownRunning = false;
    let examStarted = false;
    const timerEl = document.getElementById("countdown");
    const timeDisplayEl = document.getElementById("time-display");
    const progressEl = document.getElementById("progress");
    const selectEl = document.getElementById("sectionSelect");
    const startBtn = document.getElementById("startBtn");
    const cancelBtn = document.getElementById("cancelBtn");

    function startCountdown() {
      // prevent double-starts or starting after exam already began
      if (countdownRunning || examStarted) return;
      countdownRunning = true;
      // disable start button while counting
      try { startBtn.disabled = true; startBtn.setAttribute('aria-disabled','true'); } catch(e){}
      // reset counter & UI
      counter = initialCounter;
      timerEl.textContent = counter;
      timeDisplayEl.textContent = counter;
      progressEl.style.transform = "scaleX(0)";
      timerEl.style.color = "";

      countdownInterval = setInterval(() => {
        counter--;
        timerEl.textContent = counter;
        timeDisplayEl.textContent = counter;
        const progressValue = (initialCounter - counter) / initialCounter;
        progressEl.style.transform = `scaleX(${progressValue})`;
        if (counter <= 0) {
          clearInterval(countdownInterval);
          countdownInterval = null;
          countdownRunning = false;
          progressEl.style.transform = "scaleX(1)";
          // ensure exam starts only once
          if (!examStarted) {
            examStarted = true;
            startExam();
          }
          // safety: re-enable start button (page usually navigates away)
          try { startBtn.disabled = false; startBtn.removeAttribute('aria-disabled'); } catch(e){}
        }
      }, 1000);
    }

    function stopCountdown(reset = true) {
      if (countdownInterval) {
        clearInterval(countdownInterval);
        countdownInterval = null;
      }
      countdownRunning = false;
      try { startBtn.disabled = false; startBtn.removeAttribute('aria-disabled'); } catch(e){}
      progressEl.style.transform = "scaleX(0)";
      if (reset) {
        counter = initialCounter;
        timerEl.textContent = counter;
        timeDisplayEl.textContent = counter;
      } else {
        timerEl.textContent = "Gestoppt";
      }
    }

    function startExam() {
      // guard to ensure startExam is triggered once
      if (!examStarted) examStarted = true;
      const selectedSection = selectEl.value;
      if (selectedSection === 'lesen') {
        showPage('lesen-page');
      } else if (selectedSection === 'hoeren') {
        showPage('hoeren-page');
      } else if (selectedSection === 'schreiben') {
        showPage('schreiben-page');
      }
    }

    // wire buttons: start will now start the countdown (not the exam directly)
    startBtn.addEventListener('click', startCountdown);

    cancelBtn.addEventListener('click', () => {
      stopCountdown(true);
      timerEl.textContent = "Abgebrochen";
      timerEl.style.color = "#e53e3e";
    });

    // ===== LESEN PAGE FUNCTIONALITY =====
    function initLesenPage() {
      /* ===== Self-contained exam (embedded) ===== */
      const exam = {
        id: "exam-001",
        durationSec: 90 * 60,
        sections: [
          { 
            id: "s1", 
            title: "Leseverstehen, Teil 1", 
            points: 25,
            passageTitle: "Aufgabe: Ziehen Sie die passenden √úberschriften auf die Texte.",
            passage: "",
            questions: [],
            texts: [
              {
                id: "text1",
                content: "√úber zehntausend wissenschaftliche Studien wurden in den vergangenen Jahren im Auftrag der Weltgesundheitsorganisation WHO durchgef√ºhrt, um herauszubekommen, warum manche Menschen erheblich seltener an lebensgef√§hrlichen Krankheiten wie Krebs oder Herzinfarkt erkranken als andere. Die Zahl dieser Erkrankungen hat n√§mlich in den Industriestaaten inzwischen einen traurigen H√∂hepunkt erreicht. Die Forscher fanden heraus, dass mit wenigen Tricks viele Menschen ges√ºnder leben und damit ihr Leben verl√§ngern k√∂nnten. Das Risiko eines Herzinfarkts kann man zum Beispiel durch den t√§glichen Verzehr eines Apfels und t√§gliches zwanzigmin√ºtiges Radfahren erheblich reduzieren. Die Entstehung von Krebs herumt zum Beispiel der t√§gliche Genuss eines L√∂ffels reinen Oliven√∂ls oder eine gro√üe Tasse gr√ºnen Tees. Gegen Stress hilft Vitamin-C-reiche Ern√§hrung und regelm√§√üiges Schwimmen.",
                correctAnswer: "c"
              },
              {
                id: "text2", 
                content: "Am Mittelmeer und in Mexico w√§chst die Aloe-Vera-Pflanze, der in der heutigen Naturmedizin eine wachsende Rolle zukommt. Durch die dickfleischigen Bl√§tter dieser Pflanze ist f√ºr Sch√§dlinge kein Hindurchkommen, deshalb kann sie in Plantagen ohne chemische Schutzmittel angebaut werden. Unter der dicken Haut der Pflanze befindet sich eine gelartige Fl√ºssigkeit, deren Aufgabe darin besteht, Wasser m√∂glichst lange zu speichern - schlie√ülich ist die Pflanze in extrem trockenen Landschaften beheimatet. Dieses Gel ist sehr vitamin- und mineralstoffreich. In der Wundheilung ist Aloegel sehr effektiv. Kosmetisch wird es f√ºr Cremes benutzt, die Haterkrankungen und leichte Verbrennungen wie zum Beispiel Sonnenbrand lindern, Feuchtigkeit spenden und die Haut straffen.",
                correctAnswer: "f"
              },
              {
                id: "text3",
                content: "Eine der √§ltesten bekannten Gem√ºsesorten ist der Spargel. Schon vor 5000 Jahren war er bei den Chinesen bekannt. Gesch√§tzt wurde er vor allem in der Medizin als Herzschutzmittel und zur St√§rkung der k√∂rpereigenen Abwehrkr√§fte: Spargel h√§lt gesund. Heute sch√§tzen wir am Spargel besonders, dass er nicht dick macht. Die k√∂rperlich hart arbeitende Bev√∂lkerung fr√ºherer Zeiten sch√§tzte ihn deshalb nicht sehr, weil er kaum Energie lieferte. Im S√ºdwesten Deutschlands w√§chst der Spargel von Mitte April bis zum Johannistag, dem 24. Juni. Besonders rund um Mainz, Darmstadt, Heidelberg, Bruchsal und in der Pfalz erntet man das stangenf√∂rmige Gem√ºse. In Deutschland ist allerdings der wei√üe Spargel, der unter der Erde w√§chst, popul√§rer als sein oberirdisch wachsender Bruder, der gr√ºne Spargel.",
                correctAnswer: "b"
              },
              {
                id: "text4",
                content: "Schlank sein ist 'in'. Deshalb versuchen Millionen Menschen nicht nur in Deutschland immer wieder ihre Pfunde loszuwerden. Und so purzeln sie von einer Di√§t zur n√§chsten, immer mit dem gleichen Erfolg: Nach dem Abnehmen nehmen sie genauso schnell wieder zu. Und bei vielen kommt mit dem Gewichtsverlust die Krankheit, denn die meisten Di√§ten sind sehr einseitig und entziehen dem K√∂rper viele f√ºr sein Wohlbefinden wichtige N√§hrstoffe. Hier setzt eine neue Theorie an: Sie unterscheidet Nahrungsmittel in Fetthorter, die Fett im K√∂rper speichern, und Fettburner, die dem K√∂rper helfen, zu viel Fett und damit Kilos zu verwerten. Frisches Gem√ºse, Obst, Fisch und Gefl√ºgel versorgen den K√∂rper mit Energie und helfen ihm dabei, die Nahrungsstoffe optimal zu verwerten. Iss dich schlank, lautet das Motto der Fatburnertheorie. Aber ist es nur eine neue Theorie oder hilft sie uns wirklich schlank zu werden?",
                correctAnswer: "g"
              },
              {
                id: "text5",
                content: "Als typisch deutsch gilt sie, doch rund um den Globus ist sie eines der Basislebensmittel schlechthin. In √ñsterreich nennt man sie Erdapfel, an der Mosel hei√üt sie Grumbeere. Gemeint ist die √ºberaus popul√§re Kartoffel. Hunderte verschiedener Sorten gibt es auf der Welt, doch ihr Ursprung liegt in S√ºdamerika. Pr√§kolumbianische Kulturen begannen damit, die bis dahin wild wachsende Urform der Kartoffel systematisch anzubauen. Die englischen Seehelden Sir Francis Drake und Sir Walter Raleigh sollen sie im 16. Jahrhundert nach Europa mitgebracht haben. Etwa zur gleichen Zeit wurde sie in Spanien und Portugal bekannt. Dennoch ist das Klischee von der 'deutschen' Kartoffel nicht ganz falsch, denn zu vielen traditionellen Gerichten wird die Knolle gekocht oder in der Form von Bratkartoffeln, Kartoffelkn√∂deln oder Pommes frites als Beilage gereicht.",
                correctAnswer: "h"
              }
            ],
            headings: [
              {id: "a", text: "Das ideale Gem√ºse f√ºr schwer Arbeitende"},
              {id: "b", text: "Ein schlankes Gem√ºse f√ºr schlanke Leute"},
              {id: "c", text: "Gesunde Ern√§hrung mit Aloe Vera"},
              {id: "d", text: "Gesundes Leben sch√ºtzt vor Zivilisationskrankheiten"},
              {id: "e", text: "Gesundheitsrisiken durch fettreiche Ern√§hrung"},
              {id: "f", text: "Kartoffelrezepte als Zeitungsbeilage"},
              {id: "g", text: "Pflanzliche Kosmetik f√ºr gesunde Haut"},
              {id: "h", text: "Tolle Figur durch ausgewogene Ern√§hrung"},
              {id: "i", text: "Von der Wildpflanze zum international gesch√§tzten Nahrungsmittel"},
              {id: "j", text: "WHO untersucht Zusammenhang von Krebs und Herzinfarkt"}
            ]
          },
          { 
            id: "s2", 
            title: "Leseverstehen, Teil 2", 
            points: 25,
            passageTitle: "Ein Leben f√ºr den Kaffee - Bremer Kaffeer√∂sterei M√ºnchhausen eine der letzten traditionellen R√∂stereien",
            passage: `Vor 50 Jahren gab es in der Hansestadt Bremen ungef√§hr 300 traditionelle Kaffeer√∂stereien. Diese importierten die Kaffeebohnen selbst, stellten den Kaffee tagefrisch her und verkauften ihn im eigenen Gesch√§ft. Heute, da der Kaffee zumeist von internationalen Kaffeegesellschaften produziert und in Superm√§rkten verkauft wird, sind in Deutschland nur noch eine Handvoll Kleinr√∂stereien √ºbrig geblieben. Eine davon ist die Kaffeer√∂stereie M√ºnchhausen.

M√ºnchhausen importiert seinen Kaffee direkt von Kleinbauern in Lateinamerika. Dabei wird streng auf fairen Handel geachtet, das hei√üt, die Kaffeebauern werden f√ºr ihre anstrengende Arbeit angemessen entlohnt. Damit unterst√ºtzt der Importeur zugleich den Kaffeeanbau nach √∂kologischen Gesichtspunkten. Kaffee aus Gro√üplantagen, oft mit Pestiziden und Insektiziden belastet, ist zwar billiger, aber Qualit√§t und Reinheit des Kaffees werden bei der Kaffeer√∂sterei M√ºnchhausen ganz gro√ügeschrieben.

Der Kaffee wird nach alter Familientradition hergestellt. Die Rezeptur ist die gleiche wir vor einem halben Jahrhundert: T√§glich werden die Kaffeebohnen in kleinen Mengen frisch ger√∂stet, gerade so viele, wie an einem Tag verkauft werden. Denn nur so behalten sie ihr Aroma und der Kaffee verliert nicht an Geschmack.

Zuerst werden die Kaffeebohnen in der in den 50er Jahren angeschafften R√∂sttrommel ungef√§hr zehn Minuten lang bei Temperaturen von √ºber 200 Grad Celsius ger√∂stet. Dabei verlieren die Kaffeebohnen zwar ein Sechsteil ihres Gewichts, ihr Volumen vergr√∂√üert sich aber gleichzeitig um etwa ein Drittel. Sind die Bohnen dunkel genug ‚Äì sie d√ºrfen genauso wenig zu dunkel sein ‚Äì, werden sie auf den Verlesetisch gesch√ºttet, wo von Hand die guten von den schlechten Kaffeebohnen getrennt werden.

Danach erst werden aus den ger√∂steten Kaffeebohnen verschiedene Mischungen hergestellt, die dann im Kontor, dem Gesch√§ftsraum der R√∂sterei, fast ausschlie√ülich an langj√§hrige Stammkunden verkauft werden. Aber auch √ºber das Internet vertreibt die Kaffeer√∂sterei M√ºnchhausen ihr Kaffeeangebot deutschlandweit.

Bis zu seinem Tod kurz vor seinem dreiundneunzigsten Geburtstag f√ºhrte August M√ºnchhausen seinen Familienbetrieb, dann √ºbernahm seine Tochter die Firma, inzwischen ist auch die Enkelin beteiligt. Die Frauen planen, aus der Kaffeer√∂sterei ein Museum zu machen, um der Nachwelt die traditionelle Kunst des Kaffeer√∂stens zeigen zu k√∂nnen.

Dann h√§tte diese Institution eine reelle Chance, in Zukunft fortzubestehen und zuk√ºnftigen Generationen den Charme und die Technik der traditionellen Kaffeeherstellung zu erhalten. Selbstverst√§ndlich wird es auch in Zukunft m√∂glich sein, im Museums-Bistro den Kaffee zu genie√üen oder f√ºr den h√§uslichen Bedarf zu erwerben.`,
            questions: [
              {
                id: "s2q1",
                type: "single",
                text: "In Deutschland",
                options: [
                  {id: "s2q1o1", text: "existiert eine Vielzahl von Kaffeer√∂stereien."},
                  {id: "s2q1o2", text: "gibt es nur noch wenige traditionelle Kaffeer√∂stereien."},
                  {id: "s2q1o3", text: "handeln nur noch internationale Gesellschaften mit Kaffee."}
                ],
                correctAnswer: "s2q1o2"
              },
              {
                id: "s2q2",
                type: "single", 
                text: "F√ºr die Kaffeer√∂sterei M√ºnchhausen",
                options: [
                  {id: "s2q2o1", text: "ist es nicht von Bedeutung, ob der Kaffee von Kleinbauern oder Gro√üplantagen kommt."},
                  {id: "s2q2o2", text: "spielt der g√ºnstige Einkaufspreis eine wichtige Rolle."},
                  {id: "s2q2o3", text: "steht aber die Qualit√§t des Kaffees als der Preis im Vordergrund."}
                ],
                correctAnswer: "s2q2o3"
              },
              {
                id: "s2q3",
                type: "single",
                text: "Kaffeebohnen",
                options: [
                  {id: "s2q3o1", text: "d√ºrfen nach dem R√∂sten zwar zu dunklen sein, aber nicht zu hell."},
                  {id: "s2q3o2", text: "k√∂nnen nach der R√∂stung ohne Geschmacksverlust lange Zeit gelagert werden."},
                  {id: "s2q3o3", text: "m√ºssen nach dem R√∂sten handverlesen werden, um eine gleichbleibend hohe Qualit√§t zu gew√§hrleisten."}
                ],
                correctAnswer: "s2q3o3"
              },
              {
                id: "s2q4",
                type: "single",
                text: "Die ger√∂steten Kaffeebohnen werden",
                options: [
                  {id: "s2q4o1", text: "im Kontor nur an Stammkunden angegeben."},
                  {id: "s2q4o2", text: "in Handarbeit gemischt."},
                  {id: "s2q4o3", text: "zus√§tzlich online vermarktet."}
                ],
                correctAnswer: "s2q4o3"
              },
              {
                id: "s2q5", 
                type: "single",
                text: "In Zukunft wollen die Besitzer",
                options: [
                  {id: "s2q5o1", text: "die Kaffeer√∂sterei in ein Museum umwandeln."},
                  {id: "s2q5o2", text: "ein Museum √ºber den Kaffeeanbau er√∂ffnen."},
                  {id: "s2q5o3", text: "keinen R√∂stkaffee mehr verkaufen."}
                ],
                correctAnswer: "s2q5o1"
              }
            ]
          },
          { 
            id: "s3", 
            title: "Leseverstehen, Teil 3", 
            points: 25,
            passageTitle:"Aufgabe: Lesen Sie die zehn Situationen (11-20) und die zw√∂lf Texte (A-L). Welcher Text passt zu welcher Situation? Sie k√∂nnen jeden Text nur einmal verwenden. Manchmal passt kein Text. W√§hlen Sie dann 'x'.",
            passage: "",
            questions:[],
            texts: [
              {id: "A", text: "Urlaubsregion Allg√§uer Alpen - Die Urlaubsregion Allg√§uer Alpen ist mit eine der sch√∂nsten Deutschlands. Mit Bussen und Bahnen gelangt man zu Burgen, Schl√∂ssern, Kirchen und Kl√∂stern. Das kulinarische Angebot bietet f√ºr jeden Geschmack gen√ºgend Auswahl. Bergwanderer sch√§tzen - vor allem im Sp√§tsommer - H√ºttenwanderungen auf den gut ausgebauten H√∂henwegen. Bergbahnen und Sessellifte nehmen viel von der M√ºhe des Aufstiegs ab. Auch f√ºr die Wassersportler ist ausreichend gesorgt.", correctAnswer: "19"},
              {id: "B", text: "Ritter und Burgfr√§ulein f√ºr ein Wochenende Seit vielen Jahrhunderten gibt es in Deutschland Burgen. Hoch √ºber mittelalterlichen St√§dten und oft in romantischer Landschaft ragen sie als touristische Attraktionen empor. F√ºr Geschichtsinteressierte inszeniert man im alten Gem√§uer bunte Feste, die das Mittelalter originaltreu zum Leben erwecken. Hier erleben Sie Ritterturniere, Minnesang und z√ºnftige Gelage. Beliebt sind auch Bauernm√§rkte mit traditionsreicher Handwerkskunst, Maskentreiben und Volkstheater, deren St√ºcke an die Sagen und M√§rchen ankn√ºpfen, die sich um jede Burg ranken. Anmeldung unter info@mittelalter.com", correctAnswer: ""},
              {id: "C", text: "Ferien im Harz Der Harz erhebt sich inselartig √ºber der Norddeutschen Tiefebene und verbindet die L√§nder Sachsen-Anhalt, Niedersachsen und Th√ºringen. Er ist zugleich das h√∂chste Mittelgebirge n√∂rdlich des Mains, im Brockenmassiv auf 1.142 Meter ansteigend. Der Romkerhaller Wasserfall, der aus gro√üer H√∂he in die Tiefe st√ºrzt, ist im Obertal neben der Obertalsperre ein beliebtes Fotomotiv. Fast jede Form von Wassersport ist hier m√∂glich ‚Äì Surfen, Paddeln, Rudern etc", correctAnswer: "15"},
              {id: "D", text: "Auf den Spuren des r√∂mischen Dichters Ausonius Von Bingen am Rhein bis nach Trier an der Mosel f√ºhrt dieser nach dem r√∂mischen Dichter Ausonius benannte Wanderweg. Auf der ehemaligen r√∂mischen Heerstra√üe geht es stets √ºber die H√∂henr√ºcken des Hunsr√ºck. Durch W√§lder und vorbei an Hunsr√ºcker D√∂rfern ist die r√∂mische Vergangenheit an der Strecke und in Museen allgegenw√§rtig. Der 110 Kilometer lange Weg, den auch Ausonius bereiste, f√ºhrt √ºber die H√∂hen und durchschneidet die Bacht√§ler in stetem Auf und Ab, um dann ab Neumagen die Mosel bis nach Trier zu begleiten.", correctAnswer: "13"},
              {id: "E", text: "Extra f√ºr Musicalfans MAMMA MIA! ist eine mitrei√üende Musical-Kom√∂die mit den 22 gr√∂√üten Hits von ABBA ‚Äì und keine langweilige Biografie. Alle Songs werden auf Deutsch gesungen, so ist ein schwungvoller und unterhaltsamer Abend garantiert. Die mitrei√üende Musical-Kom√∂die von Benny Andersson und Bj√∂rn Ulvaeus hat weltweit schon √ºber 24 Millionen Zuschauer begeistert. MAMMA MIA! ‚Äì ein grandioses St√ºck √ºber Liebe, Familie und Freundschaft. Vorstellungen jeder Abend um 18 und 20.30 Uhr. Hamburg Operettenhaus Hamburg Spielbudenplatz 1 D-20369 Hamburg", correctAnswer: "14"},
              {id: "F", text: "Es gibt eine Steigerung zum normalen Strandspaziergang: die Wattwanderung. An der Nordsee finden Sie die gr√∂√üte zusammenh√§ngende Wattlandschaft der Welt. Hier gibt es viel zu entdecken: gleich drei Nationalparks im Wattenmeer mit faszinierenden Landschaften und Tausenden von Tierarten. Ein H√∂hepunkt sind bestimmt die Seehunde im Nationalpark Hamburgisches Wattenmeer. Eine weitere Spezialit√§t f√ºr fortgeschrittene Wattfans sind die Halligen, kleine Reste ehemals gro√üer Marschinseln, die w√§hrend der winterlichen Sturmfluten mehrmals landunter gehen.", correctAnswer: "18"},
              {id: "G", text: "Aktion, Kamera l√§uft! Und Action! Besucher des Movie Park Deutschland sollten sich nicht wundern, wenn sie sich pl√∂tzlich an einem Set befinden und den Anweisungen des Regisseurs folgen oder spektakul√§re Stunts hautnah erleben. In Bottrop, mitten im Ruhrgebiet, dreht sich alles um Filme mit viel Action und Spannung. Gehen auch Sie den Geheimnissen des Bermuda-Dreiecks auf den Grund, wagen Sie selbst eine aufregende Verfolgung im Flugsimulator oder testen Sie Ihre Nerven auf einer der gr√∂√üten Achterbahnen Deutschlands! Aus Sicherheitsgr√ºnden Zutritt nur f√ºr Erwachsene.", correctAnswer: "11"},
              {id: "H", text: "Wiesbaden ‚Äì Internationaler Treffpunkt Gesundheit Das Mineralheilbad Wiesbaden liegt in einer milden, gem√§√üigten Klimazone. Bereits 1836 wurde hier die erste Orthop√§dische Heilanstalt er√∂ffnet. Die Kurstadt mit ihrem historischen Charme ist unter anderem f√ºr ihre natriumchloridhaltigen Thermalquellen ber√ºhmt, die f√ºr vielf√§ltige Kuren genutzt werden. In erster Linie werden sie bei rheumatischen Erkrankungen und Katarrhen der Atmungsorgane, aber auch bei Erkrankungen des Nervensystems und psychosomatischen Leiden eingesetzt.", correctAnswer: "11"},
              {id: "I", text: "Spiel und Spa√ü am Bodensee Auf die Pl√§tze ‚Äì die kleinen grauen Zellen anknipsen ‚Äì und los geht's auf eine Erlebnisreise durch das Ravensburger Spieleland. In dem Freizeitpark am Bodensee spielt die ganze Familie mit Pumuckl beim Fensterherstellungsspiel um die Wette. Rasen mit dem Fix & Foxi-Raketenblitz und sagen Ahoi Blaub√§r Guten Tag. Bekannte Ravensburger Brettspiele wie das Verr√ºckte Labyrinth sind riesengro√ü. Und wo sonst kann man Memory-K√§rtchen vom Hubschrauber aus bedienen? Das geht nur im Freizeitpark Ravensburger Spieleland. Mitten in der sch√∂nsten Natur und ganz in der N√§he des Bodensees warten 50 Attraktionen auf 25 Hektar darauf, entdeckt zu werden.", correctAnswer: "16"},
              {id: "J", text: "Bad Elster ‚Äì heilendes Wasser aus sprudelnden Quellen In Bad Elster sprudeln gleich drei Trinkquellen unterschiedlicher Zusammensetzung und Heilwirkung. Das Herzst√ºck einer Trink- und Badekur sind die Moritz- und die Marienquelle, die sich in der N√§he des Badehauses befinden. Bereits 1858 wurde den Quellen eine heilende Kraft best√§tigt. Mineral- und Sprudelb√§der beugen Herz- und Kreislauferkrankungen vor. Natriumchloridb√§der und Packungen helfen gegen Rheuma, Arthritis, bei Frauenleiden, dem Ausheilen von Sport- und Unfallverletzungen sowie bei der operativen Nachsorge und Reha-Ma√ünahmen. Und Trinkkuren unterst√ºtzen die Heilung bei Stoffwechsel-, Nieren- und Harnwegserkrankungen.", correctAnswer: "17"},
              {id: "K", text: "Ein besonderer Weihnachtsmarkt Willkommen auf dem Striezelmarkt, dem √§ltesten Weihnachtsmarkt Deutschlands. Gegr√ºndet 1434, verdankt er seinen Namen dem Hefestriezel, l√§ngst ber√ºhmt als Original Dresdner Christstollen. Allj√§hrlich ist ihm zum Stollenfest, am Samstag vor dem 2. Advent, ein riesiger Festumzug gewidmet. Bestaunen Sie im Mittelpunkt des Marktes die mit 14 Metern h√∂chste Weihnachtspyramide der Welt. Traditionelle Handwerksarbeiten vom Feinsten aus Dresden und Umgebung wie Pyramiden, R√§ucherm√§nner, Schwibb√∂gen, T√∂pferwaren und Herrnhuter Adventssterne werden auch Sie verzaubern.", correctAnswer: null},
              {id: "L", text: "Bad Homburg ‚Äì in einzigartiger Badekultur entspannen wie K√∂nige In Bad Homburg steht das heilsame und wohltuende Thermalwasser von h√∂chster Qualit√§t als heilendes Element im Vordergrund. Es enth√§lt f√ºr den K√∂rper wichtige Mineralstoffe. Gleich sechs kalte, kohlens√§urehaltige Kochsalzquellen, ein Solenebelbad und zwei Galliaquellen werden f√ºr Trinkkuren und Mineralb√§der genutzt. Man findet aktive Entspannung mit Gesundheits-, Fitness- und Sportprogramm. Individuelle Therapien und Verfahren helfen bei Bew√§ltigung von Stressproblemen. Moderne medizinische und therapeutische Erkenntnisse haben das Kurangebot Bad Homburgs in den letzten hundert Jahren wesentlich beeinflusst.", correctAnswer: "14"}
            ],
            situations: [
              {id: "11", text: "Ein Bekannter m√∂chte miterleben, wie spektakul√§re Filmszenen gedreht werden."},
              {id: "12", text: "Eine Bekannte interessiert sich f√ºr CDs mit klassischer Musik."},
              {id: "13", text: "Eine Bekannte m√∂chte eine mehrt√§gige Fu√üwanderung machen und dabei etwas √ºber die kulturelle Vergangenheit der Region erfahren."},
              {id: "14", text: "Eine Bekannte m√∂chte sich in einem Kurort von der Hektik des Alltags erholen."},
              {id: "15", text: "Ein Bekannter m√∂chte im Urlaub auf einem See Boot fahren."},
              {id: "16", text: "Eine Familie m√∂chte mit ihren Kindern einen aktiven und lustigen Tag verbringen."},
              {id: "17", text: "Ein Bekannter hat ein neue Kniegelenk bekommen und sucht eine geeignete Kur."},
              {id: "18", text: "Eine Bekannte ist Hobbyzoologin und interessiert sich f√ºr den Lebensraum K√ºste"},
              {id: "19", text: "Ein Bekannter liebt die Bergwelt, kann aber keine steilen und anstrengenden Wege mehr gehen."},
              {id: "20", text: "Eine Bekannte m√∂chte Geschichten √ºber Ritter und Burgen lesen."}
            ]
          },
          { 
            id: "s4", 
            title: "Sprachbausteine, Teil 1", 
            points: 15,
            passageTitle:"Aufgabe: Erg√§nzen Sie den Text. W√§hlen Sie f√ºr jede L√ºcke das passende Wort.",
            passage: "",
            questions:[],
            fillBlanks: [
              {
                id: "21",
                options: ["dass", "ob", "weil"],
                correctAnswer: "dass"
              },
              {
                id: "22",
                options: ["bedienen", "beeilen", "besch√§ftigen"],
                correctAnswer: "besch√§ftigen"
              },
              {
                id: "23",
                options: ["blo√ü", "doch", "nur"],
                correctAnswer: "doch"
              },
              {
                id: "24",
                options: ["au√üerdem", "insbesondere", "jedoch"],
                correctAnswer: "insbesondere"
              },
              {
                id: "25",
                options: ["√ºberm√§chtig", "√ºberm√§√üig", "√ºberwiegend"],
                correctAnswer: "√ºberwiegend"
              },
              {
                id: "26",
                options: ["fast", "nahe", "ziemlich"],
                correctAnswer: "fast"
              },
              {
                id: "27",
                options: ["gering", "knapp", "wenig"],
                correctAnswer: "wenig"
              },
              {
                id: "28",
                options: ["kommt", "l√§uft", "steht"],
                correctAnswer: "kommt"
              },
              {
                id: "29",
                options: ["brauchst", "hast", "willst"],
                correctAnswer: "willst"
              },
              {
                id: "30",
                options: ["k√ºrzlich", "m√∂glich", "√ºblich"],
                correctAnswer: "m√∂glich"
              }
            ],
            fillText: `Liebe Corinna,

es tut mir wirklich Leid, ________ ich dir seit Ewigkeiten nicht mehr geschrieben habe. Aber du wei√üt ja: Ich habe seit drei Monaten eine neue Arbeit. Und da hatte ich gar keine Zeit, mich mit etwas Anderem zu ________ als mit der neuen Arbeit.

Es hat mich wirklich √ºberrascht, wie schnell ich nach dem Abschluss meiner Ausbildung etwas gefunden habe. Dabei haben alle immer nur gesagt: "G√§rtner? Die gibt es ________ wie Sand am Meer, wie willst du da so schnell einen Job finden?".

Ich arbeite jetzt in einer Baumschule. Wir kultivieren und verkaufen Obstb√§ume, ________ an die Obstbauern der n√§heren Umgebung. Die Arbeit macht mir gro√üen Spa√ü, es ist andererseits aber ein bisschen anstrengend, acht Stunden am Tag k√∂rperlich ________ im Freien - zu arbeiten. Und leider muss ich ________ eine dreiviertel Stunde mit dem Zug fahren, um an meinen Arbeitsplatz zu kommen.

Wenn ich dann am Abend nach Hause komme, bin ich so m√ºde, dass ich eigentlich nur noch fernsehen oder Musik h√∂ren kann. Ich habe im Moment nur ________ Lust, etwas zu unternehmen, aber ich bin mir sicher: Sie ________ wieder.

Wie geht es dir denn? Du m√ºsstest doch jetzt auch bald mit deiner Ausbildung fertig sein, oder? Hast du schon damit angefangen, dich bei verschiedenen Arbeitgebern zu bewerben? Oder ________ du dir noch ein bisschen Zeit damit? Ich w√ºrde dir in jedem Fall raten: Fang so fr√ºh wie ________ mit den Bewerbungen an, je fr√ºher, desto besser. Du wei√üt ja, was unser Klassenlehrer in der Realschule immer gesagt hat: Gut Ding will Weile haben.

So, jetzt muss ich aufh√∂ren und ins Bett gehen, damit ich morgen wieder fit bin. Mach's gut, bis bald,

dein

Richard`
          },
          { 
            id: "s5", 
            title: "Sprachbausteine, Teil 2", 
            points: 15,
            passageTitle:"Aufgabe: Lesen Sie den Text und entscheiden Sie, welches Wort in welche L√ºcke passt. Sie k√∂nnen jedes Wort nur einmal verwenden. Nicht alle W√∂rter passen in den Text.",
            passage: "",
            questions:[],
            fillBlanks2: [
              {
                id: "31",
                options: ["ALLES", "ANSTATT", "AUSGEHEN", "BEKOMMEN", "BILDEN", "DAGEGEN", "DAVON", "GEGEN", "H√ñCHSTENS", "JEDE", "MEISTENS", "SOLCHE", "UM", "WILL", "W√úNSCHT"],
                correctAnswer: "ANSTATT"
              },
              {
                id: "32", 
                options: ["ALLES", "ANSTATT", "AUSGEHEN", "BEKOMMEN", "BILDEN", "DAGEGEN", "DAVON", "GEGEN", "H√ñCHSTENS", "JEDE", "MEISTENS", "SOLCHE", "UM", "WILL", "W√úNSCHT"],
                correctAnswer: "JEDE"
              },
              {
                id: "33",
                options: ["ALLES", "ANSTATT", "AUSGEHEN", "BEKOMMEN", "BILDEN", "DAGEGEN", "DAVON", "GEGEN", "H√ñCHSTENS", "JEDE", "MEISTENS", "SOLCHE", "UM", "WILL", "W√úNSCHT"],
                correctAnswer: "GEGEN"
              },
              {
                id: "34",
                options: ["ALLES", "ANSTATT", "AUSGEHEN", "BEKOMMEN", "BILDEN", "DAGEGEN", "DAVON", "GEGEN", "H√ñCHSTENS", "JEDE", "MEISTENS", "SOLCHE", "UM", "WILL", "W√úNSCHT"],
                correctAnswer: "DAVON"
              },
              {
                id: "35",
                options: ["ALLES", "ANSTATT", "AUSGEHEN", "BEKOMMEN", "BILDEN", "DAGEGEN", "DAVON", "GEGEN", "H√ñCHSTENS", "JEDE", "MEISTENS", "SOLCHE", "UM", "WILL", "W√úNSCHT"],
                correctAnswer: "WILL"
              },
              {
                id: "36",
                options: ["ALLES", "ANSTATT", "AUSGEHEN", "BEKOMMEN", "BILDEN", "DAGEGEN", "DAVON", "GEGEN", "H√ñCHSTENS", "JEDE", "MEISTENS", "SOLCHE", "UM", "WILL", "W√úNSCHT"],
                correctAnswer: "BILDEN"
              },
              {
                id: "37",
                options: ["ALLES", "ANSTATT", "AUSGEHEN", "BEKOMMEN", "BILDEN", "DAGEGEN", "DAVON", "GEGEN", "H√ñCHSTENS", "JEDE", "MEISTENS", "SOLCHE", "UM", "WILL", "W√úNSCHT"],
                correctAnswer: "AUSGEHEN"
              },
              {
                id: "38",
                options: ["ALLES", "ANSTATT", "AUSGEHEN", "BEKOMMEN", "BILDEN", "DAGEGEN", "DAVON", "GEGEN", "H√ñCHSTENS", "JEDE", "MEISTENS", "SOLCHE", "UM", "WILL", "W√úNSCHT"],
                correctAnswer: "SOLCHE"
              },
              {
                id: "39",
                options: ["ALLES", "ANSTATT", "AUSGEHEN", "BEKOMMEN", "BILDEN", "DAGEGEN", "DAVON", "GEGEN", "H√ñCHSTENS", "JEDE", "MEISTENS", "SOLCHE", "UM", "WILL", "W√úNSCHT"],
                correctAnswer: "BEKOMMEN"
              },
              {
                id: "40",
                options: ["ALLES", "ANSTATT", "AUSGEHEN", "BEKOMMEN", "BILDEN", "DAGEGEN", "DAVON", "GEGEN", "H√ñCHSTENS", "JEDE", "MEISTENS", "SOLCHE", "UM", "WILL", "W√úNSCHT"],
                correctAnswer: "MEISTENS"
              }
            ],
            fillText2: `Schwarzarbeit kann teuer werden

Schn√§ppchen machen, um Rabatte feilschen: Wer billig einkauft, gilt als clever. Vorsicht ist jedoch bei Auftr√§gen an Schwarzarbeiter geboten. Denn schnell zahlt der Kunde drauf, ________ wie durch das illegale Arbeitsverh√§ltnis erhofft - Geld zu sparen. Rund ums Haus ist nicht ________ Gelegenheit so g√ºnstig, wie sie anfangs scheint:

Schwarzarbeit etwa ist nicht nur verboten, sondern es gibt auch ein finanzielles Argument ________ illegale Arbeiter: Oftmals rechnet sich der Dienst gegen Barzahlung gar nicht. "Abgesehen ________, dass es strafbar ist, Schwarzarbeiter zu besch√§ftigen, nimmt der Auftraggeber handfeste steuerliche Nachteile in Kauf, warnt Dirk Witte, Steuerberater aus Wildeshausen in Niedersachsen. Wer eine Putzhilfe besch√§ftigt, kann die Steuerlast auch auf legalem Weg sp√ºrbar senken.

Auch f√ºr die Modernisierung, Renovierung und Sanierung der Wohnung gibt es einen Steuernachlass, allerdings nur f√ºr legale Arbeiten. "Das Finanzamt ________ eine ordentliche Rechnung und einen √úberweisungsbeleg sehen". Barzahler k√∂nnen daher nichts von der Steuer absetzen. Noch schwerer f√§llt ins Gewicht, dass ein Kunde seine Haftungsanspr√ºche aufs Spiel setzt, wenn er vordergr√ºndig ein paar Euro sparen m√∂chte. Denn m√§ngelfreie Bauten ________ eher die Ausnahme.

Und ob ein Kunde die Beseitigung von M√§ngeln gerichtlich gegen einen Schwarzarbeiter durchsetzen kann, ist von Fall zu Fall zu pr√ºfen. Im Prinzip muss man aber damit rechnen, die Anspr√ºche zu verlieren. Ebenso d√ºrften Verbraucher leer ________, wenn beim Bauen etwas zu Bruch geht. Ein orderntlicher Handwerker hat f√ºr ________ F√§lle eine Haftpflichtversicherung.

Richtig teuer werden k√∂nnen auch Unf√§lle, bei denen sich der illegale Helfer verletzt. Dann zahlen weder Krankenversicherung noch Unfallkasse. F√§lit etwa ein Arbeiter vom Ger√ºst und ist danach dauerhaft querschnittsgel√§hmt, dann wird der Kunde daf√ºr sein Leben lang zahlen.

Die Folgen von Schwarzarbeit lassen sich mit dem Dominoprinzip beschreiben: Fliegt die illegale Besch√§ftigung auf, dann ________ es gleich mehrere Beh√∂rden mit. Post gibt es dann vom Finanzamt, der Staatsanwaltschaft und den Sozialversicherungstr√§gern. Dann braucht der Auftraggeber ________ einen Anwalt. Und der kostet nat√ºrlich auch wieder Geld.`
          }
        ]
      };

      /* ===== State & DOM refs ===== */
      let state = { 
        sectionIndex: 0, 
        questionIndex: 0, 
        answers: {}, 
        marked: {}, 
        remaining: exam.durationSec,
        showResults: false,
        timerStarted: false,
        timerInterval: null
      };
      const topTiles = document.getElementById('topTiles-lesen');
      const passageTitleEl = document.getElementById('passageTitle-lesen');
      const passageContentEl = document.getElementById('passageContent-lesen');
      const sectionNameEl = document.getElementById('sectionName-lesen');
      const questionTitleEl = document.getElementById('questionTitle-lesen');
      const questionBodyEl = document.getElementById('questionBody-lesen');
      const headingsBankContainer = document.getElementById('headingsBankContainer-lesen');
      const timerEl = document.getElementById('timer-lesen');
      const statusText = document.getElementById('statusText-lesen');
      const resultBtn = document.getElementById('resultBtn-lesen');
      const resetBtn = document.getElementById('resetBtn-lesen');
      const resetSectionBtn = document.getElementById('resetSectionBtn-lesen');

      /* ===== Timer Functions ===== */
      function startTimer(){
        if(state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        
        state.timerStarted = true;
        state.timerInterval = setInterval(()=>{
          if(state.remaining <= 0){
            clearInterval(state.timerInterval);
            timerEl.textContent = 'Zeit abgelaufen';
            return;
          }
          state.remaining--;
          updateTimerDisplay();
        }, 1000);
      }

      function resetTimer(){
        if(state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        state.remaining = exam.durationSec;
        state.timerStarted = false;
        updateTimerDisplay();
        startTimer();
      }

      function updateTimerDisplay(){
        const min = Math.floor(state.remaining / 60);
        const sec = state.remaining % 60;
        timerEl.textContent = `Verbleibende Zeit: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
      }

      /* ===== Reset Section Function ===== */
      function resetCurrentSection() {
        const currentSection = exam.sections[state.sectionIndex];
        
        if (confirm(`M√∂chten Sie wirklich den Teil "${currentSection.title}" zur√ºcksetzen? Alle Antworten in diesem Teil werden gel√∂scht.`)) {
          if (currentSection.id === 's1') {
            currentSection.texts.forEach(text => {
              delete state.answers[text.id];
            });
          } else if (currentSection.id === 's2') {
            currentSection.questions.forEach(question => {
              delete state.answers[question.id];
            });
          } else if (currentSection.id === 's3') {
            currentSection.situations.forEach(situation => {
              delete state.answers[situation.id];
            });
          } else if (currentSection.id === 's4') {
            currentSection.fillBlanks.forEach(blank => {
              delete state.answers[blank.id];
            });
          } else if (currentSection.id === 's5') {
            currentSection.fillBlanks2.forEach(blank => {
              delete state.answers[blank.id];
            });
          }
          
          renderAll();
        }
      }

      /* ===== Render ===== */
      function renderTopTiles(){ 
        topTiles.innerHTML=''; 
        exam.sections.forEach((sec,idx)=>{ 
          const div=document.createElement('div'); 
          div.className='tile'+(idx===state.sectionIndex?' active':'')+(isSectionDone(sec)?' done':''); 
          div.innerHTML=`<div>${sec.title}</div><div class="points">${sec.points} P</div>`; 
          div.onclick=()=>{state.sectionIndex=idx; state.questionIndex=0; state.showResults=false; renderAll();}; 
          topTiles.appendChild(div); 
        }); 
      }

      function isSectionDone(section){
        if(section.id==='s1') return section.texts.every(t=>state.answers[t.id]);
        if(section.id==='s2') return section.questions.every(q=>state.answers[q.id]);
        if(section.id==='s3') return section.situations.every(h=>state.answers[h.id] || state.answers[h.id] === 'X');
        if(section.id==='s4') return section.fillBlanks.every(b=>state.answers[b.id]);
        if(section.id==='s5') return section.fillBlanks2.every(b=>state.answers[b.id]);
        return false;
      }

      function renderAll(){
        renderTopTiles();
        const section = exam.sections[state.sectionIndex];
        sectionNameEl.textContent = section.title;
        passageTitleEl.textContent = section.passageTitle;
        
        resetSectionBtn.style.display = 'block';
        
        if(state.showResults){
          renderResults();
          return;
        }
        
        if(section.id === 's1'){
          renderPart1();
        } else if(section.id === 's2'){
          renderPart2();
        } else if(section.id === 's3'){
          renderPart3();
        } else if(section.id === 's4'){
          renderSprachbausteine1();
        } else if(section.id === 's5'){
          renderSprachbausteine2();
        }
      }

      function renderPart1(){
        const section = exam.sections[state.sectionIndex];
        
        let textsHTML = `<div class="instructions">Ziehen Sie die passenden √úberschriften auf die Texte. Sie k√∂nnen jede √úberschrift nur einmal verwenden.</div>`;
        
        section.texts.forEach((text, idx) => {
          const letter = String.fromCharCode(97 + idx);
          const selectedHeading = state.answers[text.id];
          
          textsHTML += `
            <div class="text-container">
              <div class="text-title">Text ${letter.toUpperCase()}</div>
              <div class="text-content">${text.content}</div>
              <div class="title-slot ${selectedHeading ? 'has-title' : ''}" data-text-id="${text.id}">
                ${selectedHeading ? getHeadingTextById(selectedHeading) : 'Ziehen Sie hier eine √úberschrift hin'}
              </div>
            </div>
          `;
        });
        
        passageContentEl.innerHTML = textsHTML;
        
        let headingsHTML = `<div class="headings-bank">`;
        section.headings.forEach(heading => {
          const isUsed = section.texts.some(text => state.answers[text.id] === heading.id);
          
          headingsHTML += `
            <div class="heading-item ${isUsed ? 'used' : ''}" draggable="${!isUsed}" data-heading-id="${heading.id}">
              ${heading.id}) ${heading.text}
            </div>
          `;
        });
        
        headingsHTML += `</div>`;
        
        headingsBankContainer.innerHTML = headingsHTML;
        
        setupDragAndDrop();
        
        questionBodyEl.innerHTML = '';
        questionTitleEl.textContent = '';
      }

      function getHeadingTextById(id){
        const section = exam.sections[state.sectionIndex];
        const heading = section.headings.find(h => h.id === id);
        return heading ? `${heading.id}) ${heading.text}` : '';
      }

      function setupDragAndDrop(){
        const headingItems = document.querySelectorAll('.heading-item:not(.used)');
        const titleSlots = document.querySelectorAll('.title-slot');
        
        headingItems.forEach(item => {
          item.addEventListener('dragstart', (e) => {
            e.dataTransfer.setData('text/plain', e.target.dataset.headingId);
          });
        });
        
        titleSlots.forEach(slot => {
          slot.addEventListener('dragover', (e) => {
            e.preventDefault();
            slot.style.background = '#e8f4ff';
          });
          
          slot.addEventListener('dragleave', (e) => {
            slot.style.background = slot.classList.contains('has-title') ? '#e8fbe9' : '#f8fbff';
          });
          
          slot.addEventListener('drop', (e) => {
            e.preventDefault();
            const headingId = e.dataTransfer.getData('text/plain');
            const textId = slot.dataset.textId;
            
            Object.keys(state.answers).forEach(key => {
              if(state.answers[key] === headingId) {
                delete state.answers[key];
              }
            });
            
            state.answers[textId] = headingId;
            renderAll();
          });
        });
      }

      function renderPart2(){
        const section = exam.sections[state.sectionIndex];
        
        passageContentEl.innerHTML = `<div class="passage">${section.passage}</div>`;
        
        let questionsHTML = `<div class="all-questions">`;
        
        section.questions.forEach((question, idx) => {
          const questionNumber = idx + 1;
          const userAnswer = state.answers[question.id];
          
          questionsHTML += `
            <div class="question-block">
              <div class="question-text">${questionNumber}. ${question.text}</div>
              <div class="options">
                ${question.options.map(opt => `
                  <div class="option ${userAnswer === opt.id ? 'selected' : ''}" 
                       onclick="window.lesenApp.selectOption('${question.id}', '${opt.id}')">
                    <div class="radio"></div>
                    <div>${opt.text}</div>
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        });
        
        questionsHTML += `</div>`;
        
        questionBodyEl.innerHTML = questionsHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';
      }

      function renderPart3(){
        const section = exam.sections[state.sectionIndex];
        
        let textsHTML = `
          <div class="instructions">Ziehen Sie die passenden Situationen auf die Texte. Sie k√∂nnen jede Situation nur einmal verwenden. Manchmal passt keine Situation.</div>
          <div class="texts-list">
            <h3>Texte (A-L)</h3>
        `;
        
        section.texts.forEach(text => {
          const userAnswer = Object.keys(state.answers).find(key => state.answers[key] === text.id);
          const selectedSituation = userAnswer ? section.situations.find(h => h.id === userAnswer) : null;
          
          textsHTML += `
            <div class="text-item" data-text-id="${text.id}">
              <div class="text-letter">${text.id})</div>
              <div class="text-content">${text.text}</div>
              <div class="title-slot ${userAnswer ? 'has-title' : ''} ${userAnswer === 'X' ? 'has-x' : ''}" data-text-id="${text.id}">
                ${selectedSituation ? selectedSituation.text : (userAnswer === 'X' ? 'X - Keine passende Situation' : 'Ziehen Sie hier eine Situation hin')}
              </div>
            </div>
          `;
        });
        
        textsHTML += `</div>`;
        
        passageContentEl.innerHTML = textsHTML;
        
        let situationsHTML = `
          <div class="situations-list">
            <h3>Situationen (11-20)</h3>
        `;
        
        section.situations.forEach((situation, idx) => {
          const situationNumber = parseInt(situation.id);
          const isUsed = state.answers[situation.id];
          const isX = state.answers[situation.id] === 'X';
          
          situationsHTML += `
            <div class="situation-item ${isUsed ? 'used' : ''}" draggable="${!isUsed}" data-situation-id="${situation.id}">
              <div class="situation-number">${situationNumber}.</div>
              <div class="situation-text">${situation.text}</div>
              ${!isUsed ? `<button class="exam-btn no-match ${isX ? 'selected' : ''}" onclick="window.lesenApp.markNoMatch('${situation.id}')">X - Kein passender Text</button>` : ''}
            </div>
          `;
        });
        
        situationsHTML += `</div>`;
        
        questionBodyEl.innerHTML = situationsHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';
        
        setupPart3DragAndDrop();
      }

      function markNoMatch(situationId) {
        Object.keys(state.answers).forEach(key => {
          if(state.answers[key] === situationId) {
            delete state.answers[key];
          }
        });
        
        state.answers[situationId] = 'X';
        try{ localStorage.setItem('lesenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        renderAll();
      }

      function setupPart3DragAndDrop(){
        const situationItems = document.querySelectorAll('.situation-item:not(.used)');
        const textSlots = document.querySelectorAll('.text-item .title-slot');
        
        situationItems.forEach(item => {
          item.addEventListener('dragstart', (e) => {
            e.dataTransfer.setData('text/plain', e.target.dataset.situationId);
          });
        });
        
        textSlots.forEach(slot => {
          slot.addEventListener('dragover', (e) => {
            e.preventDefault();
            slot.style.background = '#e8f4ff';
          });
          
          slot.addEventListener('dragleave', (e) => {
            const hasTitle = slot.classList.contains('has-title');
            const hasX = slot.classList.contains('has-x');
            slot.style.background = hasTitle ? '#e8fbe9' : (hasX ? '#f8d7da' : '#f8fbff');
          });
          
          slot.addEventListener('drop', (e) => {
            e.preventDefault();
            const situationId = e.dataTransfer.getData('text/plain');
            const textId = slot.dataset.textId;
            
            Object.keys(state.answers).forEach(key => {
              if(state.answers[key] === situationId) {
                delete state.answers[key];
              }
            });
            
            state.answers[situationId] = textId;
            renderAll();
          });
        });
      }

      function renderSprachbausteine1(){
        const section = exam.sections[state.sectionIndex];
        
        let textWithBlanks = section.fillText;
        
        const blankPlaceholders = [];
        section.fillBlanks.forEach(blank => {
          blankPlaceholders.push(`BLANK_${blank.id}`);
        });
        
        let tempText = textWithBlanks;
        blankPlaceholders.forEach((placeholder, index) => {
          tempText = tempText.replace('________', placeholder);
        });
        
        section.fillBlanks.forEach(blank => {
          const userAnswer = state.answers[blank.id];
          const displayText = userAnswer ? userAnswer : '________';
          tempText = tempText.replace(`BLANK_${blank.id}`, `<span class="blank-word ${userAnswer ? 'has-answer' : ''}" data-blank-id="${blank.id}">${displayText}</span>`);
        });
        
        passageContentEl.innerHTML = `
          <div class="instructions">Klicken Sie auf jede L√ºcke und w√§hlen Sie das passende Wort aus. Sie k√∂nnen die L√ºcken in beliebiger Reihenfolge ausf√ºllen.</div>
          <div class="fill-blank-container">${tempText}</div>
        `;
        
        document.querySelectorAll('.blank-word').forEach(blank => {
          blank.addEventListener('click', (e) => {
            showOptionsPopup(e.target);
          });
        });
        
        let optionsHTML = `<div class="horizontal-options" style="gap: 8px;">`;
        
        section.fillBlanks.forEach(blank => {
          const userAnswer = state.answers[blank.id];
          
          optionsHTML += `
            <div class="option-row" style="padding: 8px; margin-bottom: 5px;">
              <div class="option-number">${blank.id}</div>
              <div class="option-buttons">
                ${blank.options.map(opt => `
                  <div class="option-btn ${userAnswer === opt ? 'selected' : ''}" 
                       onclick="window.lesenApp.selectSprachbausteine1('${blank.id}', '${opt}')" 
                       style="padding: 6px 12px; font-size: 12px;">
                    ${opt}
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        });
        
        optionsHTML += `</div>`;
        
        questionBodyEl.innerHTML = optionsHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';
      }

      function showOptionsPopup(blankElement){
        const existingPopup = document.querySelector('.options-popup');
        if(existingPopup) {
          existingPopup.remove();
        }
        
        const blankId = blankElement.getAttribute('data-blank-id');
        const section = exam.sections.find(s => s.id === 's4');
        const blank = section.fillBlanks.find(b => b.id === blankId);
        
        if(!blank) return;
        
        const popup = document.createElement('div');
        popup.className = 'options-popup';
        
        blank.options.forEach(opt => {
          const optionItem = document.createElement('div');
          optionItem.className = 'option-item';
          optionItem.textContent = opt;
          optionItem.onclick = () => {
            selectSprachbausteine1(blankId, opt);
            popup.remove();
          };
          popup.appendChild(optionItem);
        });
        
        blankElement.appendChild(popup);
      }

      function selectSprachbausteine1(blankId, answer){
        state.answers[blankId] = answer;
        renderAll();
      }

      function renderSprachbausteine2(){
        const section = exam.sections[state.sectionIndex];
        // Build text but replace blanks with unique placeholders first (prevents ambiguous replacements)
        let textWithPlaceholders = section.fillText2;
        const placeholders = [];
        section.fillBlanks2.forEach(blank => {
          const ph = `BLANK_${blank.id}`;
          placeholders.push({id: blank.id, ph});
          // replace first occurrence of the visual underline with placeholder
          textWithPlaceholders = textWithPlaceholders.replace('________', ph);
        });

        // Now replace placeholders with actual span elements showing current answer (or underscore)
        placeholders.forEach(item => {
          const userAnswer = state.answers[item.id];
          const displayText = userAnswer ? userAnswer : '________';
          const span = `<span class="blank-slot ${userAnswer ? 'has-answer' : ''}" data-blank-id="${item.id}">${displayText}</span>`;
          textWithPlaceholders = textWithPlaceholders.replace(item.ph, span);
        });

        passageContentEl.innerHTML = `
          <div class="instructions">Klicken Sie auf jede L√ºcke und w√§hlen Sie das passende Wort aus. Sie k√∂nnen jedes Wort nur einmal verwenden.</div>
          <div class="fill-blank-container">${textWithPlaceholders}</div>
        `;

        // attach click handlers to slots
        document.querySelectorAll('.blank-slot').forEach(slot => {
          slot.addEventListener('click', (e) => {
            // use the element itself to open popup
            showSprachbausteine2Options(slot);
          });
        });

        // Build word bank on the right
        let wordBankHTML = `<div class="word-bank-vertical" style="gap: 8px;">`;
        const usedWords = Object.values(state.answers);
        // Use section.wordBank if present, otherwise derive from fillBlanks2 options
        const bank = section.fillBlanks2[0] ? section.fillBlanks2[0].options : [];
        bank.forEach(word => {
          const isUsed = usedWords.includes(word);
          wordBankHTML += `
            <div class="bank-word-vertical ${isUsed ? 'used' : ''}" 
                 draggable="${!isUsed}" 
                 data-word="${word}"
                 ${!isUsed ? `onclick="window.lesenApp.selectSprachbausteine2FromBank('${word}')"` : ''}>
              ${word}
            </div>
          `;
        });
        wordBankHTML += `</div>`;
        questionBodyEl.innerHTML = wordBankHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';

        setupSprachbausteine2DragAndDrop();
      }

      // --- Added functions to handle drag/drop and clicks for Sprachbausteine Teil 2 ---
      let lastClickedSprachSlot = null;

      function setupSprachbausteine2DragAndDrop(){
        // bank words: make draggable if not used, attach dragstart
        const bankWords = Array.from(document.querySelectorAll('.bank-word-vertical'));
        bankWords.forEach(el => {
          const word = el.dataset.word;
          if(!el.classList.contains('used')){
            el.setAttribute('draggable','true');
          } else {
            el.setAttribute('draggable','false');
          }
          // ensure single attached listener
          el.removeEventListener('dragstart', el._dstart);
          el._dstart = (e) => {
            e.dataTransfer.setData('text/plain', word);
            // also set an indicator
            e.dataTransfer.setData('source', 'bank');
          };
          el.addEventListener('dragstart', el._dstart);

          // keep onclick behavior (select into clicked slot)
          el.removeEventListener('click', el._onclick);
          el._onclick = () => {
            if(el.classList.contains('used')) return;
            selectSprachbausteine2FromBank(word);
          };
          el.addEventListener('click', el._onclick);
        });

        // blank slots: allow drop
        const slots = Array.from(document.querySelectorAll('.blank-slot'));
        slots.forEach(slot => {
          slot.addEventListener('dragover', (e) => {
            e.preventDefault();
            slot.classList.add('drag-over');
          });
          slot.addEventListener('dragleave', (e) => {
            slot.classList.remove('drag-over');
          });
          slot.addEventListener('drop', (e) => {
            e.preventDefault();
            slot.classList.remove('drag-over');
            const word = e.dataTransfer.getData('text/plain') || e.dataTransfer.getData('text/html');
            if(!word) return;
            // Determine blank id
            const blankId = slot.dataset.blankId;
            if(!blankId) return;
            // If this word is already used in another slot, free it
            Object.keys(state.answers).forEach(k => {
              if(state.answers[k] === word){
                delete state.answers[k];
              }
            });
            // If slot had a previous answer, free that bank word
            const prev = state.answers[blankId];
            if(prev){
              const prevEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === prev);
              if(prevEl){
                prevEl.classList.remove('used');
                prevEl.setAttribute('draggable','true');
                prevEl.addEventListener('click', prevEl._onclick);
              }
            }
            // mark bank word used
            const bankEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === word);
            if(bankEl){
              bankEl.classList.add('used');
              bankEl.setAttribute('draggable','false');
              // remove click to prevent double-placing
              bankEl.removeEventListener('click', bankEl._onclick);
            }
            // assign to state and re-render
            state.answers[blankId] = word;
            renderAll();
          });
        });
      }

      function showSprachbausteine2Options(slot){
        // highlight selected slot so click from bank knows target
        document.querySelectorAll('.blank-slot').forEach(s => s.classList.remove('selected-sprach'));
        slot.classList.add('selected-sprach');
        lastClickedSprachSlot = slot;
      }

      function selectSprachbausteine2FromBank(word){
        // choose target slot: prefer lastClicked, otherwise first empty
        let slot = lastClickedSprachSlot;
        if(!slot){
          slot = Array.from(document.querySelectorAll('.blank-slot')).find(s => {
            const id = s.dataset.blankId;
            return !state.answers[id];
          });
        }
        if(!slot) {
          // if none available, do nothing
          return;
        }
        const blankId = slot.dataset.blankId;
        // free previous occurrence of word
        Object.keys(state.answers).forEach(k => {
          if(state.answers[k] === word){
            delete state.answers[k];
          }
        });
        // free previous word in target slot
        const prev = state.answers[blankId];
        if(prev){
          const prevEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === prev);
          if(prevEl){
            prevEl.classList.remove('used');
            prevEl.setAttribute('draggable','true');
            if(prevEl._onclick) prevEl.addEventListener('click', prevEl._onclick);
          }
        }
        // mark selected bank word as used
        const bankEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === word);
        if(bankEl){
          bankEl.classList.add('used');
          bankEl.setAttribute('draggable','false');
          if(bankEl._onclick) try{ bankEl.removeEventListener('click', bankEl._onclick); }catch(e){}
        }
        // assign value
        state.answers[blankId] = word;
        try{ localStorage.setItem('lesenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        lastClickedSprachSlot = null;
        renderAll();
      }

      function selectOption(questionId, optionId){
        state.answers[questionId] = optionId;
        try{ localStorage.setItem('lesenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        renderAll();
      }

      function renderResults(){
        let resultsHTML = `<h2>Ergebnisse</h2>`;
        let totalCorrect = 0;
        let totalQuestions = 0;
        
        exam.sections.forEach(section => {
          resultsHTML += `<div class="result-item"><h3>${section.title}</h3>`;
          
          if(section.id === 's1'){
            section.texts.forEach(text => {
              totalQuestions++;
              const userAnswer = state.answers[text.id];
              const isCorrect = userAnswer === text.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>Text ${text.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's2'){
            section.questions.forEach(question => {
              totalQuestions++;
              const userAnswer = state.answers[question.id];
              const isCorrect = userAnswer === question.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>${question.text}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's3'){
            section.situations.forEach(situation => {
              totalQuestions++;
              const userAnswer = state.answers[situation.id];
              const correctText = section.texts.find(t => t.correctAnswer === situation.id);
              const isCorrect = userAnswer === (correctText ? correctText.id : null);
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>Situation ${situation.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's4'){
            section.fillBlanks.forEach(blank => {
              totalQuestions++;
              const userAnswer = state.answers[blank.id];
              const isCorrect = userAnswer === blank.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>L√ºcke ${blank.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's5'){
            section.fillBlanks2.forEach(blank => {
              totalQuestions++;
              const userAnswer = state.answers[blank.id];
              const isCorrect = userAnswer === blank.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>L√ºcke ${blank.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          }
          
          resultsHTML += `</div>`;
        });
        
        const percentage = totalQuestions > 0 ? Math.round((totalCorrect / totalQuestions) * 100) : 0;
        resultsHTML += `<div class="result-item"><h3>Gesamtergebnis: ${totalCorrect}/${totalQuestions} (${percentage}%)</h3></div>`;
        
        passageContentEl.innerHTML = resultsHTML;
        questionBodyEl.innerHTML = '';
        sectionNameEl.textContent = 'Ergebnisse';
        questionTitleEl.textContent = '';
      }

      /* ===== Event Listeners ===== */
      document.getElementById('prevBtn-lesen').addEventListener('click', ()=>{
        if(state.sectionIndex > 0){
          state.sectionIndex--;
          state.questionIndex = 0;
          renderAll();
        }
      });

      document.getElementById('nextBtn-lesen').addEventListener('click', ()=>{
        if(state.sectionIndex < exam.sections.length - 1){
          state.sectionIndex++;
          state.questionIndex = 0;
          renderAll();
        }
      });

      resultBtn.addEventListener('click', ()=>{
        state.showResults = !state.showResults;
        renderAll();
      });

      resetBtn.addEventListener('click', ()=>{
        if(confirm('M√∂chten Sie wirklich von neu beginnen? Alle Antworten werden gel√∂scht.')){
          state.answers = {};
          state.marked = {};
          state.showResults = false;
          resetTimer();
          renderAll();
        }
      });

      resetSectionBtn.addEventListener('click', resetCurrentSection);

      document.getElementById('saveBtn-lesen').addEventListener('click', ()=>{
        statusText.textContent = 'Gespeichert';
        setTimeout(()=>{statusText.textContent = 'Nicht gespeichert'}, 2000);
      });

      document.getElementById('submitBtn-lesen').addEventListener('click', ()=>{
        if(confirm('M√∂chten Sie die Pr√ºfung wirklich abgeben?')){
          state.showResults = true;
          renderAll();
        }
      });

      document.getElementById('nextBtn-lesen').addEventListener('click', ()=>{
        showPage('hoeren-page');
      });

      /* ===== Initialize ===== */
      updateTimerDisplay();
      renderAll();
      startTimer();
      
      // Expose functions to global scope for event handlers
      window._lesenState = state;
      window.lesenApp = {
        selectOption,
        markNoMatch,
        selectSprachbausteine1,
        selectSprachbausteine2FromBank
      };
    }

    // ===== H√ñREN PAGE FUNCTIONALITY =====
    function initHoerenPage() {
      /* ===== Self-contained exam (embedded) ===== */
      const exam = {
        id: "exam-h√∂rverstehen",
        durationSec: 17 * 60, // 17 minutes in seconds
        sections: [
          { 
            id: "h√∂rverstehen1", 
            title: "H√∂rverstehen, Teil 1", 
            points: 25,
            correctAnswers: { "41": "richtig", "42": "richtig", "43": "falsch", "44": "falsch", "45": "falsch" },
            questions: [
              {
                id: "41",
                text: "In der Europ√§ischen Union verzeichnet man weniger jugendliche Arbeitslose."
              },
              {
                id: "42", 
                text: "Das Bundesarbeitsministerium bem√ºht sich um ausl√§ndische Arbeitnehmer bestimmter Berufe."
              },
              {
                id: "43",
                text: "Die 'Lange Nacht der Musik' findet am Odeonsplatz in M√ºnchen statt."
              },
              {
                id: "44",
                text: "Im 'Tal der goldenen Mumien' wurden bisher fast 10.000 Tote gefunden."
              },
              {
                id: "45",
                text: "Die Gefahr schwerer Unwetter ist nun vorbei."
              }
            ]
          },
          { 
            id: "h√∂rverstehen2", 
            title: "H√∂rverstehen, Teil 2", 
            points: 25,
            correctAnswers: { "46": "falsch", "47": "richtig", "48": "falsch", "49": "falsch", "50": "falsch", "51": "falsch", "52": "falsch", "53": "falsch", "54": "richtig", "55": "richtig" },
            questions: [
              {
                id: "46",
                text: "Professor Steiner ist heute gar nicht mehr nerv√∂s, wenn er moderieren muss."
              },
              {
                id: "47",
                text: "Steiner vermittelt den Studierenden nicht nur theoretisches Wissen, sondern fordert auch, dass es praktisch angewendet wird."
              },
              {
                id: "48", 
                text: "Steiners Hobby ist es, experimentelle Filme zu machen."
              },
              {
                id: "49",
                text: "Journalisten sollten heute auf einzelne Medien spezialisiert sein."
              },
              {
                id: "50",
                text: "Sportjournalist zu werden, ist nach Steiners Ansicht heute fast ausgeschlossen."
              },
              {
                id: "51",
                text: "Journalisten sollten Lust haben, etwas zu entdecken."
              },
              {
                id: "52",
                text: "Steiner musste wegen einer Verletzung mit dem Fu√üballspielen aufh√∂ren."
              },
              {
                id: "53",
                text: "Steiner hat w√§hrend seines Journalistik-Studiums f√ºr das ZDF Fu√üballspiele moderiert."
              },
              {
                id: "54",
                text: "Steiner ist es wichtig, als Moderator den Sportlern gegen√ºber neutral zu bleiben."
              },
              {
                id: "55",
                text: "Steiner r√§t Abiturienten dazu, verschiedene berufliche M√∂glichkeiten zu."
              }
            ]
          },
          { 
            id: "h√∂rverstehen3", 
            title: "H√∂rverstehen, Teil 3", 
            points: 25,
            correctAnswers: { "56": "richtig", "57": "falsch", "58": "falsch", "59": "falsch", "60": "falsch" },
            questions: [
              {
                id: "56",
                text: "Bei der Deutschen Telefon KG bekommen Sie nur Auskunft zu Telefonapparaten dieses Unternehmens."
              },
              {
                id: "57",
                text: "Im Rahmen des ‚ÄûBR3 Aquarena Weekends‚Äù in Starnberg k√∂nnen Sie jeden Abend ein Feuerwerk betrachten."
              },
              {
                id: "58",
                text: "Die Trierer Domorganisten spielen am 6. Juli in Michelstadt."
              },
              {
                id: "59",
                text: "W√§hrend des Musikfestivals ‚ÄûSound of Frankfurt‚Äù ist die Benutzung der U- und S-Bahnen geb√ºhrenfrei."
              },
              {
                id: "60",
                text: "Sie haben eine ung√ºltige Serviceaufnummer gew√§hlt und werden daher automatisch weiterverbunden."
              }
            ]
          }
        ]
      };

      /* ===== State & DOM refs ===== */
      let state = { 
        sectionIndex: 0, 
        answers: {}, 
        remaining: exam.durationSec,
        showResults: false,
        timerStarted: false,
        timerInterval: null
      };
      
      const topTiles = document.getElementById('topTiles-hoeren');
      const contentContainer = document.getElementById('contentContainer-hoeren');
      const timerEl = document.getElementById('timer-hoeren');
      const statusText = document.getElementById('statusText-hoeren');

      /* ===== Timer Functions ===== */
      function startTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        
        state.timerStarted = true;
        state.timerInterval = setInterval(() => {
          if (state.remaining <= 0) {
            clearInterval(state.timerInterval);
            timerEl.textContent = 'Zeit abgelaufen';
            return;
          }
          state.remaining--;
          updateTimerDisplay();
        }, 1000);
      }

      function resetTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        state.remaining = exam.durationSec;
        state.timerStarted = false;
        updateTimerDisplay();
        startTimer();
      }

      function updateTimerDisplay() {
        const min = Math.floor(state.remaining / 60);
        const sec = state.remaining % 60;
        timerEl.textContent = `Verbleibende Zeit: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
      }

      /* ===== Render ===== */
      function renderTopTiles() { 
        topTiles.innerHTML = ''; 
        exam.sections.forEach((sec, idx) => { 
          const div = document.createElement('div'); 
          div.className = 'tile' + (idx === state.sectionIndex ? ' active' : '') + (isSectionDone(sec) ? ' done' : ''); 
          div.innerHTML = `<div>${sec.title}</div><div class="points">${sec.points} P</div>`; 
          div.onclick = () => { state.sectionIndex = idx; state.showResults = false; renderAll(); }; 
          topTiles.appendChild(div); 
        }); 
      }

      function isSectionDone(section) {
        const answers = state.answers[section.id];
        if (!answers) return false;
        
        // ÿ™ÿ≠ŸÇŸÇ ÿ•ÿ∞ÿß ÿ™ŸÖÿ™ ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ© ÿπŸÑŸâ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ© ŸÅŸä Ÿáÿ∞ÿß ÿßŸÑŸÇÿ≥ŸÖ
        const answeredQuestions = Object.keys(answers).length;
        const totalQuestions = section.questions.length;
        
        return answeredQuestions === totalQuestions;
      }

      function renderAll() {
        renderTopTiles();
        
        if (state.showResults) {
          renderResults();
          return;
        }
        
        renderListeningSection();
      }

      function renderListeningSection() {
        const section = exam.sections[state.sectionIndex];
        const currentAnswers = state.answers[section.id] || {};
        
        let contentHTML = `
          <div class="panel-title">${section.title}</div>
          <div class="instructions">
            Sie h√∂ren die Nachrichten. Entscheiden Sie beim H√∂ren, ob die Aussagen richtig oder falsch sind. 
            Sie h√∂ren die Nachrichten nur einmal. Sie haben jetzt 30 Sekunden, um die Aussagen zu lesen.
          </div>
          
          <div class="listening-task">
            <table class="true-false-table">
              <thead>
                <tr>
                  <th style="width: 10%">Nr.</th>
                  <th style="width: 60%">Aussage</th>
                  <th style="width: 30%">Ihre Antwort</th>
                </tr>
              </thead>
              <tbody>
        `;
        
        section.questions.forEach((question, index) => {
          const currentAnswer = currentAnswers[question.id] || '';
          contentHTML += `
            <tr>
              <td><strong>${question.id}</strong></td>
              <td class="question-text">${question.text}</td>
              <td>
                <div class="answer-options">
                  <label class="answer-option">
                    <input 
                      type="radio" 
                      name="q${section.id}_${question.id}" 
                      value="richtig" 
                      ${currentAnswer === 'richtig' ? 'checked' : ''}
                      onchange="window.hoerenApp.updateListeningAnswer('${section.id}', '${question.id}', this.value)"
                    >
                    Richtig
                  </label>
                  <label class="answer-option">
                    <input 
                      type="radio" 
                      name="q${section.id}_${question.id}" 
                      value="falsch" 
                      ${currentAnswer === 'falsch' ? 'checked' : ''}
                      onchange="window.hoerenApp.updateListeningAnswer('${section.id}', '${question.id}', this.value)"
                    >
                    Falsch
                  </label>
                </div>
              </td>
            </tr>
          `;
        });
        
        contentHTML += `
              </tbody>
            </table>
          </div>
        `;
        
        contentContainer.innerHTML = contentHTML;
      }

      function updateListeningAnswer(sectionId, questionId, answer) {
        if (!state.answers[sectionId]) {
          state.answers[sectionId] = {};
        }
        state.answers[sectionId][questionId] = answer;
        try{ localStorage.setItem('hoerenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        
        // ÿ•ÿπÿßÿØÿ© ÿπÿ±ÿ∂ ÿßŸÑÿ®ŸÑÿßÿ∑ÿßÿ™ ŸÑÿ™ÿ≠ÿØŸäÿ´ ÿ≠ÿßŸÑÿ© "ÿ™ŸÖ"
        renderTopTiles();
      }

      function renderResults() {
        let resultsHTML = `<div class="panel-title">Ergebnisse - H√∂rverstehen</div>`;
        
        exam.sections.forEach(section => {
          const userAnswers = state.answers[section.id] || {};
          let correctCount = 0;
          
          resultsHTML += `
            <div class="listening-task">
              <h3>${section.title} (${section.points} Punkte)</h3>
              <table class="true-false-table">
                <thead>
                  <tr>
                    <th style="width: 10%">Nr.</th>
                    <th style="width: 50%">Aussage</th>
                    <th style="width: 15%">Ihre Antwort</th>
                    <th style="width: 15%">Richtige Antwort</th>
                    <th style="width: 10%">Punkte</th>
                  </tr>
                </thead>
                <tbody>
          `;
          
          section.questions.forEach((question) => {
            const userAnswer = userAnswers[question.id] || '-';
            const correctAnswer = section.correctAnswers[question.id];
            const gotCorrect = userAnswer === correctAnswer;
            const points = gotCorrect ? "1" : "0";
            
            if (gotCorrect) correctCount++;
            
            const rowClass = gotCorrect ? 'correct-answer' : 'incorrect-answer';
            
            resultsHTML += `
              <tr class="${rowClass}">
                <td><strong>${question.id}</strong></td>
                <td class="question-text">${question.text}</td>
                <td>${userAnswer}</td>
                <td>${correctAnswer}</td>
                <td><strong>${points}</strong></td>
              </tr>
            `;
          });
          
          const totalPoints = Math.round((correctCount / section.questions.length) * section.points);
          
          resultsHTML += `
                </tbody>
              </table>
              <div style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 6px;">
                <strong>Erreichte Punkte: ${correctCount}/${section.questions.length} richtig = ${totalPoints}/${section.points} Punkten</strong>
              </div>
            </div>
          `;
        });
        
        contentContainer.innerHTML = resultsHTML;
      }

      /* ===== Event Listeners ===== */
      document.getElementById('prevBtn-hoeren').addEventListener('click', () => {
        if (state.sectionIndex > 0) {
          state.sectionIndex--;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('nextBtn-hoeren').addEventListener('click', () => {
        if (state.sectionIndex < exam.sections.length - 1) {
          state.sectionIndex++;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('resultBtn-hoeren').addEventListener('click', () => {
        state.showResults = !state.showResults;
        renderAll();
      });

      document.getElementById('resetBtn-hoeren').addEventListener('click', () => {
        if (confirm('M√∂chten Sie wirklich von neu beginnen? Alle Antworten werden gel√∂scht.')) {
          state.answers = {};
          state.showResults = false;
          resetTimer();
          renderAll();
        }
      });

      document.getElementById('saveBtn-hoeren').addEventListener('click', () => {
        statusText.textContent = 'Gespeichert';
        setTimeout(() => { statusText.textContent = 'Nicht gespeichert' }, 2000);
      });

      document.getElementById('submitBtn-hoeren').addEventListener('click', () => {
        if (confirm('M√∂chten Sie die Pr√ºfung wirklich abgeben?')) {
          state.showResults = true;
          renderAll();
        }
      });

      document.getElementById('nextBtn-hoeren').addEventListener('click', () => {
        showPage('schreiben-page');
      });

      /* ===== Initialize ===== */
      updateTimerDisplay();
      renderAll();
      startTimer();
      
      // Expose functions to global scope for event handlers
        window._hoerenState = state;
        window.hoerenApp = {
        updateListeningAnswer
      };
    }

    // ===== SCHREIBEN PAGE FUNCTIONALITY =====
    function initSchreibenPage() {
      /* ===== Self-contained exam (embedded) ===== */
      const exam = {
        id: "exam-002",
        durationSec: 30 * 60, // 30 minutes in seconds
        sections: [
          { 
            id: "s1", 
            title: "Schreiben, Teil 1", 
            points: 45,
            passageTitle: "Aufgabe: Schreiben Sie eine E-Mail",
            passage: "",
            writingTask: {
              prompt: `Kursbeschreibung

Sie haben an einem zweit√§gigen Kurs teilgenommen, der 120 Euro kostete. 
Der Kurs umfasste am ersten Tag eine Schulung, in der Sie lernen, sich professionell vorzustellen 
und zu kommunizieren sowie Ihre k√∂rperliche Leistungsf√§higkeit zu verbessern. 
Am zweiten Tag absolvieren Sie ein Praktikum, um das Gelernte aus der Schulung anzuwenden.`,
              requirements: [
                "Welche Erwartungen hatten Sie an den Kurs? Was haben Sie sich von der Teilnahme erhofft?",
                "Warum waren Sie mit diesem Kurs unzufrieden?",
                "Schreiben Sie einen Punkt Ihrer Wahl."
              ],
              wordCount: 0
            }
          }
        ]
      };

      /* ===== State & DOM refs ===== */
      let state = { 
        sectionIndex: 0, 
        answers: {}, 
        remaining: exam.durationSec,
        showResults: false,
        timerStarted: false,
        timerInterval: null
      };
      
      const topTiles = document.getElementById('topTiles-schreiben');
      const passageTitleEl = document.getElementById('passageTitle-schreiben');
      const passageContentEl = document.getElementById('passageContent-schreiben');
      const writingContainer = document.getElementById('writingContainer-schreiben');
      const timerEl = document.getElementById('timer-schreiben');
      const statusText = document.getElementById('statusText-schreiben');

      /* ===== Timer Functions ===== */
      function startTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        
        state.timerStarted = true;
        state.timerInterval = setInterval(() => {
          if (state.remaining <= 0) {
            clearInterval(state.timerInterval);
            timerEl.textContent = 'Zeit abgelaufen';
            return;
          }
          state.remaining--;
          updateTimerDisplay();
        }, 1000);
      }

      function resetTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        state.remaining = exam.durationSec;
        state.timerStarted = false;
        updateTimerDisplay();
        startTimer();
      }

      function updateTimerDisplay() {
        const min = Math.floor(state.remaining / 60);
        const sec = state.remaining % 60;
        timerEl.textContent = `Verbleibende Zeit: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
      }

      /* ===== Render ===== */
      function renderTopTiles() { 
        topTiles.innerHTML = ''; 
        exam.sections.forEach((sec, idx) => { 
          const div = document.createElement('div'); 
          div.className = 'tile' + (idx === state.sectionIndex ? ' active' : '') + (isSectionDone(sec) ? ' done' : ''); 
          div.innerHTML = `<div>${sec.title}</div><div class="points">${sec.points} P</div>`; 
          div.onclick = () => { state.sectionIndex = idx; state.showResults = false; renderAll(); }; 
          topTiles.appendChild(div); 
        }); 
      }

      function isSectionDone(section) {
        return state.answers[section.id] && state.answers[section.id].length > 0;
      }

      function renderAll() {
        renderTopTiles();
        const section = exam.sections[state.sectionIndex];
        passageTitleEl.textContent = section.passageTitle;
        
        if (state.showResults) {
          renderResults();
          return;
        }
        
        renderWritingSection();
      }

      function renderWritingSection() {
        const section = exam.sections[state.sectionIndex];
        
        // Render the prompt in left panel
        passageContentEl.innerHTML = `
          <div class="writing-task">
            <div class="writing-prompt">${section.writingTask.prompt}</div>
            <div class="instructions" style="border:1px solid #e1e8f6; padding:10px; margin:10px 0; border-radius:6px; background:#ffffff;">Sie haben an einem Kurs teilgenommen, jedoch waren Sie leider nicht zufrieden. 
Schreiben Sie eine Beschwerde an den Kursanbieter.</div>
            <div class="writing-requirements">
              <h4>Schreiben Sie in Ihrer E-Mail:</h4>
              <ul>
                ${section.writingTask.requirements.map(req => `<li>${req}</li>`).join('')}
              </ul>
            </div>
            <div class="instructions">
              Schreiben Sie eine E-Mail (ca. 150-200 W√∂rter). Achten Sie auf den Textaufbau (Anrede, Einleitung, Hauptteil, Schluss) und eine angemessene Formulierung.
            </div>
          </div>
        `;
        
        // Render writing area in right panel
        const currentAnswer = state.answers[section.id] || '';
        const wordCount = countWords(currentAnswer);
        
        writingContainer.innerHTML = `
          <div class="writing-area">
            <textarea 
              class="writing-textarea" 
              placeholder="Schreiben Sie hier Ihre E-Mail..."
              oninput="window.schreibenApp.updateWritingAnswer('${section.id}', this.value)"
            >${currentAnswer}</textarea>
            <div class="word-counter">
              W√∂rter: <span class="count">${wordCount}</span>
            </div>
          </div>
        `;
      }

      function countWords(text) {
        return text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
      }

      function updateWritingAnswer(sectionId, text) {
        state.answers[sectionId] = text;
        try{ localStorage.setItem('schreibenAnswers', JSON.stringify({content: state.answers[sectionId], wordCount: (state.answers[sectionId]||'').trim().split(/\s+/).filter(Boolean).length})); }catch(e){}
        
        const wordCount = countWords(text);
        document.querySelector('.word-counter .count').textContent = wordCount;
      }

      function renderResults() {
        let resultsHTML = `<h2>Ergebnisse</h2>`;
        
        exam.sections.forEach(section => {
          resultsHTML += `<div class="writing-task"><h3>${section.title}</h3>`;
          
          const userAnswer = state.answers[section.id];
          const wordCount = countWords(userAnswer);
          
          resultsHTML += `
            <div class="writing-requirements">
              <h4>Ihre Antwort (${wordCount} W√∂rter):</h4>
              <div style="white-space: pre-wrap; background: white; padding: 15px; border-radius: 6px; border: 1px solid #e1e8f6; margin-top: 10px;">${userAnswer || 'Keine Antwort'}</div>
            </div>
          `;
          
          resultsHTML += `</div>`;
        });
        
        passageContentEl.innerHTML = resultsHTML;
        writingContainer.innerHTML = '';
      }

      /* ===== Event Listeners ===== */
      document.getElementById('prevBtn-schreiben').addEventListener('click', () => {
        if (state.sectionIndex > 0) {
          state.sectionIndex--;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('nextBtn-schreiben').addEventListener('click', () => {
        if (state.sectionIndex < exam.sections.length - 1) {
          state.sectionIndex++;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('resultBtn-schreiben').addEventListener('click', () => {
        state.showResults = !state.showResults;
        renderAll();
      });

      document.getElementById('resetBtn-schreiben').addEventListener('click', () => {
        if (confirm('M√∂chten Sie wirklich von neu beginnen? Alle Antworten werden gel√∂schÿ™.')) {
          state.answers = {};
          state.showResults = false;
          resetTimer();
          renderAll();
        }
      });

      document.getElementById('saveBtn-schreiben').addEventListener('click', () => {
        statusText.textContent = 'Gespeichert';
        setTimeout(() => { statusText.textContent = 'Nicht gespeichert' }, 2000);
      });

      document.getElementById('submitBtn-schreiben').addEventListener('click', () => {
        if (confirm('M√∂chten Sie die Pr√ºfung wirklich abgeben?')) {
          state.showResults = true;
          renderAll();
        }
      });

      document.getElementById('nextBtn-schreiben').addEventListener('click', () => {
        showPage('ergebnisse-page');
      });

      /* ===== Initialize ===== */
      updateTimerDisplay();
      renderAll();
      startTimer();
      
      // Expose functions to global scope for event handlers
        window._schreibenState = state;
        window.schreibenApp = {
        updateWritingAnswer
      };
    }

    // ===== ERGEBNISSE PAGE FUNCTIONALITY =====
    function initErgebnissePage() {
      // ÿ•ÿ¨ÿßÿ®ÿßÿ™ ÿµÿ≠Ÿäÿ≠ÿ© - ÿ≥ÿ£ÿ≥ÿ™ÿÆÿØŸÖ ÿßŸÑÿ•ÿ¨ÿßÿ®ÿßÿ™ ŸÖŸÜ ÿßŸÑÿßŸÖÿ™ÿ≠ÿßŸÜ ÿßŸÑÿ£ÿµŸÑŸä
      const CORRECT_ANSWERS = {
        lesen: {
          // ÿßŸÑÿ¨ÿ≤ÿ° ÿßŸÑÿ£ŸàŸÑ: √úberschriften zuordnen (ÿßŸÑŸÜÿµŸàÿµ 1-5)
          "text1": "d",
          "text2": "g", 
          "text3": "b",
          "text4": "h",
          "text5": "i",
          
          // ÿßŸÑÿ¨ÿ≤ÿ° ÿßŸÑÿ´ÿßŸÜŸä: Fragen zum Text (ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ© s2q1-s2q5)
          "s2q1": "s2q1o2",
          "s2q2": "s2q2o3",
          "s2q3": "s2q3o3",
          "s2q4": "s2q4o3",
          "s2q5": "s2q5o1",
          
          // ÿßŸÑÿ¨ÿ≤ÿ° ÿßŸÑÿ´ÿßŸÑÿ´: Texte zuordnen (ÿßŸÑŸÖŸàÿßŸÇŸÅ 11-20)
          "11": "G",
          "12": "X",
          "13": "D",
          "14": "L",
          "15": "C",
          "16": "I",
          "17": "J",
          "18": "F",
          "19": "A",
          "20": "X",
          
          // Sprachbausteine Teil 1 (ÿßŸÑŸÅÿ±ÿßÿ∫ÿßÿ™ 21-30)
          "21": "dass",
          "22": "besch√§ftigen",
          "23": "doch",
          "24": "insbesondere",
          "25": "√ºberwiegend",
          "26": "fast",
          "27": "wenig",
          "28": "kommt",
          "29": "willst",
          "30": "m√∂glich",
          
          // Sprachbausteine Teil 2 (ÿßŸÑŸÅÿ±ÿßÿ∫ÿßÿ™ 31-40)
          "31": "ANSTATT",
          "32": "JEDE",
          "33": "GEGEN",
          "34": "DAVON",
          "35": "WILL",
          "36": "BILDEN",
          "37": "AUSGEHEN",
          "38": "SOLCHE",
          "39": "BEKOMMEN",
          "40": "MEISTENS"
        },
        
        hoeren: {
          // H√∂ren Teil 1 (ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ© 41-45)
          "41": "richtig",
          "42": "richtig",
          "43": "falsch",
          "44": "falsch",
          "45": "falsch",
          
          // H√∂ren Teil 2 (ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ© 46-55)
          "46": "falsch",
          "47": "richtig",
          "48": "falsch",
          "49": "falsch",
          "50": "falsch",
          "51": "falsch",
          "52": "falsch",
          "53": "falsch",
          "54": "richtig",
          "55": "richtig",
          
          // H√∂ren Teil 3 (ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ© 56-60)
          "56": "richtig",
          "57": "falsch",
          "58": "falsch",
          "59": "falsch",
          "60": "falsch"
        }
      };

      const CONFIG = {
        totals: { 
          lesen: 105, 
          hoeren: 75, 
          schreiben: 45, 
          gesamt: 225 
        },
        counts: { 
          lesen: 40, 
          hoeren: 20 
        }
      };

      // ===== ÿØŸàÿßŸÑ ŸÖÿ≥ÿßÿπÿØÿ© =====
      function normalizeAnswer(a) {
        if (a === null || a === undefined || a === '') return '-';
        let s = String(a).trim();
        if (s === '' || s === 'undefined') return '-';
        return s;
      }

      function escapeHtml(s) {
        return String(s)
          .replace(/&/g, '&amp;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;')
          .replace(/"/g, '&quot;')
          .replace(/'/g, '&#039;');
      }

      function getHeadingText(headingId) {
        if (!headingId || headingId === '-') return '-';
        const headings = {
          "a": "Das ideale Gem√ºse f√ºr schwer Arbeitende",
          "b": "Ein schlankes Gem√ºse f√ºr schlanke Leute",
          "c": "Gesundes Leben sch√ºtzt vor Zivilisationskrankheiten",
          "d": "Gesundheitsrisiken durch fettreiche Ern√§hrung",
          "e": "Kartoffelrezepte als Zeitungsbeilage",
          "f": "Pflanzliche Kosmetik f√ºr gesunde Haut",
          "g": "Tolle Figur durch ausgewogene Ern√§hrung",
          "h": "Von der Wildpflanze zum international gesch√§tzten Nahrungsmittel",
          "i": "WHO untersucht Zusammenhang von Krebs und Herzinfarkt"
        };
        return headings[headingId] || headingId;
      }

      function getOptionText(optionId) {
        if (!optionId || optionId === '-') return '-';
        const options = {
          "s2q1o1": "existiert eine Vielzahl von Kaffeer√∂stereien.",
          "s2q1o2": "gibt es only noch wenige traditionelle Kaffeer√∂stereien.",
          "s2q1o3": "handeln nur noch internationale Gesellschaften mit Kaffee.",
          "s2q2o1": "ist es nicht von Bedeutung, ob der Kaffee von Kleinbauern oder Gro√üplantagen kommt.",
          "s2q2o2": "spielt der g√ºnstige Einkaufspreis eine wichtige Rolle.",
          "s2q2o3": "steht aber die Qualit√§t des Kaffees als der Preis im Vordergrund.",
          "s2q3o1": "d√ºrfen nach dem R√∂sten zwar zu dunklen sein, aber nicht zu hell.",
          "s2q3o2": "k√∂nnen nach der R√∂stung ohne Geschmacksverlust lange Zeit gelagert werden.",
          "s2q3o3": "m√ºssen nach dem R√∂sten handverlesen werden, um eine gleichbleibend hohe Qualit√§t zu gew√§hrleisten.",
          "s2q4o1": "im Kontor nur an Stammkunden angegeben.",
          "s2q4o2": "in Handarbeit gemischt.",
          "s2q4o3": "zus√§tzlich online vermarktet.",
          "s2q5o1": "die Kaffeer√∂sterei in ein Museum umwandeln.",
          "s2q5o2": "ein Museum √ºber den Kaffeeanbau er√∂ffnen.",
          "s2q5o3": "keinen R√∂stkaffee mehr verkaufen."
        };
        return options[optionId] || optionId;
      }

      // ===== ŸÇÿ±ÿßÿ°ÿ© ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ =====
      function readExamResults() {
        try {
          const lesen = {};
          const hoeren = {};
          const schreiben = { content: '', wordCount: 0 };

          // ŸÇÿ±ÿßÿ°ÿ© ŸÖŸÜ ÿßŸÑÿ∞ÿßŸÉÿ±ÿ©
          try {
            if (window._lesenState && window._lesenState.answers) {
              Object.assign(lesen, window._lesenState.answers);
            }
          } catch (e) {}

          try {
            if (window._hoerenState && window._hoerenState.answers) {
              Object.keys(window._hoerenState.answers).forEach(sectionId => {
                Object.assign(hoeren, window._hoerenState.answers[sectionId]);
              });
            }
          } catch (e) {}

          try {
            if (window._schreibenState && window._schreibenState.answers) {
              const answers = window._schreibenState.answers;
              if (answers['s1']) {
                schreiben.content = answers['s1'];
              } else if (Object.keys(answers).length > 0) {
                schreiben.content = answers[Object.keys(answers)[0]];
              }
            }
          } catch (e) {}

          // ŸÇÿ±ÿßÿ°ÿ© ŸÖŸÜ localStorage ÿ•ÿ∞ÿß ŸÑÿ≤ŸÖ ÿßŸÑÿ£ŸÖÿ±
          try {
            if (Object.keys(lesen).length === 0) {
              const stored = localStorage.getItem('lesenAnswers');
              if (stored) Object.assign(lesen, JSON.parse(stored));
            }
          } catch (e) {}

          try {
            if (Object.keys(hoeren).length === 0) {
              const stored = localStorage.getItem('hoerenAnswers');
              if (stored) {
                const parsed = JSON.parse(stored);
                // ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ÿßŸÑÿ•ÿ¨ÿßÿ®ÿßÿ™ ŸÖŸÇÿ≥ŸÖÿ© ÿ≠ÿ≥ÿ® ÿßŸÑÿ£ŸÇÿ≥ÿßŸÖ
                if (parsed.h√∂rverstehen1 || parsed.h√∂rverstehen2 || parsed.h√∂rverstehen3) {
                  Object.keys(parsed).forEach(section => {
                    Object.assign(hoeren, parsed[section]);
                  });
                } else {
                  Object.assign(hoeren, parsed);
                }
              }
            }
          } catch (e) {}

          try {
            if (!schreiben.content) {
              const stored = localStorage.getItem('schreibenAnswers');
              if (stored) {
                const parsed = JSON.parse(stored);
                schreiben.content = parsed.content || '';
              }
            }
          } catch (e) {}

          // ÿ≠ÿ≥ÿßÿ® ÿπÿØÿØ ÿßŸÑŸÉŸÑŸÖÿßÿ™
          schreiben.wordCount = schreiben.content ? 
            schreiben.content.trim().split(/\s+/).filter(word => word.length > 0).length : 0;

          return { hoeren, lesen, schreiben };
        } catch (e) {
          return { hoeren: {}, lesen: {}, schreiben: {} };
        }
      }

      // ===== ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿØÿ±ÿ¨ÿßÿ™ =====
      function gradeHoeren(answers) {
        let okCount = 0;
        const details = [];
        
        for (let q = 41; q <= 60; q++) {
          const id = String(q);
          const userAnswer = normalizeAnswer(answers[id]);
          const correctAnswer = CORRECT_ANSWERS.hoeren[id] || '-';
          const isCorrect = userAnswer !== '-' && userAnswer.toLowerCase() === correctAnswer.toLowerCase();
          if (isCorrect) okCount++;
          
          details.push({
            id: id,
            user: userAnswer,
            correct: correctAnswer,
            isCorrect: isCorrect
          });
        }
        
        const total = (okCount * (CONFIG.totals.hoeren / CONFIG.counts.hoeren)).toFixed(2);
        return { okCount, total: parseFloat(total), details };
      }

      function gradeLesen(answers) {
        let okCount = 0;
        const details = [];
        
        Object.keys(CORRECT_ANSWERS.lesen).forEach(key => {
          const userAnswer = normalizeAnswer(answers[key]);
          const correctAnswer = CORRECT_ANSWERS.lesen[key] || '-';
          const isCorrect = userAnswer !== '-' && userAnswer.toLowerCase() === correctAnswer.toLowerCase();
          if (isCorrect) okCount++;
          
          details.push({
            id: key,
            user: userAnswer,
            correct: correctAnswer,
            isCorrect: isCorrect
          });
        });
        
        const total = (okCount * (CONFIG.totals.lesen / CONFIG.counts.lesen)).toFixed(2);
        return { okCount, total: parseFloat(total), details };
      }

      // ===== ÿ®ŸÜÿßÿ° ÿßŸÑÿ¨ÿØÿßŸàŸÑ =====
      function buildTable(title, details, total, max) {
        let html = `<div class="result-item">
                      <h3>${title} - ${total.toFixed(2)}/${max} Punkte</h3>
                      <table class="true-false-table">
                        <thead>
                          <tr>
                            <th style="width: 10%">Frage</th>
                            <th style="width: 40%">Ihre Antwort</th>
                            <th style="width: 40%">Richtige Antwort</th>
                            <th style="width: 10%">Ergebnis</th>
                          </tr>
                        </thead>
                        <tbody>`;
        
        details.forEach(item => {
          const rowClass = item.isCorrect ? 'correct-answer' : 'incorrect-answer';
          const resultIcon = item.isCorrect ? '‚úÖ Richtig' : '‚ùå Falsch';
          let userDisplay = item.user;
          let correctDisplay = item.correct;
          
          // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ±ŸÖŸàÿ≤ ÿ•ŸÑŸâ ŸÜÿµŸàÿµ ŸÑŸÑÿ¨ÿ≤ÿ° ÿßŸÑÿ£ŸàŸÑ ŸÖŸÜ ÿßŸÑŸÇÿ±ÿßÿ°ÿ©
          if (item.id.startsWith('text')) {
            userDisplay = getHeadingText(userDisplay);
            correctDisplay = getHeadingText(correctDisplay);
          }
          
          // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ±ŸÖŸàÿ≤ ÿ•ŸÑŸâ ŸÜÿµŸàÿµ ŸÑŸÑÿ¨ÿ≤ÿ° ÿßŸÑÿ´ÿßŸÜŸä ŸÖŸÜ ÿßŸÑŸÇÿ±ÿßÿ°ÿ©
          else if (item.id.startsWith('s2q')) {
            userDisplay = getOptionText(userDisplay);
            correctDisplay = getOptionText(correctDisplay);
          }
          
          html += `<tr class="${rowClass}">
                    <td><strong>${item.id}</strong></td>
                    <td>${escapeHtml(userDisplay)}</td>
                    <td>${escapeHtml(correctDisplay)}</td>
                    <td><strong>${resultIcon}</strong></td>
                  </tr>`;
        });
        
        html += `</tbody>
                </table>
                <div style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 6px;">
                  <strong>Erreichte Punkte: ${total.toFixed(2)}/${max} (${((total/max)*100).toFixed(1)}%)</strong>
                </div>
              </div>`;
        return html;
      }

      // ===== ÿπÿ±ÿ∂ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ =====
      function renderResults() {
        const results = readExamResults();
        const h = gradeHoeren(results.hoeren);
        const l = gradeLesen(results.lesen);
        
        const details = document.getElementById('details-ergebnisse');
        const tiles = document.getElementById('topTiles-ergebnisse');
        
        // ŸÇÿ±ÿßÿ°ÿ© ÿØÿ±ÿ¨ÿ© ÿßŸÑŸÉÿ™ÿßÿ®ÿ©
        const sScoreRaw = localStorage.getItem('schreibenScore');
        const sScore = sScoreRaw ? Number(sScoreRaw) : 0;

        // ÿ®ŸÜÿßÿ° ÿßŸÑÿ®ŸÑÿßÿ∑ÿßÿ™ ÿßŸÑÿπŸÑŸàŸäÿ©
        tiles.innerHTML = `
          <div class="results-tile">
            <h3>Lesen</h3>
            <div class="score">${l.total.toFixed(2)} / ${CONFIG.totals.lesen}</div>
            <div class="small-muted">${((l.total / CONFIG.totals.lesen) * 100).toFixed(1)}%</div>
          </div>
          <div class="results-tile">
            <h3>H√∂ren</h3>
            <div class="score">${h.total.toFixed(2)} / ${CONFIG.totals.hoeren}</div>
            <div class="small-muted">${((h.total / CONFIG.totals.hoeren) * 100).toFixed(1)}%</div>
          </div>
          <div class="results-tile">
            <h3>Schreiben</h3>
            <div class="score" id="schreibenScoreDisplay">${sScore.toFixed(2)} / ${CONFIG.totals.schreiben}</div>
            <div class="small-muted">Manuelle Eingabe</div>
          </div>
        `;

        // ÿ®ŸÜÿßÿ° ÿßŸÑÿ™ŸÅÿßÿµŸäŸÑ
        details.innerHTML = `
          <div class="result-item">
            <h2>üìä Detaillierte Ergebnisse</h2>
            <div class="instructions">Hier sehen Sie einen detaillierten Vergleich Ihrer Antworten mit den korrekten L√∂sungen.</div>
          </div>
          
          ${buildTable('Leseverstehen', l.details, l.total, CONFIG.totals.lesen)}
          
          ${buildTable('H√∂rverstehen', h.details, h.total, CONFIG.totals.hoeren)}
          
          <div class="result-item">
            <h3>‚úçÔ∏è Schreiben - Ihre Antwort</h3>
            <div class="small-muted">W√∂rter: ${results.schreiben.wordCount}</div>
            <div style="margin-top: 10px; padding: 15px; background: white; border-radius: 6px; border: 1px solid #e1e8f6; min-height: 100px;">
              ${results.schreiben.content ? escapeHtml(results.schreiben.content) : '<span class="small-muted">Keine Antwort</span>'}
            </div>
            <div style="margin-top: 15px; display: flex; gap: 10px; align-items: center;">
              Punkte eingeben (0‚Äì45): 
              <input id="sInput" type="number" min="0" max="45" step="0.5" value="${sScore}">
              <button id="saveS" class="results-btn">Speichern</button>
            </div>
          </div>
        `;

        // ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä
        const totalScore = l.total + h.total + sScore;
        const totalMax = CONFIG.totals.gesamt;
        const percentage = ((totalScore / totalMax) * 100).toFixed(2);
        
        document.getElementById('finalSummary-ergebnisse').innerHTML = `
          <div class="left">
            <strong>Gesamtpunktzahl:</strong><br>
            <span style="font-size: 24px; font-weight: bold;">${totalScore.toFixed(2)} / ${totalMax}</span><br>
            <span class="small-muted">Lesen + H√∂ren + Schreiben</span>
          </div>
          <div class="right">
            <strong>Prozentsatz:</strong><br>
            <span style="font-size: 24px; font-weight: bold;">${percentage}%</span><br>
            <span class="small-muted">von 100%</span>
          </div>
        `;

        // ÿ≠ÿØÿ´ ÿ≠ŸÅÿ∏ ÿØÿ±ÿ¨ÿ© ÿßŸÑŸÉÿ™ÿßÿ®ÿ©
        document.getElementById('saveS').onclick = function() {
          const newScore = Number(document.getElementById('sInput').value) || 0;
          localStorage.setItem('schreibenScore', newScore);
          
          // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿπÿ±ÿ∂
          document.getElementById('schreibenScoreDisplay').textContent = `${newScore.toFixed(2)} / ${CONFIG.totals.schreiben}`;
          
          // ÿ•ÿπÿßÿØÿ© ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä
          const newTotalScore = l.total + h.total + newScore;
          const newPercentage = ((newTotalScore / totalMax) * 100).toFixed(2);
          
          document.getElementById('finalSummary-ergebnisse').innerHTML = `
            <div class="left">
              <strong>Gesamtpunktzahl:</strong><br>
              <span style="font-size: 24px; font-weight: bold;">${newTotalScore.toFixed(2)} / ${totalMax}</span><br>
              <span class="small-muted">Lesen + H√∂ren + Schreiben</span>
            </div>
            <div class="right">
              <strong>Prozentsatz:</strong><br>
              <span style="font-size: 24px; font-weight: bold;">${newPercentage}%</span><br>
              <span class="small-muted">von 100%</span>
            </div>
          `;
          
          alert('Schreiben-Punkte wurden gespeichert!');
        };
      }

      // ===== ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑÿµŸÅÿ≠ÿ© =====
      document.getElementById('calcBtn-ergebnisse').onclick = renderResults;
      document.getElementById('backBtn-ergebnisse').onclick = function(e) {
        e.preventDefault();
        showPage('start-page');
      };
      
      // ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã
      renderResults();
    }
  </script>
</body>
</html>