<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Deutsch B2 Pr√ºfung - Komplet</title>
  <style>
    /* ===== GLOBAL STYLES ===== */
    :root {
      --primary-color: #1e3a5f;
      --secondary-color: #2c5282;
      --accent-color: #4da6ff;
      --light-color: #ebf8ff;
      --text-color: #2d3748;
      --white: #ffffff;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      --transition: all 0.3s ease;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      color: var(--white);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    button {
      cursor: pointer;
    }
    
    /* ===== START PAGE STYLES ===== */
    .start-container {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      padding: 20px;
      min-height: 100vh;
    }
    
    .start-content {
      max-width: 600px;
      width: 100%;
      background-color: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 40px;
      box-shadow: var(--shadow);
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .logo {
      margin-bottom: 20px;
    }
    
    .logo-icon {
      font-size: 48px;
      margin-bottom: 10px;
    }
    
    h1 {
      font-size: 32px;
      margin-bottom: 10px;
      font-weight: 700;
    }
    
    .subtitle {
      font-size: 18px;
      margin-bottom: 30px;
      opacity: 0.9;
    }
    
    .card {
      background-color: var(--white);
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: var(--shadow);
      color: var(--text-color);
    }
    
    .card h2 {
      font-size: 20px;
      margin-bottom: 15px;
      color: var(--primary-color);
    }
    
    .card p {
      margin-bottom: 20px;
      line-height: 1.5;
    }
    
    select {
      width: 100%;
      padding: 12px 16px;
      font-size: 16px;
      border-radius: 8px;
      border: 2px solid var(--accent-color);
      outline: none;
      background-color: var(--white);
      color: var(--text-color);
      cursor: pointer;
      transition: var(--transition);
    }
    
    select:focus {
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.3);
    }
    
    .timer-container {
      margin: 25px 0;
    }
    
    .timer-label {
      font-size: 16px;
      margin-bottom: 10px;
    }
    
    .timer {
      font-size: 48px;
      font-weight: 700;
      color: var(--accent-color);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }
    
    .progress-bar {
      height: 8px;
      width: 100%;
      background-color: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
      overflow: hidden;
      margin-top: 10px;
    }
    
    .progress {
      height: 100%;
      width: 100%;
      background-color: var(--accent-color);
      border-radius: 4px;
      transform: scaleX(1);
      transform-origin: left;
      transition: transform 1s linear;
    }
    
    .info-text {
      font-size: 14px;
      margin-top: 20px;
      opacity: 0.8;
    }
    
    .button-container {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }
    
    .btn {
      flex: 1;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      background-color: var(--accent-color);
      color: white;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }
    
    .btn:hover {
      background-color: #3399ff;
    }
    
    /* ===== EXAM PAGE STYLES ===== */
    .exam-body {
      background: #f5f5f5;
      color: #333;
      line-height: 1.45;
      -webkit-font-smoothing: antialiased;
    }
    
    /* Header Styles */
    header.topbar {
      background: #1e3a5f;
      color: #fff;
      padding: 12px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      min-height: 80px;
    }

    .brand {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .brand .logo {
      width: 80px;
      height: 40px;
      background: #e74c3c;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: white;
      font-size: 18px;
    }

    .meta .main-title {
      font-weight: 800;
      font-size: 18px;
    }

    .meta .sub-title {
      font-size: 13px;
      opacity: 0.9;
    }

    .timer {
      font-weight: 700;
      font-size: 18px;
      color: #fff;
      margin: 0 20px;
    }

    .buttons-grid {
      display: grid;
      grid-template-columns: repeat(2, auto);
      gap: 10px 20px;
    }

    .exam-btn {
      padding: 12px 20px;
      border-radius: 6px;
      border: none;
      background: #4da6ff;
      color: white;
      font-weight: 700;
      font-size: 15px;
      cursor: pointer;
      transition: background 0.2s ease-in-out;
      min-width: 150px;
      text-align: center;
    }

    .exam-btn:hover {
      background: #336fbf;
    }
    
    .exam-btn.save {
      background: #4da6ff;
      color: #000;
    }
    
    .exam-btn.save:hover {
      background: #3399ff;
    }
    
    .exam-btn.submit {
      background: #4da6ff;
    }
    
    .exam-btn.submit:hover {
      background: #3399ff;
    }
    
    .exam-btn.result {
      background: #4da6ff;
    }
    
    .exam-btn.result:hover {
      background: #3399ff;
    }
    
    .exam-btn.next {
      background: #4da6ff;
      color: #fff;
    }
    
    .exam-btn.next:hover {
      background: #3399ff;
    }
    
    .exam-btn.reset {
      background: #4da6ff;
    }
    
    .exam-btn.reset:hover {
      background: #3399ff;
    }
    
    .exam-btn.reset-section {
      background: #d35400;
      font-size: 12px;
      padding: 6px 10px;
      min-width: auto;
    }
    
    .exam-btn.reset-section:hover {
      background: #e67e22;
    }
    
    .exam-btn.no-match {
      background: #95a5a6;
      font-size: 12px;
      padding: 6px 10px;
      min-width: auto;
      margin-top: 5px;
    }
    
    .exam-btn.no-match:hover {
      background: #7f8c8d;
    }
    
    .exam-btn.no-match.selected {
      background: #e74c3c;
    }
    
    /* Top Tiles */
    .top-tiles {
      display: flex;
      justify-content: center;
      gap: 8px;
      padding: 8px 12px;
      background: #1e3a5f;
      border-bottom: 1px solid #0f223a;
    }
    
    .tile {
      flex: 1;
      max-width: 180px;
      text-align: center;
      padding: 12px;
      border-radius: 6px;
      border: 1px solid #ccc;
      background: #3b4a63;
      color: #fff;
      font-weight: 600;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 60px;
    }
    
    .tile:hover {
      background: #4a5b78;
    }
    
    .tile.active {
      background: #ffffff;
      color: #000;
      border-color: #bbb;
    }
    
    .tile.done {
      background: #2ecc71;
      color: #fff;
      border-color: #27ae60;
    }
    
    .tile.done::after {
      content: " ‚úÖ";
      margin-left: 5px;
    }
    
    .tile .points {
      background: rgba(255,255,255,0.2);
      padding: 4px 8px;
      border-radius: 12px;
      font-weight: 700;
      font-size: 11px;
      margin-top: 4px;
    }
    
    .tile.active .points {
      background: #e9eefc;
      color: #2c3e50;
    }
    
    /* Container Styles */
    .container {
      display: grid;
      grid-template-columns: 1fr 420px;
      gap: 16px;
      padding: 16px;
      max-width: 1200px;
      margin: 12px auto;
    }
    
    .container-full {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      padding: 16px;
      max-width: 1200px;
      margin: 12px auto;
    }
    
    .container-split {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      padding: 16px;
      max-width: 1200px;
      margin: 12px auto;
    }
    
    .left-panel {
      background: white;
      border-radius: 8px;
      padding: 18px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      max-height: 76vh;
      overflow: auto;
    }
    
    .left-panel .passage {
      font-size: 14px;
      color: #2c3e50;
      line-height: 1.8;
    }
    
    .left-panel h2 {
      font-size: 16px;
      margin-bottom: 10px;
    }
    
    .right-panel {
      background: white;
      border-radius: 8px;
      padding: 12px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      display: flex;
      flex-direction: column;
      gap: 12px;
      max-height: 76vh;
      overflow: auto;
    }
    
    .main-panel {
      background: white;
      border-radius: 8px;
      padding: 25px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      max-height: 76vh;
      overflow: auto;
    }
    
    .panel-title {
      font-size: 18px;
      margin-bottom: 15px;
      color: #1e3a5f;
      font-weight: 700;
    }
    
    /* Question Styles */
    .question-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }
    
    .question-body {
      margin-top: 8px;
    }
    
    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .option {
      background: #fbfdff;
      border: 1px solid #e1e8f6;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .option:hover {
      background: #f0f6ff;
    }
    
    .option.selected {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .option .radio {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      border: 2px solid #cfdff6;
      background: #fff;
      display: inline-block;
      flex-shrink: 0;
    }
    
    .option.selected .radio {
      background: #3498db;
      border-color: #3498db;
      box-shadow: inset 0 -3px 0 rgba(0,0,0,0.05);
    }
    
    .text-container {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
      position: relative;
      min-height: 120px;
    }
    
    .text-container:hover {
      background: #f0f6ff;
    }
    
    .text-title {
      font-weight: 700;
      margin-bottom: 8px;
      color: #2c3e50;
    }
    
    .text-content {
      font-size: 14px;
      color: #2c3e50;
      line-height: 1.6;
    }
    
    .title-slot {
      min-height: 40px;
      margin-top: 10px;
      padding: 8px;
      border: 2px dashed #c8d9f6;
      border-radius: 6px;
      background: #f8fbff;
    }
    
    .title-slot.has-title {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .title-slot.has-x {
      background: #f8d7da;
      border-color: #e74c3c;
      color: #c0392b;
      font-weight: bold;
    }
    
    .headings-bank {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 0;
    }
    
    .heading-item {
      padding: 10px;
      border: 1px solid #dbe7fb;
      border-radius: 8px;
      background: #f8fbff;
      cursor: grab;
    }
    
    .heading-item:hover {
      background: #e9f0ff;
    }
    
    .heading-item.used {
      opacity: 0.5;
      cursor: not-allowed;
      background: #f8d7da;
      border-color: #f5c6cb;
    }
    
    .result-correct {
      color: #27ae60;
      font-weight: bold;
    }
    
    .result-incorrect {
      color: #c0392b;
      font-weight: bold;
    }
    
    .result-item {
      margin: 10px 0;
      padding: 10px;
      border-radius: 6px;
      background: #f8f9fa;
    }
    
    .instructions {
      color: #7f8c8d;
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 15px;
    }
    
    .question-text {
      font-weight: 600;
      margin-bottom: 15px;
      font-size: 15px;
      color: #2c3e50;
    }
    
    .all-questions {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    
    .question-block {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .texts-list, .situations-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .text-item, .situation-item {
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .text-letter {
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 8px;
    }
    
    .situation-number {
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 8px;
    }
    
    .fill-blank-container {
      margin: 20px 0;
    }
    
    .blank-word {
      display: inline-block;
      min-width: 120px;
      padding: 4px 8px;
      margin: 0 6px;
      background: #fff;
      cursor: pointer;
      position: relative;
      border: 1px solid #dbe7fb;
      border-radius: 4px;
    }
    
    .blank-word.has-answer {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .options-popup {
      position: absolute;
      top: 100%;
      left: 0;
      background: white;
      border: 1px solid #dbe7fb;
      border-radius: 6px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      z-index: 100;
      min-width: 150px;
    }
    
    .option-item {
      padding: 8px 12px;
      cursor: pointer;
      border-bottom: 1px solid #f0f4fb;
    }
    
    .option-item:hover {
      background: #f0f6ff;
    }
    
    .option-item:last-child {
      border-bottom: none;
    }
    
    .horizontal-options {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .option-row {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 10px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .option-number {
      font-weight: bold;
      color: #2c3e50;
      min-width: 30px;
    }
    
    .option-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .option-btn {
      padding: 8px 16px;
      border: 1px solid #dbe7fb;
      border-radius: 6px;
      background: #f8fbff;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .option-btn:hover {
      background: #e9f0ff;
    }
    
    .option-btn.selected {
      background: #3498db;
      color: white;
      border-color: #3498db;
    }
    
    .word-bank-vertical {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .bank-word-vertical {
      padding: 10px;
      border: 1px solid #dbe7fb;
      border-radius: 6px;
      background: #f8fbff;
      text-align: center;
      cursor: grab;
    }
    
    .bank-word-vertical.used {
      opacity: 0.5;
      cursor: not-allowed;
      background: #f8d7da;
      border-color: #f5c6cb;
    }
    
    .blank-slot {
      display: inline-block;
      min-width: 100px;
      padding: 4px 8px;
      margin: 0 6px;
      background: #fff;
      min-height: 30px;
      vertical-align: middle;
      border: 1px solid #dbe7fb;
      border-radius: 4px;
      cursor: pointer;
    }
    
    .blank-slot.has-answer {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .footer-buttons {
      display: flex;
      gap: 10px;
    }
    
    .situation-item.used {
      opacity: 0.7;
      cursor: not-allowed;
      background: #f8d7da;
      border-color: #f5c6cb;
      color: #333;
    }
    
    /* Listening Section Styles */
    .listening-task {
      margin-bottom: 10px;
    }
    
    .true-false-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      font-size: 14px;
    }
    
    .true-false-table th {
      background: #3498db;
      color: white;
      padding: 15px;
      text-align: left;
      font-weight: 600;
      font-size: 14px;
    }
    
    .true-false-table td {
      padding: 15px;
      border-bottom: 1px solid #e1e8f6;
      vertical-align: top;
    }
    
    .true-false-table tr:nth-child(even) {
      background: #f8f9fa;
    }
    
    .true-false-table tr:hover {
      background: #e3f2fd;
    }
    
    .answer-options {
      display: flex;
      gap: 25px;
    }
    
    .answer-option {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      padding: 10px 15px;
      border-radius: 4px;
      transition: background 0.2s;
      font-weight: 500;
    }
    
    .answer-option:hover {
      background: #e3f2fd;
    }
    
    .answer-option input {
      margin: 0;
      transform: scale(1.2);
    }

    .correct-answer {
      background: #d4edda !important;
      border-left: 4px solid #28a745;
    }
    
    .incorrect-answer {
      background: #f8d7da !important;
      border-left: 4px solid #dc3545;
    }
    
    /* Writing Section Styles */
    .writing-task {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .writing-prompt {
      font-size: 14px;
      color: #2c3e50;
      line-height: 1.6;
      margin-bottom: 15px;
    }
    
    .writing-requirements {
      background: #f8f9fa;
      padding: 12px;
      border-radius: 6px;
      border-left: 4px solid #3498db;
      margin-bottom: 15px;
    }
    
    .writing-requirements h4 {
      margin: 0 0 8px 0;
      color: #2c3e50;
    }
    
    .writing-requirements ul {
      margin: 0;
      padding-left: 20px;
    }
    
    .writing-requirements li {
      margin-bottom: 5px;
      color: #2c3e50;
    }
    
    .writing-area {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    
    .writing-textarea {
      flex: 1;
      min-height: 500px;
      padding: 15px;
      border: 2px solid #e1e8f6;
      border-radius: 8px;
      font-size: 14px;
      line-height: 1.6;
      resize: vertical;
      font-family: Arial, sans-serif;
    }
    
    .writing-textarea:focus {
      outline: none;
      border-color: #3498db;
    }
    
    .word-counter {
      margin-top: 10px;
      text-align: right;
      font-size: 13px;
      color: #7f8c8d;
      padding: 8px 0;
    }
    
    .word-counter .count {
      font-weight: bold;
      color: #2c3e50;
    }
    
    /* Results Page Styles */
    .results-body {
      background: #f7fafc;
      color: #0f1724;
      line-height: 1.6;
    }
    
    .results-header {
      background: #1e3a5f;
      color: #fff;
      padding: 18px 20px;
      display: flex;
      align-items: center;
      gap: 16px;
    }
    
    .results-logo {
      background: #fff;
      color: #1e3a5f;
      padding: 8px 12px;
      border-radius: 6px;
      font-weight: 800;
    }
    
    .results-title {
      font-size: 18px;
      font-weight: 700;
    }
    
    .results-container {
      max-width: 1100px;
      margin: 22px auto;
      padding: 20px;
    }
    
    .results-tiles {
      display: flex;
      gap: 12px;
      margin: 18px 0;
    }
    
    .results-tile {
      flex: 1;
      background: #fff;
      border-radius: 10px;
      padding: 16px;
      box-shadow: 0 6px 18px rgba(2, 6, 23, 0.06);
      border-left: 6px solid #1e3a5f;
    }
    
    .results-tile h3 {
      margin: 0;
      font-size: 16px;
      color: #1e3a5f;
    }
    
    .results-tile .score {
      font-size: 20px;
      font-weight: 800;
      margin-top: 8px;
    }
    
    .section-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
    }
    
    .section-table th,
    .section-table td {
      padding: 8px;
      border-bottom: 1px solid #e6eef8;
      text-align: left;
      font-size: 14px;
    }
    
    .summary {
      background: #fff;
      padding: 16px;
      border-radius: 10px;
      margin-top: 18px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .summary .left {
      font-weight: 700;
    }
    
    .summary .right {
      text-align: right;
    }
    
    .controls {
      display: flex;
      gap: 10px;
      margin-top: 18px;
    }
    
    .results-btn {
      background: #4da6ff;
      border: none;
      color: #fff;
      padding: 10px 14px;
      border-radius: 8px;
      font-weight: 700;
      cursor: pointer;
      transition: background 0.3s;
    }
    
    .results-btn:hover {
      background: #3a8ce0;
    }
    
    .button-like {
      text-decoration: none;
    }
    
    .small-muted {
      color: #6b7280;
      font-size: 13px;
    }
    
    input[type="number"] {
      width: 90px;
      padding: 8px;
      border: 1px solid #d7e6fb;
      border-radius: 6px;
    }
    
    .note {
      font-size: 13px;
      color: #6b7280;
      margin-top: 8px;
    }
    
    /* Footer */
    footer.controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: white;
      border-top: 1px solid #e1e8f6;
      margin-top: 20px;
    }
    
    .status {
      font-size: 14px;
      color: #7f8c8d;
    }
    
    .ghost {
      background: transparent;
      border: 2px solid #2c3e50;
      color: #2c3e50;
    }
    
    .ghost:hover {
      background: #2c3e50;
      color: white;
    }

    /* Responsive Styles */
    @media (max-width: 980px) {
      .container {
        grid-template-columns: 1fr;
        padding: 12px;
      }
      
      .container-split {
        grid-template-columns: 1fr;
      }
      
      .right-panel {
        order: 2;
      }
      
      .top-tiles {
        padding-left: 8px;
        padding-right: 8px;
      }
      
      header.topbar {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }
      
      .buttons-grid {
        grid-template-columns: 1fr;
      }
      
      .answer-options {
        flex-direction: column;
        gap: 10px;
      }
      
      footer.controls {
        flex-direction: column;
        gap: 15px;
      }
      
      .results-tiles {
        flex-direction: column;
      }
      
      .summary {
        flex-direction: column;
        gap: 10px;
        text-align: center;
      }
      
      .controls {
        flex-direction: column;
      }
    }
    
    @media (max-width: 600px) {
      .start-content {
        padding: 25px 20px;
      }
      
      h1 {
        font-size: 28px;
      }
      
      .card {
        padding: 20px 15px;
      }
    }
    
    /* === ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿÆÿßÿµÿ© ŸÑŸÑŸáŸàÿßÿ™ŸÅ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© ÿ¨ÿØÿß === */
    @media (max-width: 480px) {
      /* 1. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ≠ÿßŸàŸäÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© */
      .container, .container-split, .container-full {
        grid-template-columns: 1fr !important;
        padding: 8px !important;
        gap: 10px !important;
      }
      
      /* 2. ÿ¨ÿπŸÑ ÿßŸÑŸÑŸàÿ≠ÿßÿ™ (panels) ÿ™ÿ£ÿÆÿ∞ ÿπÿ±ÿ∂ ŸÉÿßŸÖŸÑ */
      .left-panel, .right-panel, .main-panel {
        max-height: none !important;
        height: auto !important;
        overflow: visible !important;
        margin-bottom: 10px;
      }
      
      /* 3. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸáŸäÿØÿ± */
      .topbar {
        flex-direction: column !important;
        align-items: stretch !important;
        padding: 10px !important;
      }
      
      .brand {
        justify-content: center;
        margin-bottom: 10px;
      }
      
      /* 4. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ± ŸÅŸä ÿßŸÑŸáŸäÿØÿ± */
      .buttons-grid {
        grid-template-columns: 1fr !important;
        width: 100%;
      }
      
      .exam-btn {
        width: 100% !important;
        margin: 2px 0 !important;
        font-size: 14px !important;
        padding: 12px 8px !important;
      }
      
      /* 5. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ™ÿßŸäŸÑÿßÿ™ */
      .top-tiles {
        flex-wrap: wrap;
        justify-content: center;
      }
      
      .tile {
        flex: 0 0 calc(33% - 5px) !important;
        max-width: calc(33% - 5px) !important;
        margin: 2px;
        font-size: 11px !important;
        padding: 8px 4px !important;
      }
      
      /* 6. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÜÿµŸàÿµ */
      .passage, .text-content, .question-text {
        font-size: 15px !important;
        line-height: 1.5 !important;
      }
      
      /* 7. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™ */
      .option {
        padding: 12px 10px !important;
        margin: 4px 0 !important;
      }
      
      /* 8. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ¨ÿØÿßŸàŸÑ True/False */
      .true-false-table {
        display: block;
        overflow-x: auto;
        white-space: nowrap;
      }
      
      /* 9. ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑŸÉÿ™ÿßÿ®ÿ© */
      .writing-textarea {
        min-height: 300px !important;
        font-size: 16px !important;
      }
      
      /* 10. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÅŸàÿ™ÿ± */
      footer.controls {
        flex-direction: column !important;
        gap: 10px !important;
      }
      
      .footer-buttons {
        width: 100%;
        display: flex;
        gap: 5px;
      }
      
      .footer-buttons .exam-btn {
        flex: 1;
      }
      
      /* 11. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ */
      .results-tiles {
        flex-direction: column !important;
      }
      
      .results-tile {
        margin-bottom: 10px;
      }
    }

    /* === ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÑŸÑŸáŸàÿßÿ™ŸÅ ÿßŸÑŸÖÿ™Ÿàÿ≥ÿ∑ÿ© === */
    @media (min-width: 481px) and (max-width: 768px) {
      .container, .container-split {
        grid-template-columns: 1fr !important;
      }
      
      .tile {
        max-width: 180px !important;
      }
    }
  </style>
</head>
<body id="body">
  <!-- Start Page -->
  <div id="start-page" class="start-container">
    <div class="start-content">
      <div class="logo">
        <div class="logo-icon">üìù</div>
        <h1>Deutsch B2 Pr√ºfung</h1>
        <div class="subtitle">Bereiten Sie sich auf Ihre Pr√ºfung vor</div>
      </div>
      <div class="card">
        <h2>Pr√ºfungsbereich ausw√§hlen</h2>
        <p>W√§hlen Sie bitte den Bereich aus, den Sie √ºben m√∂chten. Die Pr√ºfung startet automatisch in <span id="time-display">30</span> Sekunden.</p>
        <select id="sectionSelect">
          <option value="lesen">Lesen</option>
          <option value="hoeren">H√∂ren</option>
          <option value="schreiben">Schreiben</option>
        </select>
        <div class="button-container">
          <button id="cancelBtn" class="btn">Abbrechen</button>
          <button id="startBtn" class="btn">Jetzt starten</button>
        </div>
      </div>
      <div class="timer-container">
        <div class="timer-label">Die Pr√ºfung startet in:</div>
        <div class="timer" id="countdown">30</div>
        <div class="progress-bar">
          <div class="progress" id="progress"></div>
        </div>
      </div>
      <div class="info-text">Stellen Sie sicher, dass Sie in einer ruhigen Umgebung sind und gen√ºgend Zeit haben.</div>
    </div>
  </div>

  <!-- Lesen Page -->
  <div id="lesen-page" class="exam-page" style="display: none;">
    <header class="topbar" role="banner">
      <div class="brand">
        <div class="logo">test</div>
        <div class="meta">
          <div class="main-title">Deutsch - B2 (√úbung)</div>
          <div class="sub-title">Lesen ‚Äî Testbeispiel</div>
        </div>
      </div>

      <div id="timer-lesen" class="timer" aria-live="polite">Verbleibende Zeit: 90:00</div>

      <div class="buttons-grid">
        <button id="resetBtn-lesen" class="exam-btn reset">üîÑ Von neu beginnen</button>
        <button id="saveBtn-lesen" class="exam-btn save">üìã Speichern</button>
        <button id="resultBtn-lesen" class="exam-btn result">üìä Ergebnis</button>
        <button id="submitBtn-lesen" class="exam-btn submit">üèÅ Abgabe</button>
        <button class="exam-btn next" id="nextBtn-lesen">‚û°Ô∏è N√§chste Pr√ºfung</button>
      </div>
    </header>

    <div class="top-tiles" id="topTiles-lesen" role="navigation" aria-label="Sections overview"></div>

    <div class="container">
      <main class="left-panel" id="leftPanel-lesen">
        <div class="passage" id="passage-lesen">
          <h2 id="passageTitle-lesen">Aufgabe</h2>
          <div id="passageContent-lesen"></div>
        </div>
      </main>

      <aside class="right-panel" id="rightPanel-lesen" aria-labelledby="questionTitle-lesen">
        <div class="question-head">
          <div>
            <div id="sectionName-lesen" style="font-weight:800"></div>
            <div id="questionTitle-lesen" style="font-size:13px;color:#55607a">Frage</div>
          </div>
          <button id="resetSectionBtn-lesen" class="exam-btn reset-section" style="display:none;">Teil zur√ºcksetzen</button>
        </div>
        <div class="question-body" id="questionBody-lesen"></div>
        <div id="headingsBankContainer-lesen"></div>
      </aside>
    </div>

    <footer class="controls">
      <div class="footer-buttons">
        <button id="prevBtn-lesen" class="exam-btn ghost">Zur√ºck</button>
        <button id="nextBtn-lesen" class="exam-btn ghost">Weiter</button>
      </div>
      <div class="status"><span id="statusText-lesen">Nicht gespeichert</span></div>
    </footer>
  </div>

  <!-- H√∂ren Page -->
  <div id="hoeren-page" class="exam-page" style="display: none;">
    <header class="topbar" role="banner">
      <div class="brand">
        <div class="logo">test</div>
        <div class="meta">
          <div class="main-title">Deutsch - B2 (√úbung)</div>
          <div class="sub-title">H√∂rverstehen ‚Äî Testbeispiel</div>
        </div>
      </div>

      <div id="timer-hoeren" class="timer" aria-live="polite">Verbleibende Zeit: 17:00</div>

      <div class="buttons-grid">
        <button id="resetBtn-hoeren" class="exam-btn reset">üîÑ Von neu beginnen</button>
        <button id="saveBtn-hoeren" class="exam-btn save">üìã Speichern</button>
        <button id="resultBtn-hoeren" class="exam-btn result">üìä Ergebnis</button>
        <button id="submitBtn-hoeren" class="exam-btn submit">üèÅ Abgabe</button>
        <button class="exam-btn next" id="nextBtn-hoeren">‚û°Ô∏è N√§chste Pr√ºfung</button>
      </div>
    </header>

    <div class="top-tiles" id="topTiles-hoeren" role="navigation" aria-label="Sections overview"></div>

    <div class="container-full">
      <main class="main-panel" id="mainPanel-hoeren">
        <div id="contentContainer-hoeren"></div>
      </main>
    </div>

    <footer class="controls">
      <div class="footer-buttons">
        <button id="prevBtn-hoeren" class="exam-btn ghost">Zur√ºck</button>
        <button id="nextBtn-hoeren" class="exam-btn ghost">Weiter</button>
      </div>
      <div class="status"><span id="statusText-hoeren">Nicht gespeichert</span></div>
    </footer>
  </div>

  <!-- Schreiben Page -->
  <div id="schreiben-page" class="exam-page" style="display: none;">
    <header class="topbar" role="banner">
      <div class="brand">
        <div class="logo">test</div>
        <div class="meta">
          <div class="main-title">Deutsch - B2 (√úbung)</div>
          <div class="sub-title">Schreiben ‚Äî Testbeispiel</div>
        </div>
      </div>

      <div id="timer-schreiben" class="timer" aria-live="polite">Verbleibende Zeit: 30:00</div>

      <div class="buttons-grid">
        <button id="resetBtn-schreiben" class="exam-btn reset">üîÑ Von neu beginnen</button>
        <button id="saveBtn-schreiben" class="exam-btn save">üìã Speichern</button>
        <button id="resultBtn-schreiben" class="exam-btn result">üìä Ergebnis</button>
        <button id="submitBtn-schreiben" class="exam-btn submit">üèÅ Abgabe</button>
        <button class="exam-btn next" id="nextBtn-schreiben">‚û°Ô∏è N√§chste Pr√ºfung</button>
      </div>
    </header>

    <div class="top-tiles" id="topTiles-schreiben" role="navigation" aria-label="Sections overview"></div>

    <div class="container-split">
      <main class="left-panel" id="leftPanel-schreiben">
        <div class="passage" id="passage-schreiben">
          <h2 id="passageTitle-schreiben">Aufgabe</h2>
          <div id="passageContent-schreiben"></div>
        </div>
      </main>

      <aside class="right-panel" id="rightPanel-schreiben">
        <div id="writingContainer-schreiben"></div>
      </aside>
    </div>

    <footer class="controls">
      <div class="footer-buttons">
        <button id="prevBtn-schreiben" class="exam-btn ghost">Zur√ºck</button>
        <button id="nextBtn-schreiben" class="exam-btn ghost">Weiter</button>
      </div>
      <div class="status"><span id="statusText-schreiben">Nicht gespeichert</span></div>
    </footer>
  </div>

  <!-- Ergebnisse Page -->
  <div id="ergebnisse-page" class="results-page" style="display: none;">
    <header class="results-header">
      <div class="results-logo">test</div>
      <div class="results-title">Gesamtergebnis ‚Äî Deutsch B2</div>
    </header>

    <div class="results-container">
      <div class="results-tiles" id="topTiles-ergebnisse"></div>
      <div id="details-ergebnisse"></div>
      <div class="summary" id="finalSummary-ergebnisse"></div>
      <div class="controls">
        <a class="button-like" href="#" id="backBtn-ergebnisse">
          <button class="results-btn">üîÅ Zur√ºck zur Startseite</button>
        </a>
        <button id="calcBtn-ergebnisse" class="results-btn">‚úÖ Ergebnisse anzeigen</button>
      </div>
      <div class="note">Hinweis: Schreiben (45 Punkte) wird manuell eingegeben, falls nicht automatisch vorhanden.</div>
    </div>
  </div>

  <script>
    // ===== PAGE NAVIGATION =====
    function showPage(pageId) {
      // Hide all pages
      document.getElementById('start-page').style.display = 'none';
      document.getElementById('lesen-page').style.display = 'none';
      document.getElementById('hoeren-page').style.display = 'none';
      document.getElementById('schreiben-page').style.display = 'none';
      document.getElementById('ergebnisse-page').style.display = 'none';
      
      // Change body class based on page
      document.getElementById('body').className = '';
      if (pageId === 'ergebnisse-page') {
        document.getElementById('body').className = 'results-body';
      } else if (pageId !== 'start-page') {
        document.getElementById('body').className = 'exam-body';
      }
      
      // Show selected page
      document.getElementById(pageId).style.display = 'block';
      
      // Initialize the page if needed
      if (pageId === 'lesen-page' && typeof initLesenPage === 'function') {
        initLesenPage();
      } else if (pageId === 'hoeren-page' && typeof initHoerenPage === 'function') {
        initHoerenPage();
      } else if (pageId === 'schreiben-page' && typeof initSchreibenPage === 'function') {
        initSchreibenPage();
      } else if (pageId === 'ergebnisse-page' && typeof initErgebnissePage === 'function') {
        initErgebnissePage();
      }
    }

    // ===== START PAGE FUNCTIONALITY =====
    let initialCounter = 30;
    let counter = initialCounter;
    let countdownInterval;
    let countdownRunning = false;
    let examStarted = false;
    const timerEl = document.getElementById("countdown");
    const timeDisplayEl = document.getElementById("time-display");
    const progressEl = document.getElementById("progress");
    const selectEl = document.getElementById("sectionSelect");
    const startBtn = document.getElementById("startBtn");
    const cancelBtn = document.getElementById("cancelBtn");

    function startCountdown() {
      // prevent double-starts or starting after exam already began
      if (countdownRunning || examStarted) return;
      countdownRunning = true;
      // disable start button while counting
      try { startBtn.disabled = true; startBtn.setAttribute('aria-disabled','true'); } catch(e){}
      // reset counter & UI
      counter = initialCounter;
      timerEl.textContent = counter;
      timeDisplayEl.textContent = counter;
      progressEl.style.transform = "scaleX(0)";
      timerEl.style.color = "";

      countdownInterval = setInterval(() => {
        counter--;
        timerEl.textContent = counter;
        timeDisplayEl.textContent = counter;
        const progressValue = (initialCounter - counter) / initialCounter;
        progressEl.style.transform = `scaleX(${progressValue})`;
        if (counter <= 0) {
          clearInterval(countdownInterval);
          countdownInterval = null;
          countdownRunning = false;
          progressEl.style.transform = "scaleX(1)";
          // ensure exam starts only once
          if (!examStarted) {
            examStarted = true;
            startExam();
          }
          // safety: re-enable start button (page usually navigates away)
          try { startBtn.disabled = false; startBtn.removeAttribute('aria-disabled'); } catch(e){}
        }
      }, 1000);
    }

    function stopCountdown(reset = true) {
      if (countdownInterval) {
        clearInterval(countdownInterval);
        countdownInterval = null;
      }
      countdownRunning = false;
      try { startBtn.disabled = false; startBtn.removeAttribute('aria-disabled'); } catch(e){}
      progressEl.style.transform = "scaleX(0)";
      if (reset) {
        counter = initialCounter;
        timerEl.textContent = counter;
        timeDisplayEl.textContent = counter;
      } else {
        timerEl.textContent = "Gestoppt";
      }
    }

    function startExam() {
      // guard to ensure startExam is triggered once
      if (!examStarted) examStarted = true;
      const selectedSection = selectEl.value;
      if (selectedSection === 'lesen') {
        showPage('lesen-page');
      } else if (selectedSection === 'hoeren') {
        showPage('hoeren-page');
      } else if (selectedSection === 'schreiben') {
        showPage('schreiben-page');
      }
    }

    // wire buttons: start will now start the countdown (not the exam directly)
    startBtn.addEventListener('click', startCountdown);

    cancelBtn.addEventListener('click', () => {
      stopCountdown(true);
      timerEl.textContent = "Abgebrochen";
      timerEl.style.color = "#e53e3e";
    });

    // ===== LESEN PAGE FUNCTIONALITY =====
    function initLesenPage() {
      /* ===== Self-contained exam (embedded) ===== */
      const exam = {
        id: "exam-001",
        durationSec: 90 * 60,
        sections: [
          { 
            id: "s1", 
            title: "Leseverstehen, Teil 1", 
            points: 25,
            passageTitle: "Aufgabe: Ziehen Sie die passenden √úberschriften auf die Texte.",
            passage: "",
            questions: [],
            texts: [
              {
                id: "text1",
                content: "Der Buchtitel erinnert an eine Horrorgeschichte: ‚ÄúDie Nacht‚Äù. Aber dem Autor Paul Bogart geht es nicht um Fantasiewelten, sondern um sehr reale Dinge. Das Thema des Autors ist die n√§chtliche Finsternis. Wer erlebt noch eine dunkle Nacht? Gro√üstadtbewohner eher nicht, au√üer im abgedunkelten Schlafzimmer. Ein nat√ºrlicher Nachthimmel mit unz√§hligen Sternen ist die Ausnahme, deshalb sind wir √ºberw√§ltigt, wenn wir ihn doch einmal zu sehen bekommen. Das war fr√ºher anders, und zwar bis Gaslicht und Gl√ºhlampe erfunden wurden. Heute sieht man in St√§dten gerade noch den Mund und, wenn man Gl√ºck hat, eine Handvoll der hellsten Sterne. Paul Bogart erl√§utert, warum k√ºnstliches Licht so weit verbreitet ist, und betrachtet dies sehr kritisch. Der Autor fesselt seine Leser dabei mit beachtlichem Fachwissen. Au√üerdem ist er weit gereist. √úberall, so berichtet er, gebe es Organisationen, die sich f√ºr eine Reduzierung des k√ºnstlichen Lichts einsetzen - auch in Deutschland. Paul Bogart f√§nde es positiv, wenn die Organisationen sich durchsetzen k√∂nnten. Denn der Autor - und das macht er sehr deutlich - h√§lt nicht viel davon, dass es heute kaum noch v√∂llig dunkel ist.",
                correctAnswer: "b"
              },
              {
                id: "text2", 
                content: "Fotos machen ist heute nicht schwer. Schnell nimmt man das Handy und macht einen Schnappschuss. Wer aber besondere und eindrucksvolle Bilder haben m√∂chte, muss sich mit dem Thema Fotografie schon etwas intensiver befassen. Dietmar Spehrs neuer Fotografie-Ratgeber ist dabei ein gutes Hilfsmittel. Auf 424 Seiten erkl√§rt der Autor und Journalist mit einfachen, aber kompetenten Worten, was zu beachten ist. Der Ratgeber versteht sich als Fotokurs f√ºr Ein- und Aufsteiger und richtet sich an die vielen Menschen, die gerne fotografieren, aber wenig Fachwissen haben. Diesen Hobbyfotografen vermittelt das Buch sehr verst√§ndlich Schritt f√ºr Schritt solides Basiswissen. Spehr setzt dabei auf Beispielbilder, Tabellen und Grafiken und schreibt so wenig wie m√∂glich, aber so viel wie n√∂tig. Das sorgt daf√ºr, dass der Ratgeber sehr unterhaltsam zu lesen ist und nicht wie ein langweiliges Lehrbuch daherkommt. Von der Auswahl des Motivs √ºber die richtige Kameraeinstellung bis hin zur optimierenden Nachbearbeitung am Computer wird alles Wissenswerte vermittelt.",
                correctAnswer: "i"
              },
              {
                id: "text3",
                content: "Bilder der Fotografin Annie Leibovitz sind ab kommendem Samstag im Kunsthaus Wien zu sehen. Die Ausstellung besticht durch ihre umfangreiche Bildauswahl. Zum einen kann man zahlreiche Portraits ber√ºhmter Schauspieler, Politiker oder Musiker bestaunen. Zum anderen sieht man Bilder aus dem privaten Fotoalbum der K√ºnstlerin. Die zum Teil sehr pers√∂nlichen Aufnahmen dokumentieren ihr Leben und zeigen bisher unver√∂ffentlichte Werke, die zum Teil sehr bedr√ºckend sind. Bilder ihres Vaters ber√ºhren den Besucher und oftmals ist man von der Offenheit der Fotografin √ºberrascht. Zwischen Aufnahmen der Fotografin selbst stehen zahlreiche Portr√§ts ihrer Eltern und Urlaubsfotos der Familie. Die bunte Mischung von gro√üformatigen und kleinformatigen Bildern sorgt f√ºr Abwechslung. Um die Fotografien besser kennenzulernen, k√∂nnen Besucher einen ca. 1,5 Stunden langen Film √ºber die Karriere von Annie Leibovitz sehen. Eines ist nach der Ausstellung und dem Film klar: Anne Leibovitz z√§hlt zu den bedeutendsten Fotografinnen des 20. und beginnenden 21. Jahrhunderts.",
                correctAnswer: "a"
              },
              {
                id: "text4",
                content: "Die Abk√ºrzung TWAN klingt nach einem neuen Computerprogramm, aber tats√§chlich steht sie f√ºr eine neue fotografische Methode, die der Iraner Babak Amin Tafreshi entwickelt hat. Diese neue Methode f√ºhrt zu atemberaubenden Ergebnissen: Noch nie hat man die Sterne so eindrucksvoll √ºber den Landschaften der Erde gesehen wie auf den Bildern in diesem Buch - ein Genuss f√ºr die Augen. Was man auf den 160 Seiten des Buches sieht, ist meines Wissens ohne Beispiel. Viele der gezeigten Orte und Landschaften sind bekannte Motive, hier aber wirken sie doch vollkommen anders, als man sie kennt. Da sieht man Sterne √ºber den Ruinen von Persepolis, den Mond √ºber ungarischen W√§ldern, die Milchstra√üe √ºber dem kalifornischen Mammutbaum ‚ÄúGeneral Grant‚Äù. Die drei Herausgeber Stefan Seip, Gernot Meiser und Babak A. Tafreshi wurden unterst√ºtzt von einem weltweiten Team erfahrener Naturfotografen. Auf den letzten Seiten des Buchs erf√§hrt man auch, dass ‚ÄúFotografieren im TWAN-Stil hei√üt, bei fortgeschrittener D√§mmerung oder Dunkelheit Aufnahmen zu machen, auch wenn man selbst nicht mehr viel sehen kann‚Äù. Neben aller Technik kommt es aber auf den k√ºnstlerischen Blick des Fotografen an - und viel Geduld.",
                correctAnswer: "g"
              },
              {
                id: "text5",
                content: "Er geh√∂rte zu den ganz Gro√üen seines Fachs: Andreas Feininger. Eine neue Biografie erz√§hlt die Lebensgeschichte des weltber√ºhmten Fotografen. Neben einem Text auf Deutsch und Englisch enth√§lt sie auch eine kleine, aber gute Auswahl seiner Fotoarbeiten aus allen Schaffensphasen. Die Autoren zeigen den Weg des 1906 in Paris geborenen Fotografen von der Kindheit in Berlin √ºber die Jahre in Weimar und Dessau bis hin zum Leben in Hamburg, Stockholm und schlie√ülich New York, dessen Stadtansichten Feininger weltber√ºhmt machen. Dabei hatte Feininger keineswegs das Ziel, Fotograf zu sein. Eigentlich war Andreas Feininger gelernter Architekt. Als Feininger mit seiner Frau 1933 nach Stockholm auswandert, findet er dort als Architekt keine Anstellung. So macht er aus der Not eine Tugend: Weil er die kleine Familie mit Sohn Thomas ern√§hren muss, macht er seine Leidenschaft, die Fotografie, zum Broterwerb. Den Durchbruch als weltweit anerkannter Fotograf schafft er schlie√ülich in New York, wohin seine Familie 1939 auswandert.",
                correctAnswer: "c"
              }
            ],
            headings: [
              {id: "a", text: "Bilder einer bedeutenden K√ºnstlerin"},
              {id: "b", text: "Das Ende der Dunkelheit"},
              {id: "c", text: "Die bemerkenswerte Karriere eines Fotografen"},
              {id: "d", text: "Ein Fotograf auf Reisen"},
              {id: "e", text: "Eine Fotografin dreht einen Film"},
              {id: "f", text: "Entwicklungsgeschichte der Lampen"},
              {id: "g", text: "Erde, Mond und Sterne - wie man sie noch nie gesehen hat"},
              {id: "h", text: "Familienfotos ber√ºhmter Pers√∂nlichkeiten"},
              {id: "i", text: "Gelungene Einf√ºhrung in die moderne Fotografie"},
              {id: "j", text: "Mit Profis eine neue Foto-Technik erlernen"}
            ]
          },
          { 
            id: "s2", 
            title: "Leseverstehen, Teil 2", 
            points: 25,
            passageTitle: "Gesundes Essen f√ºr Schulkinder",
            passage: `F√ºr Kinder sind regelm√§√üige Mahlzeiten wichtig, um volle Konzentrations‚Äì und Leistungsf√§higkeit zu gew√§hrleisten. Um gut in den Tag zu kommen, sollte jedes Schulkind mit einem ausgewogenen Fr√ºhst√ºck starten.
Aber eine Umfrage kam zu erschreckenden Ergebnissen: Jedes siebte Kind isst morgens nichts, bevor es in die Schule geht. Die Gr√ºnde daf√ºr sind vielf√§ltig: Jeder vierte Befragte gab an, dass sein Kind morgens keinen Appetit habe. Und sogar jede dritte Mutter und jeder dritte Vater sagten, dass morgens keine Zeit f√ºr Fr√ºhst√ºck sei. F√ºr eine gesunde Morgenmahlzeit sollte man jedoch immer Zeit freischaufeln, r√§t Ern√§hrungswissenschaftlerin Alexandra Krotz.
Mit leerem Magen k√∂nnen K√∂rper und Geist keine Leistung erbringen. Die Folge: Die Kinder sind reizbar, nerv√∂s und k√∂nnen sich nicht richtig konzentrieren. Und das ist schon auf dem Schulweg wichtig: Kinder bewegen sich sicherer, wenn sie rechtzeitig aufgestanden sind und entspannt gefr√ºhst√ºckt haben.
Zu einem gesunden Fr√ºhst√ºck eignen sich am besten Vollkornbrote mit fettarmer Wurst oder K√§se, aber auch M√ºslis mit Milch oder Joghurt, N√ºssen und frisches Obst. Wer morgens keinen Hunger hat, sollte wenigstens eine Kleinigkeit zu sich nehmen ‚Äì etwa eine Banane essen und dazu einen Kakao trinken ‚Äì und das ausgiebige Fr√ºhst√ºck dann etwas sp√§ter nachholen. In einigen Schulen wird gemeinsam gefr√ºhst√ºckt. Hier gilt es, je nach Vereinbarung mit Erziehern und Lehrern, ein leckeres Fr√ºhst√ºck zusammenzustellen. Wer seinen Kinder ein zweites Fr√ºhst√ºck einpackt, sollte auf Abwechslung und die geeignete Verpackung achten. Am besten eignet sich eine Brotdose ‚Äì die spart Verpackungsmilli und vermeidet zermatschte Brote. Zudem lassen sich darin auch Obst und Gem√ºse sicher transportieren.
Eine gute Erg√§nzung zu lecker belegten Vollkornbroten ist Rohkost. Dazu eignen sich besonders transportsichere feste Sorten wie M√∂hren, Kohlrabi, Cherrytonaten, Trauben oder √Ñpfel. Je nach Jahreszeit und Vorliebe der Kinder k√∂nnen Sie als Eltern hierbei f√ºr Abwechslung sorgieren.
Heutzutage wird Schulmilch leider nicht mehr in allen Schulen angeboten. Schade, denn Milch liefert wichtiges Calcium, Eiwei√ü und viele B-Vitamine. Wer als Kind die M√∂glichkeit hat, in der Schule Milch zu trinken, sollte darauf nicht verzichten. Und selbst Milchmuffel d√ºrften zufrieden sein: Da Milch in vielen Varianten angeboten wird ‚Äì von Erdbeermilch √ºber Kakao zu Vanillemlich ‚Äì, ist f√ºr jedes Kind das Richtige dabei.
Generell ist der Wasserbedarf von Kindern im Verh√§ltnis zum K√∂rpergewicht h√∂her als bei Erwachsenen. Trinken Kinder zu wenig, beeintr√§chtigt dies schneller die k√∂rperliche und geistige Leistungsf√§higkeit. Kinder sollten deshalb je nach Alter mindestens 0,7 Liter bis 1,2 Liter trinken ‚Äì Milch nicht mitgerechnet. Wenn das Kind viel Sport treibt oder tobt und bei besonders warmen Tagen brauchen die Kinder entsprechend mehr Fl√ºssigkeit.
Viele Kinder trinken zu wenig. H√§ufig vergessen sie ganz einfach zu trinken, wenn sie konzentriert spielen oder lernen. Ganz wichtig ist es daher, Kinder immer mal wieder zum Trinken aufzufordern und auch zwischen den Mahlzeiten den Durst zu l√∂schen, auch w√§hrend der Unterrichtsstunden. Am besten sind Wasser, Kr√§utertees und Saftschorles geeignet.
√úbrigens: Fast ein Viertel aller Sch√ºler in Deutschland trinkt vormittags nichts oder fast nichts. Das hat eine Untersuchung der Universit√§t Paderborn zum Trinkverhalten vor und w√§hrend der Unterrichtszeit ergeben. Die unzureichende Fl√ºssigkeitsaufnahme f√ºhrte dabei nachweislich zu Einschr√§nkungen der geistigen und k√∂rperlichen Leistungsf√§higkeit.
Kinder m√∂gen S√º√ües. Schokoriegel und S√º√üigkeiten sollten allerdings beim Pausenbrot nicht die Regel sein. Eine gute Alternative dazu sind Trockenfr√ºchte, Fruchtschnitten oder Studentenfutter. Sie liefern wichtige Vitamine und Mineralstoffe und sind als Energieschub zwischendurch geeignet. Aber Vorsicht: Sie enthalten auch viel Energie und sollten gerade von Kindern, die leichtes √úbergewicht haben, nur in geringen Mengen gegessen werden.
Viele Eltern nehmen sich morgens nicht die Zeit, mit ihren Kindern zu fr√ºhst√ºcken, und geben Ihnen lieber Geld mit, damit sie sich auf dem Schulweg ein Fr√ºhst√ºck kaufen k√∂nnen. Versuchen Sie, das zu vermeiden. Denn die meisten Kinder legen das Geld in S√º√üwaren oder Fast Food, Cola oder andere S√º√ügetr√§nke an. Die Mittagsverpflegung in Schulen kann sehr unterschiedlich sein. Ein weiteres Pausenbrot w√§re jedenfalls eine Zumutung f√ºr die Kinder. Deshalb gibt es verschiedene Systeme f√ºr die Versorgung am Mittag ‚Äì Catering, kochende Eltern oder Profi‚ÄìK√ºchen mit geschultem Personal. Klar ist: F√ºr die Kinder sind Pausen und regelm√§√üige Mahlzeiten zur Aufrechterhaltung ihrer Leistungsf√§higkeit wichtig. Daher sollte es im Interesse aller sein, den Kindern in der Schule eine geeignete Mittagsverpflegung zur Verf√ºgung zu stellen.`,
            questions: [
              {
                id: "s2q1",
                type: "single",
                text: "Einige Eltern",
                options: [
                  {id: "s2q1o1", text: "haben selbst keinen Appetit auf ein Fr√ºhst√ºck."},
                  {id: "s2q1o2", text: "lassen das Fr√ºhst√ºck aus Zeitmangel ausfallen."},
                  {id: "s2q1o3", text: "schaufeln das Fr√ºhst√ºck einfach in sich hinein."}
                ],
                correctAnswer: "s2q1o2"
              },
              {
                id: "s2q2",
                type: "single", 
                text: "Ein gesundes Fr√ºhst√ºck",
                options: [
                  {id: "s2q2o1", text: "erh√∂ht auch die Sicherheit des Kindes auf dem Weg zur Schule."},
                  {id: "s2q2o2", text: "muss mindestens aus einem Glas Kakao oder Milch bestehen."},
                  {id: "s2q2o3", text: "sollte gemeinsam in der Schule angenommen werden."}
                ],
                correctAnswer: "s2q2o1"
              },
              {
                id: "s2q3",
                type: "single",
                text: "Milch",
                options: [
                  {id: "s2q3o1", text: "deckt den t√§glichen Fl√ºssigkeitsbedarf."},
                  {id: "s2q3o2", text: "geh√∂rt zum Angebot der Schulkantinen."},
                  {id: "s2q3o3", text: "wird in verschiedenen Geschmacksrichtungen angeboten."}
                ],
                correctAnswer: "s2q3o3"
              },
              {
                id: "s2q4",
                type: "single",
                text: "Kinder",
                options: [
                  {id: "s2q4o1", text: "denken von alleine nicht immer daran, genug zu trinken."},
                  {id: "s2q4o2", text: "d√ºrfen w√§hrend des Unterrichts nichts trinken."},
                  {id: "s2q4o3", text: "k√∂nnen sich auch noch gut konzentrieren, wenn sie nicht genug getrunken haben."}
                ],
                correctAnswer: "s2q4o1"
              },
              {
                id: "s2q5", 
                type: "single",
                text: "Mittagessen",
                options: [
                  {id: "s2q5o1", text: "sollte in der Schule angeboten werden."},
                  {id: "s2q5o2", text: "sollten die Kinder von zu Hause mitbringen."},
                  {id: "s2q5o3", text: "sollten Kinder bei den Eltern zu Hause bekommen."}
                ],
                correctAnswer: "s2q5o1"
              }
            ]
          },
          { 
            id: "s3", 
            title: "Leseverstehen, Teil 3", 
            points: 25,
            passageTitle:"Aufgabe: Lesen Sie die zehn Situationen (11-20) und die zw√∂lf Texte (A-L). Welcher Text passt zu welcher Situation? Sie k√∂nnen jeden Text nur einmal verwenden. Manchmal passt kein Text. W√§hlen Sie dann 'x'.",
            passage: "",
            questions:[],
            texts: [
              {id: "A", text: "Neues Angebot der VHS: Ab dem kommenden Monat bietet die Volkshochschule in Zusammenarbeit mit der B√ºrgerschaft in unserem Stadtteil einen neuen Kurs an. Unter dem Motto 'Gemeinsam statt einsam' k√∂nnen alleinstehende √§ltere Menschen hier neue Kontakte kn√ºpfen. Bei Kaffee und Kuchen wird gemeinsam gespielt, gesungen und √ºber aktuelle Themen diskutiert. Der Kurs findet jeden Dienstag von 14 bis 16 Uhr statt. Eine Anmeldung ist nicht erforderlich.", correctAnswer: "18"},
              {id: "B", text: "Essen erleben Gesunde Ern√§hrung ist wichtig, auch schon f√ºr die Kleinen. Nur wer von Anfang an lernt, wie frisches Gem√ºse und Obst schmecken, wie man mit einfachen Mitteln und auch wenig Zeit leckere Gerichte zubereiten kann, wird sich dauerhaft gesund ern√§hren. Deshalb bietet die Kochschule ‚ÄúKochl√∂ffel‚Äù ab sofort Kochkurse f√ºr Eltern und Kinder ab sechs Jahren an. Die Kurse werden zu unterschiedlichen Tageszeiten angeboten und finden auch schon bei wenigen Anmeldungen statt. Nutzen Sie die Gelegenheit, mit ihrem Kind gemeinsam zu kochen und dabei nat√ºrlich auch Spa√ü zu haben! Infos und Anmeldung: www.kochloeffel-kochschule.eu ", correctAnswer: ""},
              {id: "C", text: "Kurzreise nach M√ºnchen Studienreisen Studius bietet Ihnen einen besonderen Ausflug an: Fahren Sie mit unserem modernen Reisebus am fr√ºhen Morgen von K√∂ln nach M√ºnchen zum Deutschen Museum und nehmen Sie an einer exklusiven F√ºhrung teil, die sich auf die Geschichte der Technik konzentriert. Die R√ºckreise erfolgt am fr√ºhen Abend, so dass Sie in der Nacht wieder in K√∂ln ankommen. Im Reisepreis sind der Eintritt sowie die F√ºhrung bereits enthalten. Ohne √úbernachtung, daher besonders g√ºnstig! Begrenzte Pl√§tze, buchen Sie schnell telefonisch unter 0221/809043 oder √ºber unsere Homepage.", correctAnswer: "14"},
              {id: "D", text: "Entspannung am Wasser Von M√§rz bis September bei sch√∂nem Wetter auch l√§nger k√∂nnen Sie bei unserem Bootsverleih Wasserfall das Gef√§hrt Ihrer Wahl ausleihen, um einen unvergesslichen Tag am und auf dem Baldeneysee zu verbringen. Mit einem Ruderboot oder Tretboot k√∂nnen Sie ein wenig Sport treiben und gleichzeitig die Natur genie√üen. Wenn Ihnen das zu anstrengend ist, k√∂nnen Sie auch ein Motorboot ausleihen. Voraussetzung ist der entsprechende F√ºhrerschein. Ausleihfristen: zwischen zwei und zw√∂lf Stunden. Wir bieten auch Rabatte f√ºr Gruppen oder regelm√§√üige Besucher an. Fragen Sie uns einfach! Telefon 0201/185790", correctAnswer: "11"},
              {id: "E", text: "Als echter Hamburger... kennt man nat√ºrlich den Hafen der Hansestadt und seine Wirtschaftskraft. F√ºr alle Interessierten, die dar√ºber erst noch etwas erfahren wollen, bietet das Bildungszentrum Buxtehude am n√§chsten Freitag einen zweist√ºndigen Vortrag an, in dem man Wissenswertes √ºber die wirtschaftliche Bedeutung des Hamburger Hafens erf√§hrt. Von der Gr√ºndung des Freihafens bis zu den heutigen modernen Anlagen wird die spannende Entwicklung des gr√∂√üten deutschen Hafens unter √∂konomischen Aspekten dargelegt. Weitere Informationen und Anmeldung im Internet unter www.buxtehude.eu.", correctAnswer: ""},
              {id: "F", text: "Schiffe versenken, Marmorkuchen und selbstgebastelte Papierh√ºte Das bietet Ihnen unser Service ‚ÄúKinderfeiern leicht gemacht‚Äù. Mit uns wird jeder Kindergeburtstag zum Erfolg, auch wenn Sie selbst nur wenig Zeit f√ºr die Vorbereitung haben. Wir √ºbernehmen auf Wunsch die Dekoration, liefen Speisen und Getr√§nke (beispielsweise Kuchen/Kekse, Salate, Frikadellen und vieles mehr), planen lustige Spiele und bringen auch alles mit, was f√ºr die Spiele gebraucht wird. Weitere Informationen unter 01805/7131192.", correctAnswer: "13"},
              {id: "G", text: "Hamburger & Co. Sie m√∂gen Fast Food? Sie glauben aber, dass Fast Food nicht gesund sein kann? Wir zeigen Ihnen das Gegenteil. Lernen Sie viele Gerichte aus den USA in unserem Kochkurs ‚ÄúHamburger & Co.‚Äù neu kennen. An drei Wochenenden zeigen wir Ihnen, dass man Hamburger auch so zubereitet kann, dass sie gar nicht so viele Kalorien haben. Und schmecken werden sie nat√ºrlich auch. Anmeldung bis n√§chsten Samstag telefonisch unter 0800/1398700.", correctAnswer: ""},
              {id: "H", text: "Nur auf Reisen lernt der Mensch Seit fast f√ºnf Jahrzehnten bietet die √ºberregionale Bildungsakademie ‚ÄúLernform e.V.‚Äù allen interessierten B√ºrgerinnen und B√ºrgern Ausfl√ºge zu wichtigen Orten der deutschen Geschichte an. Anl√§sslich unseres Jubil√§ums veranstalten wir in den kommenden Monaten nun auch mehrt√§gige Fahrten in gro√üe deutsche St√§dte, um uns dort mit der Geschichte und Entwicklung der Stadt zu besch√§ftigen. Die Reisen f√ºhren beispielsweise nach Berlin, K√∂ln oder M√ºnchen. Informieren Sie sich jetzt oder buchen Sie sofort unter www.ba-lernform.eu.  ", correctAnswer: "19"},
              {id: "I", text: "Die bewegte Geschichte eines Stadtteils Unser Stadtteil kann auf eine bewegte Geschichte zur√ºckblicken. Die Mitarbeiter des Stadtteil-Archivs wollen deshalb ein Buch ver√∂ffentlichen, in dem die Geschichte lebendig und f√ºr Alt- und Neu-B√ºrger anschaulich wird. Noch bis Jahresende bittet das Archiv alle B√ºrger, pers√∂nliche Erinnerungen einzureichen, sei es in Form kurzer Geschichten oder in Form von Fotos. Auch historische Zeitungsartikel sind willkommen, da nicht alle Zeitungen im Archiv vorhanden sind. Melden Sie sich einfach pers√∂nlich im Archiv am Dreiringplatz.", correctAnswer: ""},
              {id: "J", text: "Deutschland aus einer anderen Perspektive Lernen Sie die sch√∂nsten deutschen Landschaften vom Fluss aus mit einer unserer Flusskreuzfahrten kennen. Auf ger√§umigen modernen Schiffen fahren Sie √ºber Rhein, Mosel oder Donau, sehen die wundersch√∂ne Natur l√§ngs der Fl√ºsse und besichtigen auch die kleinen Ortschaften bei Ausfl√ºgen an Land. Wir haben Angebote f√ºr Reisende aller Altersklassen, f√ºr Individual- oder Gruppenreisende. Fordern Sie unser Informationsmaterial an unter der Rufnummer 0800/4455992. .", correctAnswer: "15"},
              {id: "K", text: "Unser Stadtteil ist lebendig Deshalb planen wir, im kommenden Jahr auf allen Pl√§tzen des Stadtteils ein Fest durchzuf√ºhren. Noch stehen wir am Anfang unserer Planung, sammeln Ideen und suchen vor allem weitere Helfer. Wer m√∂chte das Fest und unseren Stadtteil mitgestalten, Ideen entwickeln oder die konkrete Planung √ºbernehmen? Noch ist alles m√∂glich! Wir, die Einwohner unseres Stadtteils, wollen unsere Pl√§tze noch sch√∂ner, bunter und lebendiger machen. Wir freuen uns √ºber jeden Helfer, f√ºr das Fest und f√ºr die Umsetzung unserer Pl√§ne. Wer mitmachen m√∂chte, kann sich per E-Mail melden bei a.yildrim@online.eu.", correctAnswer: "16"},
              {id: "L", text: "Technik - spannend und verst√§ndlich Sie kennen die typische Kinderfrage: ‚ÄùWie geht das?‚Äù Oder Sie haben selbst als Kind einmal eine Uhr ge√∂ffnet, weil Sie wissen wollten, was darin war. Kinder sind neugierig, Kinder interessieren sich f√ºr Technik - und zwar nicht nur, wenn sie damit spielen k√∂nnen. Kinder wollen auch wissen, wie die Sachen funktionieren, aber leider k√∂nnen nicht alle Erwachsenen das gut erkl√§ren. Deshalb wurde jetzt in Oberhausen das erste Technik-Museum f√ºr Kinder er√∂ffnet. Besucher zwischen 6 und 12 Jahren erfahren dort (nat√ºrlich in Begleitung eines Erwachsenen) spielerisch oder bei kindgerechten F√ºhrungen alles, was sie √ºber Technik wissen wollen. Informationen: www.technik-museum-oberhausen.de.", correctAnswer: "20"}
            ],
            situations: [
              {id: "11", text: "Sie m√∂chten einen Ganztagesausflug machen und sich dabei bewegen."},
              {id: "12", text: "Sie m√∂chten eine Fahrt durch den Hamburger Hafen buchen."},
              {id: "13", text: "Eine Bekannte organisiert einen gro√üen Kindergeburtstag und braucht Hilfe."},
              {id: "14", text: "Sie interessieren sich f√ºr Technikgeschichte."},
              {id: "15", text: "Ein Freund m√∂chte gerne eine Schiffsreise machen."},
              {id: "16", text: "Sie m√∂chten helfen, Ihren Stadtteil zu gestalten."},
              {id: "17", text: "Sie wollen mit einer Bekannten essen gehen. Sie mag amerikanische K√ºche."},
              {id: "18", text: "Sie sind neu in der Stadt und m√∂chten Ihren Stadtteil kennenlernen."},
              {id: "19", text: "Ein Freund m√∂chte mehr √ºber die Geschichte deutscher St√§dte erfahren."},
              {id: "20", text: "Sie m√∂chten etwas mit Ihrer 6-j√§hrigen Nichte unternehmen, die gerne ins Museum geht."}
            ]  
          },
          { 
            id: "s4", 
            title: "Sprachbausteine, Teil 1", 
            points: 15,
            passageTitle:"Aufgabe: Erg√§nzen Sie den Text. W√§hlen Sie f√ºr jede L√ºcke das passende Wort.",
            passage: "",
            questions:[],
            fillBlanks: [
              {
                id: "21",
                options: ["ab", "aus", "von"],
                correctAnswer: "aus"
              },
              {
                id: "22",
                options: ["wann", "was", "wie"],
                correctAnswer: "was"
              },
              {
                id: "23",
                options: ["da", "denn", "obwohl"],
                correctAnswer: "da"
              },
              {
                id: "24",
                options: ["ist", "wird", "w√ºrde"],
                correctAnswer: "wird"
              },
              {
                id: "25",
                options: ["bin", "war", "w√§re"],
                correctAnswer: "w√§re"
              },
              {
                id: "26",
                options: ["konnte", "musste", "sollte"],
                correctAnswer: "konnte"
              },
              {
                id: "27",
                options: ["aber", "denn", "sondern"],
                correctAnswer: "denn"
              },
              {
                id: "28",
                options: ["Beide", "Beiden", "Beides"],
                correctAnswer: "Beides"
              },
              {
                id: "29",
                options: ["erst", "noch", "schon"],
                correctAnswer: "noch"
              },
              {
                id: "30",
                options: ["auf", "f√ºr", "√ºber"],
                correctAnswer: "auf"
              }
            ],
            fillText: `Betreff: Gr√º√üe ________ Berlin

Hallo Leon,

vielen Dank f√ºr deine letzte Mail ________ Peking! Du arbeitest ja jetzt schon seit einem halben Jahr in China unglaublich, wie schnell die Zeit vergeht.

Leider hatte ich in den letzten drei Wochen keine Zeit, dir zu antworten, weil ich viel zu tun hatte. Aber jetzt berichte ich dir, ________ alles los war.

Also, im B√ºro haben wir derzeit viel Stress, ________ drei Kollegen im Urlaub sind und eine weitere Kollegin seit zwei Wochen krank ist. Jetzt m√ºssen wir mit f√ºnf Leuten die Arbeit erledigen, die sonst neun Leute machen. Ich wei√ü wirklich nicht, wer diese Urlaubsplanung gemacht hat. Hoffentlich ________ das in Zukunft besser organisiert.

Abends waren Carmen und ich dann ein paarmal aus. Wir waren zum Beispiel bei einem Konzert von "Belasco". Kennst du die Band? Eigentlich war ich an dem Abend ganz sch√∂n kaputt und ________ am liebsten zuhause geblieben, aber ich hatte Carmen die Karten zum Geburtstag geschenkt. Da ________ ich ja schlecht auf dem Sofa sitzen bleiben! Im Nachhinein muss ich sagen: Ein Gl√ºck, dass wir zu dem Konzert gegangen sind, ________ es war einfach nur super!

An den letzten beiden Wochenenden hatten wir dann auch noch Familienfeiern: Erst hatte meine √§ltere Schwester Geburtstag und has gro√ü gefeiert, dann hat ein Cousin geheiratet und uns eingeladen, ________ war zwar sch√∂n, aber auch anstrengend. Ich bin froh, dass wir f√ºr die kommenden Wochenenden ________ keine Pl√§ne haben.

Das war's erst mal von mir. Melde dich doch wieder, ich freue mich deine n√§chste E-Mail!

Viele Gr√º√üe sendet dir

Fabian`
    },
    { 
      id: "s5", 
      title: "Sprachbausteine, Teil 2", 
      points: 15,
      passageTitle:"Aufgabe: Lesen Sie den Text und entscheiden Sie, welches Wort in welche L√ºcke passt. Sie k√∂nnen jedes Wort nur einmal verwenden. Nicht alle W√∂rter passen in den Text.",
      passage: "",
      questions:[],
      fillBlanks2: [
        {
          id: "31",
          options: ["ABER", "AN", "BESONDERS", "F√úR", "KAUM", "MIT", "M√úSSTE", "UM", "OHNE", "SCHON", "SO", "SOGAR", "SOLLTE", "SONDERN", "ANSTATT", "VON"],
          correctAnswer: "SOGAR"
        },
        {
          id: "32", 
          options: ["ABER", "AN", "BESONDERS", "F√úR", "KAUM", "MIT", "M√úSSTE", "UM", "OHNE", "SCHON", "SO", "SOGAR", "SOLLTE", "SONDERN", "ANSTATT", "VON"],
          correctAnswer: "MIT"
        },
        {
          id: "33",
          options: ["ABER", "AN", "BESONDERS", "F√úR", "KAUM", "MIT", "M√úSSTE", "UM", "OHNE", "SCHON", "SO", "SOGAR", "SOLLTE", "SONDERN", "ANSTATT", "VON"],
          correctAnswer: "SONDERN"
        },
        {
          id: "34",
          options: ["ABER", "AN", "BESONDERS", "F√úR", "KAUM", "MIT", "M√úSSTE", "UM", "OHNE", "SCHON", "SO", "SOGAR", "SOLLTE", "SONDERN", "ANSTATT", "VON"],
          correctAnswer: "OHNE"
        },
        {
          id: "35",
          options: ["ABER", "AN", "BESONDERS", "F√úR", "KAUM", "MIT", "M√úSSTE", "UM", "OHNE", "SCHON", "SO", "SOGAR", "SOLLTE", "SONDERN", "ANSTATT", "VON"],
          correctAnswer: "ANSTATT"
        },
        {
          id: "36",
          options: ["ABER", "AN", "BESONDERS", "F√úR", "KAUM", "MIT", "M√úSSTE", "UM", "OHNE", "SCHON", "SO", "SOGAR", "SOLLTE", "SONDERN", "ANSTATT", "VON"],
          correctAnswer: "BESONDERS"
        },
        {
          id: "37",
          options: ["ABER", "AN", "BESONDERS", "F√úR", "KAUM", "MIT", "M√úSSTE", "UM", "OHNE", "SCHON", "SO", "SOGAR", "SOLLTE", "SONDERN", "ANSTATT", "VON"],
          correctAnswer: "ABER"
        },
        {
          id: "38",
          options: ["ABER", "AN", "BESONDERS", "F√úR", "KAUM", "MIT", "M√úSSTE", "UM", "OHNE", "SCHON", "SO", "SOGAR", "SOLLTE", "SONDERN", "ANSTATT", "VON"],
          correctAnswer: "SOLLTE"
        },
        {
          id: "39",
          options: ["ABER", "AN", "BESONDERS", "F√úR", "KAUM", "MIT", "M√úSSTE", "UM", "OHNE", "SCHON", "SO", "SOGAR", "SOLLTE", "SONDERN", "ANSTATT", "VON"],
          correctAnswer: "UM"
        },
        {
          id: "40",
          options: ["ABER", "AN", "BESONDERS", "F√úR", "KAUM", "MIT", "M√úSSTE", "UM", "OHNE", "SCHON", "SO", "SOGAR", "SOLLTE", "SONDERN", "ANSTATT", "VON"],
          correctAnswer: "SCHON"
        }
      ],
      fillText2: `Online-Sprachkurse & Co. - Wie lernt man heute am besten eine Sprache?

Es gibt inzwischen zahlreiche Online-Sprachkurse und ________ mit Smartphones kann man Sprachen lernen. Eine weitere Lernm√∂glichkeit ist zum Beispiel eine Tandem-Partnerschaft ________ einem Muttersprachler. Welche Vorteile und Nachteile haben die unterschiedlichen Methoden?

Es gibt inzwischen zahlreiche Online-Lernportale, die leicht zu √ºberblicken und zu bedienen sind. Der Vorteil: Man kann die W√∂rter nicht nur lesen, ________ gleichzeitig auch h√∂ren. Au√üerdem kann man W√∂rter nachsprechen, ________ dass ein ganzer Kurs zuh√∂rt.

Auch Lerntipps bekommt man bei Online-Portalen, beispielsweise diesen: Vokabeln sollte man lieber mehrmals t√§glich in F√ºnf-Minuten-Bl√∂cken wiederholen, ________ sie in einer Stunde alle auf einmal zu lernen.

Wer auch unterwegs lernen m√∂chte, kann es mit einer Smartphone-App versuchen, einem kleinen Programm, das auf dem Handy l√§uft. Viele Programme gibt es kostenlos, andere kosten zwischen einem und mehreren Euro. Die kleinen Helfer sind ________ gut zum Vokabellernen geeignet - mehr aber meist nicht. Das spielerische Vokabeltraining macht zwar Spa√ü, ________ Satzbau oder andere Grammatikthemen werden allenfalls kurz angesprochen. Ein richtiges Gespr√§ch kann man mit dieser Methode erst recht nicht √ºben. Daf√ºr ________ man besser in einen Kurs gehen oder einen Tandem-Partner suchen.

Ein Tandem-Partner ist ein Muttersprachler, der die Grammatik erkl√§rt, die Aussprache verbessert und seinerseits die Muttersprache des anderen lernen m√∂chte.

Der schnellste Weg, ________ einen passenden Tandem-Partner zu finden, ist die Online-Suche: Muttersprache, Zielsprache und Wohnort eingeben, ________ werden alle Treffer angezeigt. Man trifft sich beispielsweise in einem Restaurant, schickt sich Nachrichten oder E-Mails und erkl√§rt sich gegenseitig die eigene Sprache.`
    }
        ]
      };

      /* ===== State & DOM refs ===== */
      let state = { 
        sectionIndex: 0, 
        questionIndex: 0, 
        answers: {}, 
        marked: {}, 
        remaining: exam.durationSec,
        showResults: false,
        timerStarted: false,
        timerInterval: null
      };
      const topTiles = document.getElementById('topTiles-lesen');
      const passageTitleEl = document.getElementById('passageTitle-lesen');
      const passageContentEl = document.getElementById('passageContent-lesen');
      const sectionNameEl = document.getElementById('sectionName-lesen');
      const questionTitleEl = document.getElementById('questionTitle-lesen');
      const questionBodyEl = document.getElementById('questionBody-lesen');
      const headingsBankContainer = document.getElementById('headingsBankContainer-lesen');
      const timerEl = document.getElementById('timer-lesen');
      const statusText = document.getElementById('statusText-lesen');
      const resultBtn = document.getElementById('resultBtn-lesen');
      const resetBtn = document.getElementById('resetBtn-lesen');
      const resetSectionBtn = document.getElementById('resetSectionBtn-lesen');

      /* ===== Timer Functions ===== */
      function startTimer(){
        if(state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        
        state.timerStarted = true;
        state.timerInterval = setInterval(()=>{
          if(state.remaining <= 0){
            clearInterval(state.timerInterval);
            timerEl.textContent = 'Zeit abgelaufen';
            return;
          }
          state.remaining--;
          updateTimerDisplay();
        }, 1000);
      }

      function resetTimer(){
        if(state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        state.remaining = exam.durationSec;
        state.timerStarted = false;
        updateTimerDisplay();
        startTimer();
      }

      function updateTimerDisplay(){
        const min = Math.floor(state.remaining / 60);
        const sec = state.remaining % 60;
        timerEl.textContent = `Verbleibende Zeit: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
      }

      /* ===== Reset Section Function ===== */
      function resetCurrentSection() {
        const currentSection = exam.sections[state.sectionIndex];
        
        if (confirm(`M√∂chten Sie wirklich den Teil "${currentSection.title}" zur√ºcksetzen? Alle Antworten in diesem Teil werden gel√∂scht.`)) {
          if (currentSection.id === 's1') {
            currentSection.texts.forEach(text => {
              delete state.answers[text.id];
            });
          } else if (currentSection.id === 's2') {
            currentSection.questions.forEach(question => {
              delete state.answers[question.id];
            });
          } else if (currentSection.id === 's3') {
            currentSection.situations.forEach(situation => {
              delete state.answers[situation.id];
            });
          } else if (currentSection.id === 's4') {
            currentSection.fillBlanks.forEach(blank => {
              delete state.answers[blank.id];
            });
          } else if (currentSection.id === 's5') {
            currentSection.fillBlanks2.forEach(blank => {
              delete state.answers[blank.id];
            });
          }
          
          renderAll();
        }
      }

      /* ===== Render ===== */
      function renderTopTiles(){ 
        topTiles.innerHTML=''; 
        exam.sections.forEach((sec,idx)=>{ 
          const div=document.createElement('div'); 
          div.className='tile'+(idx===state.sectionIndex?' active':'')+(isSectionDone(sec)?' done':''); 
          div.innerHTML=`<div>${sec.title}</div><div class="points">${sec.points} P</div>`; 
          div.onclick=()=>{state.sectionIndex=idx; state.questionIndex=0; state.showResults=false; renderAll();}; 
          topTiles.appendChild(div); 
        }); 
      }

      function isSectionDone(section){
        if(section.id==='s1') return section.texts.every(t=>state.answers[t.id]);
        if(section.id==='s2') return section.questions.every(q=>state.answers[q.id]);
        if(section.id==='s3') return section.situations.every(h=>state.answers[h.id] || state.answers[h.id] === 'X');
        if(section.id==='s4') return section.fillBlanks.every(b=>state.answers[b.id]);
        if(section.id==='s5') return section.fillBlanks2.every(b=>state.answers[b.id]);
        return false;
      }

      function renderAll(){
        renderTopTiles();
        const section = exam.sections[state.sectionIndex];
        sectionNameEl.textContent = section.title;
        passageTitleEl.textContent = section.passageTitle;
        
        resetSectionBtn.style.display = 'block';
        
        if(state.showResults){
          renderResults();
          return;
        }
        
        if(section.id === 's1'){
          renderPart1();
        } else if(section.id === 's2'){
          renderPart2();
        } else if(section.id === 's3'){
          renderPart3();
        } else if(section.id === 's4'){
          renderSprachbausteine1();
        } else if(section.id === 's5'){
          renderSprachbausteine2();
        }
      }

      function renderPart1(){
        const section = exam.sections[state.sectionIndex];
        
        let textsHTML = `<div class="instructions">Ziehen Sie die passenden √úberschriften auf die Texte. Sie k√∂nnen jede √úberschrift nur einmal verwenden.</div>`;
        
        section.texts.forEach((text, idx) => {
          const letter = String.fromCharCode(97 + idx);
          const selectedHeading = state.answers[text.id];
          
          textsHTML += `
            <div class="text-container">
              <div class="text-title">Text ${letter.toUpperCase()}</div>
              <div class="text-content">${text.content}</div>
              <div class="title-slot ${selectedHeading ? 'has-title' : ''}" data-text-id="${text.id}">
                ${selectedHeading ? getHeadingTextById(selectedHeading) : 'Ziehen Sie hier eine √úberschrift hin'}
              </div>
            </div>
          `;
        });
        
        passageContentEl.innerHTML = textsHTML;
        
        let headingsHTML = `<div class="headings-bank">`;
        section.headings.forEach(heading => {
          const isUsed = section.texts.some(text => state.answers[text.id] === heading.id);
          
          headingsHTML += `
            <div class="heading-item ${isUsed ? 'used' : ''}" draggable="${!isUsed}" data-heading-id="${heading.id}">
              ${heading.id}) ${heading.text}
            </div>
          `;
        });
        
        headingsHTML += `</div>`;
        
        headingsBankContainer.innerHTML = headingsHTML;
        
        setupDragAndDrop();
        
        questionBodyEl.innerHTML = '';
        questionTitleEl.textContent = '';
      }

      function getHeadingTextById(id){
        const section = exam.sections[state.sectionIndex];
        const heading = section.headings.find(h => h.id === id);
        return heading ? `${heading.id}) ${heading.text}` : '';
      }

      function setupDragAndDrop(){
        const headingItems = document.querySelectorAll('.heading-item:not(.used)');
        const titleSlots = document.querySelectorAll('.title-slot');
        
        headingItems.forEach(item => {
          item.addEventListener('dragstart', (e) => {
            e.dataTransfer.setData('text/plain', e.target.dataset.headingId);
          });
        });
        
        titleSlots.forEach(slot => {
          slot.addEventListener('dragover', (e) => {
            e.preventDefault();
            slot.style.background = '#e8f4ff';
          });
          
          slot.addEventListener('dragleave', (e) => {
            slot.style.background = slot.classList.contains('has-title') ? '#e8fbe9' : '#f8fbff';
          });
          
          slot.addEventListener('drop', (e) => {
            e.preventDefault();
            const headingId = e.dataTransfer.getData('text/plain');
            const textId = slot.dataset.textId;
            
            Object.keys(state.answers).forEach(key => {
              if(state.answers[key] === headingId) {
                delete state.answers[key];
              }
            });
            
            state.answers[textId] = headingId;
            renderAll();
          });
        });
      }

      function renderPart2(){
        const section = exam.sections[state.sectionIndex];
        
        passageContentEl.innerHTML = `<div class="passage">${section.passage}</div>`;
        
        let questionsHTML = `<div class="all-questions">`;
        
        section.questions.forEach((question, idx) => {
          const questionNumber = idx + 1;
          const userAnswer = state.answers[question.id];
          
          questionsHTML += `
            <div class="question-block">
              <div class="question-text">${questionNumber}. ${question.text}</div>
              <div class="options">
                ${question.options.map(opt => `
                  <div class="option ${userAnswer === opt.id ? 'selected' : ''}" 
                       onclick="window.lesenApp.selectOption('${question.id}', '${opt.id}')">
                    <div class="radio"></div>
                    <div>${opt.text}</div>
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        });
        
        questionsHTML += `</div>`;
        
        questionBodyEl.innerHTML = questionsHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';
      }

      function renderPart3(){
        const section = exam.sections[state.sectionIndex];
        
        let textsHTML = `
          <div class="instructions">Ziehen Sie die passenden Situationen auf die Texte. Sie k√∂nnen jede Situation nur einmal verwenden. Manchmal passt keine Situation.</div>
          <div class="texts-list">
            <h3>Texte (A-L)</h3>
        `;
        
        section.texts.forEach(text => {
          const userAnswer = Object.keys(state.answers).find(key => state.answers[key] === text.id);
          const selectedSituation = userAnswer ? section.situations.find(h => h.id === userAnswer) : null;
          
          textsHTML += `
            <div class="text-item" data-text-id="${text.id}">
              <div class="text-letter">${text.id})</div>
              <div class="text-content">${text.text}</div>
              <div class="title-slot ${userAnswer ? 'has-title' : ''} ${userAnswer === 'X' ? 'has-x' : ''}" data-text-id="${text.id}">
                ${selectedSituation ? selectedSituation.text : (userAnswer === 'X' ? 'X - Keine passende Situation' : 'Ziehen Sie hier eine Situation hin')}
              </div>
            </div>
          `;
        });
        
        textsHTML += `</div>`;
        
        passageContentEl.innerHTML = textsHTML;
        
        let situationsHTML = `
          <div class="situations-list">
            <h3>Situationen (11-20)</h3>
        `;
        
        section.situations.forEach((situation, idx) => {
          const situationNumber = parseInt(situation.id);
          const isUsed = state.answers[situation.id];
          const isX = state.answers[situation.id] === 'X';
          
          situationsHTML += `
            <div class="situation-item ${isUsed ? 'used' : ''}" draggable="${!isUsed}" data-situation-id="${situation.id}">
              <div class="situation-number">${situationNumber}.</div>
              <div class="situation-text">${situation.text}</div>
              ${!isUsed ? `<button class="exam-btn no-match ${isX ? 'selected' : ''}" onclick="window.lesenApp.markNoMatch('${situation.id}')">X - Kein passender Text</button>` : ''}
            </div>
          `;
        });
        
        situationsHTML += `</div>`;
        
        questionBodyEl.innerHTML = situationsHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';
        
        setupPart3DragAndDrop();
      }

      function markNoMatch(situationId) {
        Object.keys(state.answers).forEach(key => {
          if(state.answers[key] === situationId) {
            delete state.answers[key];
          }
        });
        
        state.answers[situationId] = 'X';
        try{ localStorage.setItem('lesenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        renderAll();
      }

      function setupPart3DragAndDrop(){
        const situationItems = document.querySelectorAll('.situation-item:not(.used)');
        const textSlots = document.querySelectorAll('.text-item .title-slot');
        
        situationItems.forEach(item => {
          item.addEventListener('dragstart', (e) => {
            e.dataTransfer.setData('text/plain', e.target.dataset.situationId);
          });
        });
        
        textSlots.forEach(slot => {
          slot.addEventListener('dragover', (e) => {
            e.preventDefault();
            slot.style.background = '#e8f4ff';
          });
          
          slot.addEventListener('dragleave', (e) => {
            const hasTitle = slot.classList.contains('has-title');
            const hasX = slot.classList.contains('has-x');
            slot.style.background = hasTitle ? '#e8fbe9' : (hasX ? '#f8d7da' : '#f8fbff');
          });
          
          slot.addEventListener('drop', (e) => {
            e.preventDefault();
            const situationId = e.dataTransfer.getData('text/plain');
            const textId = slot.dataset.textId;
            
            Object.keys(state.answers).forEach(key => {
              if(state.answers[key] === situationId) {
                delete state.answers[key];
              }
            });
            
            state.answers[situationId] = textId;
            renderAll();
          });
        });
      }

      function renderSprachbausteine1(){
        const section = exam.sections[state.sectionIndex];
        
        let textWithBlanks = section.fillText;
        
        const blankPlaceholders = [];
        section.fillBlanks.forEach(blank => {
          blankPlaceholders.push(`BLANK_${blank.id}`);
        });
        
        let tempText = textWithBlanks;
        blankPlaceholders.forEach((placeholder, index) => {
          tempText = tempText.replace('________', placeholder);
        });
        
        section.fillBlanks.forEach(blank => {
          const userAnswer = state.answers[blank.id];
          const displayText = userAnswer ? userAnswer : '________';
          tempText = tempText.replace(`BLANK_${blank.id}`, `<span class="blank-word ${userAnswer ? 'has-answer' : ''}" data-blank-id="${blank.id}">${displayText}</span>`);
        });
        
        passageContentEl.innerHTML = `
          <div class="instructions">Klicken Sie auf jede L√ºcke und w√§hlen Sie das passende Wort aus. Sie k√∂nnen die L√ºcken ŸÅŸä beliebiger Reihenfolge ausf√ºllen.</div>
          <div class="fill-blank-container">${tempText}</div>
        `;
        
        document.querySelectorAll('.blank-word').forEach(blank => {
          blank.addEventListener('click', (e) => {
            showOptionsPopup(e.target);
          });
        });
        
        let optionsHTML = `<div class="horizontal-options" style="gap: 8px;">`;
        
        section.fillBlanks.forEach(blank => {
          const userAnswer = state.answers[blank.id];
          
          optionsHTML += `
            <div class="option-row" style="padding: 8px; margin-bottom: 5px;">
              <div class="option-number">${blank.id}</div>
              <div class="option-buttons">
                ${blank.options.map(opt => `
                  <div class="option-btn ${userAnswer === opt ? 'selected' : ''}" 
                       onclick="window.lesenApp.selectSprachbausteine1('${blank.id}', '${opt}')" 
                       style="padding: 6px 12px; font-size: 12px;">
                    ${opt}
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        });
        
        optionsHTML += `</div>`;
        
        questionBodyEl.innerHTML = optionsHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';
      }

      function showOptionsPopup(blankElement){
        const existingPopup = document.querySelector('.options-popup');
        if(existingPopup) {
          existingPopup.remove();
        }
        
        const blankId = blankElement.getAttribute('data-blank-id');
        const section = exam.sections.find(s => s.id === 's4');
        const blank = section.fillBlanks.find(b => b.id === blankId);
        
        if(!blank) return;
        
        const popup = document.createElement('div');
        popup.className = 'options-popup';
        
        blank.options.forEach(opt => {
          const optionItem = document.createElement('div');
          optionItem.className = 'option-item';
          optionItem.textContent = opt;
          optionItem.onclick = () => {
            selectSprachbausteine1(blankId, opt);
            popup.remove();
          };
          popup.appendChild(optionItem);
        });
        
        blankElement.appendChild(popup);
      }

      function selectSprachbausteine1(blankId, answer){
        state.answers[blankId] = answer;
        renderAll();
      }

      function renderSprachbausteine2(){
        const section = exam.sections[state.sectionIndex];
        // Build text but replace blanks with unique placeholders first (prevents ambiguous replacements)
        let textWithPlaceholders = section.fillText2;
        const placeholders = [];
        section.fillBlanks2.forEach(blank => {
          const ph = `BLANK_${blank.id}`;
          placeholders.push({id: blank.id, ph});
          // replace first occurrence of the visual underline with placeholder
          textWithPlaceholders = textWithPlaceholders.replace('________', ph);
        });

        // Now replace placeholders with actual span elements showing current answer (or underscore)
        placeholders.forEach(item => {
          const userAnswer = state.answers[item.id];
          const displayText = userAnswer ? userAnswer : '________';
          const span = `<span class="blank-slot ${userAnswer ? 'has-answer' : ''}" data-blank-id="${item.id}">${displayText}</span>`;
          textWithPlaceholders = textWithPlaceholders.replace(item.ph, span);
        });

        passageContentEl.innerHTML = `
          <div class="instructions">Klicken Sie auf jede L√ºcke und w√§hlen Sie das passende Wort aus. Sie k√∂nnen jedes Wort nur einmal verwenden.</div>
          <div class="fill-blank-container">${textWithPlaceholders}</div>
        `;

        // attach click handlers to slots
        document.querySelectorAll('.blank-slot').forEach(slot => {
          slot.addEventListener('click', (e) => {
            // use the element itself to open popup
            showSprachbausteine2Options(slot);
          });
        });

        // Build word bank on the right
        let wordBankHTML = `<div class="word-bank-vertical" style="gap: 8px;">`;
        const usedWords = Object.values(state.answers);
        // Use section.wordBank if present, otherwise derive from fillBlanks2 options
        const bank = section.wordBank && section.wordBank.length ? section.wordBank : (section.fillBlanks2[0] ? section.fillBlanks2[0].options : []);
        bank.forEach(word => {
          const isUsed = usedWords.includes(word);
          wordBankHTML += `
            <div class="bank-word-vertical ${isUsed ? 'used' : ''}" 
                 draggable="${!isUsed}" 
                 data-word="${word}"
                 ${!isUsed ? `onclick="window.lesenApp.selectSprachbausteine2FromBank('${word}')"` : ''}>
              ${word}
            </div>
          `;
        });
        wordBankHTML += `</div>`;
        questionBodyEl.innerHTML = wordBankHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';

        setupSprachbausteine2DragAndDrop();
      }

      // --- Added functions to handle drag/drop and clicks for Sprachbausteine Teil 2 ---
      let lastClickedSprachSlot = null;

      function setupSprachbausteine2DragAndDrop(){
        // bank words: make draggable if not used, attach dragstart
        const bankWords = Array.from(document.querySelectorAll('.bank-word-vertical'));
        bankWords.forEach(el => {
          const word = el.dataset.word;
          if(!el.classList.contains('used')){
            el.setAttribute('draggable','true');
          } else {
            el.setAttribute('draggable','false');
          }
          // ensure single attached listener
          el.removeEventListener('dragstart', el._dstart);
          el._dstart = (e) => {
            e.dataTransfer.setData('text/plain', word);
            // also set an indicator
            e.dataTransfer.setData('source', 'bank');
          };
          el.addEventListener('dragstart', el._dstart);

          // keep onclick behavior (select into clicked slot)
          el.removeEventListener('click', el._onclick);
          el._onclick = () => {
            if(el.classList.contains('used')) return;
            selectSprachbausteine2FromBank(word);
          };
          el.addEventListener('click', el._onclick);
        });

        // blank slots: allow drop
        const slots = Array.from(document.querySelectorAll('.blank-slot'));
        slots.forEach(slot => {
          slot.addEventListener('dragover', (e) => {
            e.preventDefault();
            slot.classList.add('drag-over');
          });
          slot.addEventListener('dragleave', (e) => {
            slot.classList.remove('drag-over');
          });
          slot.addEventListener('drop', (e) => {
            e.preventDefault();
            slot.classList.remove('drag-over');
            const word = e.dataTransfer.getData('text/plain') || e.dataTransfer.getData('text/html');
            if(!word) return;
            // Determine blank id
            const blankId = slot.dataset.blankId;
            if(!blankId) return;
            // If this word is already used in another slot, free it
            Object.keys(state.answers).forEach(k => {
              if(state.answers[k] === word){
                delete state.answers[k];
              }
            });
            // If slot had a previous answer, free that bank word
            const prev = state.answers[blankId];
            if(prev){
              const prevEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === prev);
              if(prevEl){
                prevEl.classList.remove('used');
                prevEl.setAttribute('draggable','true');
                prevEl.addEventListener('click', prevEl._onclick);
              }
            }
            // mark bank word used
            const bankEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === word);
            if(bankEl){
              bankEl.classList.add('used');
              bankEl.setAttribute('draggable','false');
              // remove click to prevent double-placing
              bankEl.removeEventListener('click', bankEl._onclick);
            }
            // assign to state and re-render
            state.answers[blankId] = word;
            renderAll();
          });
        });
      }

      function showSprachbausteine2Options(slot){
        // highlight selected slot so click from bank knows target
        document.querySelectorAll('.blank-slot').forEach(s => s.classList.remove('selected-sprach'));
        slot.classList.add('selected-sprach');
        lastClickedSprachSlot = slot;
      }

      function selectSprachbausteine2FromBank(word){
        // choose target slot: prefer lastClicked, otherwise first empty
        let slot = lastClickedSprachSlot;
        if(!slot){
          slot = Array.from(document.querySelectorAll('.blank-slot')).find(s => {
            const id = s.dataset.blankId;
            return !state.answers[id];
          });
        }
        if(!slot) {
          // if none available, do nothing
          return;
        }
        const blankId = slot.dataset.blankId;
        // free previous occurrence of word
        Object.keys(state.answers).forEach(k => {
          if(state.answers[k] === word){
            delete state.answers[k];
          }
        });
        // free previous word in target slot
        const prev = state.answers[blankId];
        if(prev){
          const prevEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === prev);
          if(prevEl){
            prevEl.classList.remove('used');
            prevEl.setAttribute('draggable','true');
            if(prevEl._onclick) prevEl.addEventListener('click', prevEl._onclick);
          }
        }
        // mark selected bank word as used
        const bankEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === word);
        if(bankEl){
          bankEl.classList.add('used');
          bankEl.setAttribute('draggable','false');
          if(bankEl._onclick) try{ bankEl.removeEventListener('click', bankEl._onclick); }catch(e){}
        }
        // assign value
        state.answers[blankId] = word;
        try{ localStorage.setItem('lesenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        lastClickedSprachSlot = null;
        renderAll();
      }

      function selectOption(questionId, optionId){
        state.answers[questionId] = optionId;
        try{ localStorage.setItem('lesenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        renderAll();
      }

      function renderResults(){
        let resultsHTML = `<h2>Ergebnisse</h2>`;
        let totalCorrect = 0;
        let totalQuestions = 0;
        
        exam.sections.forEach(section => {
          resultsHTML += `<div class="result-item"><h3>${section.title}</h3>`;
          
          if(section.id === 's1'){
            section.texts.forEach(text => {
              totalQuestions++;
              const userAnswer = state.answers[text.id];
              const isCorrect = userAnswer === text.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>Text ${text.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's2'){
            section.questions.forEach(question => {
              totalQuestions++;
              const userAnswer = state.answers[question.id];
              const isCorrect = userAnswer === question.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>${question.text}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's3'){
            section.situations.forEach(situation => {
              totalQuestions++;
              const userAnswer = state.answers[situation.id];
              const correctText = section.texts.find(t => t.correctAnswer === situation.id);
              const isCorrect = userAnswer === (correctText ? correctText.id : null);
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>Situation ${situation.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's4'){
            section.fillBlanks.forEach(blank => {
              totalQuestions++;
              const userAnswer = state.answers[blank.id];
              const isCorrect = userAnswer === blank.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>L√ºcke ${blank.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's5'){
            section.fillBlanks2.forEach(blank => {
              totalQuestions++;
              const userAnswer = state.answers[blank.id];
              const isCorrect = userAnswer === blank.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>L√ºcke ${blank.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          }
          
          resultsHTML += `</div>`;
        });
        
        const percentage = totalQuestions > 0 ? Math.round((totalCorrect / totalQuestions) * 100) : 0;
        resultsHTML += `<div class="result-item"><h3>Gesamtergebnis: ${totalCorrect}/${totalQuestions} (${percentage}%)</h3></div>`;
        
        passageContentEl.innerHTML = resultsHTML;
        questionBodyEl.innerHTML = '';
        sectionNameEl.textContent = 'Ergebnisse';
        questionTitleEl.textContent = '';
      }

      /* ===== Event Listeners ===== */
      document.getElementById('prevBtn-lesen').addEventListener('click', ()=>{
        if(state.sectionIndex > 0){
          state.sectionIndex--;
          state.questionIndex = 0;
          renderAll();
        }
      });

      document.getElementById('nextBtn-lesen').addEventListener('click', ()=>{
        if(state.sectionIndex < exam.sections.length - 1){
          state.sectionIndex++;
          state.questionIndex = 0;
          renderAll();
        }
      });

      resultBtn.addEventListener('click', ()=>{
        state.showResults = !state.showResults;
        renderAll();
      });

      resetBtn.addEventListener('click', ()=>{
        if(confirm('M√∂chten Sie wirklich von neu beginnen? Alle Antworten werden gel√∂scht.')){
          state.answers = {};
          state.marked = {};
          state.showResults = false;
          resetTimer();
          renderAll();
        }
      });

      resetSectionBtn.addEventListener('click', resetCurrentSection);

      document.getElementById('saveBtn-lesen').addEventListener('click', ()=>{
        statusText.textContent = 'Gespeichert';
        setTimeout(()=>{statusText.textContent = 'Nicht gespeichert'}, 2000);
      });

      document.getElementById('submitBtn-lesen').addEventListener('click', ()=>{
        if(confirm('M√∂chten Sie die Pr√ºfung wirklich abgeben?')){
          state.showResults = true;
          renderAll();
        }
      });

      document.getElementById('nextBtn-lesen').addEventListener('click', ()=>{
        showPage('hoeren-page');
      });

      /* ===== Initialize ===== */
      updateTimerDisplay();
      renderAll();
      startTimer();
      
      // Expose functions to global scope for event handlers
      window._lesenState = state;
      window.lesenApp = {
        selectOption,
        markNoMatch,
        selectSprachbausteine1,
        selectSprachbausteine2FromBank
      };
    }

    // ===== H√ñREN PAGE FUNCTIONALITY =====
    function initHoerenPage() {
      /* ===== Self-contained exam (embedded) ===== */
      const exam = {
        id: "exam-h√∂rverstehen",
        durationSec: 17 * 60, // 17 minutes in seconds
        sections: [
          { 
            id: "h√∂rverstehen1", 
            title: "H√∂rverstehen, Teil 1", 
            points: 25,
            correctAnswers: { "41": "falsch", "42": "richtig", "43": "falsch", "44": "richtig", "45": "falsch" },
            questions: [
              {
                id: "41",
                text: "Viele Kunden w√ºrden f√ºr bessere Serviceleistungen der Paketdienste h√∂here Geb√ºhren bezahlen."
              },
              {
                id: "42", 
                text: "Nach dem Unfall konnten beide Schiffe ihre Fahrt nicht fortsetzen."
              },
              {
                id: "43",
                text: "Europaweit gibt es immer weniger V√∂gel."
              },
              {
                id: "44",
                text: "Die Polizei hat auf der Autobahn ein dort verbotenes Fahrzeug entdeckt."
              },
              {
                id: "45",
                text: "Bei dem Festival konnte man Konzerte an verschiedenen Orten besuchen."
              }
            ]
          },
          { 
            id: "h√∂rverstehen2", 
            title: "H√∂rverstehen, Teil 2", 
            points: 25,
            correctAnswers: { "46": "falsch", "47": "richtig", "48": "falsch", "49": "richtig", "50": "falsch", "51": "falsch", "52": "falsch", "53": "richtig", "54": "falsch", "55": "richtig" },
            questions: [
              {
                id: "46",
                text: "Herr Karimov hat vor sechs Jahren die Internetplattform ZEITPLAN gegr√ºndet."
              },
              {
                id: "47",
                text: "Die Mitglieder bekommen f√ºr ihre Hilfe ein Stundenguthaben."
              },
              {
                id: "48", 
                text: "Herr Karimov hatte ein eigenes Handwerksunternehmen."
              },
              {
                id: "49",
                text: "Nach dem Umzug aufs Land war er auf die Hilfe der Nachbarn angewiesen."
              },
              {
                id: "50",
                text: "Manchmal erwarten Mitglieder keine Gegenleistung f√ºr ihre Arbeit."
              },
              {
                id: "51",
                text: "Meistens brauchen alleinstehende Frauen Herrn Karimovs Hilfe."
              },
              {
                id: "52",
                text: "Viele Menschen sehen im ZEITPLAN eine Konkurrenz zu Handwerksbetrieben."
              },
              {
                id: "53",
                text: "Herr Karimov erledigt nicht so gerne B√ºroarbeit."
              },
              {
                id: "54",
                text: "Wer sich bei der Nachbarschaftshilfe einbringen m√∂chte, muss sich pers√∂nlich vorstellen."
              },
              {
                id: "55",
                text: "Herr Karimov brauchte vor√ºbergehend einen Chauffeur."
              }
            ]
          },
          { 
            id: "h√∂rverstehen3", 
            title: "H√∂rverstehen, Teil 3", 
            points: 25,
            correctAnswers: { "56": "richtig", "57": "falsch", "58": "falsch", "59": "falsch", "60": "richtig" },
            questions: [
              {
                id: "56",
                text: "Besucher des Reitturniers sollten m√∂glichst Parkpl√§tze au√üerhalb des Turniergel√§ndes nutzen."
              },
              {
                id: "57",
                text: "Das Open-Air-Gospelkonzert wird live im Radio √ºbertragen."
              },
              {
                id: "58",
                text: "Bei der Berliner Museumsnacht k√∂nnen Sie mit einer Sonderbuslinie bequem jedes Museum erreichen."
              },
              {
                id: "59",
                text: "Wegen Gl√§tte ist die A5 zwischen Mannheim und Frankfurt in beide Richtungen voll gesperrt."
              },
              {
                id: "60",
                text: "Hotelreservierungen in Dresden sind ausschlie√ülich telefonisch m√∂glich."
              }
            ]
          }
        ]
      };

      /* ===== State & DOM refs ===== */
      let state = { 
        sectionIndex: 0, 
        answers: {}, 
        remaining: exam.durationSec,
        showResults: false,
        timerStarted: false,
        timerInterval: null
      };
      
      const topTiles = document.getElementById('topTiles-hoeren');
      const contentContainer = document.getElementById('contentContainer-hoeren');
      const timerEl = document.getElementById('timer-hoeren');
      const statusText = document.getElementById('statusText-hoeren');

      /* ===== Timer Functions ===== */
      function startTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        
        state.timerStarted = true;
        state.timerInterval = setInterval(() => {
          if (state.remaining <= 0) {
            clearInterval(state.timerInterval);
            timerEl.textContent = 'Zeit abgelaufen';
            return;
          }
          state.remaining--;
          updateTimerDisplay();
        }, 1000);
      }

      function resetTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        state.remaining = exam.durationSec;
        state.timerStarted = false;
        updateTimerDisplay();
        startTimer();
      }

      function updateTimerDisplay() {
        const min = Math.floor(state.remaining / 60);
        const sec = state.remaining % 60;
        timerEl.textContent = `Verbleibende Zeit: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
      }

      /* ===== Render ===== */
      function renderTopTiles() { 
        topTiles.innerHTML = ''; 
        exam.sections.forEach((sec, idx) => { 
          const div = document.createElement('div'); 
          div.className = 'tile' + (idx === state.sectionIndex ? ' active' : '') + (isSectionDone(sec) ? ' done' : ''); 
          div.innerHTML = `<div>${sec.title}</div><div class="points">${sec.points} P</div>`; 
          div.onclick = () => { state.sectionIndex = idx; state.showResults = false; renderAll(); }; 
          topTiles.appendChild(div); 
        }); 
      }

      function isSectionDone(section) {
        const answers = state.answers[section.id];
        if (!answers) return false;
        
        // ÿ™ÿ≠ŸÇŸÇ ÿ•ÿ∞ÿß ÿ™ŸÖÿ™ ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ© ÿπŸÑŸâ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ© ŸÅŸä Ÿáÿ∞ÿß ÿßŸÑŸÇÿ≥ŸÖ
        const answeredQuestions = Object.keys(answers).length;
        const totalQuestions = section.questions.length;
        
        return answeredQuestions === totalQuestions;
      }

      function renderAll() {
        renderTopTiles();
        
        if (state.showResults) {
          renderResults();
          return;
        }
        
        renderListeningSection();
      }

      function renderListeningSection() {
        const section = exam.sections[state.sectionIndex];
        const currentAnswers = state.answers[section.id] || {};
        
        let contentHTML = `
          <div class="panel-title">${section.title}</div>
          <div class="instructions">
            Sie h√∂ren die Nachrichten. Entscheiden Sie beim H√∂ren, ob die Aussagen richtig oder falsch sind. 
            Sie h√∂ren die Nachrichten nur einmal. Sie haben jetzt 30 Sekunden, um die Aussagen zu lesen.
          </div>
          
          <div class="listening-task">
            <table class="true-false-table">
              <thead>
                <tr>
                  <th style="width: 10%">Nr.</th>
                  <th style="width: 60%">Aussage</th>
                  <th style="width: 30%">Ihre Antwort</th>
                </tr>
              </thead>
              <tbody>
        `;
        
        section.questions.forEach((question, index) => {
          const currentAnswer = currentAnswers[question.id] || '';
          contentHTML += `
            <tr>
              <td><strong>${question.id}</strong></td>
              <td class="question-text">${question.text}</td>
              <td>
                <div class="answer-options">
                  <label class="answer-option">
                    <input 
                      type="radio" 
                      name="q${section.id}_${question.id}" 
                      value="richtig" 
                      ${currentAnswer === 'richtig' ? 'checked' : ''}
                      onchange="window.hoerenApp.updateListeningAnswer('${section.id}', '${question.id}', this.value)"
                    >
                    Richtig
                  </label>
                  <label class="answer-option">
                    <input 
                      type="radio" 
                      name="q${section.id}_${question.id}" 
                      value="falsch" 
                      ${currentAnswer === 'falsch' ? 'checked' : ''}
                      onchange="window.hoerenApp.updateListeningAnswer('${section.id}', '${question.id}', this.value)"
                    >
                    Falsch
                  </label>
                </div>
              </td>
            </tr>
          `;
        });
        
        contentHTML += `
              </tbody>
            </table>
          </div>
        `;
        
        contentContainer.innerHTML = contentHTML;
      }

      function updateListeningAnswer(sectionId, questionId, answer) {
        if (!state.answers[sectionId]) {
          state.answers[sectionId] = {};
        }
        state.answers[sectionId][questionId] = answer;
        try{ localStorage.setItem('hoerenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        
        // ÿ•ÿπÿßÿØÿ© ÿπÿ±ÿ∂ ÿßŸÑÿ®ŸÑÿßÿ∑ÿßÿ™ ŸÑÿ™ÿ≠ÿØŸäÿ´ ÿ≠ÿßŸÑÿ© "ÿ™ŸÖ"
        renderTopTiles();
      }

      function renderResults() {
        let resultsHTML = `<div class="panel-title">Ergebnisse - H√∂rverstehen</div>`;
        
        exam.sections.forEach(section => {
          const userAnswers = state.answers[section.id] || {};
          let correctCount = 0;
          
          resultsHTML += `
            <div class="listening-task">
              <h3>${section.title} (${section.points} Punkte)</h3>
              <table class="true-false-table">
                <thead>
                  <tr>
                    <th style="width: 10%">Nr.</th>
                    <th style="width: 50%">Aussage</th>
                    <th style="width: 15%">Ihre Antwort</th>
                    <th style="width: 15%">Richtige Antwort</th>
                    <th style="width: 10%">Punkte</th>
                  </tr>
                </thead>
                <tbody>
          `;
          
          section.questions.forEach((question) => {
            const userAnswer = userAnswers[question.id] || '-';
            const correctAnswer = section.correctAnswers[question.id];
            const gotCorrect = userAnswer === correctAnswer;
            const points = gotCorrect ? "1" : "0";
            
            if (gotCorrect) correctCount++;
            
            const rowClass = gotCorrect ? 'correct-answer' : 'incorrect-answer';
            
            resultsHTML += `
              <tr class="${rowClass}">
                <td><strong>${question.id}</strong></td>
                <td class="question-text">${question.text}</td>
                <td>${userAnswer}</td>
                <td>${correctAnswer}</td>
                <td><strong>${points}</strong></td>
              </tr>
            `;
          });
          
          const totalPoints = Math.round((correctCount / section.questions.length) * section.points);
          
          resultsHTML += `
                </tbody>
              </table>
              <div style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 6px;">
                <strong>Erreichte Punkte: ${correctCount}/${section.questions.length} richtig = ${totalPoints}/${section.points} Punkten</strong>
              </div>
            </div>
          `;
        });
        
        contentContainer.innerHTML = resultsHTML;
      }

      /* ===== Event Listeners ===== */
      document.getElementById('prevBtn-hoeren').addEventListener('click', () => {
        if (state.sectionIndex > 0) {
          state.sectionIndex--;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('nextBtn-hoeren').addEventListener('click', () => {
        if (state.sectionIndex < exam.sections.length - 1) {
          state.sectionIndex++;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('resultBtn-hoeren').addEventListener('click', () => {
        state.showResults = !state.showResults;
        renderAll();
      });

      document.getElementById('resetBtn-hoeren').addEventListener('click', () => {
        if (confirm('M√∂chten Sie wirklich von neu beginnen? Alle Antworten werden gel√∂scht.')) {
          state.answers = {};
          state.showResults = false;
          resetTimer();
          renderAll();
        }
      });

      document.getElementById('saveBtn-hoeren').addEventListener('click', () => {
        statusText.textContent = 'Gespeichert';
        setTimeout(() => { statusText.textContent = 'Nicht gespeichert' }, 2000);
      });

      document.getElementById('submitBtn-hoeren').addEventListener('click', () => {
        if (confirm('M√∂chten Sie die Pr√ºfung wirklich abgeben?')) {
          state.showResults = true;
          renderAll();
        }
      });

      document.getElementById('nextBtn-hoeren').addEventListener('click', () => {
        showPage('schreiben-page');
      });

      /* ===== Initialize ===== */
      updateTimerDisplay();
      renderAll();
      startTimer();
      
      // Expose functions to global scope for event handlers
        window._hoerenState = state;
        window.hoerenApp = {
        updateListeningAnswer
      };
    }

    // ===== SCHREIBEN PAGE FUNCTIONALITY =====
    function initSchreibenPage() {
      /* ===== Self-contained exam (embedded) ===== */
      const exam = {
        id: "exam-002",
        durationSec: 30 * 60, // 30 minutes in seconds
        sections: [
          { 
            id: "s1", 
            title: "Schreiben, Teil 1", 
            points: 45,
            passageTitle: "Aufgabe: Schreiben Sie eine E-Mail",
            passage: "",
            writingTask: {
              prompt: `Schmelzk√§se - Alpengeschmack

Die Reinheit der Natur auf Ihrem Teller! 
Schmelzk√§se ist eine besondere Spezialit√§t unter den K√§sen und wird aus gereiftem Schnittk√§se 
oder Frischk√§se auf Grundlage einer traditionellen Methode weiterverarbeitet und gleichzeitig 
haltbar gemacht. 

Schmelzk√§se - Alpengeschmack ist in der modernen K√ºche besonders beliebt, da er vielseitig 
einsetzbar ist: Er bindet So√üen und Suppen, verleiht den Gerichten eine feinw√ºrzige Note, ist perfekt 
zum √úberbacken geeignet und darf auf keinem Fr√ºhst√ºcks- oder Abendbrottisch fehlen. 

Zutaten: 
50 % K√§se, S√º√ümolke, Butter, Schmelzsalze, Natriumphosphate, Natriumcitrate, Polyphosphate, 
Magermilch aus Kuhmilch, Milcheiwei√ü, Speisesalz, 
Farbstoffe: Paprikaextrakt, Carotin. 

10 Scheiben, einzeln in Folie verpackt. 
Unge√∂ffnet mindestens 24 Tage haltbar. Nach dem √ñffnen gek√ºhlt lagern. 

Artikelnummer: 9977 8855 
Hersteller: Molkerei Alpengeschmack 
Lindauer Stra√üe 5 
87437 Kempten 
Tel. 0831-181921 
www.molkerei-alpengeschmack.de`,
              requirements: [
                "Erl√§utern Sie, wozu Sie diesen K√§se verwenden.",
                "Beschreiben Sie, welche gesundheitlichen Beschwerden Sie nach dem Essen hatten.",
                "Erkl√§ren Sie, warum die Fremdk√∂rper gesundheitsgef√§hrdend sind.",
                "Beschreiben Sie, wen Sie au√üer dem Hersteller noch informiert haben."
              ],
              wordCount: 0
            }
          }
        ]
      };

      /* ===== State & DOM refs ===== */
      let state = { 
        sectionIndex: 0, 
        answers: {}, 
        remaining: exam.durationSec,
        showResults: false,
        timerStarted: false,
        timerInterval: null
      };
      
      const topTiles = document.getElementById('topTiles-schreiben');
      const passageTitleEl = document.getElementById('passageTitle-schreiben');
      const passageContentEl = document.getElementById('passageContent-schreiben');
      const writingContainer = document.getElementById('writingContainer-schreiben');
      const timerEl = document.getElementById('timer-schreiben');
      const statusText = document.getElementById('statusText-schreiben');

      /* ===== Timer Functions ===== */
      function startTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        
        state.timerStarted = true;
        state.timerInterval = setInterval(() => {
          if (state.remaining <= 0) {
            clearInterval(state.timerInterval);
            timerEl.textContent = 'Zeit abgelaufen';
            return;
          }
          state.remaining--;
          updateTimerDisplay();
        }, 1000);
      }

      function resetTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        state.remaining = exam.durationSec;
        state.timerStarted = false;
        updateTimerDisplay();
        startTimer();
      }

      function updateTimerDisplay() {
        const min = Math.floor(state.remaining / 60);
        const sec = state.remaining % 60;
        timerEl.textContent = `Verbleibende Zeit: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
      }

      /* ===== Render ===== */
      function renderTopTiles() { 
        topTiles.innerHTML = ''; 
        exam.sections.forEach((sec, idx) => { 
          const div = document.createElement('div'); 
          div.className = 'tile' + (idx === state.sectionIndex ? ' active' : '') + (isSectionDone(sec) ? ' done' : ''); 
          div.innerHTML = `<div>${sec.title}</div><div class="points">${sec.points} P</div>`; 
          div.onclick = () => { state.sectionIndex = idx; state.showResults = false; renderAll(); }; 
          topTiles.appendChild(div); 
        }); 
      }

      function isSectionDone(section) {
        return state.answers[section.id] && state.answers[section.id].length > 0;
      }

      function renderAll() {
        renderTopTiles();
        const section = exam.sections[state.sectionIndex];
        passageTitleEl.textContent = section.passageTitle;
        
        if (state.showResults) {
          renderResults();
          return;
        }
        
        renderWritingSection();
      }

      function renderWritingSection() {
        const section = exam.sections[state.sectionIndex];
        
        // Render the prompt in left panel
        passageContentEl.innerHTML = `
          <div class="writing-task">
            <div class="writing-prompt">${section.writingTask.prompt}</div>
            <div class="instructions" style="border:1px solid #e1e8f6; padding:10px; margin:10px 0; border-radius:6px; background:#ffffff;">Sie haben dieses Produkt gekauft, es war aber verunreinigt. 
Der K√§se enthielt Fremdk√∂rper, und Sie sind nach dem Essen erkrankt. 
Schreiben Sie einen Beschwerdebrief an den Hersteller.</div>
            <div class="writing-requirements">
              <h4>Schreiben Sie in Ihrer E-Mail:</h4>
              <ul>
                ${section.writingTask.requirements.map(req => `<li>${req}</li>`).join('')}
              </ul>
            </div>
            <div class="instructions">
              Schreiben Sie eine E-Mail (ca. 150-200 W√∂rter). Achten Sie auf den Textaufbau (Anrede, Einleitung, Hauptteil, Schluss) und eine angemessene Formulierung.
            </div>
          </div>
        `;
        
        // Render writing area in right panel
        const currentAnswer = state.answers[section.id] || '';
        const wordCount = countWords(currentAnswer);
        
        writingContainer.innerHTML = `
          <div class="writing-area">
            <textarea 
              class="writing-textarea" 
              placeholder="Schreiben Sie hier Ihre E-Mail..."
              oninput="window.schreibenApp.updateWritingAnswer('${section.id}', this.value)"
            >${currentAnswer}</textarea>
            <div class="word-counter">
              W√∂rter: <span class="count">${wordCount}</span>
            </div>
          </div>
        `;
      }

      function countWords(text) {
        return text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
      }

      function updateWritingAnswer(sectionId, text) {
        state.answers[sectionId] = text;
        try{ localStorage.setItem('schreibenAnswers', JSON.stringify({content: state.answers[sectionId], wordCount: (state.answers[sectionId]||'').trim().split(/\s+/).filter(Boolean).length})); }catch(e){}
        
        const wordCount = countWords(text);
        document.querySelector('.word-counter .count').textContent = wordCount;
      }

      function renderResults() {
        let resultsHTML = `<h2>Ergebnisse</h2>`;
        
        exam.sections.forEach(section => {
          resultsHTML += `<div class="writing-task"><h3>${section.title}</h3>`;
          
          const userAnswer = state.answers[section.id];
          const wordCount = countWords(userAnswer);
          
          resultsHTML += `
            <div class="writing-requirements">
              <h4>Ihre Antwort (${wordCount} W√∂rter):</h4>
              <div style="white-space: pre-wrap; background: white; padding: 15px; border-radius: 6px; border: 1px solid #e1e8f6; margin-top: 10px;">${userAnswer || 'Keine Antwort'}</div>
            </div>
          `;
          
          resultsHTML += `</div>`;
        });
        
        passageContentEl.innerHTML = resultsHTML;
        writingContainer.innerHTML = '';
      }

      /* ===== Event Listeners ===== */
      document.getElementById('prevBtn-schreiben').addEventListener('click', () => {
        if (state.sectionIndex > 0) {
          state.sectionIndex--;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('nextBtn-schreiben').addEventListener('click', () => {
        if (state.sectionIndex < exam.sections.length - 1) {
          state.sectionIndex++;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('resultBtn-schreiben').addEventListener('click', () => {
        state.showResults = !state.showResults;
        renderAll();
      });

      document.getElementById('resetBtn-schreiben').addEventListener('click', () => {
        if (confirm('M√∂chten Sie wirklich von neu beginnen? Alle Antworten werden gel√∂scht.')) {
          state.answers = {};
          state.showResults = false;
          resetTimer();
          renderAll();
        }
      });

      document.getElementById('saveBtn-schreiben').addEventListener('click', () => {
        statusText.textContent = 'Gespeichert';
        setTimeout(() => { statusText.textContent = 'Nicht gespeichert' }, 2000);
      });

      document.getElementById('submitBtn-schreiben').addEventListener('click', () => {
        if (confirm('M√∂chten Sie die Pr√ºfung wirklich abgeben?')) {
          state.showResults = true;
          renderAll();
        }
      });

      document.getElementById('nextBtn-schreiben').addEventListener('click', () => {
        showPage('ergebnisse-page');
      });

      /* ===== Initialize ===== */
      updateTimerDisplay();
      renderAll();
      startTimer();
      
      // Expose functions to global scope for event handlers
        window._schreibenState = state;
        window.schreibenApp = {
        updateWritingAnswer
      };
    }

    // ===== ERGEBNISSE PAGE FUNCTIONALITY =====
    function initErgebnissePage() {
      // ===== ÿßŸÑÿ•ÿ¨ÿßÿ®ÿßÿ™ ÿßŸÑÿµÿ≠Ÿäÿ≠ÿ© ÿßŸÑŸÖÿ±ŸÉÿ≤Ÿäÿ© =====
      // ŸÖŸÑÿßÿ≠ÿ∏ÿ©: Ÿäÿ¨ÿ® ŸÖŸÑÿ° Ÿáÿ∞ÿß ÿßŸÑŸÉÿßÿ¶ŸÜ ŸÖŸÜ ÿßŸÑÿßŸÖÿ™ÿ≠ÿßŸÜ ÿßŸÑÿ£ÿµŸÑŸä ŸÑŸÑÿπŸÖŸäŸÑ
      const CORRECT_ANSWERS = {
        lesen: {
          // ÿßŸÑÿ¨ÿ≤ÿ° ÿßŸÑÿ£ŸàŸÑ: √úberschriften zuordnen (ÿßŸÑŸÜÿµŸàÿµ 1-5)
          "text1": "b",
          "text2": "i", 
          "text3": "a",
          "text4": "g",
          "text5": "c",
          
          // ÿßŸÑÿ¨ÿ≤ÿ° ÿßŸÑÿ´ÿßŸÜŸä: Fragen zum Text (ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ© s2q1-s2q5)
          "s2q1": "s2q1o2",
          "s2q2": "s2q2o1",
          "s2q3": "s2q3o3",
          "s2q4": "s2q4o1",
          "s2q5": "s2q5o1",
          
          // ÿßŸÑÿ¨ÿ≤ÿ° ÿßŸÑÿ´ÿßŸÑÿ´: Texte zuordnen (ÿßŸÑŸÖŸàÿßŸÇŸÅ 11-20)
          "11": "D",
          "12": "X",
          "13": "F",
          "14": "C",
          "15": "J",
          "16": "K",
          "17": "X",
          "18": "A",
          "19": "H",
          "20": "L",
          
          // Sprachbausteine Teil 1 (ÿßŸÑŸÅÿ±ÿßÿ∫ÿßÿ™ 21-30)
          "21": "aus",
          "22": "was",
          "23": "da",
          "24": "wird",
          "25": "w√§re",
          "26": "konnte",
          "27": "denn",
          "28": "Beides",
          "29": "noch",
          "30": "auf",
          
          // Sprachbausteine Teil 2 (ÿßŸÑŸÅÿ±ÿßÿ∫ÿßÿ™ 31-40)
          "31": "SOGAR",
          "32": "MIT",
          "33": "SONDERN",
          "34": "OHNE",
          "35": "ANSTATT",
          "36": "BESONDERS",
          "37": "ABER",
          "38": "SOLLTE",
          "39": "UM",
          "40": "SCHON"
        },
        
        hoeren: {
          // H√∂ren Teil 1 (ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ© 41-45)
          "41": "falsch",
          "42": "falsch",
          "43": "richtig",
          "44": "richtig",
          "45": "richtig",
          
          // H√∂ren Teil 2 (ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ© 46-55)
          "46": "falsch",
          "47": "richtig",
          "48": "falsch",
          "49": "falsch",
          "50": "richtig",
          "51": "falsch",
          "52": "falsch",
          "53": "richtig",
          "54": "richtig",
          "55": "richtig",
          
          // H√∂ren Teil 3 (ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ© 56-60)
          "56": "richtig",
          "57": "falsch",
          "58": "richtig",
          "59": "falsch",
          "60": "falsch"
        }
      };

      const CONFIG = {
        totals: { 
          lesen: 105, 
          hoeren: 75, 
          schreiben: 45, 
          gesamt: 225 
        },
        counts: { 
          lesen: 40, 
          hoeren: 20 
        },
        hoerenCorrect: CORRECT_ANSWERS.hoeren, // ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ•ÿ¨ÿßÿ®ÿßÿ™ ÿßŸÑŸÖÿ±ŸÉÿ≤Ÿäÿ©
        lesenCorrect: CORRECT_ANSWERS.lesen    // ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ•ÿ¨ÿßÿ®ÿßÿ™ ÿßŸÑŸÖÿ±ŸÉÿ≤Ÿäÿ©
      };

      function normalizeAnswer(a) {
        if (a === null || a === undefined) return '';
        let s = String(a).trim();
        if (s === '') return '';
        const low = s.toLowerCase();
        if (["richtig", "true", "yes", "ja"].includes(low)) return 'richtig';
        if (["falsch", "false", "no", "nein"].includes(low)) return 'falsch';
        return s;
      }

      // ===== ÿØŸàÿßŸÑ ŸÖÿ≥ÿßÿπÿØÿ© =====
      function getHeadingText(headingId) {
        if (!headingId || headingId === '-' || headingId === 'X') return '-';
        const headings = {
          "a": "Bilder einer bedeutenden K√ºnstlerin",
          "b": "Gelungene Einf√ºhrung in die moderne Fotografie",
          "c": "Die bemerkenswerte Karriere eines Fotografen",
          "d": "Ein Fotograf auf Reisen",
          "e": "Eine Fotografin dreht einen Film",
          "f": "Entwicklungsgeschichte der Lampen",
          "g": "Erde, Mond und Sterne - wie man sie noch nie gesehen hat",
          "h": "Familienfotos ber√ºhmter Pers√∂nlichkeiten",
          "i": "Das Ende der Dunkelheit",
          "j": "Mit Profis eine neue Foto-Technik erlernen"
        };
        return headings[headingId] || headingId;
      }

      function getOptionText(questionId, optionId) {
        if (!optionId || optionId === '-') return '-';
        const options = {
          "s2q1o1": "haben selbst keinen Appetit auf ein Fr√ºhst√ºck.",
          "s2q1o2": "lassen das Fr√ºhst√ºck aus Zeitmangel ausfallen.",
          "s2q1o3": "schaufeln das Fr√ºhst√ºck einfach in sich hinein.",
          "s2q2o1": "erh√∂ht auch die Sicherheit des Kindes auf dem Weg zur Schule.",
          "s2q2o2": "muss mindestens aus einem Glas Kakao oder Milch bestehen.",
          "s2q2o3": "sollte gemeinsam in der Schule angenommen werden.",
          "s2q3o1": "deckt den t√§glichen Fl√ºssigkeitsbedarf.",
          "s2q3o2": "geh√∂rt zum Angebot der Schulkantinen.",
          "s2q3o3": "wird in verschiedenen Geschmacksrichtungen angeboten.",
          "s2q4o1": "denken von alleine nicht immer daran, genug zu trinken.",
          "s2q4o2": "d√ºrfen w√§hrend des Unterrichts nichts trinken.",
          "s2q4o3": "k√∂nnen sich auch noch gut konzentrieren, wenn sie nicht genug getrunken haben.",
          "s2q5o1": "sollte in der Schule angeboten werden.",
          "s2q5o2": "sollten die Kinder von zu Hause mitbringen.",
          "s2q5o3": "sollten Kinder bei den Eltern zu Hause bekommen."
        };
        return options[optionId] || optionId;
      }

      function getSituationText(id) {
        const situations = {
          "11": "Sie m√∂chten einen Ganztagesausflug machen und sich dabei bewegen.",
          "12": "Sie m√∂chten eine Fahrt durch den Hamburger Hafen buchen.",
          "13": "Eine Bekannte organisiert einen gro√üen Kindergeburtstag und braucht Hilfe.",
          "14": "Sie interessieren sich f√ºr Technikgeschichte.",
          "15": "Ein Freund m√∂chte gerne eine Schiffsreise machen.",
          "16": "Sie m√∂chten helfen, Ihren Stadtteil zu gestalten.",
          "17": "Sie wollen mit einer Bekannten essen gehen. Sie mag amerikanische K√ºche.",
          "18": "Sie sind neu in der Stadt und m√∂chten Ihren Stadtteil kennenlernen.",
          "19": "Ein Freund m√∂chte mehr √ºber die Geschichte deutscher St√§dte erfahren.",
          "20": "Sie m√∂chten etwas mit Ihrer 6-j√§hrigen Nichte unternehmen, die gerne ins Museum geht."
        };
        return situations[id] || id;
      }

      function escapeHtml(s) {
        return String(s)
          .replace(/&/g, '&amp;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;')
          .replace(/"/g, '&quot;')
          .replace(/'/g, '&#039;');
      }

      function buildTable(title, dets, total, max) {
        let html = `<div class="result-item">
                    <h3>${title} - ${total.toFixed(2)}/${max} Punkte</h3>
                    <div class="section-table">
                      <table class="true-false-table">
                        <thead>
                          <tr>
                            <th style="width: 10%">Frage</th>
                            <th style="width: 40%">Ihre Antwort</th>
                            <th style="width: 40%">Richtige Antwort</th>
                            <th style="width: 10%">Ergebnis</th>
                          </tr>
                        </thead>
                        <tbody>`;
        
        dets.forEach(x => {
          const isCorrect = x.richtig;
          const rowClass = isCorrect ? 'correct-answer' : 'incorrect-answer';
          const resultIcon = isCorrect ? '‚úÖ Richtig' : '‚ùå Falsch';
          
          html += `<tr class="${rowClass}">
                    <td><strong>${x.frage}</strong></td>
                    <td>${escapeHtml(x.user)}</td>
                    <td>${escapeHtml(x.correct)}</td>
                    <td><strong>${resultIcon}</strong></td>
                  </tr>`;
        });
        
        html += `</tbody>
                </table>
                <div style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 6px;">
                  <strong>Erreichte Punkte: ${total.toFixed(2)}/${max} (${((total/max)*100).toFixed(1)}%)</strong>
                </div>
              </div></div>`;
        return html;
      }

      function renderLesenDetails(answers) {
        let html = `<div class="result-item">
                    <h3>üìñ Leseverstehen - Detaillierte Auswertung</h3>`;
        
        // 1. √úberschriften zuordnen
        const teil1Questions = ["text1", "text2", "text3", "text4", "text5"];
        const teil1Details = [];
        let teil1Correct = 0;
        
        teil1Questions.forEach(qId => {
          const userAnswer = normalizeAnswer(answers[qId] || '');
          const correctAnswer = CORRECT_ANSWERS.lesen[qId];
          const isCorrect = userAnswer === correctAnswer;
          if (isCorrect) teil1Correct++;
          
          teil1Details.push({
            frage: qId.replace('text', 'Text '),
            user: getHeadingText(userAnswer),
            correct: getHeadingText(correctAnswer),
            richtig: isCorrect
          });
        });
        
        const teil1Points = (teil1Correct / teil1Questions.length) * 25;
        html += `<h4>Teil 1: √úberschriften zuordnen (${teil1Correct}/${teil1Questions.length} richtig)</h4>`;
        html += buildTable("√úberschriften zuordnen", teil1Details, teil1Points, 25);
        
        // 2. Fragen zum Text
        const teil2Questions = ["s2q1", "s2q2", "s2q3", "s2q4", "s2q5"];
        const teil2Details = [];
        let teil2Correct = 0;
        
        teil2Questions.forEach(qId => {
          const userAnswer = normalizeAnswer(answers[qId] || '');
          const correctAnswer = CORRECT_ANSWERS.lesen[qId];
          const isCorrect = userAnswer === correctAnswer;
          if (isCorrect) teil2Correct++;
          
          teil2Details.push({
            frage: qId.replace('s2q', 'Frage '),
            user: getOptionText(qId, userAnswer),
            correct: getOptionText(qId, correctAnswer),
            richtig: isCorrect
          });
        });
        
        const teil2Points = (teil2Correct / teil2Questions.length) * 25;
        html += `<h4 style="margin-top: 20px;">Teil 2: Fragen zum Text (${teil2Correct}/${teil2Questions.length} richtig)</h4>`;
        html += buildTable("Fragen zum Text", teil2Details, teil2Points, 25);
        
        // 3. Texte zuordnen
        const teil3Questions = ["11", "12", "13", "14", "15", "16", "17", "18", "19", "20"];
        const teil3Details = [];
        let teil3Correct = 0;
        
        teil3Questions.forEach(qId => {
          const userAnswer = normalizeAnswer(answers[qId] || '');
          const correctAnswer = CORRECT_ANSWERS.lesen[qId];
          const isCorrect = userAnswer === correctAnswer;
          if (isCorrect) teil3Correct++;
          
          let userDisplay = userAnswer;
          if (userAnswer === 'X') userDisplay = 'X - Kein passender Text';
          else if (userAnswer === '') userDisplay = '-';
          
          let correctDisplay = correctAnswer;
          if (correctAnswer === 'X') correctDisplay = 'X - Kein passender Text';
          
          teil3Details.push({
            frage: `Situation ${qId}`,
            user: userDisplay,
            correct: correctDisplay,
            richtig: isCorrect
          });
        });
        
        const teil3Points = (teil3Correct / teil3Questions.length) * 25;
        html += `<h4 style="margin-top: 20px;">Teil 3: Texte zuordnen (${teil3Correct}/${teil3Questions.length} richtig)</h4>`;
        html += buildTable("Texte zuordnen", teil3Details, teil3Points, 25);
        
        // 4. Sprachbausteine Teil 1
        const sb1Questions = ["21", "22", "23", "24", "25", "26", "27", "28", "29", "30"];
        const sb1Details = [];
        let sb1Correct = 0;
        
        sb1Questions.forEach(qId => {
          const userAnswer = normalizeAnswer(answers[qId] || '');
          const correctAnswer = CORRECT_ANSWERS.lesen[qId];
          const isCorrect = userAnswer === correctAnswer;
          if (isCorrect) sb1Correct++;
          
          sb1Details.push({
            frage: `L√ºcke ${qId}`,
            user: userAnswer || '-',
            correct: correctAnswer,
            richtig: isCorrect
          });
        });
        
        const sb1Points = (sb1Correct / sb1Questions.length) * 15;
        html += `<h4 style="margin-top: 20px;">Sprachbausteine Teil 1 (${sb1Correct}/${sb1Questions.length} richtig)</h4>`;
        html += buildTable("Sprachbausteine Teil 1", sb1Details, sb1Points, 15);
        
        // 5. Sprachbausteine Teil 2
        const sb2Questions = ["31", "32", "33", "34", "35", "36", "37", "38", "39", "40"];
        const sb2Details = [];
        let sb2Correct = 0;
        
        sb2Questions.forEach(qId => {
          const userAnswer = normalizeAnswer(answers[qId] || '');
          const correctAnswer = CORRECT_ANSWERS.lesen[qId];
          const isCorrect = userAnswer === correctAnswer;
          if (isCorrect) sb2Correct++;
          
          sb2Details.push({
            frage: `L√ºcke ${qId}`,
            user: userAnswer || '-',
            correct: correctAnswer,
            richtig: isCorrect
          });
        });
        
        const sb2Points = (sb2Correct / sb2Questions.length) * 15;
        html += `<h4 style="margin-top: 20px;">Sprachbausteine Teil 2 (${sb2Correct}/${sb2Questions.length} richtig)</h4>`;
        html += buildTable("Sprachbausteine Teil 2", sb2Details, sb2Points, 15);
        
        html += `</div>`;
        return html;
      }

      function buildHoerenDetails(answers) {
        let html = `<table class="true-false-table">
                      <thead>
                        <tr>
                          <th>Frage</th>
                          <th>Ihre Antwort</th>
                          <th>Richtige Antwort</th>
                          <th>Ergebnis</th>
                        </tr>
                      </thead>
                      <tbody>`;
        
        for (let i = 41; i <= 60; i++) {
          const id = i.toString();
          const userAnswer = normalizeAnswer(answers[id] || '');
          const correctAnswer = CORRECT_ANSWERS.hoeren[id];
          const isCorrect = userAnswer === correctAnswer;
          const rowClass = isCorrect ? 'correct-answer' : 'incorrect-answer';
          const resultIcon = isCorrect ? '‚úÖ' : '‚ùå';
          
          html += `<tr class="${rowClass}">
                    <td><strong>${id}</strong></td>
                    <td>${userAnswer || '-'}</td>
                    <td>${correctAnswer}</td>
                    <td><strong>${resultIcon}</strong></td>
                  </tr>`;
        }
        
        html += `</tbody></table>`;
        return html;
      }

      function readExamResults() {
        try {
          const lesen = {};
          const hoeren = {};
          const schreiben = { content: '', wordCount: 0 };

          // 1) Try to read from in-memory states exposed by pages
          try {
            if (window._lesenState && window._lesenState.answers) {
              Object.keys(window._lesenState.answers).forEach(k => {
                lesen[k] = window._lesenState.answers[k];
              });
            }
          } catch (e) {}

          try {
            if (window._hoerenState && window._hoerenState.answers) {
              Object.keys(window._hoerenState.answers).forEach(sectionId => {
                const sec = window._hoerenState.answers[sectionId] || {};
                Object.keys(sec).forEach(q => {
                  hoeren[q] = sec[q];
                });
              });
            }
          } catch (e) {}

          try {
            if (window._schreibenState && window._schreibenState.answers) {
              const answers = window._schreibenState.answers;
              if (answers['s1']) {
                schreiben.content = answers['s1'];
              } else {
                const keys = Object.keys(answers);
                if (keys.length > 0) schreiben.content = answers[keys[0]] || '';
              }
              schreiben.wordCount = (schreiben.content && schreiben.content.trim()) ? String(schreiben.content).trim().split(/\s+/).filter(Boolean).length : 0;
            }
          } catch (e) {}

          // 2) Fallback to localStorage if any part is still empty
          try {
            if (Object.keys(lesen).length === 0) {
              const storedL = localStorage.getItem('lesenAnswers');
              if (storedL) Object.assign(lesen, JSON.parse(storedL));
            }
          } catch (e) {}

          try {
            if (Object.keys(hoeren).length === 0) {
              const storedH = localStorage.getItem('hoerenAnswers');
              if (storedH) Object.assign(hoeren, JSON.parse(storedH));
            }
          } catch (e) {}

          try {
            if (!schreiben.content) {
              const storedS = localStorage.getItem('schreibenAnswers');
              if (storedS) {
                const obj = JSON.parse(storedS);
                schreiben.content = obj.content || '';
                schreiben.wordCount = obj.wordCount || (schreiben.content.trim() ? String(schreiben.content).trim().split(/\s+/).filter(Boolean).length : 0);
              }
            }
          } catch (e) {}

          // final safe return
          return { hoeren, lesen, schreiben };
        } catch (e) {
          return { hoeren: {}, lesen: {}, schreiben: {} };
        }
      }

      function gradeHoeren(u) {
        const c = CORRECT_ANSWERS.hoeren;
        let okCount = 0;
        const d = [];
        
        for (let q = 41; q <= 60; q++) {
          const k = String(q);
          const uA = normalizeAnswer(u[k] || '');
          const exp = normalizeAnswer(c[k] || '');
          const ok = (uA !== '' && uA.toLowerCase() === exp.toLowerCase());
          if (ok) okCount++;
          const ptsPer = CONFIG.totals.hoeren / CONFIG.counts.hoeren;
          d.push({
            frage: k,
            user: uA || '-',
            correct: exp || '-',
            richtig: ok,
            punkte: ok ? ptsPer.toFixed(2) : '0'
          });
        }
        
        const total = Number((okCount * (CONFIG.totals.hoeren / CONFIG.counts.hoeren)).toFixed(2));
        return { okCount, total, details: d };
      }

      function gradeLesen(u) {
        const c = CORRECT_ANSWERS.lesen;
        let okCount = 0;
        const d = [];
        
        Object.keys(c).forEach(k => {
          const exp = normalizeAnswer(c[k]);
          const uA = normalizeAnswer(u[k] || '');
          const ok = (uA !== '' && uA.toLowerCase() === exp.toLowerCase());
          if (ok) okCount++;
          const ptsPer = CONFIG.totals.lesen / CONFIG.counts.lesen;
          d.push({
            frage: k,
            user: uA || '-',
            correct: exp || '-',
            richtig: ok,
            punkte: ok ? ptsPer.toFixed(2) : '0'
          });
        });
        
        const total = Number((okCount * (CONFIG.totals.lesen / CONFIG.counts.lesen)).toFixed(2));
        return { okCount, total, details: d };
      }

      function renderResults() {
        const st = readExamResults() || { hoeren: {}, lesen: {}, schreiben: {} };
        const h = gradeHoeren(st.hoeren || {});
        const l = gradeLesen(st.lesen || {});
        const details = document.getElementById('details-ergebnisse');
        const tiles = document.getElementById('topTiles-ergebnisse');
        const sScoreRaw = localStorage.getItem('schreibenScore');
        const sScore = sScoreRaw ? Number(sScoreRaw) : 0;

        details.innerHTML = '';
        tiles.innerHTML = '';

        const tL = `<div class="results-tile">
                    <h3>Lesen</h3>
                    <div class="score">${l.total.toFixed(2)} / ${CONFIG.totals.lesen} Punkte</div>
                    <div class="small-muted">(${(l.total / CONFIG.totals.lesen * 100).toFixed(2)} %)</div>
                  </div>`;
                  
        const tH = `<div class="results-tile">
                    <h3>H√∂ren</h3>
                    <div class="score">${h.total.toFixed(2)} / ${CONFIG.totals.hoeren} Punkte</div>
                    <div class="small-muted">(${(h.total / CONFIG.totals.hoeren * 100).toFixed(2)} %)</div>
                  </div>`;
                  
        const tS = `<div class="results-tile">
                    <h3>Schreiben</h3>
                    <div class="score" id="schreibenScoreDisplay">${sScore.toFixed(2)} / ${CONFIG.totals.schreiben} Punkte</div>
                    <div class="small-muted">Manuelle Eingabe</div>
                  </div>`;
                  
        tiles.innerHTML = tL + tH + tS;

        details.innerHTML = `
          <h2>üìä Detaillierte Ergebnisse</h2>
          <div class="instructions">Hier sehen Sie eine detaillierte Auswertung Ihrer Antworten im Vergleich zu den richtigen L√∂sungen.</div>
        `;

        // ŸÇÿ≥ŸÖ ÿßŸÑŸÇÿ±ÿßÿ°ÿ©
        details.innerHTML += renderLesenDetails(st.lesen);
        
        // ŸÇÿ≥ŸÖ ÿßŸÑÿßÿ≥ÿ™ŸÖÿßÿπ
        details.innerHTML += `
          <div class="result-item">
            <h3>üëÇ H√∂rverstehen - Detaillierte Auswertung</h3>
            <div class="section-table">
              ${buildHoerenDetails(st.hoeren)}
              <div style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 6px;">
                <strong>Erreichte Punkte: ${h.total.toFixed(2)}/${CONFIG.totals.hoeren} (${((h.total/CONFIG.totals.hoeren)*100).toFixed(1)}%)</strong>
              </div>
            </div>
          </div>
        `;

        // ŸÇÿ≥ŸÖ ÿßŸÑŸÉÿ™ÿßÿ®ÿ©
        let sHtml = '<div class="result-item">';
        sHtml += '<h3>‚úçÔ∏è Schreiben - Ihre Antwort</h3>';
        const txt = st.schreiben.content ? escapeHtml(st.schreiben.content) : '<span class="small-muted">Kein Text gefunden.</span>';
        const wc = st.schreiben.wordCount || '-';
        
        sHtml += `<div class="small-muted">W√∂rter: ${wc}</div>
                <div style="margin-top:10px;padding:12px;background:#fff;border-radius:8px;border:1px solid #eef6ff;min-height:80px">${txt}</div>
                <div style="margin-top:10px;display:flex;gap:10px;align-items:center">
                  Punkte (0‚Äì45): 
                  <input id="sInput" type="number" min="0" max="45" step="0.5" value="${sScore}"> 
                  <button id="saveS" class="results-btn">Speichern</button>
                </div>`;
        sHtml += '</div>';
                
        details.innerHTML += sHtml;

        const total = (l.total + h.total + sScore).toFixed(2);
        const percent = ((total / CONFIG.totals.gesamt) * 100).toFixed(2);
        
        document.getElementById('finalSummary-ergebnisse').innerHTML = `
          <div class="left">
            Gesamtpunktzahl: <strong>${total}</strong> / ${CONFIG.totals.gesamt} Punkte<br>
            <span class="small-muted">Lesen + H√∂ren + Schreiben</span>
          </div>
          <div class="right">
            Prozentsatz: <strong>${percent} %</strong>
          </div>`;

        document.getElementById('saveS').onclick = () => {
          const v = Number(document.getElementById('sInput').value) || 0;
          localStorage.setItem('schreibenScore', v);
          document.getElementById('schreibenScoreDisplay').textContent = `${v.toFixed(2)} / ${CONFIG.totals.schreiben} Punkte`;
          
          const newTotal = (l.total + h.total + v).toFixed(2);
          const newPercent = ((newTotal / CONFIG.totals.gesamt) * 100).toFixed(2);
          
          document.getElementById('finalSummary-ergebnisse').innerHTML = `
            <div class="left">
              Gesamtpunktzahl: <strong>${newTotal}</strong> / ${CONFIG.totals.gesamt} Punkte<br>
              <span class="small-muted">Lesen + H√∂ren + Schreiben</span>
            </div>
            <div class="right">
              Prozentsatz: <strong>${newPercent} %</strong>
            </div>`;
        };
      }

      document.getElementById('calcBtn-ergebnisse').onclick = () => renderResults();
      document.getElementById('backBtn-ergebnisse').onclick = (e) => {
        e.preventDefault();
        showPage('start-page');
      };
      
      // Initialize results on page load
      renderResults();
    }

    // ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ≥ÿ≠ÿ® ŸàÿßŸÑÿ•ŸÅŸÑÿßÿ™ ŸÑŸÑÿ¥ÿßÿ¥ÿßÿ™ ÿßŸÑÿ™Ÿä ÿ™ÿπŸÖŸÑ ÿ®ÿßŸÑŸÑŸÖÿ≥
    function setupTouchDragAndDrop() {
      if ('ontouchstart' in window) {
        // ÿ™ÿ∫ŸäŸäÿ± ÿ≥ŸÑŸàŸÉ ÿßŸÑÿπŸÜÿßÿµÿ± ÿßŸÑŸÇÿßÿ®ŸÑÿ© ŸÑŸÑÿ≥ÿ≠ÿ®
        document.querySelectorAll('[draggable="true"]').forEach(item => {
          item.addEventListener('touchstart', handleTouchStart);
          item.addEventListener('touchend', handleTouchEnd);
        });
        
        document.querySelectorAll('.title-slot, .blank-slot').forEach(slot => {
          slot.addEventListener('touchmove', handleTouchMove);
          slot.addEventListener('touchend', handleTouchDrop);
        });
      }
    }

    function handleTouchStart(e) {
      // ÿ™ŸÜŸÅŸäÿ∞ ÿßŸÑÿ≥ÿ≠ÿ® ÿπŸÜÿØ ÿßŸÑŸÑŸÖÿ≥
    }

    // ÿßÿ≥ÿ™ÿØÿπÿßÿ° ÿßŸÑÿØÿßŸÑÿ© ÿπŸÜÿØ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿµŸÅÿ≠ÿ©
    document.addEventListener('DOMContentLoaded', setupTouchDragAndDrop);
  </script>
</body>
</html>