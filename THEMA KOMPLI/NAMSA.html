<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Deutsch B2 Pr√ºfung - Komplett</title>
  <style>
    /* ===== GLOBAL STYLES ===== */
    :root {
      --primary-color: #1e3a5f;
      --secondary-color: #2c5282;
      --accent-color: #4da6ff;
      --light-color: #ebf8ff;
      --text-color: #2d3748;
      --white: #ffffff;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      --transition: all 0.3s ease;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      color: var(--white);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    button {
      cursor: pointer;
    }
    
    /* ===== START PAGE STYLES ===== */
    .start-container {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      padding: 20px;
      min-height: 100vh;
    }
    
    .start-content {
      max-width: 600px;
      width: 100%;
      background-color: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 40px;
      box-shadow: var(--shadow);
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .logo {
      margin-bottom: 20px;
    }
    
    .logo-icon {
      font-size: 48px;
      margin-bottom: 10px;
    }
    
    h1 {
      font-size: 32px;
      margin-bottom: 10px;
      font-weight: 700;
    }
    
    .subtitle {
      font-size: 18px;
      margin-bottom: 30px;
      opacity: 0.9;
    }
    
    .card {
      background-color: var(--white);
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: var(--shadow);
      color: var(--text-color);
    }
    
    .card h2 {
      font-size: 20px;
      margin-bottom: 15px;
      color: var(--primary-color);
    }
    
    .card p {
      margin-bottom: 20px;
      line-height: 1.5;
    }
    
    select {
      width: 100%;
      padding: 12px 16px;
      font-size: 16px;
      border-radius: 8px;
      border: 2px solid var(--accent-color);
      outline: none;
      background-color: var(--white);
      color: var(--text-color);
      cursor: pointer;
      transition: var(--transition);
    }
    
    select:focus {
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.3);
    }
    
    .timer-container {
      margin: 25px 0;
    }
    
    .timer-label {
      font-size: 16px;
      margin-bottom: 10px;
    }
    
    .timer {
      font-size: 48px;
      font-weight: 700;
      color: var(--accent-color);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }
    
    .progress-bar {
      height: 8px;
      width: 100%;
      background-color: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
      overflow: hidden;
      margin-top: 10px;
    }
    
    .progress {
      height: 100%;
      width: 100%;
      background-color: var(--accent-color);
      border-radius: 4px;
      transform: scaleX(1);
      transform-origin: left;
      transition: transform 1s linear;
    }
    
    .info-text {
      font-size: 14px;
      margin-top: 20px;
      opacity: 0.8;
    }
    
    .button-container {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }
    
    .btn {
      flex: 1;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      background-color: var(--accent-color);
      color: white;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }
    
    .btn:hover {
      background-color: #3399ff;
    }
    
    /* ===== EXAM PAGE STYLES ===== */
    .exam-body {
      background: #f5f5f5;
      color: #333;
      line-height: 1.45;
      -webkit-font-smoothing: antialiased;
    }
    
    /* Header Styles */
    header.topbar {
      background: #1e3a5f;
      color: #fff;
      padding: 12px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      min-height: 80px;
    }

    .brand {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .brand .logo {
      width: 80px;
      height: 40px;
      background: #e74c3c;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: white;
      font-size: 18px;
    }

    .meta .main-title {
      font-weight: 800;
      font-size: 18px;
    }

    .meta .sub-title {
      font-size: 13px;
      opacity: 0.9;
    }

    .timer {
      font-weight: 700;
      font-size: 18px;
      color: #fff;
      margin: 0 20px;
    }

    .buttons-grid {
      display: grid;
      grid-template-columns: repeat(2, auto);
      gap: 10px 20px;
    }

    .exam-btn {
      padding: 12px 20px;
      border-radius: 6px;
      border: none;
      background: #4da6ff;
      color: white;
      font-weight: 700;
      font-size: 15px;
      cursor: pointer;
      transition: background 0.2s ease-in-out;
      min-width: 150px;
      text-align: center;
    }

    .exam-btn:hover {
      background: #336fbf;
    }
    
    .exam-btn.save {
      background: #4da6ff;
      color: #000;
    }
    
    .exam-btn.save:hover {
      background: #3399ff;
    }
    
    .exam-btn.submit {
      background: #4da6ff;
    }
    
    .exam-btn.submit:hover {
      background: #3399ff;
    }
    
    .exam-btn.result {
      background: #4da6ff;
    }
    
    .exam-btn.result:hover {
      background: #3399ff;
    }
    
    .exam-btn.next {
      background: #4da6ff;
      color: #fff;
    }
    
    .exam-btn.next:hover {
      background: #3399ff;
    }
    
    .exam-btn.reset {
      background: #4da6ff;
    }
    
    .exam-btn.reset:hover {
      background: #3399ff;
    }
    
    .exam-btn.reset-section {
      background: #d35400;
      font-size: 12px;
      padding: 6px 10px;
      min-width: auto;
    }
    
    .exam-btn.reset-section:hover {
      background: #e67e22;
    }
    
    .exam-btn.no-match {
      background: #95a5a6;
      font-size: 12px;
      padding: 6px 10px;
      min-width: auto;
      margin-top: 5px;
    }
    
    .exam-btn.no-match:hover {
      background: #7f8c8d;
    }
    
    .exam-btn.no-match.selected {
      background: #e74c3c;
    }
    
    /* Top Tiles */
    .top-tiles {
      display: flex;
      justify-content: center;
      gap: 8px;
      padding: 8px 12px;
      background: #1e3a5f;
      border-bottom: 1px solid #0f223a;
    }
    
    .tile {
      flex: 1;
      max-width: 180px;
      text-align: center;
      padding: 12px;
      border-radius: 6px;
      border: 1px solid #ccc;
      background: #3b4a63;
      color: #fff;
      font-weight: 600;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 60px;
    }
    
    .tile:hover {
      background: #4a5b78;
    }
    
    .tile.active {
      background: #ffffff;
      color: #000;
      border-color: #bbb;
    }
    
    .tile.done {
      background: #2ecc71;
      color: #fff;
      border-color: #27ae60;
    }
    
    .tile.done::after {
      content: " ‚úÖ";
      margin-left: 5px;
    }
    
    .tile .points {
      background: rgba(255,255,255,0.2);
      padding: 4px 8px;
      border-radius: 12px;
      font-weight: 700;
      font-size: 11px;
      margin-top: 4px;
    }
    
    .tile.active .points {
      background: #e9eefc;
      color: #2c3e50;
    }
    
    /* Container Styles */
    .container {
      display: grid;
      grid-template-columns: 1fr 420px;
      gap: 16px;
      padding: 16px;
      max-width: 1200px;
      margin: 12px auto;
    }
    
    .container-full {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      padding: 16px;
      max-width: 1200px;
      margin: 12px auto;
    }
    
    .container-split {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      padding: 16px;
      max-width: 1200px;
      margin: 12px auto;
    }
    
    .left-panel {
      background: white;
      border-radius: 8px;
      padding: 18px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      max-height: 76vh;
      overflow: auto;
    }
    
    .left-panel .passage {
      font-size: 14px;
      color: #2c3e50;
      line-height: 1.8;
    }
    
    .left-panel h2 {
      font-size: 16px;
      margin-bottom: 10px;
    }
    
    .right-panel {
      background: white;
      border-radius: 8px;
      padding: 12px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      display: flex;
      flex-direction: column;
      gap: 12px;
      max-height: 76vh;
      overflow: auto;
    }
    
    .main-panel {
      background: white;
      border-radius: 8px;
      padding: 25px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      max-height: 76vh;
      overflow: auto;
    }
    
    .panel-title {
      font-size: 18px;
      margin-bottom: 15px;
      color: #1e3a5f;
      font-weight: 700;
    }
    
    /* Question Styles */
    .question-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }
    
    .question-body {
      margin-top: 8px;
    }
    
    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .option {
      background: #fbfdff;
      border: 1px solid #e1e8f6;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .option:hover {
      background: #f0f6ff;
    }
    
    .option.selected {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .option .radio {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      border: 2px solid #cfdff6;
      background: #fff;
      display: inline-block;
      flex-shrink: 0;
    }
    
    .option.selected .radio {
      background: #3498db;
      border-color: #3498db;
      box-shadow: inset 0 -3px 0 rgba(0,0,0,0.05);
    }
    
    .text-container {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
      position: relative;
      min-height: 120px;
    }
    
    .text-container:hover {
      background: #f0f6ff;
    }
    
    .text-title {
      font-weight: 700;
      margin-bottom: 8px;
      color: #2c3e50;
    }
    
    .text-content {
      font-size: 14px;
      color: #2c3e50;
      line-height: 1.6;
    }
    
    .title-slot {
      min-height: 40px;
      margin-top: 10px;
      padding: 8px;
      border: 2px dashed #c8d9f6;
      border-radius: 6px;
      background: #f8fbff;
    }
    
    .title-slot.has-title {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .title-slot.has-x {
      background: #f8d7da;
      border-color: #e74c3c;
      color: #c0392b;
      font-weight: bold;
    }
    
    .headings-bank {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 0;
    }
    
    .heading-item {
      padding: 10px;
      border: 1px solid #dbe7fb;
      border-radius: 8px;
      background: #f8fbff;
      cursor: grab;
    }
    
    .heading-item:hover {
      background: #e9f0ff;
    }
    
    .heading-item.used {
      opacity: 0.5;
      cursor: not-allowed;
      background: #f8d7da;
      border-color: #f5c6cb;
    }
    
    .result-correct {
      color: #27ae60;
      font-weight: bold;
    }
    
    .result-incorrect {
      color: #c0392b;
      font-weight: bold;
    }
    
    .result-item {
      margin: 10px 0;
      padding: 10px;
      border-radius: 6px;
      background: #f8f9fa;
    }
    
    .instructions {
      color: #7f8c8d;
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 15px;
    }
    
    .question-text {
      font-weight: 600;
      margin-bottom: 15px;
      font-size: 15px;
      color: #2c3e50;
    }
    
    .all-questions {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    
    .question-block {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .texts-list, .situations-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .text-item, .situation-item {
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .text-letter {
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 8px;
    }
    
    .situation-number {
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 8px;
    }
    
    .fill-blank-container {
      margin: 20px 0;
    }
    
    .blank-word {
      display: inline-block;
      min-width: 120px;
      padding: 4px 8px;
      margin: 0 6px;
      background: #fff;
      cursor: pointer;
      position: relative;
      border: 1px solid #dbe7fb;
      border-radius: 4px;
    }
    
    .blank-word.has-answer {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .options-popup {
      position: absolute;
      top: 100%;
      left: 0;
      background: white;
      border: 1px solid #dbe7fb;
      border-radius: 6px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      z-index: 100;
      min-width: 150px;
    }
    
    .option-item {
      padding: 8px 12px;
      cursor: pointer;
      border-bottom: 1px solid #f0f4fb;
    }
    
    .option-item:hover {
      background: #f0f6ff;
    }
    
    .option-item:last-child {
      border-bottom: none;
    }
    
    .horizontal-options {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .option-row {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 10px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .option-number {
      font-weight: bold;
      color: #2c3e50;
      min-width: 30px;
    }
    
    .option-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .option-btn {
      padding: 8px 16px;
      border: 1px solid #dbe7fb;
      border-radius: 6px;
      background: #f8fbff;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .option-btn:hover {
      background: #e9f0ff;
    }
    
    .option-btn.selected {
      background: #3498db;
      color: white;
      border-color: #3498db;
    }
    
    .word-bank-vertical {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .bank-word-vertical {
      padding: 10px;
      border: 1px solid #dbe7fb;
      border-radius: 6px;
      background: #f8fbff;
      text-align: center;
      cursor: grab;
    }
    
    .bank-word-vertical.used {
      opacity: 0.5;
      cursor: not-allowed;
      background: #f8d7da;
      border-color: #f5c6cb;
    }
    
    .blank-slot {
      display: inline-block;
      min-width: 100px;
      padding: 4px 8px;
      margin: 0 6px;
      background: #fff;
      min-height: 30px;
      vertical-align: middle;
      border: 1px solid #dbe7fb;
      border-radius: 4px;
      cursor: pointer;
    }
    
    .blank-slot.has-answer {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .footer-buttons {
      display: flex;
      gap: 10px;
    }
    
    .situation-item.used {
      opacity: 0.7;
      cursor: not-allowed;
      background: #f8d7da;
      border-color: #f5c6cb;
      color: #333;
    }
    
    /* Listening Section Styles */
    .listening-task {
      margin-bottom: 10px;
    }
    
    .true-false-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      font-size: 14px;
    }
    
    .true-false-table th {
      background: #3498db;
      color: white;
      padding: 15px;
      text-align: left;
      font-weight: 600;
      font-size: 14px;
    }
    
    .true-false-table td {
      padding: 15px;
      border-bottom: 1px solid #e1e8f6;
      vertical-align: top;
    }
    
    .true-false-table tr:nth-child(even) {
      background: #f8f9fa;
    }
    
    .true-false-table tr:hover {
      background: #e3f2fd;
    }
    
    .answer-options {
      display: flex;
      gap: 25px;
    }
    
    .answer-option {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      padding: 10px 15px;
      border-radius: 4px;
      transition: background 0.2s;
      font-weight: 500;
    }
    
    .answer-option:hover {
      background: #e3f2fd;
    }
    
    .answer-option input {
      margin: 0;
      transform: scale(1.2);
    }

    .correct-answer {
      background: #d4edda !important;
      border-left: 4px solid #28a745;
    }
    
    .incorrect-answer {
      background: #f8d7da !important;
      border-left: 4px solid #dc3545;
    }
    
    /* Writing Section Styles */
    .writing-task {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .writing-prompt {
      font-size: 14px;
      color: #2c3e50;
      line-height: 1.6;
      margin-bottom: 15px;
    }
    
    .writing-requirements {
      background: #f8f9fa;
      padding: 12px;
      border-radius: 6px;
      border-left: 4px solid #3498db;
      margin-bottom: 15px;
    }
    
    .writing-requirements h4 {
      margin: 0 0 8px 0;
      color: #2c3e50;
    }
    
    .writing-requirements ul {
      margin: 0;
      padding-left: 20px;
    }
    
    .writing-requirements li {
      margin-bottom: 5px;
      color: #2c3e50;
    }
    
    .writing-area {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    
    .writing-textarea {
      flex: 1;
      min-height: 500px;
      padding: 15px;
      border: 2px solid #e1e8f6;
      border-radius: 8px;
      font-size: 14px;
      line-height: 1.6;
      resize: vertical;
      font-family: Arial, sans-serif;
    }
    
    .writing-textarea:focus {
      outline: none;
      border-color: #3498db;
    }
    
    .word-counter {
      margin-top: 10px;
      text-align: right;
      font-size: 13px;
      color: #7f8c8d;
      padding: 8px 0;
    }
    
    .word-counter .count {
      font-weight: bold;
      color: #2c3e50;
    }
    
    /* Results Page Styles */
    .results-body {
      background: #f7fafc;
      color: #0f1724;
      line-height: 1.6;
    }
    
    .results-header {
      background: #1e3a5f;
      color: #fff;
      padding: 18px 20px;
      display: flex;
      align-items: center;
      gap: 16px;
    }
    
    .results-logo {
      background: #fff;
      color: #1e3a5f;
      padding: 8px 12px;
      border-radius: 6px;
      font-weight: 800;
    }
    
    .results-title {
      font-size: 18px;
      font-weight: 700;
    }
    
    .results-container {
      max-width: 1100px;
      margin: 22px auto;
      padding: 20px;
    }
    
    .results-tiles {
      display: flex;
      gap: 12px;
      margin: 18px 0;
    }
    
    .results-tile {
      flex: 1;
      background: #fff;
      border-radius: 10px;
      padding: 16px;
      box-shadow: 0 6px 18px rgba(2, 6, 23, 0.06);
      border-left: 6px solid #1e3a5f;
    }
    
    .results-tile h3 {
      margin: 0;
      font-size: 16px;
      color: #1e3a5f;
    }
    
    .results-tile .score {
      font-size: 20px;
      font-weight: 800;
      margin-top: 8px;
    }
    
    .section-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
    }
    
    .section-table th,
    .section-table td {
      padding: 8px;
      border-bottom: 1px solid #e6eef8;
      text-align: left;
      font-size: 14px;
    }
    
    .summary {
      background: #fff;
      padding: 16px;
      border-radius: 10px;
      margin-top: 18px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .summary .left {
      font-weight: 700;
    }
    
    .summary .right {
      text-align: right;
    }
    
    .controls {
      display: flex;
      gap: 10px;
      margin-top: 18px;
    }
    
    .results-btn {
      background: #4da6ff;
      border: none;
      color: #fff;
      padding: 10px 14px;
      border-radius: 8px;
      font-weight: 700;
      cursor: pointer;
      transition: background 0.3s;
    }
    
    .results-btn:hover {
      background: #3a8ce0;
    }
    
    .button-like {
      text-decoration: none;
    }
    
    .small-muted {
      color: #6b7280;
      font-size: 13px;
    }
    
    input[type="number"] {
      width: 90px;
      padding: 8px;
      border: 1px solid #d7e6fb;
      border-radius: 6px;
    }
    
    .note {
      font-size: 13px;
      color: #6b7280;
      margin-top: 8px;
    }
    
    /* Footer */
    footer.controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: white;
      border-top: 1px solid #e1e8f6;
      margin-top: 20px;
    }
    
    .status {
      font-size: 14px;
      color: #7f8c8d;
    }
    
    .ghost {
      background: transparent;
      border: 2px solid #2c3e50;
      color: #2c3e50;
    }
    
    .ghost:hover {
      background: #2c3e50;
      color: white;
    }

    /* Responsive Styles */
    @media (max-width: 980px) {
      .container {
        grid-template-columns: 1fr;
        padding: 12px;
      }
      
      .container-split {
        grid-template-columns: 1fr;
      }
      
      .right-panel {
        order: 2;
      }
      
      .top-tiles {
        padding-left: 8px;
        padding-right: 8px;
      }
      
      header.topbar {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }
      
      .buttons-grid {
        grid-template-columns: 1fr;
      }
      
      .answer-options {
        flex-direction: column;
        gap: 10px;
      }
      
      footer.controls {
        flex-direction: column;
        gap: 15px;
      }
      
      .results-tiles {
        flex-direction: column;
      }
      
      .summary {
        flex-direction: column;
        gap: 10px;
        text-align: center;
      }
      
      .controls {
        flex-direction: column;
      }
    }
    
    @media (max-width: 600px) {
      .start-content {
        padding: 25px 20px;
      }
      
      h1 {
        font-size: 28px;
      }
      
      .card {
        padding: 20px 15px;
      }
    }

    /* === ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿÆÿßÿµÿ© ŸÑŸÑŸáŸàÿßÿ™ŸÅ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© ÿ¨ÿØÿß === */
    @media (max-width: 480px) {
      /* 1. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ≠ÿßŸàŸäÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© */
      .container, .container-split, .container-full {
        grid-template-columns: 1fr !important;
        padding: 8px !important;
        gap: 10px !important;
      }
      
      /* 2. ÿ¨ÿπŸÑ ÿßŸÑŸÑŸàÿ≠ÿßÿ™ (panels) ÿ™ÿ£ÿÆÿ∞ ÿπÿ±ÿ∂ ŸÉÿßŸÖŸÑ */
      .left-panel, .right-panel, .main-panel {
        max-height: none !important;
        height: auto !important;
        overflow: visible !important;
        margin-bottom: 10px;
      }
      
      /* 3. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸáŸäÿØÿ± */
      .topbar {
        flex-direction: column !important;
        align-items: stretch !important;
        padding: 10px !important;
      }
      
      .brand {
        justify-content: center;
        margin-bottom: 10px;
      }
      
      /* 4. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ± ŸÅŸä ÿßŸÑŸáŸäÿØÿ± */
      .buttons-grid {
        grid-template-columns: 1fr !important;
        width: 100%;
      }
      
      .exam-btn {
        width: 100% !important;
        margin: 2px 0 !important;
        font-size: 14px !important;
        padding: 12px 8px !important;
      }
      
      /* 5. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ™ÿßŸäŸÑÿßÿ™ */
      .top-tiles {
        flex-wrap: wrap;
        justify-content: center;
      }
      
      .tile {
        flex: 0 0 calc(33% - 5px) !important;
        max-width: calc(33% - 5px) !important;
        margin: 2px;
        font-size: 11px !important;
        padding: 8px 4px !important;
      }
      
      /* 6. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÜÿµŸàÿµ */
      .passage, .text-content, .question-text {
        font-size: 15px !important;
        line-height: 1.5 !important;
      }
      
      /* 7. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™ */
      .option {
        padding: 12px 10px !important;
        margin: 4px 0 !important;
      }
      
      /* 8. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ¨ÿØÿßŸàŸÑ True/False */
      .true-false-table {
        display: block;
        overflow-x: auto;
        white-space: nowrap;
      }
      
      /* 9. ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑŸÉÿ™ÿßÿ®ÿ© */
      .writing-textarea {
        min-height: 300px !important;
        font-size: 16px !important;
      }
      
      /* 10. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÅŸàÿ™ÿ± */
      footer.controls {
        flex-direction: column !important;
        gap: 10px !important;
      }
      
      .footer-buttons {
        width: 100%;
        display: flex;
        gap: 5px;
      }
      
      .footer-buttons .exam-btn {
        flex: 1;
      }
      
      /* 11. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ */
      .results-tiles {
        flex-direction: column !important;
      }
      
      .results-tile {
        margin-bottom: 10px;
      }
    }

    /* === ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÑŸÑŸáŸàÿßÿ™ŸÅ ÿßŸÑŸÖÿ™Ÿàÿ≥ÿ∑ÿ© === */
    @media (min-width: 481px) and (max-width: 768px) {
      .container, .container-split {
        grid-template-columns: 1fr !important;
      }
      
      .tile {
        max-width: 180px !important;
      }
    }
  </style>
</head>
<body id="body">
  <!-- Start Page -->
  <div id="start-page" class="start-container">
    <div class="start-content">
      <div class="logo">
        <div class="logo-icon">üìù</div>
        <h1>Deutsch B2 Pr√ºfung</h1>
        <div class="subtitle">Bereiten Sie sich auf Ihre Pr√ºfung vor</div>
      </div>
      <div class="card">
        <h2>Pr√ºfungsbereich ausw√§hlen</h2>
        <p>W√§hlen Sie bitte den Bereich aus, den Sie √ºben m√∂chten. Die Pr√ºfung startet automatisch in <span id="time-display">30</span> Sekunden.</p>
        <select id="sectionSelect">
          <option value="lesen">Lesen</option>
          <option value="hoeren">H√∂ren</option>
          <option value="schreiben">Schreiben</option>
        </select>
        <div class="button-container">
          <button id="cancelBtn" class="btn">Abbrechen</button>
          <button id="startBtn" class="btn">Jetzt starten</button>
        </div>
      </div>
      <div class="timer-container">
        <div class="timer-label">Die Pr√ºfung startet in:</div>
        <div class="timer" id="countdown">30</div>
        <div class="progress-bar">
          <div class="progress" id="progress"></div>
        </div>
      </div>
      <div class="info-text">Stellen Sie sicher, dass Sie in einer ruhigen Umgebung sind und gen√ºgend Zeit haben.</div>
    </div>
  </div>

  <!-- Lesen Page -->
  <div id="lesen-page" class="exam-page" style="display: none;">
    <header class="topbar" role="banner">
      <div class="brand">
        <div class="logo">test</div>
        <div class="meta">
          <div class="main-title">Deutsch - B2 (√úbung)</div>
          <div class="sub-title">Lesen ‚Äî Testbeispiel</div>
        </div>
      </div>

      <div id="timer-lesen" class="timer" aria-live="polite">Verbleibende Zeit: 90:00</div>

      <div class="buttons-grid">
        <button id="resetBtn-lesen" class="exam-btn reset">üîÑ Von neu beginnen</button>
        <button id="saveBtn-lesen" class="exam-btn save">üìã Speichern</button>
        <button id="resultBtn-lesen" class="exam-btn result">üìä Ergebnis</button>
        <button id="submitBtn-lesen" class="exam-btn submit">üèÅ Abgabe</button>
        <button class="exam-btn next" id="nextBtn-lesen">‚û°Ô∏è N√§chste Pr√ºfung</button>
      </div>
    </header>

    <div class="top-tiles" id="topTiles-lesen" role="navigation" aria-label="Sections overview"></div>

    <div class="container">
      <main class="left-panel" id="leftPanel-lesen">
        <div class="passage" id="passage-lesen">
          <h2 id="passageTitle-lesen">Aufgabe</h2>
          <div id="passageContent-lesen"></div>
        </div>
      </main>

      <aside class="right-panel" id="rightPanel-lesen" aria-labelledby="questionTitle-lesen">
        <div class="question-head">
          <div>
            <div id="sectionName-lesen" style="font-weight:800"></div>
            <div id="questionTitle-lesen" style="font-size:13px;color:#55607a">Frage</div>
          </div>
          <button id="resetSectionBtn-lesen" class="exam-btn reset-section" style="display:none;">Teil zur√ºcksetzen</button>
        </div>
        <div class="question-body" id="questionBody-lesen"></div>
        <div id="headingsBankContainer-lesen"></div>
      </aside>
    </div>

    <footer class="controls">
      <div class="footer-buttons">
        <button id="prevBtn-lesen" class="exam-btn ghost">Zur√ºck</button>
        <button id="nextBtn-lesen" class="exam-btn ghost">Weiter</button>
      </div>
      <div class="status"><span id="statusText-lesen">Nicht gespeichert</span></div>
    </footer>
  </div>

  <!-- H√∂ren Page -->
  <div id="hoeren-page" class="exam-page" style="display: none;">
    <header class="topbar" role="banner">
      <div class="brand">
        <div class="logo">test</div>
        <div class="meta">
          <div class="main-title">Deutsch - B2 (√úbung)</div>
          <div class="sub-title">H√∂rverstehen ‚Äî Testbeispiel</div>
        </div>
      </div>

      <div id="timer-hoeren" class="timer" aria-live="polite">Verbleibende Zeit: 17:00</div>

      <div class="buttons-grid">
        <button id="resetBtn-hoeren" class="exam-btn reset">üîÑ Von neu beginnen</button>
        <button id="saveBtn-hoeren" class="exam-btn save">üìã Speichern</button>
        <button id="resultBtn-hoeren" class="exam-btn result">üìä Ergebnis</button>
        <button id="submitBtn-hoeren" class="exam-btn submit">üèÅ Abgabe</button>
        <button class="exam-btn next" id="nextBtn-hoeren">‚û°Ô∏è N√§chste Pr√ºfung</button>
      </div>
    </header>

    <div class="top-tiles" id="topTiles-hoeren" role="navigation" aria-label="Sections overview"></div>

    <div class="container-full">
      <main class="main-panel" id="mainPanel-hoeren">
        <div id="contentContainer-hoeren"></div>
      </main>
    </div>

    <footer class="controls">
      <div class="footer-buttons">
        <button id="prevBtn-hoeren" class="exam-btn ghost">Zur√ºck</button>
        <button id="nextBtn-hoeren" class="exam-btn ghost">Weiter</button>
      </div>
      <div class="status"><span id="statusText-hoeren">Nicht gespeichert</span></div>
    </footer>
  </div>

  <!-- Schreiben Page -->
  <div id="schreiben-page" class="exam-page" style="display: none;">
    <header class="topbar" role="banner">
      <div class="brand">
        <div class="logo">test</div>
        <div class="meta">
          <div class="main-title">Deutsch - B2 (√úbung)</div>
          <div class="sub-title">Schreiben ‚Äî Testbeispiel</div>
        </div>
      </div>

      <div id="timer-schreiben" class="timer" aria-live="polite">Verbleibende Zeit: 30:00</div>

      <div class="buttons-grid">
        <button id="resetBtn-schreiben" class="exam-btn reset">üîÑ Von neu beginnen</button>
        <button id="saveBtn-schreiben" class="exam-btn save">üìã Speichern</button>
        <button id="resultBtn-schreiben" class="exam-btn result">üìä Ergebnis</button>
        <button id="submitBtn-schreiben" class="exam-btn submit">üèÅ Abgabe</button>
        <button class="exam-btn next" id="nextBtn-schreiben">‚û°Ô∏è N√§chste Pr√ºfung</button>
      </div>
    </header>

    <div class="top-tiles" id="topTiles-schreiben" role="navigation" aria-label="Sections overview"></div>

    <div class="container-split">
      <main class="left-panel" id="leftPanel-schreiben">
        <div class="passage" id="passage-schreiben">
          <h2 id="passageTitle-schreiben">Aufgabe</h2>
          <div id="passageContent-schreiben"></div>
        </div>
      </main>

      <aside class="right-panel" id="rightPanel-schreiben">
        <div id="writingContainer-schreiben"></div>
      </aside>
    </div>

    <footer class="controls">
      <div class="footer-buttons">
        <button id="prevBtn-schreiben" class="exam-btn ghost">Zur√ºck</button>
        <button id="nextBtn-schreiben" class="exam-btn ghost">Weiter</button>
      </div>
      <div class="status"><span id="statusText-schreiben">Nicht gespeichert</span></div>
    </footer>
  </div>

  <!-- Ergebnisse Page -->
  <div id="ergebnisse-page" class="results-page" style="display: none;">
    <header class="results-header">
      <div class="results-logo">test</div>
      <div class="results-title">Gesamtergebnis ‚Äî Deutsch B2</div>
    </header>

    <div class="results-container">
      <div class="results-tiles" id="topTiles-ergebnisse"></div>
      <div id="details-ergebnisse"></div>
      <div class="summary" id="finalSummary-ergebnisse"></div>
      <div class="controls">
        <a class="button-like" href="#" id="backBtn-ergebnisse">
          <button class="results-btn">üîÅ Zur√ºck zur Startseite</button>
        </a>
        <button id="calcBtn-ergebnisse" class="results-btn">‚úÖ Ergebnisse anzeigen</button>
      </div>
      <div class="note">Hinweis: Schreiben (45 Punkte) wird manuell eingegeben, falls nicht automatisch vorhanden.</div>
    </div>
  </div>

  <script>
    // ===== PAGE NAVIGATION =====
    function showPage(pageId) {
      document.getElementById('start-page').style.display = 'none';
      document.getElementById('lesen-page').style.display = 'none';
      document.getElementById('hoeren-page').style.display = 'none';
      document.getElementById('schreiben-page').style.display = 'none';
      document.getElementById('ergebnisse-page').style.display = 'none';
      
      document.getElementById('body').className = '';
      if (pageId === 'ergebnisse-page') {
        document.getElementById('body').className = 'results-body';
      } else if (pageId !== 'start-page') {
        document.getElementById('body').className = 'exam-body';
      }
      
      document.getElementById(pageId).style.display = 'block';
      
      if (pageId === 'lesen-page' && typeof initLesenPage === 'function') {
        initLesenPage();
      } else if (pageId === 'hoeren-page' && typeof initHoerenPage === 'function') {
        initHoerenPage();
      } else if (pageId === 'schreiben-page' && typeof initSchreibenPage === 'function') {
        initSchreibenPage();
      } else if (pageId === 'ergebnisse-page' && typeof initErgebnissePage === 'function') {
        initErgebnissePage();
      }
    }

    // ===== START PAGE FUNCTIONALITY =====
    let initialCounter = 30;
    let counter = initialCounter;
    let countdownInterval;
    let countdownRunning = false;
    let examStarted = false;
    const timerEl = document.getElementById("countdown");
    const timeDisplayEl = document.getElementById("time-display");
    const progressEl = document.getElementById("progress");
    const selectEl = document.getElementById("sectionSelect");
    const startBtn = document.getElementById("startBtn");
    const cancelBtn = document.getElementById("cancelBtn");

    function startCountdown() {
      if (countdownRunning || examStarted) return;
      countdownRunning = true;
      try { startBtn.disabled = true; startBtn.setAttribute('aria-disabled','true'); } catch(e){}
      counter = initialCounter;
      timerEl.textContent = counter;
      timeDisplayEl.textContent = counter;
      progressEl.style.transform = "scaleX(0)";
      timerEl.style.color = "";

      countdownInterval = setInterval(() => {
        counter--;
        timerEl.textContent = counter;
        timeDisplayEl.textContent = counter;
        const progressValue = (initialCounter - counter) / initialCounter;
        progressEl.style.transform = `scaleX(${progressValue})`;
        if (counter <= 0) {
          clearInterval(countdownInterval);
          countdownInterval = null;
          countdownRunning = false;
          progressEl.style.transform = "scaleX(1)";
          if (!examStarted) {
            examStarted = true;
            startExam();
          }
          try { startBtn.disabled = false; startBtn.removeAttribute('aria-disabled'); } catch(e){}
        }
      }, 1000);
    }

    function stopCountdown(reset = true) {
      if (countdownInterval) {
        clearInterval(countdownInterval);
        countdownInterval = null;
      }
      countdownRunning = false;
      try { startBtn.disabled = false; startBtn.removeAttribute('aria-disabled'); } catch(e){}
      progressEl.style.transform = "scaleX(0)";
      if (reset) {
        counter = initialCounter;
        timerEl.textContent = counter;
        timeDisplayEl.textContent = counter;
      } else {
        timerEl.textContent = "Gestoppt";
      }
    }

    function startExam() {
      if (!examStarted) examStarted = true;
      const selectedSection = selectEl.value;
      if (selectedSection === 'lesen') {
        showPage('lesen-page');
      } else if (selectedSection === 'hoeren') {
        showPage('hoeren-page');
      } else if (selectedSection === 'schreiben') {
        showPage('schreiben-page');
      }
    }

    startBtn.addEventListener('click', startCountdown);

    cancelBtn.addEventListener('click', () => {
      stopCountdown(true);
      timerEl.textContent = "Abgebrochen";
      timerEl.style.color = "#e53e3e";
    });

    // ===== LESEN PAGE FUNCTIONALITY =====
    function initLesenPage() {
      const exam = {
        id: "exam-001",
        durationSec: 90 * 60,
        sections: [
          { 
            id: "s1", 
            title: "Leseverstehen, Teil 1", 
            points: 25,
            passageTitle: "Aufgabe: Ziehen Sie die passenden √úberschriften auf die Texte.",
            passage: "",
            questions: [],
            texts: [
              {
                id: "text1",
                content: "Das Lesemagazin MENU hat eine Umfrage zu den popul√§rsten M√§rkten in √ñsterreich durchgef√ºhrt. Vor der eigentlichen Abstimmung hatte das Magazin seine Leserinnen und Leser dazu aufgerufen, Markte zu nominieren. Aus den h√§ufigsten Nennungen hat das Redaktionsteam eine Liste mit zwanzig M√§rkte aus ganz √ñsterreich erstellt und zwei Wochen lang online zur Abstimmung angeboten. Als klarer Sieger ging der Markt am Domplatz von St. P√∂lten hervor. Dieser ist ber√ºhmt f√ºr sein ganzj√§hriges Einkaufsvergn√ºgen. Als Nahversorger f√ºr die Innenstadt und Anziehungspunkt f√ºr Menschen aus dem Umlana tr√§gt er erheblich zur Lebensqualit√§t der Bev√∂lkerung bei, Auf Platz zwei und drei folgten zwei buregl√§ndische M√§rkte, n√§mlich der Markt der Erde in Parndorf und der Regionalmarkt in den ehemaligen Stallungen von Schloss Esterh√§zy in Eisenstadt. Das gro√üe Interesse an der Abstimmung zeigt laut MENU, wie sehr die Konsumentinnen und Konsumenten M√§rkte sch√§tzen.",
                correctAnswer: "d"
              },
              {
                id: "text2", 
                content: "Sie sind der Meinung, dass Ihre Qualifikationen ausreichen, um Karriere zu machen? Qualifikationen und Berufserfahrung sind zwar wichtige Kriterien f√ºr den erfolgreichen Aufstieg auf der Karriereleiter, doch ohne gutes Selbstmarketing werden Sie auf halbem Wege stehenbleiben. Das ist letztlich genauso wie beim Verkauf eines Produktes: Es reicht nicht, dass ein Produkt gut ist, es muss auch gut beworben werden. W√§hrend Marketing das Produkt vorteilhaft am Markt platzieren m√∂chte, verfolgt man beim Selbstmarketing das Ziel, seine Pers√∂nlichen und St√§rken bewusst hervorzuheben. Mit anderen Worten: Es geht darum, sich gut zu verkaufen. Selbstmarketing beginnt schon bei der Bewerbung und dem Vorstellungssprach und setzt sich im Job fort. Auch dort m√ºssen Sie auf sich aufmerksam machen. Doch Achtung: Angeber mag niemand! Wie Sie das richtige Ma√ü finden, erfahren Sie in einem Seminar, das an vier Wochenenden im April in Klagenfurt stattfindet. Alle Details gibt es hier.",
                correctAnswer: "f"
              },
              {
                id: "text3",
                content: "Der Wiener Naschmarkt geh√∂rt zu √ñsterreichs beliebtesten M√§rkten. Mit einer Fl√§che von mehr als zwei Hektar ist er der gr√∂√üte Markt in der Innenstadt. Schon 1780 handelten Bauern dort mit Milchprodukten. Gemauerte Marktst√§nde entstanden erst mehr als 100 Jahre sp√§ter. Von 1910 an wurden mehr als 120 fixe Marktst√§nde im einheitlichen Stil von Otto Wagner geplant und errichtet. Das Marktantageb√§ude bei der Kettenbr√ºckengasse wurde 1916 fertiggestellt. Heute ist der Naschmarkt eine begehrte Wiener Sehensw√ºrdigkeit. Bei Sch√∂nwettet z√§hlt der Markt mehr als 65, 000 Personen pro woche, viele davon Touristen. Ein Teil der Marktfl√§che ist f√ºr Gastronomietbetriebe reserviert. Nun erz√§hlt ein neuer Reisef√ºhrer die Geschichte des Naschmarktes, reich illustriert mit alten Aufnahmen. Ein Kapitel behandelt auch die ber√ºhmten Wienzeilenh√§user Otto Wagners, die sich an der Linken Wienzeile im Bereich des Naschmarktes befinden. Dazu gibt es Einkaufstipps und Beschreibungen der Lokale. ‚ÄûDer Markt am Wienfluss‚Äú. Hrsg. Hannes Ortner, 35 Seiten, 17 Euro.",
                correctAnswer: "j"
              },
              {
                id: "text4",
                content: "Wer bloggt, zeigt neben Fachkompetenz auch Kreativit√§t. Das sch√§tzen auch 4 Arbeitgeber. Ob man √ºber fachliche Fragestellungen schreibt oder einfach nur √ºber das Leben - das Themenspektrum von Blogs ist riesig. Genauso vielf√§ltig sind auch die M√∂glichkeiten, die sie Bewerberinnen und Bewerbern bieten. Wer einen Blog professionell betreibt, kann seine fachlichen Kompetenzen pr√§sentieren und gleichzeitig seinen Ideenreichtum unter Beweis stellen. Doch auch die Darstellung eines Hobbys zeigt, dass der Bewerber aktiv und kreativ ist. Experten raten daher Bloggerinnen und Bloggern, in ihren Bewerbungsunterlagen gezielt darauf hinzuweisen. Doch Achtung: Ein Blog kann Bewerber auch in einem schlechten Licht erscheinen lassen. Bloggen w√§hrend der Arbeitszeit und das Schreiben √ºber Firmeninterna sind nat√ºrlich tabu.",
                correctAnswer: "e"
              },
              {
                id: "text5",
                content: "Bis Herbst soll ein neues Marktkonzept f√ºr den altehrw√ºrdigen Salzburger Gr√ºnmarkt vorliegen. Damit der Markt f√ºr Besucherinnen und Besucher wieder attraktiver wird, setzt die zust√§ndige Stelle im Magistrat auf Nachhaltigkeit. Biologische Lebensmittel aus nachhaltiger Produktion, im Idealfall aus der Region, sollen den Markt wieder zu einem Fixpunkt in der Altstadt werden lassen. Der f√ºr M√§rkte, Stadtnatur und Lebensqualit√§t zust√§ndige Vizeb√ºrgermeister hofft, dass der Markt dazu beitragen kann, ein positives Lebensgef√ºhl zu vermitteln. Obwohl die Stadt die Verkaufsst√§nde vor einigen Jahren aufw√§ndig hatte restaurieren lassen, verzeichneten die H√§ndler zuletzt einen deutlichen R√ºckgang an Kundschaft. Zudem haben einige von ihnen altersbedingt ihre Verkaufsst√§nde aufgegeben. In diesem Zusammenhang wurde auch die beliebte Foodbloggerin Jasmin May engagiert. Sie soll dazu beitragen, das Konzept in der √ñffentlichkeit bekannter zu machen. Wir werden das Projekt weiterverfolgen und von seinem Fortgang berichten.",
                correctAnswer: "a"
              }
            ],
            headings: [
              {id: "a", text: "Erneuerungskur f√ºr einen alten Markt"},
              {id: "b", text: "Junge Influencer werben f√ºr Bioprodukte"},
              {id: "c", text: "Neues Buch √ºber einen Wiener Architekten erschienen"},
              {id: "d", text: "√ñsterreichs beliebteste Marktpl√§tze"},
              {id: "e", text: "Schreiben im Internet f√ºr die Karriere"},
              {id: "f", text: "Schulung zum Erfolg im Beruf"},
              {id: "g", text: "Seminar: Produkte erfolgreich verkaufen"},
              {id: "h", text: "Warum immer mehr Menschen auf M√§rkten einkaufen"},
              {id: "i", text: "Wenn Blogger Firmengeheimnisse verraten"},
              {id: "j", text: "Wissenswertes √ºber Wiens gr√∂√üten innerst√§dtischen Markt"}
            ]
          },
          { 
            id: "s2", 
            title: "Leseverstehen, Teil 2", 
            points: 25,
            passageTitle: "√ñsterreich, das Land der Poolbesitzer",
            passage: `√ñsterreich schwimmt. Und das nicht nur in Seen, Teichen oder Frebadem, Ein Bick √ºber die Gatenzaune des Landes macht deutlich: Die √ñsterreicher schwimmen zunehmend gerne zu Hause. Die Poolbranche sch√§tzt die Anzahl der Poolbesitzer in √ñsterreich auf etwa 90.000 bis 150.000. Im Vergleich zu Deutschland ist √ñsterreich wesentlich dichter mit Polls besiedelt. Warum Swimmingpools so beliebt sind, dar√ºber herrscht Uneinigkeit. Manche Vertreter der Branche sehen darin eine Reaktion auf wirtschaftlich unsichere Zeiten. Da investierten die Leute gerne in die eigenen vier W√§nde und in den Gartern inklusive Pools, meinen sie. Aridere sehen darin einen Ausdruck des allgemeinen Wellness-und Gesundheitstrends. Auch die Sehnsucht nach dem Meer wird bisweilen als Argument f√ºr den ausgepr√§gten Wunsch nach einem Pool vorgebracht. Das allein kann es nicht sein, denn als st√§rkster Poolmarkt in Europa gilt nach wie vor Frankreich. Branchenkenner f√ºhren den Boom aber auch auf finanzielle Gr√ºnde zur√ºck. Dass der Umsatz in den vergangenen Jahren stetig angestiegen ist, sehen viele im Angebot an preism√§√üigen Pools begr√ºndet. Vor 20 Jahren sei ein eigenes Schwimmbad noch ein absolutes Luxusgut gewesen. Jetzt gebe es immer mehr Alternativen, die einen Pool erschwinglich machen. Welche Gr√ºnde auch ausschlaggebend sein m√∂gen: Die Branche besitzt durchaus noch Potenzial, da sind sich alle einig. Laut einer kurzlei durchgef√ºhrten Studie tr√§umt n√§mlich beinahe jeder zweite √ñsterreicher von einem Pool. An erster Stelle der Wohnungsw√ºnsche steht er zwar nicht: So hat f√ºr 97 Prozent der befragten √ñsterreicher die Traumimmobilie einen Balkon, eine Loogia oder eine Terrasse, und 92 Prozent w√ºnschen sich eine Garage. 82 Prozent sehnen sich nach einem Garten, und 46 Prozent nach einem Swimmingpool - und zehn Prozent besitzen auch einen solchen. Dabei gibt es regionale Unterschiede. In absoluten Zahlen gibt es die meisten Pools in Wien und Niedergsterreich. Pro Kopf gerechnet gibt es aber in Vorarlberg die meisten privaten Schwimmbader. Einen nagelneuen Pool hat auch die 37-j√§hrige Rija in ihrem neuen Zuhause. Die Wienerin ist mit ihrem Lebensgef√§hrten vor kurzem nach Nieder√∂sterreich gezogen. Es war immer mein Traum einen Pool zu haben", sagt sie. Nun kann sie den Sommer im eigenen Pool genie√üen. Neben der Entspannung und Abk√ºhlung hat der Pool f√ºr sie noch einen weiteren Wert Der Pool hat Leben in den Garten gebracht. Es haben sich schon alle m√∂glichen Bekannten zum Schwimmen angemeldet", sagt sie, Denen dr√ºck ich aber vorher einen Spaten in die Hand - ein Teil vom Garten ist ja noch Baustelle." Tats√§chlich schwei√üt so ein Pool nicht nur die Nachbarschaft zusammen. Es ist auch die beste Werbung f√ºr weitere Becken. Kaum hat einer in einer Siedlung einen Pool, hat der Nachbar spatiestens nach zwei Jahren auch einen", meint ein Branchenvertreter. Besonders deutlich wird das in Kleingartensiedlungen, bei denen ein kleines Schwimmbecken schon beinahe zur Grundausstattung geh√∂rn. Doch manche Menschen bevorzugen naturnahe Schwimmteiche. Nach Sch√§tzungen macht de Anteil der Schwimmteiche am Schwimmanlagenmarkt rund 15 Prozent aus, in den vergangenen Jahren ist die Nachfrage nach Schwimmteichen stark gestiegen. Das hat auch zur Entwicklung von Naturpools gef√ºhrt. Optisch ein klassischer Swimmingpool, kommt der Naturpool ganzlich ohne Chemikalien aus Hier wird das Wasser durch Pumpen und Fillersysteme sauber gehalten. Bei der naturlichen Variante geht es √ºbrigens bei 35.000 Euro los. Daf√ºr spart man sich das j√§hrliche Bef√ºllen und Putzen. Das j√§hrliche Bef√ºllen von Pools aus den Wasserleitungen kann in manchen Regionen gelegentlich zu Wasserknappheit f√ºhren. Das betrifft aber meist nur jene Gemeinden, die von sehr kleinen Wassergenossenschaften versorgt werden. In Wien fali die Bel√ºlung der Pools kaum auf. Was den Leiter des Wiener Rohmetzes eher stort, ist der Wasserdiebstahl √ºber Hydranten, also √ºber die Zapistellen in den Stra√üen f√ºr Feuerwehr und Stra√üenreinigung. Denn wer es besonders eilig hat, kann seinen Pool auch √ºber die Hydranten bef√ºllen. Das geht schneller, muss aber angemeldet werden und kostet Geid. Generell gebe es aber keine Wasserknappheit. Es sei genug Wasser f√ºr alle da, so die Wesserversorger. F√ºrs Auffallen von Pools, aber auch f√ºrs Blumengie√üen, zum Duschen und auch zum Trinken Wir verwenden in √ñsterreich nur ein Prozent der vorhandenen Wasserressourcen.`,
            questions: [
              {
                id: "s2q1",
                type: "single",
                text: "Einige Vertreter der Poolbranche denken, dass",
                options: [
                  {id: "s2q1o1", text: "es in √ñsterreich bald mehr Pools gibt als in Frankreich"},
                  {id: "s2q1o2", text: "in unsicheren Zeiten weniger investiert wird."},
                  {id: "s2q1o3", text: "mehr Leute einen Pool bauen, weil Pools billiger geworden sind."}
                ],
                correctAnswer: "s2q1o3"
              },
              {
                id: "s2q2",
                type: "single", 
                text: "Laut einer Studie",
                options: [
                  {id: "s2q2o1", text: "m√∂chten die meisten Befragten ein Heim mit Garage."},
                  {id: "s2q2o2", text: "steht ein Pool nicht an erster Stelle auf der Wunschliste,"},
                  {id: "s2q2o3", text: "w√ºnschen sich 10 Prozent der √ñsterreicher einen Pool."}
                ],
                correctAnswer: "s2q2o2"
              },
              {
                id: "s2q3",
                type: "single",
                text: "Rija ist der Meinung, dass",
                options: [
                  {id: "s2q3o1", text: "ein Pool die Nachbarn neidisch macht."},
                  {id: "s2q3o2", text: "ihr Pool ein Anziehungspunkt f√ºr Freunde geworden ist."},
                  {id: "s2q3o3", text: "ihre Freunde beim Poolbau helfen sollen."}
                ],
                correctAnswer: "s2q3o2"
              },
              {
                id: "s2q4",
                type: "single",
                text: "Naturpools",
                options: [
                  {id: "s2q4o1", text: "brauchen keine chemischen Reinigungsmittel."},
                  {id: "s2q4o2", text: "m√ºssen h√§ufig geputzt werden."},
                  {id: "s2q4o3", text: "sehen genauso aus wie Schwimmteiche."}
                ],
                correctAnswer: "s2q4o1"
              },
              {
                id: "s2q5", 
                type: "single",
                text: "In Wien",
                options: [
                  {id: "s2q5o1", text: "darf man einen Pool nur mit Wasser aus der Leitung f√ºllen."},
                  {id: "s2q5o2", text: "f√ºhrt das Bef√ºllen von Pools regelm√§√üig zu Wasserknappheit."},
                  {id: "s2q5o3", text: "wird manchmal Wasser zum Bef√ºllen von Pools gestohlen"}
                ],
                correctAnswer: "s2q5o3"
              }
            ]
          },
          { 
            id: "s3", 
            title: "Leseverstehen, Teil 3", 
            points: 25,
            passageTitle: "Aufgabe: Lesen Sie die zehn Situationen (11-20) und die zw√∂lf Texte (A-L). Welcher Text passt zu welcher Situation? Sie k√∂nnen jeden Text nur einmal verwenden. ManchŸÖÿß passt kein Text. W√§hlen Sie dann 'x'.",
            passage: "",
            questions: [],
            texts: [
              {id: "A", text: "Die Nachfrage nach individueller Farb- und Stilberatung ist gro√ü. Denn wer heute im Gesch√§fts- wie auch im Privatleben erfolgreich sein m√∂chte, muss sich in Outfit und Benehmen vorteilhaft pr√§sentieren k√∂nnen. Der Leitfaden zeigt Ihnen, wie Sie sich selbst am besten in Szene setzen. Von der passenden und farblich stimmigen Garderobe √ºber Make-up und Accessoires bis zu modernen Umgangsformen. Nutzen Sie also diesen 'Kurs' als Eintrittskarte in diese reizvolle Welt der Selbstdarstellung. Sie werden garantiert mit einem √ºberzeugenden und gewinnenden pers√∂nlichen Auftritt davon profitieren.", correctAnswer: "16"},
              {id: "B", text: "Die meisten Menschen kennen keine Strategien, wie sie ihr Lernverhalten und die F√§higkeit, sich Informationen zu merken, gezielt trainieren k√∂nnen. Dieses Buch gibt zun√§chst einen √úberblick, wie das menschliche Ged√§chtnis funktioniert, und bietet dann eine F√ºlle von Techniken an, mit denen auch Unge√ºbte sich das Lernen und Arbeiten leichter machen k√∂nnen.", correctAnswer: "13"},
              {id: "C", text: "Dieses erstmals 1788 erschienene Buch handelt von dem Umgang der Menschen miteinander und gibt Ratschl√§ge, wie man sich im Umgang mit Menschen verschiedenster Alters- und Rangstufen richtig verh√§lt. Es definiert, was Gutes und was schlechtes Verhalten ist, und galt so lange Zeit als ein Leitfaden f√ºr ‚Äúrichtiges‚Äù Benehmen.", correctAnswer: null},
              {id: "D", text: "Tim Gallwey entwickelte die Theorie vom Tennis-Spiel, das sich im Kopf abspielt. Er zeigt, wie jeder sein Leben frei von Angst und mit Eleganz spielen kann, ohne in Selbstzweifel oder Unkonzentriertheit zu verfallen. Das Gallwey‚Äôsche Tennisspiel setzt ungeahnte Energien frei und zeigt das grenzenlose Potential des menschlichen K√∂rpers und Geistes, wenn es darum geht, seine Lebensziele zu verfolgen und zu erreichen.", correctAnswer: "12"},
              {id: "E", text: "Jeder Mensch kann seine kommunikativen M√∂glichkeiten entdecken und damit sein Leben bereichern. Die Themen des Buches sind: Die Grundlagen der Kommunikation, Rede und Vortrag, Gespr√§che erfolgreich f√ºhren, Sicherheit gewinnen und Rede√§ngste √ºberwinden, Zeitmanagement f√ºr Redner und Konferenzleiter und vieles mehr. Ein ausf√ºhrlicher Praxisteil mit zahlreichen √úbungen erm√∂glicht es dem Leser, seine rhetorischen F√§higkeiten zu trainieren.", correctAnswer: "14"},
              {id: "F", text: "Gute Umgangsformen sind wieder ‚Äúin‚Äù. Aber gilt das auch in der Schule? Auf humorvolle Weise erz√§hlt die Autorin aus ihrem Alltag als Lehrerin an einer Realschule. Von gutem Benehmen kann da nicht immer die Rede sein ‚Äì √ºbrigens auch nicht bei den Eltern..", correctAnswer: "15"},
              {id: "G", text: "Frieder Schulze Reden wir miteinander oder aneinander vorbei? Manche Missverst√§ndnisse entstehen, wenn Menschen miteinander reden, besonders im privaten Bereich erleben wir das oft. Wenn Kommunikation erfolgreich sein soll, ist die F√§higkeit erforderlich, den anderen zu durchschauen und seelische Vorg√§nge und menschliche Probleme zu erkennen. Viele Beispiele zeigen, wie psychologische Aspekte menschliche Kommunikation verkomplizieren k√∂nnen und wie man damit am besten klar kommen kann.", correctAnswer: "17"},
              {id: "H", text: "Ken Best Dein K√∂rper liegt nicht Der K√∂rper liegt nicht. Gesten und Geb√§rden decken die Ebene des Unbewussten auf: Wer einen erhobenen Zeigefinger oder eine ger√ºmpfte Nase sieht, versteht sofort, was der Gespr√§chspartner meint, auch wenn der mit Worten etwas anderes sagt. Dieses Buch gibt einen anschaulichen √úberblick √ºber die Signale, die wir st√§ndig mit unserem K√∂rper senden, und hilft uns zu verstehen, ŸÖÿß jemand in Wahrheit gerade denkt und meint.", correctAnswer: null},
              {id: "I", text: "Rolph Barth Basiswissen: Bewerbungstraining Die Konkurrenz auf dem Arbeitsmarkt um immer knapper werdende freie Stellen ist gro√ü. Umso wichtiger ist es zu wissen, wie man sich richtig bewirbt. Dieses Buch gibt Arbeitsuchenden umfassende Informationen zur erfolgreichen Bewerbung und bereitet optimal auf das Vorstellungsgespr√§ch vor. Im √úbungsteil werden gute Formulierungen f√ºr das Anschreiben und das sichere Auftreten des Bewerbers im Gespr√§ch trainiert.", correctAnswer: "18"},
              {id: "J", text: "Brigitte H√ºhner Richtig pr√§sentieren Dieses Buch ist ein Leitfaden f√ºr alle, die Teamsitzungen, Besprechungen, Workshops und Konferenzen durchf√ºhren. Anhand vieler praktischer Beispiele erh√§lt der Leser Anregungen zum gekonnten Visualisieren, zur gut geplanten und sicher durchgef√ºhrten Pr√§sentation und zur effektiv gestalteten Besprechung. Es zeigt, wie durch den Einsatz von Bildern und Grafiken Pr√§sentationen aufgelockert und Informationen besser verstanden werden k√∂nnen.", correctAnswer: "19"},
              {id: "K", text: "Helga Sinn-Krummacher Delfin oder Delphin? So schreibt man das jetzt richtig Dieses Trainingsbuch ist f√ºr den Arbeitsplatz und f√ºr zu Hause gedacht. Auf humorvolle Art werden die neuen Rechtschreibregeln der deutschen Sprache vorgestellt und einge√ºbt. Es enth√§lt au√üerdem die neue amtliche Wortliste zur Rechtschreibung und die neuen Zeichensetzungsregeln.", correctAnswer: "20"},
              {id: "L", text: "Erika Jack Zeitmanagement Viele Menschen wissen nicht mehr, wo Ihnen der Kopf steht. Zu viele Termine und Aufgaben stellen Sie unter st√§ndigen Zeitdruck. Mit Zeitmanagement lernen Sie, wie Sie Ihre Zeit so einteilen k√∂nnen, dass Sie wieder Zeit zum Leben haben. Sie erkennen Ihre pers√∂nlichen Zeitdiebe, Sie lernen, Priorit√§ten und erreichbare Ziele zu setzen. Durch das F√ºhren eines Zeitplanbuchs lernen Sie wieder (und dauerhaft), aus der Zeitfalle herauszukommen.", correctAnswer: "11"}
            ],
            situations: [
              {id: "11", text: "Eine Bekannte interessiert sich f√ºr B√ºcher √ºber den Tennissport."},
              {id: "12", text: "Ein befreundetes Ehepaar steht andauernd unter Stress und m√∂chte wieder mehr Zeit f√ºr sich und andere haben."},
              {id: "13", text: "Eine Bekannte m√∂chte ihre Wohnung renovieren und sucht Tipps zu Tapeten und Wandfarben."},
              {id: "14", text: "Eine Studentin sucht Informationen, wie sie besser und systematischer lernen kann."},
              {id: "15", text: "Ein Bekannter m√∂chte wissen, welche Botschaften durch Gestik und Mimik transportiert werden."},
              {id: "16", text: "Eine Bekannte m√∂chte ihr √§u√üeres Erscheinungsbild optimieren."},
              {id: "17", text: "Ein Bekannter ist sich noch unsicher, wie er sich bei einem Vorstellungsgespr√§ch am besten pr√§sentiert."},
              {id: "18", text: "Ein Bekannter schreibt an einer Hausarbeit √ºber H√∂flichkeit und Benimmregeln in fr√ºheren Jahrhunderten."},
              {id: "19", text: "Ein Bekannter m√∂chte lernen, wie man gute Gesch√§ftsbriefe schreibt."},
              {id: "20", text: "Eine Bekannte ist sehr verunsichert, weil sie auf Konferenzen immer wieder Angst hat, frei zu sprechen."}
            ]
          },
          { 
            id: "s4", 
            title: "Sprachbausteine, Teil 1", 
            points: 15,
            passageTitle: "Aufgabe: Erg√§nzen Sie den Text. W√§hlen Sie f√ºr jede L√ºcke das passende Wort.",
            passage: "",
            questions: [],
            fillBlanks: [
              {
                id: "21",
                options: ["seine", "sind", "waren"],
                correctAnswer: "sind"
              },
              {
                id: "22",
                options: ["da", "das", "dass"],
                correctAnswer: "da"
              },
              {
                id: "23",
                options: ["an", "auf", "f√ºr"],
                correctAnswer: "auf"
              },
              {
                id: "24",
                options: ["je ... desto", "sowohl.... als auch", "weder .... noch"],
                correctAnswer: "sowohl.... als auch"
              },
              {
                id: "25",
                options: ["verwandte", "verwandeten", "verwandter"],
                correctAnswer: "verwandte"
              },
              {
                id: "26",
                options: ["unsere", "unseren", "unserer"],
                correctAnswer: "unsere"
              },
              {
                id: "27",
                options: ["als", "f√ºr", "wie"],
                correctAnswer: "als"
              },
              {
                id: "28",
                options: ["dass", "ob", "wenn"],
                correctAnswer: "ob"
              },
              {
                id: "29",
                options: ["bereten", "machen", "tun"],
                correctAnswer: "tun"
              },
              {
                id: "30",
                options: ["h√§tten", "k√∂nnten", "sollten"],
                correctAnswer: "k√∂nnten"
              }
            ],
            fillText: `Liebe Maria, lieber Timur,

herzlichen Dank f√ºr die Einladung zu eurem Hochzeitsfest! Nachdem wir gestern aus dem Urlaub zur√ºckgekommen ________, haben wir euren Brief und die Einladungskarte im Briefkasten entdeckt. ________ gibt es nicht viel zu √ºberlegen: Nat√ºrlich kommen wir sehr gerne! Wir freuen uns sehr ________ euch, dass ihr nun endlich diesen Schritt wagt. Es ist eine geniale Idee, ________ in der T√ºrkei ________ in √ñsterreich zu feiern, so k√∂nnen alle Freunde und ________ dabei sein. Wir hoffen, dass wir einige ________ alten Freunde wiedersehen werden.

Ihr habt geschrieben, dass Timurs Eltern und seine Schwestern auch in √ñsterreich sein werden. Endlich lernen wir auch Timurs Familie kennen! Und wie sch√∂n, dass ihr in Marias Heimatdorf im M√ºhlviertel feiert! Wir erinnern uns noch oft an die langen Partyn√§chte, die wir dort ________ Jugendliche gemeinsam verbracht haben. Nun √ºberlegen wir, ________ wir nicht gleich ein Hotelzimmer f√ºr einige Tage buchen sollten. Ihr habt ja sicher mit den Vorbereitungen alle H√§nde voll zu ________. Dann k√∂nnen wir am Freitag wandern gehen. Am Samstag ist dann euer Fest und am Sonntag ________ wir die Gelegenheit vor der Abreise noch gem√ºtlich zusammen zu fr√ºhst√ºcken. In welchem Hotel habt ihr eure Verwandten untergebracht? Seid ihr auch in einem Hotel, oder √ºbernachtet ihr bei deinen Eltern, Maria? Nun, das k√∂nnen wir alles noch sp√§ter besprechen.

Vorerst freuen wir uns einfach nur auf euch und euer Fest.

Noch einmal vielen Dank f√ºr die Einladung und bis bald!`
          },
          { 
            id: "s5", 
            title: "Sprachbausteine, Teil 2", 
            points: 15,
            passageTitle: "Aufgabe: Lesen Sie den Text und entscheiden Sie, welches Wort in welche L√ºcke passt. Sie k√∂nnen jedes Wort nur einmal verwenden. Nicht alle W√∂rter passen in den Text.",
            passage: "",
            questions: [],
            fillBlanks2: [
              {
                id: "31",
                options: ["BEGRIFFE", "DADURCH", "DAF√úR", "DASS", "DENN", "EINGRIFFE", "GING", "INNERHALB", "NAHKOMMEN", "NOCH", "SODASS", "SOWIE", "UM", "VORKOMMEN", "VOR", "W√ÑHREND"],
                correctAnswer: "VOR"
              },
              {
                id: "32", 
                options: ["BEGRIFFE", "DADURCH", "DAF√úR", "DASS", "DENN", "EINGRIFFE", "GING", "INNERHALB", "NAHKOMMEN", "NOCH", "SODASS", "SOWIE", "UM", "VORKOMMEN", "VOR", "W√ÑHREND"],
                correctAnswer: "DADURCH"
              },
              {
                id: "33",
                options: ["BEGRIFFE", "DADURCH", "DAF√úR", "DASS", "DENN", "EINGRIFFE", "GING", "INNERHALB", "NAHKOMMEN", "NOCH", "SODASS", "SOWIE", "UM", "VORKOMMEN", "VOR", "W√ÑHREND"],
                correctAnswer: "DASS"
              },
              {
                id: "34",
                options: ["BEGRIFFE", "DADURCH", "DAF√úR", "DASS", "DENN", "EINGRIFFE", "GING", "INNERHALB", "NAHKOMMEN", "NOCH", "SODASS", "SOWIE", "UM", "VORKOMMEN", "VOR", "W√ÑHREND"],
                correctAnswer: "UM"
              },
              {
                id: "35",
                options: ["BEGRIFFE", "DADURCH", "DAF√úR", "DASS", "DENN", "EINGRIFFE", "GING", "INNERHALB", "NAHKOMMEN", "NOCH", "SODASS", "SOWIE", "UM", "VORKOMMEN", "VOR", "W√ÑHREND"],
                correctAnswer: "INNERHALB"
              },
              {
                id: "36",
                options: ["BEGRIFFE", "DADURCH", "DAF√úR", "DASS", "DENN", "EINGRIFFE", "GING", "INNERHALB", "NAHKOMMEN", "NOCH", "SODASS", "SOWIE", "UM", "VORKOMMEN", "VOR", "W√ÑHREND"],
                correctAnswer: "DAF√úR"
              },
              {
                id: "37",
                options: ["BEGRIFFE", "DADURCH", "DAF√úR", "DASS", "DENN", "EINGRIFFE", "GING", "INNERHALB", "NAHKOMMEN", "NOCH", "SODASS", "SOWIE", "UM", "VORKOMMEN", "VOR", "W√ÑHREND"],
                correctAnswer: "DENN"
              },
              {
                id: "38",
                options: ["BEGRIFFE", "DADURCH", "DAF√úR", "DASS", "DENN", "EINGRIFFE", "GING", "INNERHALB", "NAHKOMMEN", "NOCH", "SODASS", "SOWIE", "UM", "VORKOMMEN", "VOR", "W√ÑHREND"],
                correctAnswer: "EINGRIFFE"
              },
              {
                id: "39",
                options: ["BEGRIFFE", "DADURCH", "DAF√úR", "DASS", "DENN", "EINGRIFFE", "GING", "INNERHALB", "NAHKOMMEN", "NOCH", "SODASS", "SOWIE", "UM", "VORKOMMEN", "VOR", "W√ÑHREND"],
                correctAnswer: "NOCH"
              },
              {
                id: "40",
                options: ["BEGRIFFE", "DADURCH", "DAF√úR", "DASS", "DENN", "EINGRIFFE", "GING", "INNERHALB", "NAHKOMMEN", "NOCH", "SODASS", "SOWIE", "UM", "VORKOMMEN", "VOR", "W√ÑHREND"],
                correctAnswer: "GING"
              }
            ],
            fillText2: `Das Schicksal des Braunb√§ren

Klimatische Ver√§nderungen seit der letzten Kaltzeit k√∂nnten f√ºr den stetigen R√ºckgang der Braunb√§renzahl in Europa verantwortlich sein. Wie eine aktuelle Studie nahelegt, haben ________ allem steigende Wintertemperaturen in der vergangenen 12.000 Jahre die Fortpflanzungsrate der Tiere verringert, was entscheidend zu deren Verschwinden beigetragen hat. Zudem wurden ________ die Klimaver√§nderung gr√∂√üere Fl√§chen f√ºr den Ackerbau nutzbar. Es ist l√§ngst unumstritten, ________ das Verschwinden der Braunb√§ren mit der Landnutzung durch den Menschen zusammenh√§ngt.

Ein internationales Expertenteam untersuchte nun die Rolle des Klimas beim R√ºckgang der B√§renzahl. In den letzten 12.000 Jahren ist die Wintertemperatur in weiten Teilen Europas ________ zwei bis vier Grad angestiegen. In der Folge bekamen die Braunb√§ren weniger ________, und ihre Zahl schrumpfte.

Der Grund ________ ist, dass Braunb√§ren bei steigenden Wintertemperaturen mehr Energie f√ºr ihre Winterruhe verbrauchen. Braunb√§renweibchen ben√∂tigen ihre Energiereserven auch f√ºr die Fortpflanzung, ________ sie bringen im Winter ihre Jungen zur Welt. Wird mehr Energie f√ºr die Winterruhe verbraucht, bleibt nicht so viel f√ºr die Fortpflanzung √ºbrig, und es gibt weniger Nachwuchs.

Steigende Wintertemperaturen k√∂nnten auch indirekt f√ºr das Schicksal des Braunb√§ren verantwortlich gewesen sein. W√§rmere Winter beg√ºnstigten n√§mlich auch die menschlichen ________ in die Naturlandschaften und damit in den Lebensraum der Braunb√§ren.

Am Ende der letzten Eiszeit war der Braunb√§r ________ √ºberall in Europa heimisch. Ein gro√ües Aussterben gab es in S√ºdwesteuropa vor 7.000 bis 5.000 Jahren. Richtig bergab ________ es mit dem Braunb√§ren aber vor etwa 2.000 Jahren, als sich seine Zahl stark verringerte.`
          }
        ]
      };

      let state = { 
        sectionIndex: 0, 
        questionIndex: 0, 
        answers: {}, 
        marked: {}, 
        remaining: exam.durationSec,
        showResults: false,
        timerStarted: false,
        timerInterval: null
      };
      const topTiles = document.getElementById('topTiles-lesen');
      const passageTitleEl = document.getElementById('passageTitle-lesen');
      const passageContentEl = document.getElementById('passageContent-lesen');
      const sectionNameEl = document.getElementById('sectionName-lesen');
      const questionTitleEl = document.getElementById('questionTitle-lesen');
      const questionBodyEl = document.getElementById('questionBody-lesen');
      const headingsBankContainer = document.getElementById('headingsBankContainer-lesen');
      const timerEl = document.getElementById('timer-lesen');
      const statusText = document.getElementById('statusText-lesen');
      const resultBtn = document.getElementById('resultBtn-lesen');
      const resetBtn = document.getElementById('resetBtn-lesen');
      const resetSectionBtn = document.getElementById('resetSectionBtn-lesen');

      function startTimer(){
        if(state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        
        state.timerStarted = true;
        state.timerInterval = setInterval(()=>{
          if(state.remaining <= 0){
            clearInterval(state.timerInterval);
            timerEl.textContent = 'Zeit abgelaufen';
            return;
          }
          state.remaining--;
          updateTimerDisplay();
        }, 1000);
      }

      function resetTimer(){
        if(state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        state.remaining = exam.durationSec;
        state.timerStarted = false;
        updateTimerDisplay();
        startTimer();
      }

      function updateTimerDisplay(){
        const min = Math.floor(state.remaining / 60);
        const sec = state.remaining % 60;
        timerEl.textContent = `Verbleibende Zeit: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
      }

      function resetCurrentSection() {
        const currentSection = exam.sections[state.sectionIndex];
        
        if (confirm(`M√∂chten Sie wirklich den Teil "${currentSection.title}" zur√ºcksetzen? Alle Antworten in diesem Teil werden gel√∂scht.`)) {
          if (currentSection.id === 's1') {
            currentSection.texts.forEach(text => {
              delete state.answers[text.id];
            });
          } else if (currentSection.id === 's2') {
            currentSection.questions.forEach(question => {
              delete state.answers[question.id];
            });
          } else if (currentSection.id === 's3') {
            currentSection.situations.forEach(situation => {
              delete state.answers[situation.id];
            });
          } else if (currentSection.id === 's4') {
            currentSection.fillBlanks.forEach(blank => {
              delete state.answers[blank.id];
            });
          } else if (currentSection.id === 's5') {
            currentSection.fillBlanks2.forEach(blank => {
              delete state.answers[blank.id];
            });
          }
          
          renderAll();
        }
      }

      function renderTopTiles(){ 
        topTiles.innerHTML=''; 
        exam.sections.forEach((sec,idx)=>{ 
          const div=document.createElement('div'); 
          div.className='tile'+(idx===state.sectionIndex?' active':'')+(isSectionDone(sec)?' done':''); 
          div.innerHTML=`<div>${sec.title}</div><div class="points">${sec.points} P</div>`; 
          div.onclick=()=>{state.sectionIndex=idx; state.questionIndex=0; state.showResults=false; renderAll();}; 
          topTiles.appendChild(div); 
        }); 
      }

      function isSectionDone(section){
        if(section.id==='s1') return section.texts.every(t=>state.answers[t.id]);
        if(section.id==='s2') return section.questions.every(q=>state.answers[q.id]);
        if(section.id==='s3') return section.situations.every(h=>state.answers[h.id] || state.answers[h.id] === 'X');
        if(section.id==='s4') return section.fillBlanks.every(b=>state.answers[b.id]);
        if(section.id==='s5') return section.fillBlanks2.every(b=>state.answers[b.id]);
        return false;
      }

      function renderAll(){
        renderTopTiles();
        const section = exam.sections[state.sectionIndex];
        sectionNameEl.textContent = section.title;
        passageTitleEl.textContent = section.passageTitle;
        
        resetSectionBtn.style.display = 'block';
        
        if(state.showResults){
          renderResults();
          return;
        }
        
        if(section.id === 's1'){
          renderPart1();
        } else if(section.id === 's2'){
          renderPart2();
        } else if(section.id === 's3'){
          renderPart3();
        } else if(section.id === 's4'){
          renderSprachbausteine1();
        } else if(section.id === 's5'){
          renderSprachbausteine2();
        }
      }

      function renderPart1(){
        const section = exam.sections[state.sectionIndex];
        
        let textsHTML = `<div class="instructions">Ziehen Sie die passenden √úberschriften auf die Texte. Sie k√∂nnen jede √úberschrift nur einmal verwenden.</div>`;
        
        section.texts.forEach((text, idx) => {
          const letter = String.fromCharCode(97 + idx);
          const selectedHeading = state.answers[text.id];
          
          textsHTML += `
            <div class="text-container">
              <div class="text-title">Text ${letter.toUpperCase()}</div>
              <div class="text-content">${text.content}</div>
              <div class="title-slot ${selectedHeading ? 'has-title' : ''}" data-text-id="${text.id}">
                ${selectedHeading ? getHeadingTextById(selectedHeading) : 'Ziehen Sie hier eine √úberschrift hin'}
              </div>
            </div>
          `;
        });
        
        passageContentEl.innerHTML = textsHTML;
        
        let headingsHTML = `<div class="headings-bank">`;
        section.headings.forEach(heading => {
          const isUsed = section.texts.some(text => state.answers[text.id] === heading.id);
          
          headingsHTML += `
            <div class="heading-item ${isUsed ? 'used' : ''}" draggable="${!isUsed}" data-heading-id="${heading.id}">
              ${heading.id}) ${heading.text}
            </div>
          `;
        });
        
        headingsHTML += `</div>`;
        
        headingsBankContainer.innerHTML = headingsHTML;
        
        setupDragAndDrop();
        
        questionBodyEl.innerHTML = '';
        questionTitleEl.textContent = '';
      }

      function getHeadingTextById(id){
        const section = exam.sections[state.sectionIndex];
        const heading = section.headings.find(h => h.id === id);
        return heading ? `${heading.id}) ${heading.text}` : '';
      }

      function setupDragAndDrop(){
        const headingItems = document.querySelectorAll('.heading-item:not(.used)');
        const titleSlots = document.querySelectorAll('.title-slot');
        
        headingItems.forEach(item => {
          item.addEventListener('dragstart', (e) => {
            e.dataTransfer.setData('text/plain', e.target.dataset.headingId);
          });
        });
        
        titleSlots.forEach(slot => {
          slot.addEventListener('dragover', (e) => {
            e.preventDefault();
            slot.style.background = '#e8f4ff';
          });
          
          slot.addEventListener('dragleave', (e) => {
            slot.style.background = slot.classList.contains('has-title') ? '#e8fbe9' : '#f8fbff';
          });
          
          slot.addEventListener('drop', (e) => {
            e.preventDefault();
            const headingId = e.dataTransfer.getData('text/plain');
            const textId = slot.dataset.textId;
            
            Object.keys(state.answers).forEach(key => {
              if(state.answers[key] === headingId) {
                delete state.answers[key];
              }
            });
            
            state.answers[textId] = headingId;
            renderAll();
          });
        });
      }

      function renderPart2(){
        const section = exam.sections[state.sectionIndex];
        
        passageContentEl.innerHTML = `<div class="passage">${section.passage}</div>`;
        
        let questionsHTML = `<div class="all-questions">`;
        
        section.questions.forEach((question, idx) => {
          const questionNumber = idx + 1;
          const userAnswer = state.answers[question.id];
          
          questionsHTML += `
            <div class="question-block">
              <div class="question-text">${questionNumber}. ${question.text}</div>
              <div class="options">
                ${question.options.map(opt => `
                  <div class="option ${userAnswer === opt.id ? 'selected' : ''}" 
                       onclick="window.lesenApp.selectOption('${question.id}', '${opt.id}')">
                    <div class="radio"></div>
                    <div>${opt.text}</div>
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        });
        
        questionsHTML += `</div>`;
        
        questionBodyEl.innerHTML = questionsHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';
      }

      function renderPart3(){
        const section = exam.sections[state.sectionIndex];
        
        let textsHTML = `
          <div class="instructions">Ziehen Sie die passenden Situationen auf die Texte. Sie k√∂nnen jede Situation nur einmal verwenden. Manchmal passt keine Situation.</div>
          <div class="texts-list">
            <h3>Texte (A-L)</h3>
        `;
        
        section.texts.forEach(text => {
          const userAnswer = Object.keys(state.answers).find(key => state.answers[key] === text.id);
          const selectedSituation = userAnswer ? section.situations.find(h => h.id === userAnswer) : null;
          
          textsHTML += `
            <div class="text-item" data-text-id="${text.id}">
              <div class="text-letter">${text.id})</div>
              <div class="text-content">${text.text}</div>
              <div class="title-slot ${userAnswer ? 'has-title' : ''} ${userAnswer === 'X' ? 'has-x' : ''}" data-text-id="${text.id}">
                ${selectedSituation ? selectedSituation.text : (userAnswer === 'X' ? 'X - Keine passende Situation' : 'Ziehen Sie hier eine Situation hin')}
              </div>
            </div>
          `;
        });
        
        textsHTML += `</div>`;
        
        passageContentEl.innerHTML = textsHTML;
        
        let situationsHTML = `
          <div class="situations-list">
            <h3>Situationen (11-20)</h3>
        `;
        
        section.situations.forEach((situation, idx) => {
          const situationNumber = parseInt(situation.id);
          const isUsed = state.answers[situation.id];
          const isX = state.answers[situation.id] === 'X';
          
          situationsHTML += `
            <div class="situation-item ${isUsed ? 'used' : ''}" draggable="${!isUsed}" data-situation-id="${situation.id}">
              <div class="situation-number">${situationNumber}.</div>
              <div class="situation-text">${situation.text}</div>
              ${!isUsed ? `<button class="exam-btn no-match ${isX ? 'selected' : ''}" onclick="window.lesenApp.markNoMatch('${situation.id}')">X - Kein passender Text</button>` : ''}
            </div>
          `;
        });
        
        situationsHTML += `</div>`;
        
        questionBodyEl.innerHTML = situationsHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';
        
        setupPart3DragAndDrop();
      }

      function markNoMatch(situationId) {
        Object.keys(state.answers).forEach(key => {
          if(state.answers[key] === situationId) {
            delete state.answers[key];
          }
        });
        
        state.answers[situationId] = 'X';
        try{ localStorage.setItem('lesenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        renderAll();
      }

      function setupPart3DragAndDrop(){
        const situationItems = document.querySelectorAll('.situation-item:not(.used)');
        const textSlots = document.querySelectorAll('.text-item .title-slot');
        
        situationItems.forEach(item => {
          item.addEventListener('dragstart', (e) => {
            e.dataTransfer.setData('text/plain', e.target.dataset.situationId);
          });
        });
        
        textSlots.forEach(slot => {
          slot.addEventListener('dragover', (e) => {
            e.preventDefault();
            slot.style.background = '#e8f4ff';
          });
          
          slot.addEventListener('dragleave', (e) => {
            const hasTitle = slot.classList.contains('has-title');
            const hasX = slot.classList.contains('has-x');
            slot.style.background = hasTitle ? '#e8fbe9' : (hasX ? '#f8d7da' : '#f8fbff');
          });
          
          slot.addEventListener('drop', (e) => {
            e.preventDefault();
            const situationId = e.dataTransfer.getData('text/plain');
            const textId = slot.dataset.textId;
            
            Object.keys(state.answers).forEach(key => {
              if(state.answers[key] === situationId) {
                delete state.answers[key];
              }
            });
            
            state.answers[situationId] = textId;
            renderAll();
          });
        });
      }

      function renderSprachbausteine1(){
        const section = exam.sections[state.sectionIndex];
        
        let textWithBlanks = section.fillText;
        
        const blankPlaceholders = [];
        section.fillBlanks.forEach(blank => {
          blankPlaceholders.push(`BLANK_${blank.id}`);
        });
        
        let tempText = textWithBlanks;
        blankPlaceholders.forEach((placeholder, index) => {
          tempText = tempText.replace('________', placeholder);
        });
        
        section.fillBlanks.forEach(blank => {
          const userAnswer = state.answers[blank.id];
          const displayText = userAnswer ? userAnswer : '________';
          tempText = tempText.replace(`BLANK_${blank.id}`, `<span class="blank-word ${userAnswer ? 'has-answer' : ''}" data-blank-id="${blank.id}">${displayText}</span>`);
        });
        
        passageContentEl.innerHTML = `
          <div class="instructions">Klicken Sie auf jede L√ºcke und w√§hlen Sie das passende Wort aus. Sie k√∂nnen die L√ºcken in beliebiger Reihenfolge ausf√ºllen.</div>
          <div class="fill-blank-container">${tempText}</div>
        `;
        
        document.querySelectorAll('.blank-word').forEach(blank => {
          blank.addEventListener('click', (e) => {
            showOptionsPopup(e.target);
          });
        });
        
        let optionsHTML = `<div class="horizontal-options" style="gap: 8px;">`;
        
        section.fillBlanks.forEach(blank => {
          const userAnswer = state.answers[blank.id];
          
          optionsHTML += `
            <div class="option-row" style="padding: 8px; margin-bottom: 5px;">
              <div class="option-number">${blank.id}</div>
              <div class="option-buttons">
                ${blank.options.map(opt => `
                  <div class="option-btn ${userAnswer === opt ? 'selected' : ''}" 
                       onclick="window.lesenApp.selectSprachbausteine1('${blank.id}', '${opt}')" 
                       style="padding: 6px 12px; font-size: 12px;">
                    ${opt}
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        });
        
        optionsHTML += `</div>`;
        
        questionBodyEl.innerHTML = optionsHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';
      }

      function showOptionsPopup(blankElement){
        const existingPopup = document.querySelector('.options-popup');
        if(existingPopup) {
          existingPopup.remove();
        }
        
        const blankId = blankElement.getAttribute('data-blank-id');
        const section = exam.sections.find(s => s.id === 's4');
        const blank = section.fillBlanks.find(b => b.id === blankId);
        
        if(!blank) return;
        
        const popup = document.createElement('div');
        popup.className = 'options-popup';
        
        blank.options.forEach(opt => {
          const optionItem = document.createElement('div');
          optionItem.className = 'option-item';
          optionItem.textContent = opt;
          optionItem.onclick = () => {
            selectSprachbausteine1(blankId, opt);
            popup.remove();
          };
          popup.appendChild(optionItem);
        });
        
        blankElement.appendChild(popup);
      }

      function selectSprachbausteine1(blankId, answer){
        state.answers[blankId] = answer;
        renderAll();
      }

      function renderSprachbausteine2(){
        const section = exam.sections[state.sectionIndex];
        let textWithPlaceholders = section.fillText2;
        const placeholders = [];
        section.fillBlanks2.forEach(blank => {
          const ph = `BLANK_${blank.id}`;
          placeholders.push({id: blank.id, ph});
          textWithPlaceholders = textWithPlaceholders.replace('________', ph);
        });

        placeholders.forEach(item => {
          const userAnswer = state.answers[item.id];
          const displayText = userAnswer ? userAnswer : '________';
          const span = `<span class="blank-slot ${userAnswer ? 'has-answer' : ''}" data-blank-id="${item.id}">${displayText}</span>`;
          textWithPlaceholders = textWithPlaceholders.replace(item.ph, span);
        });

        passageContentEl.innerHTML = `
          <div class="instructions">Klicken Sie auf jede L√ºcke und w√§hlen Sie das passende Wort aus. Sie k√∂nnen jedes Wort nur einmal verwenden.</div>
          <div class="fill-blank-container">${textWithPlaceholders}</div>
        `;

        document.querySelectorAll('.blank-slot').forEach(slot => {
          slot.addEventListener('click', (e) => {
            showSprachbausteine2Options(slot);
          });
        });

        let wordBankHTML = `<div class="word-bank-vertical" style="gap: 8px;">`;
        const usedWords = Object.values(state.answers);
        const bank = section.wordBank && section.wordBank.length ? section.wordBank : (section.fillBlanks2[0] ? section.fillBlanks2[0].options : []);
        bank.forEach(word => {
          const isUsed = usedWords.includes(word);
          wordBankHTML += `
            <div class="bank-word-vertical ${isUsed ? 'used' : ''}" 
                 draggable="${!isUsed}" 
                 data-word="${word}"
                 ${!isUsed ? `onclick="window.lesenApp.selectSprachbausteine2FromBank('${word}')"` : ''}>
              ${word}
            </div>
          `;
        });
        wordBankHTML += `</div>`;
        questionBodyEl.innerHTML = wordBankHTML;
        questionTitleEl.textContent = '';
        headingsBankContainer.innerHTML = '';

        setupSprachbausteine2DragAndDrop();
      }

      let lastClickedSprachSlot = null;

      function setupSprachbausteine2DragAndDrop(){
        const bankWords = Array.from(document.querySelectorAll('.bank-word-vertical'));
        bankWords.forEach(el => {
          const word = el.dataset.word;
          if(!el.classList.contains('used')){
            el.setAttribute('draggable','true');
          } else {
            el.setAttribute('draggable','false');
          }
          el.removeEventListener('dragstart', el._dstart);
          el._dstart = (e) => {
            e.dataTransfer.setData('text/plain', word);
            e.dataTransfer.setData('source', 'bank');
          };
          el.addEventListener('dragstart', el._dstart);

          el.removeEventListener('click', el._onclick);
          el._onclick = () => {
            if(el.classList.contains('used')) return;
            selectSprachbausteine2FromBank(word);
          };
          el.addEventListener('click', el._onclick);
        });

        const slots = Array.from(document.querySelectorAll('.blank-slot'));
        slots.forEach(slot => {
          slot.addEventListener('dragover', (e) => {
            e.preventDefault();
            slot.classList.add('drag-over');
          });
          slot.addEventListener('dragleave', (e) => {
            slot.classList.remove('drag-over');
          });
          slot.addEventListener('drop', (e) => {
            e.preventDefault();
            slot.classList.remove('drag-over');
            const word = e.dataTransfer.getData('text/plain') || e.dataTransfer.getData('text/html');
            if(!word) return;
            const blankId = slot.dataset.blankId;
            if(!blankId) return;
            Object.keys(state.answers).forEach(k => {
              if(state.answers[k] === word){
                delete state.answers[k];
              }
            });
            const prev = state.answers[blankId];
            if(prev){
              const prevEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === prev);
              if(prevEl){
                prevEl.classList.remove('used');
                prevEl.setAttribute('draggable','true');
                prevEl.addEventListener('click', prevEl._onclick);
              }
            }
            const bankEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === word);
            if(bankEl){
              bankEl.classList.add('used');
              bankEl.setAttribute('draggable','false');
              bankEl.removeEventListener('click', bankEl._onclick);
            }
            state.answers[blankId] = word;
            renderAll();
          });
        });
      }

      function showSprachbausteine2Options(slot){
        document.querySelectorAll('.blank-slot').forEach(s => s.classList.remove('selected-sprach'));
        slot.classList.add('selected-sprach');
        lastClickedSprachSlot = slot;
      }

      function selectSprachbausteine2FromBank(word){
        let slot = lastClickedSprachSlot;
        if(!slot){
          slot = Array.from(document.querySelectorAll('.blank-slot')).find(s => {
            const id = s.dataset.blankId;
            return !state.answers[id];
          });
        }
        if(!slot) {
          return;
        }
        const blankId = slot.dataset.blankId;
        Object.keys(state.answers).forEach(k => {
          if(state.answers[k] === word){
            delete state.answers[k];
          }
        });
        const prev = state.answers[blankId];
        if(prev){
          const prevEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === prev);
          if(prevEl){
            prevEl.classList.remove('used');
            prevEl.setAttribute('draggable','true');
            if(prevEl._onclick) prevEl.addEventListener('click', prevEl._onclick);
          }
        }
        const bankEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b=>b.dataset.word === word);
        if(bankEl){
          bankEl.classList.add('used');
          bankEl.setAttribute('draggable','false');
          if(bankEl._onclick) try{ bankEl.removeEventListener('click', bankEl._onclick); }catch(e){}
        }
        state.answers[blankId] = word;
        try{ localStorage.setItem('lesenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        lastClickedSprachSlot = null;
        renderAll();
      }

      function selectOption(questionId, optionId){
        state.answers[questionId] = optionId;
        try{ localStorage.setItem('lesenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        renderAll();
      }

      function renderResults(){
        let resultsHTML = `<h2>Ergebnisse</h2>`;
        let totalCorrect = 0;
        let totalQuestions = 0;
        
        exam.sections.forEach(section => {
          resultsHTML += `<div class="result-item"><h3>${section.title}</h3>`;
          
          if(section.id === 's1'){
            section.texts.forEach(text => {
              totalQuestions++;
              const userAnswer = state.answers[text.id];
              const isCorrect = userAnswer === text.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>Text ${text.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's2'){
            section.questions.forEach(question => {
              totalQuestions++;
              const userAnswer = state.answers[question.id];
              const isCorrect = userAnswer === question.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>${question.text}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's3'){
            section.situations.forEach(situation => {
              totalQuestions++;
              const userAnswer = state.answers[situation.id];
              const correctText = section.texts.find(t => t.correctAnswer === situation.id);
              const isCorrect = userAnswer === (correctText ? correctText.id : null);
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>Situation ${situation.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's4'){
            section.fillBlanks.forEach(blank => {
              totalQuestions++;
              const userAnswer = state.answers[blank.id];
              const isCorrect = userAnswer === blank.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>L√ºcke ${blank.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's5'){
            section.fillBlanks2.forEach(blank => {
              totalQuestions++;
              const userAnswer = state.answers[blank.id];
              const isCorrect = userAnswer === blank.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>L√ºcke ${blank.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          }
          
          resultsHTML += `</div>`;
        });
        
        const percentage = totalQuestions > 0 ? Math.round((totalCorrect / totalQuestions) * 100) : 0;
        resultsHTML += `<div class="result-item"><h3>Gesamtergebnis: ${totalCorrect}/${totalQuestions} (${percentage}%)</h3></div>`;
        
        passageContentEl.innerHTML = resultsHTML;
        questionBodyEl.innerHTML = '';
        sectionNameEl.textContent = 'Ergebnisse';
        questionTitleEl.textContent = '';
      }

      document.getElementById('prevBtn-lesen').addEventListener('click', ()=>{
        if(state.sectionIndex > 0){
          state.sectionIndex--;
          state.questionIndex = 0;
          renderAll();
        }
      });

      document.getElementById('nextBtn-lesen').addEventListener('click', ()=>{
        if(state.sectionIndex < exam.sections.length - 1){
          state.sectionIndex++;
          state.questionIndex = 0;
          renderAll();
        }
      });

      resultBtn.addEventListener('click', ()=>{
        state.showResults = !state.showResults;
        renderAll();
      });

      resetBtn.addEventListener('click', ()=>{
        if(confirm('M√∂chten Sie wirklich von neu beginnen? Alle Antworten werden gel√∂scht.')){
          state.answers = {};
          state.marked = {};
          state.showResults = false;
          resetTimer();
          renderAll();
        }
      });

      resetSectionBtn.addEventListener('click', resetCurrentSection);

      document.getElementById('saveBtn-lesen').addEventListener('click', ()=>{
        statusText.textContent = 'Gespeichert';
        setTimeout(()=>{statusText.textContent = 'Nicht gespeichert'}, 2000);
      });

      document.getElementById('submitBtn-lesen').addEventListener('click', ()=>{
        if(confirm('M√∂chten Sie die Pr√ºfung wirklich abgeben?')){
          state.showResults = true;
          renderAll();
        }
      });

      document.getElementById('nextBtn-lesen').addEventListener('click', ()=>{
        showPage('hoeren-page');
      });

      updateTimerDisplay();
      renderAll();
      startTimer();
      
      window._lesenState = state;
      window.lesenApp = {
        selectOption,
        markNoMatch,
        selectSprachbausteine1,
        selectSprachbausteine2FromBank
      };
    }

    // ===== H√ñREN PAGE FUNCTIONALITY =====
    function initHoerenPage() {
      const exam = {
        id: "exam-h√∂rverstehen",
        durationSec: 17 * 60,
        sections: [
          { 
            id: "h√∂rverstehen1", 
            title: "H√∂rverstehen, Teil 1", 
            points: 25,
            correctAnswers: { "41": "falsch", "42": "richtig", "43": "richtig", "44": "falsch", "45": "richtig" },
            questions: [
              {
                id: "41",
                text: "Die Stadt Friedrichsberg l√§dt zu einer Preisverleihung ein."
              },
              {
                id: "42", 
                text: "Die Alte Br√ºcke ist zum Jahresbeginn wieder befahrbar."
              },
              {
                id: "43",
                text: "Der Wanderer wurde verarztet und in Sicherheit gebracht."
              },
              {
                id: "44",
                text: "In dem Unternehmen kommt es zu K√ºndigungen."
              },
              {
                id: "45",
                text: "Man kann nach einer Registrierung an einem Gruppenlauf teilnehmen."
              }
            ]
          },
          { 
            id: "h√∂rverstehen2", 
            title: "H√∂rverstehen, Teil 2", 
            points: 25,
            correctAnswers: { "46": "falsch", "47": "richtig", "48": "falsch", "49": "falsch", "50": "falsch", "51": "falsch", "52": "richtig", "53": "falsch", "54": "falsch", "55": "falsch" },
            questions: [
              {
                id: "46",
                text: "Professor Steiner m√∂chte, dass die Studierenden das Gelernte auch in der Praxis anwenden k√∂nnen."
              },
              {
                id: "47",
                text: "Steiners Hobby ist es, experimentelle Filme zu machen."
              },
              {
                id: "48", 
                text: "Journalisten sollten heute auf einzelne Medien spezialisiert sein."
              },
              {
                id: "49",
                text: "Nach Steiners Ansicht ist der Berufswunsch Sportjournalist heutzutage unrealistisch."
              },
              {
                id: "50",
                text: "Journalisten sollten m√∂glichst viele Informationen an die √ñffentlichkeit weitergeben."
              },
              {
                id: "51",
                text: "Steiner musste wegen einer Verletzung mit dem Fu√üballspielen aufh√∂ren."
              },
              {
                id: "52",
                text: "Steiner hat w√§hrend seines Journalistik-Studiums f√ºr das ZDF Fu√üballspiele kommentiert."
              },
              {
                id: "53",
                text: "Steiner legt Wert darauf, als Moderator Sportlern gegen√ºber neutral zu bleiben."
              },
              {
                id: "54",
                text: "Auch die Frau von Roland W√ºnschmann engagiert sich im Fu√üball."
              },
              {
                id: "55",
                text: "Der Vereinsvorstand sch√§tzt Herrn W√ºnschmanns Arbeit."
              }
            ]
          },
          { 
            id: "h√∂rverstehen3", 
            title: "H√∂rverstehen, Teil 3", 
            points: 25,
            correctAnswers: { "56": "richtig", "57": "falsch", "58": "richtig", "59": "falsch", "60": "falsch" },
            questions: [
              {
                id: "56",
                text: "W√§hrend des Musikfestivals 'Sound of Frankfurt' gibt es verbilligte Fahrkarten f√ºr alle √∂ffentlichen Verkehrsmittel."
              },
              {
                id: "57",
                text: "Sie gehen am 3. Juli ins Konzert, weil Sie die beiden Leipziger Klaviervirtuosen h√∂ren m√∂chten."
              },
              {
                id: "58",
                text: "Am Wochenende k√∂nnen Sie sich in Hamburg √ºber die Bek√§mpfung von Krankheiten bei Apfelb√§umen informieren."
              },
              {
                id: "59",
                text: "Im Handwerksmuseum werden Kleidungsst√ºcke ausgestellt."
              },
              {
                id: "60",
                text: "Die Autobahn 'A5' ist zwischen Baden-... (ÿßŸÑÿ¨ŸÖŸÑÿ© ÿ∫Ÿäÿ± ŸÖŸÉÿ™ŸÖŸÑÿ© ŸÅŸä ÿßŸÑŸÜÿµ ÿßŸÑÿ£ÿµŸÑŸäÿå ŸÑŸÉŸÜ ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ© ÿßŸÑÿµÿ≠Ÿäÿ≠ÿ© ŸáŸä falsch)."
              }
            ]
          }
        ]
      };

      let state = { 
        sectionIndex: 0, 
        answers: {}, 
        remaining: exam.durationSec,
        showResults: false,
        timerStarted: false,
        timerInterval: null
      };
      
      const topTiles = document.getElementById('topTiles-hoeren');
      const contentContainer = document.getElementById('contentContainer-hoeren');
      const timerEl = document.getElementById('timer-hoeren');
      const statusText = document.getElementById('statusText-hoeren');

      function startTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        
        state.timerStarted = true;
        state.timerInterval = setInterval(() => {
          if (state.remaining <= 0) {
            clearInterval(state.timerInterval);
            timerEl.textContent = 'Zeit abgelaufen';
            return;
          }
          state.remaining--;
          updateTimerDisplay();
        }, 1000);
      }

      function resetTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        state.remaining = exam.durationSec;
        state.timerStarted = false;
        updateTimerDisplay();
        startTimer();
      }

      function updateTimerDisplay() {
        const min = Math.floor(state.remaining / 60);
        const sec = state.remaining % 60;
        timerEl.textContent = `Verbleibende Zeit: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
      }

      function renderTopTiles() { 
        topTiles.innerHTML = ''; 
        exam.sections.forEach((sec, idx) => { 
          const div = document.createElement('div'); 
          div.className = 'tile' + (idx === state.sectionIndex ? ' active' : '') + (isSectionDone(sec) ? ' done' : ''); 
          div.innerHTML = `<div>${sec.title}</div><div class="points">${sec.points} P</div>`; 
          div.onclick = () => { state.sectionIndex = idx; state.showResults = false; renderAll(); }; 
          topTiles.appendChild(div); 
        }); 
      }

      function isSectionDone(section) {
        const answers = state.answers[section.id];
        if (!answers) return false;
        
        const answeredQuestions = Object.keys(answers).length;
        const totalQuestions = section.questions.length;
        
        return answeredQuestions === totalQuestions;
      }

      function renderAll() {
        renderTopTiles();
        
        if (state.showResults) {
          renderResults();
          return;
        }
        
        renderListeningSection();
      }

      function renderListeningSection() {
        const section = exam.sections[state.sectionIndex];
        const currentAnswers = state.answers[section.id] || {};
        
        let contentHTML = `
          <div class="panel-title">${section.title}</div>
          <div class="instructions">
            Sie h√∂ren die Nachrichten. Entscheiden Sie beim H√∂ren, ob die Aussagen richtig oder falsch sind. 
            Sie h√∂ren die Nachrichten nur einmal. Sie haben jetzt 30 Sekunden, um die Aussagen zu lesen.
          </div>
          
          <div class="listening-task">
            <table class="true-false-table">
              <thead>
                <tr>
                  <th style="width: 10%">Nr.</th>
                  <th style="width: 60%">Aussage</th>
                  <th style="width: 30%">Ihre Antwort</th>
                </tr>
              </thead>
              <tbody>
        `;
        
        section.questions.forEach((question, index) => {
          const currentAnswer = currentAnswers[question.id] || '';
          contentHTML += `
            <tr>
              <td><strong>${question.id}</strong></td>
              <td class="question-text">${question.text}</td>
              <td>
                <div class="answer-options">
                  <label class="answer-option">
                    <input 
                      type="radio" 
                      name="q${section.id}_${question.id}" 
                      value="richtig" 
                      ${currentAnswer === 'richtig' ? 'checked' : ''}
                      onchange="window.hoerenApp.updateListeningAnswer('${section.id}', '${question.id}', this.value)"
                    >
                    Richtig
                  </label>
                  <label class="answer-option">
                    <input 
                      type="radio" 
                      name="q${section.id}_${question.id}" 
                      value="falsch" 
                      ${currentAnswer === 'falsch' ? 'checked' : ''}
                      onchange="window.hoerenApp.updateListeningAnswer('${section.id}', '${question.id}', this.value)"
                    >
                    Falsch
                  </label>
                </div>
              </td>
            </tr>
          `;
        });
        
        contentHTML += `
              </tbody>
            </table>
          </div>
        `;
        
        contentContainer.innerHTML = contentHTML;
      }

      function updateListeningAnswer(sectionId, questionId, answer) {
        if (!state.answers[sectionId]) {
          state.answers[sectionId] = {};
        }
        state.answers[sectionId][questionId] = answer;
        try{ localStorage.setItem('hoerenAnswers', JSON.stringify(state.answers)); }catch(e){}
        
        renderTopTiles();
      }

      function renderResults() {
        let resultsHTML = `<div class="panel-title">Ergebnisse - H√∂rverstehen</div>`;
        
        exam.sections.forEach(section => {
          const userAnswers = state.answers[section.id] || {};
          let correctCount = 0;
          
          resultsHTML += `
            <div class="listening-task">
              <h3>${section.title} (${section.points} Punkte)</h3>
              <table class="true-false-table">
                <thead>
                  <tr>
                    <th style="width: 10%">Nr.</th>
                    <th style="width: 50%">Aussage</th>
                    <th style="width: 15%">Ihre Antwort</th>
                    <th style="width: 15%">Richtige Antwort</th>
                    <th style="width: 10%">Punkte</th>
                  </tr>
                </thead>
                <tbody>
          `;
          
          section.questions.forEach((question) => {
            const userAnswer = userAnswers[question.id] || '-';
            const correctAnswer = section.correctAnswers[question.id];
            const gotCorrect = userAnswer === correctAnswer;
            const points = gotCorrect ? "1" : "0";
            
            if (gotCorrect) correctCount++;
            
            const rowClass = gotCorrect ? 'correct-answer' : 'incorrect-answer';
            
            resultsHTML += `
              <tr class="${rowClass}">
                <td><strong>${question.id}</strong></td>
                <td class="question-text">${question.text}</td>
                <td>${userAnswer}</td>
                <td>${correctAnswer}</td>
                <td><strong>${points}</strong></td>
              </tr>
            `;
          });
          
          const totalPoints = Math.round((correctCount / section.questions.length) * section.points);
          
          resultsHTML += `
                </tbody>
              </table>
              <div style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 6px;">
                <strong>Erreichte Punkte: ${correctCount}/${section.questions.length} richtig = ${totalPoints}/${section.points} Punkten</strong>
              </div>
            </div>
          `;
        });
        
        contentContainer.innerHTML = resultsHTML;
      }

      document.getElementById('prevBtn-hoeren').addEventListener('click', () => {
        if (state.sectionIndex > 0) {
          state.sectionIndex--;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('nextBtn-hoeren').addEventListener('click', () => {
        if (state.sectionIndex < exam.sections.length - 1) {
          state.sectionIndex++;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('resultBtn-hoeren').addEventListener('click', () => {
        state.showResults = !state.showResults;
        renderAll();
      });

      document.getElementById('resetBtn-hoeren').addEventListener('click', () => {
        if (confirm('M√∂chten Sie wirklich von neu beginnen? Alle Antworten werden gel√∂scht.')) {
          state.answers = {};
          state.showResults = false;
          resetTimer();
          renderAll();
        }
      });

      document.getElementById('saveBtn-hoeren').addEventListener('click', () => {
        statusText.textContent = 'Gespeichert';
        setTimeout(() => { statusText.textContent = 'Nicht gespeichert' }, 2000);
      });

      document.getElementById('submitBtn-hoeren').addEventListener('click', () => {
        if (confirm('M√∂chten Sie die Pr√ºfung wirklich abgeben?')) {
          state.showResults = true;
          renderAll();
        }
      });

      document.getElementById('nextBtn-hoeren').addEventListener('click', () => {
        showPage('schreiben-page');
      });

      updateTimerDisplay();
      renderAll();
      startTimer();
      
      window._hoerenState = state;
      window.hoerenApp = {
        updateListeningAnswer
      };
    }

    // ===== SCHREIBEN PAGE FUNCTIONALITY =====
    function initSchreibenPage() {
      const exam = {
        id: "exam-002",
        durationSec: 30 * 60,
        sections: [
          { 
            id: "s1", 
            title: "Schreiben, Teil 1", 
            points: 45,
            passageTitle: "Aufgabe: Schreiben Sie eine E-Mail",
            passage: "",
            writingTask: {
              prompt: `M√∂chten Sie in Ihrer Freizeit mehr erleben? Neue Leute aus Mainz kennenlernen? Am Wochenende nie mehr allein sein? 
      Dann werden Sie Mitglied im Freizeitverein!
      Wir organisieren verschiedene Aktivit√§ten in Mainz und Umgebung:
      Wanderungen, Fahrradtouren, Museums- und Theaterbesuche, Spiele- und Kinoabende, Restaurantbesuche und Ausfl√ºge.
      Jede Woche stehen mindestens zwei unterschiedliche Angebote auf dem Programm.
      Ob Sport oder Kultur ‚Äì bei uns kommt jeder auf seine Kosten. Sie k√∂nnen viel Neues ausprobieren und lernen dabei nette Leute kennen.
      Unsere Mitglieder sind zwischen 26 und 85 Jahre alt. Bei uns ist jeder willkommen, ob Student oder Senior. 
      Sie finden bei uns neue Freunde und Bekannte, mit denen Sie viel erleben k√∂nnen. Probieren Sie es doch einfach mal aus!
      Die Mitgliedschaft kostet 20 Euro pro Monat.`,
              requirements: [
                "Erkl√§ren Sie, was Sie nach dem Lesen der Anzeige erwartet hatten.",
                "Erkl√§ren Sie, warum Sie mit dem Angebot des Freizeitvereins nicht zufrieden sind.",
                "Machen Sie Verbesserungsvorschl√§ge zum Programm.",
                "Erkl√§ren Sie, was Sie tun werden, wenn sich nichts √§ndert."
              ],
              wordCount: 0
            }
          }
        ]
      };

      let state = { 
        sectionIndex: 0, 
        answers: {}, 
        remaining: exam.durationSec,
        showResults: false,
        timerStarted: false,
        timerInterval: null
      };
      
      const topTiles = document.getElementById('topTiles-schreiben');
      const passageTitleEl = document.getElementById('passageTitle-schreiben');
      const passageContentEl = document.getElementById('passageContent-schreiben');
      const writingContainer = document.getElementById('writingContainer-schreiben');
      const timerEl = document.getElementById('timer-schreiben');
      const statusText = document.getElementById('statusText-schreiben');

      function startTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        
        state.timerStarted = true;
        state.timerInterval = setInterval(() => {
          if (state.remaining <= 0) {
            clearInterval(state.timerInterval);
            timerEl.textContent = 'Zeit abgelaufen';
            return;
          }
          state.remaining--;
          updateTimerDisplay();
        }, 1000);
      }

      function resetTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        state.remaining = exam.durationSec;
        state.timerStarted = false;
        updateTimerDisplay();
        startTimer();
      }

      function updateTimerDisplay() {
        const min = Math.floor(state.remaining / 60);
        const sec = state.remaining % 60;
        timerEl.textContent = `Verbleibende Zeit: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
      }

      function renderTopTiles() { 
        topTiles.innerHTML = ''; 
        exam.sections.forEach((sec, idx) => { 
          const div = document.createElement('div'); 
          div.className = 'tile' + (idx === state.sectionIndex ? ' active' : '') + (isSectionDone(sec) ? ' done' : ''); 
          div.innerHTML = `<div>${sec.title}</div><div class="points">${sec.points} P</div>`; 
          div.onclick = () => { state.sectionIndex = idx; state.showResults = false; renderAll(); }; 
          topTiles.appendChild(div); 
        }); 
      }

      function isSectionDone(section) {
        return state.answers[section.id] && state.answers[section.id].length > 0;
      }

      function renderAll() {
        renderTopTiles();
        const section = exam.sections[state.sectionIndex];
        passageTitleEl.textContent = section.passageTitle;
        
        if (state.showResults) {
          renderResults();
          return;
        }
        
        renderWritingSection();
      }

      function renderWritingSection() {
        const section = exam.sections[state.sectionIndex];
        
        passageContentEl.innerHTML = `
          <div class="writing-task">
            <div class="writing-prompt">${section.writingTask.prompt}</div>
            <div class="instructions" style="border:1px solid #e1e8f6; padding:10px; margin:10px 0; border-radius:6px; background:#ffffff;">Sie sind seit zwei Wochen Mitglied im Freizeitverein. Doch Sie sind nicht zufrieden. 
      Schreiben Sie eine Beschwerde.</div>
            <div class="writing-requirements">
              <h4>Schreiben Sie in Ihrer E-Mail:</h4>
              <ul>
                ${section.writingTask.requirements.map(req => `<li>${req}</li>`).join('')}
              </ul>
            </div>
            <div class="instructions">
              Schreiben Sie eine E-Mail (ca. 150-200 W√∂rter). Achten Sie auf den Textaufbau (Anrede, Einleitung, Hauptteil, Schluss) und eine angemessene Formulierung.
            </div>
          </div>
        `;
        
        const currentAnswer = state.answers[section.id] || '';
        const wordCount = countWords(currentAnswer);
        
        writingContainer.innerHTML = `
          <div class="writing-area">
            <textarea 
              class="writing-textarea" 
              placeholder="Schreiben Sie hier Ihre E-Mail..."
              oninput="window.schreibenApp.updateWritingAnswer('${section.id}', this.value)"
            >${currentAnswer}</textarea>
            <div class="word-counter">
              W√∂rter: <span class="count">${wordCount}</span>
            </div>
          </div>
        `;
      }

      function countWords(text) {
        return text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
      }

      function updateWritingAnswer(sectionId, text) {
        state.answers[sectionId] = text;
        try{ localStorage.setItem('schreibenAnswers', JSON.stringify({content: state.answers[sectionId], wordCount: (state.answers[sectionId]||'').trim().split(/\s+/).filter(Boolean).length})); }catch(e){}
        
        const wordCount = countWords(text);
        document.querySelector('.word-counter .count').textContent = wordCount;
      }

      function renderResults() {
        let resultsHTML = `<h2>Ergebnisse</h2>`;
        
        exam.sections.forEach(section => {
          resultsHTML += `<div class="writing-task"><h3>${section.title}</h3>`;
          
          const userAnswer = state.answers[section.id];
          const wordCount = countWords(userAnswer);
          
          resultsHTML += `
            <div class="writing-requirements">
              <h4>Ihre Antwort (${wordCount} W√∂rter):</h4>
              <div style="white-space: pre-wrap; background: white; padding: 15px; border-radius: 6px; border: 1px solid #e1e8f6; margin-top: 10px;">${userAnswer || 'Keine Antwort'}</div>
            </div>
          `;
          
          resultsHTML += `</div>`;
        });
        
        passageContentEl.innerHTML = resultsHTML;
        writingContainer.innerHTML = '';
      }

      document.getElementById('prevBtn-schreiben').addEventListener('click', () => {
        if (state.sectionIndex > 0) {
          state.sectionIndex--;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('nextBtn-schreiben').addEventListener('click', () => {
        if (state.sectionIndex < exam.sections.length - 1) {
          state.sectionIndex++;
          state.showResults = false;
          renderAll();
        }
      });

      document.getElementById('resultBtn-schreiben').addEventListener('click', () => {
        state.showResults = !state.showResults;
        renderAll();
      });

      document.getElementById('resetBtn-schreiben').addEventListener('click', () => {
        if (confirm('M√∂chten Sie wirklich von neu beginnen? Alle Antworten werden gel√∂schÿ™.')) {
          state.answers = {};
          state.showResults = false;
          resetTimer();
          renderAll();
        }
      });

      document.getElementById('saveBtn-schreiben').addEventListener('click', () => {
        statusText.textContent = 'Gespeichert';
        setTimeout(() => { statusText.textContent = 'Nicht gespeichert' }, 2000);
      });

      document.getElementById('submitBtn-schreiben').addEventListener('click', () => {
        if (confirm('M√∂chten Sie die Pr√ºfung wirklich abgeben?')) {
          state.showResults = true;
          renderAll();
        }
      });

      document.getElementById('nextBtn-schreiben').addEventListener('click', () => {
        showPage('ergebnisse-page');
      });

      updateTimerDisplay();
      renderAll();
      startTimer();
      
      window._schreibenState = state;
      window.schreibenApp = {
        updateWritingAnswer
      };
    }

    // ===== ERGEBNISSE PAGE FUNCTIONALITY =====
    function initErgebnissePage() {
      const CORRECT_ANSWERS = {
        lesen: {
          "text1": "d",
          "text2": "f", 
          "text3": "j",
          "text4": "e",
          "text5": "a",
          
          "s2q1": "s2q1o3",
          "s2q2": "s2q2o2",
          "s2q3": "s2q3o2",
          "s2q4": "s2q4o1",
          "s2q5": "s2q5o3",
          
          "11": "D",
          "12": "L",
          "13": "X",
          "14": "B",
          "15": "H",
          "16": "A",
          "17": "I",
          "18": "C",
          "19": "K",
          "20": "E",
          
          "21": "waren",
          "22": "da",
          "23": "f√ºr",
          "24": "sowohl.... als auch",
          "25": "verwandeten",
          "26": "unserer",
          "27": "als",
          "28": "ob",
          "29": "tun",
          "30": "h√§tten",
          
          "31": "W√ÑHREND",
          "32": "DADURCH",
          "33": "DASS",
          "34": "UM",
          "35": "NAHKOMMEN",
          "36": "DAF√úR",
          "37": "DENN",
          "38": "EINGRIFFE",
          "39": "NOCH",
          "40": "GING"
        },
        
        hoeren: {
          "41": "falsch",
          "42": "richtig",
          "43": "richtig",
          "44": "falsch",
          "45": "richtig",
          
          "46": "falsch",
          "47": "richtig",
          "48": "falsch",
          "49": "falsch",
          "50": "falsch",
          "51": "falsch",
          "52": "falsch",
          "53": "falsch",
          "54": "richtig",
          "55": "richtig",
          
          "56": "richtig",
          "57": "falsch",
          "58": "richtig",
          "59": "falsch",
          "60": "falsch"
        }
      };

      const CONFIG = {
        totals: { 
          lesen: 105, 
          hoeren: 75, 
          schreiben: 45, 
          gesamt: 225 
        },
        counts: { 
          lesen: 40, 
          hoeren: 20 
        },
        hoerenCorrect: CORRECT_ANSWERS.hoeren,
        lesenCorrect: CORRECT_ANSWERS.lesen
      };

      function normalizeAnswer(a) {
        if (a === null || a === undefined) return '';
        let s = String(a).trim();
        if (s === '') return '';
        const low = s.toLowerCase();
        if (["richtig", "true", "yes", "ja"].includes(low)) return 'richtig';
        if (["falsch", "false", "no", "nein"].includes(low)) return 'falsch';
        return s;
      }

      function readExamResults() {
        try {
          const lesen = {};
          const hoeren = {};
          const schreiben = { content: '', wordCount: 0 };

          try {
            if (window._lesenState && window._lesenState.answers) {
              Object.keys(window._lesenState.answers).forEach(k => {
                lesen[k] = window._lesenState.answers[k];
              });
            }
          } catch (e) {}

          try {
            if (window._hoerenState && window._hoerenState.answers) {
              Object.keys(window._hoerenState.answers).forEach(sectionId => {
                const sec = window._hoerenState.answers[sectionId] || {};
                Object.keys(sec).forEach(q => {
                  hoeren[q] = sec[q];
                });
              });
            }
          } catch (e) {}

          try {
            if (window._schreibenState && window._schreibenState.answers) {
              const answers = window._schreibenState.answers;
              if (answers['s1']) {
                schreiben.content = answers['s1'];
              } else {
                const keys = Object.keys(answers);
                if (keys.length > 0) schreiben.content = answers[keys[0]] || '';
              }
              schreiben.wordCount = (schreiben.content && schreiben.content.trim()) ? String(schreiben.content).trim().split(/\s+/).filter(Boolean).length : 0;
            }
          } catch (e) {}

          try {
            if (Object.keys(lesen).length === 0) {
              const storedL = localStorage.getItem('lesenAnswers');
              if (storedL) Object.assign(lesen, JSON.parse(storedL));
            }
          } catch (e) {}

          try {
            if (Object.keys(hoeren).length === 0) {
              const storedH = localStorage.getItem('hoerenAnswers');
              if (storedH) Object.assign(hoeren, JSON.parse(storedH));
            }
          } catch (e) {}

          try {
            if (!schreiben.content) {
              const storedS = localStorage.getItem('schreibenAnswers');
              if (storedS) {
                const obj = JSON.parse(storedS);
                schreiben.content = obj.content || '';
                schreiben.wordCount = obj.wordCount || (schreiben.content.trim() ? String(schreiben.content).trim().split(/\s+/).filter(Boolean).length : 0);
              }
            }
          } catch (e) {}

          return { hoeren, lesen, schreiben };
        } catch (e) {
          return { hoeren: {}, lesen: {}, schreiben: {} };
        }
      }

      function getHeadingText(headingId) {
        if (!headingId || headingId === '-' || headingId === 'X') return '-';
        const headings = {
          "a": "Erneuerungskur f√ºr einen alten Markt",
          "b": "Junge Influencer werben f√ºr Bioprodukte",
          "c": "Neues Buch √ºber einen Wiener Architekten erschienen",
          "d": "√ñsterreichs beliebteste Marktpl√§tze",
          "e": "Schreiben im Internet f√ºr die Karriere",
          "f": "Schulung zum Erfolg im Beruf",
          "g": "Seminar: Produkte erfolgreich verkaufen",
          "h": "Warum immer mehr Menschen auf M√§rkten einkaufen",
          "i": "Wenn Blogger Firmengeheimnisse verraten",
          "j": "Wissenswertes √ºber Wiens gr√∂√üten innerst√§dtischen Markt"
        };
        return headings[headingId] || headingId;
      }

      function getOptionText(questionId, optionId) {
        if (!optionId || optionId === '-') return '-';
        const options = {
          "s2q1o1": "es in √ñsterreich bald mehr Pools gibt als in Frankreich",
          "s2q1o2": "in unsicheren Zeiten weniger investiert wird.",
          "s2q1o3": "mehr Leute einen Pool bauen, weil Pools billiger geworden sind.",
          "s2q2o1": "m√∂chten die meisten Befragten ein Heim mit Garage.",
          "s2q2o2": "steht ein Pool nicht an erster Stelle auf der Wunschliste,",
          "s2q2o3": "w√ºnschen sich 10 Prozent der √ñsterreicher einen Pool.",
          "s2q3o1": "ein Pool die Nachbarn neidisch macht.",
          "s2q3o2": "ihr Pool ein Anziehungspunkt f√ºr Freunde geworden ist.",
          "s2q3o3": "ihre Freunde beim Poolbau helfen sollen.",
          "s2q4o1": "brauchen keine chemischen Reinigungsmittel.",
          "s2q4o2": "m√ºssen h√§ufig geputzt werden.",
          "s2q4o3": "sehen genauso aus wie Schwimmteiche.",
          "s2q5o1": "darf man einen Pool nur mit Wasser aus der Leitung f√ºllen.",
          "s2q5o2": "f√ºhrt das Bef√ºllen von Pools regelm√§√üig zu Wasserknappheit.",
          "s2q5o3": "wird manchmal Wasser zum Bef√ºllen von Pools gestohlen"
        };
        return options[optionId] || optionId;
      }

      function getSituationText(id) {
        const situations = {
          "11": "Eine Bekannte interessiert sich f√ºr B√ºcher √ºber den Tennissport.",
          "12": "Ein befreundetes Ehepaar steht andauernd unter Stress und m√∂chte wieder mehr Zeit f√ºr sich und andere haben.",
          "13": "Eine Bekannte m√∂chte ihre Wohnung renovieren und sucht Tipps zu Tapeten und Wandfarben.",
          "14": "Eine Studentin sucht Informationen, wie sie besser und systematischer lernen kann.",
          "15": "Ein Bekannter m√∂chte wissen, welche Botschaften durch Gestik und Mimik transportiert werden.",
          "16": "Eine Bekannte interessiert sich f√ºr B√ºcher √ºber den Tennissport.",
          "17": "Ein Bekannter ist sich noch unsicher, wie er sich bei einem Vorstellungsgespr√§ch am besten pr√§sentiert.",
          "18": "Ein Bekannter schreibt an einer Hausarbeit √ºber H√∂flichkeit und Benimmregeln in fr√ºheren Jahrhunderten.",
          "19": "Ein Bekannter m√∂chte lernen, wie man gute Gesch√§ftsbriefe schreibt.",
          "20": "Eine Bekannte ist sehr verunsichert, weil sie auf Konferenzen immer wieder Angst hat, frei zu sprechen."
        };
        return situations[id] || id;
      }

      function escapeHtml(s) {
        return String(s)
          .replace(/&/g, '&amp;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;')
          .replace(/"/g, '&quot;')
          .replace(/'/g, '&#039;');
      }

      function buildTable(title, dets, total, max) {
        let html = `<div class="result-item">
                <h3>${title} - ${total.toFixed(2)}/${max} Punkte</h3>
                <div class="section-table">
                  <table class="true-false-table">
                    <thead>
                      <tr>
                        <th style="width: 10%">Frage</th>
                        <th style="width: 40%">Ihre Antwort</th>
                        <th style="width: 40%">Richtige Antwort</th>
                        <th style="width: 10%">Ergebnis</th>
                      </tr>
                    </thead>
                    <tbody>`;
  
        dets.forEach(x => {
          const isCorrect = x.richtig;
          const rowClass = isCorrect ? 'correct-answer' : 'incorrect-answer';
          const resultIcon = isCorrect ? '‚úÖ Richtig' : '‚ùå Falsch';
          
          html += `<tr class="${rowClass}">
              <td><strong>${x.frage}</strong></td>
              <td>${escapeHtml(x.user)}</td>
              <td>${escapeHtml(x.correct)}</td>
              <td><strong>${resultIcon}</strong></td>
            </tr>`;
        });
  
        html += `</tbody>
          </table>
          <div style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 6px;">
            <strong>Erreichte Punkte: ${total.toFixed(2)}/${max} (${((total/max)*100).toFixed(1)}%)</strong>
          </div>
        </div></div>`;
        return html;
      }

      function gradeHoeren(u) {
        const c = CONFIG.hoerenCorrect;
        let okCount = 0;
        const d = [];
        
        for (let q = 41; q <= 60; q++) {
          const k = String(q);
          const uA = normalizeAnswer(u[k] || '');
          const exp = normalizeAnswer(c[k] || '');
          const ok = (uA !== '' && uA.toLowerCase() === exp.toLowerCase());
          if (ok) okCount++;
          const ptsPer = CONFIG.totals.hoeren / CONFIG.counts.hoeren;
          d.push({
            frage: k,
            user: uA || '-',
            correct: exp || '-',
            richtig: ok,
            punkte: ok ? ptsPer.toFixed(2) : '0'
          });
        }
        
        const total = Number((okCount * (CONFIG.totals.hoeren / CONFIG.counts.hoeren)).toFixed(2));
        return { okCount, total, details: d };
      }

      function gradeLesen(u) {
        const c = CONFIG.lesenCorrect;
        let okCount = 0;
        const d = [];
        
        Object.keys(c).forEach(k => {
          const exp = normalizeAnswer(c[k]);
          const uA = normalizeAnswer(u[k] || '');
          const ok = (uA !== '' && uA.toLowerCase() === exp.toLowerCase());
          if (ok) okCount++;
          const ptsPer = CONFIG.totals.lesen / CONFIG.counts.lesen;
          
          let userDisplay = uA || '-';
          let correctDisplay = exp || '-';
          
          if (k.startsWith('text')) {
            userDisplay = getHeadingText(uA);
            correctDisplay = getHeadingText(exp);
          } else if (k.startsWith('s2q')) {
            userDisplay = getOptionText(k, uA);
            correctDisplay = getOptionText(k, exp);
          } else if (['11','12','13','14','15','16','17','18','19','20'].includes(k)) {
            userDisplay = uA === 'X' ? 'X' : (uA || '-');
            correctDisplay = exp === 'X' ? 'X' : (exp || '-');
          }
          
          d.push({
            frage: k,
            user: userDisplay,
            correct: correctDisplay,
            richtig: ok,
            punkte: ok ? ptsPer.toFixed(2) : '0'
          });
        });
        
        const total = Number((okCount * (CONFIG.totals.lesen / CONFIG.counts.lesen)).toFixed(2));
        return { okCount, total, details: d };
      }

      function renderLesenDetails(answers) {
        const result = gradeLesen(answers || {});
        
        let html = `<div class="result-item">
              <h3>üìñ Leseverstehen - Detaillierte Auswertung</h3>`;
        
        const part1Details = result.details.filter(d => d.frage.startsWith('text'));
        const part2Details = result.details.filter(d => d.frage.startsWith('s2q'));
        const part3Details = result.details.filter(d => ['11','12','13','14','15','16','17','18','19','20'].includes(d.frage));
        const part4Details = result.details.filter(d => ['21','22','23','24','25','26','27','28','29','30'].includes(d.frage));
        const part5Details = result.details.filter(d => ['31','32','33','34','35','36','37','38','39','40'].includes(d.frage));
        
        if (part1Details.length > 0) {
          html += `<h4 style="margin-top: 20px;">Teil 1: √úberschriften zuordnen</h4>
                   ${buildTable('√úberschriften zuordnen', part1Details, 
                     (result.okCount/result.details.length*25), 25).replace('<h3>', '<h4>').replace('</h3>', '</h4>')}`;
        }
        
        if (part2Details.length > 0) {
          html += `<h4 style="margin-top: 20px;">Teil 2: Fragen zum Text</h4>
                   ${buildTable('Fragen zum Text', part2Details, 
                     (result.okCount/result.details.length*25), 25).replace('<h3>', '<h4>').replace('</h3>', '</h4>')}`;
        }
        
        if (part3Details.length > 0) {
          html += `<h4 style="margin-top: 20px;">Teil 3: Texte zuordnen</h4>
                   ${buildTable('Texte zuordnen', part3Details, 
                     (result.okCount/result.details.length*25), 25).replace('<h3>', '<h4>').replace('</h3>', '</h4>')}`;
        }
        
        if (part4Details.length > 0) {
          html += `<h4 style="margin-top: 20px;">Sprachbausteine Teil 1</h4>
                   ${buildTable('Sprachbausteine Teil 1', part4Details, 
                     (result.okCount/result.details.length*15), 15).replace('<h3>', '<h4>').replace('</h3>', '</h4>')}`;
        }
        
        if (part5Details.length > 0) {
          html += `<h4 style="margin-top: 20px;">Sprachbausteine Teil 2</h4>
                   ${buildTable('Sprachbausteine Teil 2', part5Details, 
                     (result.okCount/result.details.length*15), 15).replace('<h3>', '<h4>').replace('</h3>', '</h4>')}`;
        }
        
        html += `</div>`;
        return html;
      }

      function buildHoerenDetails(answers) {
        const result = gradeHoeren(answers || {});
        return buildTable('H√∂rverstehen', result.details, result.total, CONFIG.totals.hoeren);
      }

      function renderResults() {
        const st = readExamResults() || { hoeren: {}, lesen: {}, schreiben: {} };
        const h = gradeHoeren(st.hoeren || {});
        const l = gradeLesen(st.lesen || {});
        const details = document.getElementById('details-ergebnisse');
        const tiles = document.getElementById('topTiles-ergebnisse');
        const sScoreRaw = localStorage.getItem('schreibenScore');
        const sScore = sScoreRaw ? Number(sScoreRaw) : 0;

        details.innerHTML = '';
        tiles.innerHTML = '';

        const tL = `<div class="results-tile">
                    <h3>Lesen</h3>
                    <div class="score">${l.total.toFixed(2)} / ${CONFIG.totals.lesen} Punkte</div>
                    <div class="small-muted">(${(l.total / CONFIG.totals.lesen * 100).toFixed(2)} %)</div>
                  </div>`;
                  
        const tH = `<div class="results-tile">
                    <h3>H√∂ren</h3>
                    <div class="score">${h.total.toFixed(2)} / ${CONFIG.totals.hoeren} Punkte</div>
                    <div class="small-muted">(${(h.total / CONFIG.totals.hoeren * 100).toFixed(2)} %)</div>
                  </div>`;
                  
        const tS = `<div class="results-tile">
                    <h3>Schreiben</h3>
                    <div class="score" id="schreibenScoreDisplay">${sScore.toFixed(2)} / ${CONFIG.totals.schreiben} Punkte</div>
                    <div class="small-muted">Manuelle Eingabe</div>
                  </div>`;
                  
        tiles.innerHTML = tL + tH + tS;

        details.innerHTML += `<h2 style="margin-top: 20px;">üìä Detaillierte Ergebnisse</h2>
          <div class="instructions" style="margin-bottom: 20px;">
            Hier sehen Sie eine detaillierte Auswertung Ihrer Pr√ºfung. Richtige Antworten sind gr√ºn markiert, falsche rot.
          </div>`;
        
        details.innerHTML += renderLesenDetails(st.lesen);
        details.innerHTML += `<div class="result-item">
          <h3>üëÇ H√∂rverstehen - Detaillierte Auswertung</h3>
          ${buildHoerenDetails(st.hoeren)}
        </div>`;

        let sHtml = '<div class="result-item"><h3>‚úçÔ∏è Schreiben - Ihre Antwort</h3>';
        const txt = st.schreiben.content ? escapeHtml(st.schreiben.content) : '<span class="small-muted">Kein Text gefunden.</span>';
        const wc = st.schreiben.wordCount || '-';
        
        sHtml += `<div class="small-muted">W√∂rter: ${wc}</div>
                <div style="margin-top:10px;padding:12px;background:#fff;border-radius:8px;border:1px solid #eef6ff;min-height:80px">${txt}</div>
                <div style="margin-top:10px;display:flex;gap:10px;align-items:center">
                  Punkte (0‚Äì45): 
                  <input id="sInput" type="number" min="0" max="45" step="0.5" value="${sScore}"> 
                  <button id="saveS" class="results-btn">Speichern</button>
                </div>`;
                
        details.innerHTML += sHtml + '</div>';

        const total = (l.total + h.total + sScore).toFixed(2);
        const percent = ((total / CONFIG.totals.gesamt) * 100).toFixed(2);
        
        document.getElementById('finalSummary-ergebnisse').innerHTML = `
          <div class="left">
            Gesamtpunktzahl: <strong>${total}</strong> / ${CONFIG.totals.gesamt} Punkte<br>
            <span class="small-muted">Lesen + H√∂ren + Schreiben</span>
          </div>
          <div class="right">
            Prozentsatz: <strong>${percent} %</strong>
          </div>`;

        document.getElementById('saveS').onclick = () => {
          const v = Number(document.getElementById('sInput').value) || 0;
          localStorage.setItem('schreibenScore', v);
          document.getElementById('schreibenScoreDisplay').textContent = `${v.toFixed(2)} / ${CONFIG.totals.schreiben} Punkte`;
          
          const newTotal = (l.total + h.total + v).toFixed(2);
          const newPercent = ((newTotal / CONFIG.totals.gesamt) * 100).toFixed(2);
          
          document.getElementById('finalSummary-ergebnisse').innerHTML = `
            <div class="left">
              Gesamtpunktzahl: <strong>${newTotal}</strong> / ${CONFIG.totals.gesamt} Punkte<br>
              <span class="small-muted">Lesen + H√∂ren + Schreiben</span>
            </div>
            <div class="right">
              Prozentsatz: <strong>${newPercent} %</strong>
            </div>`;
        };
      }

      document.getElementById('calcBtn-ergebnisse').onclick = () => renderResults();
      document.getElementById('backBtn-ergebnisse').onclick = (e) => {
        e.preventDefault();
        showPage('start-page');
      };
      
      renderResults();
    }
    
    // ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ≥ÿ≠ÿ® ŸàÿßŸÑÿ•ŸÅŸÑÿßÿ™ ŸÑŸÑÿ¥ÿßÿ¥ÿßÿ™ ÿßŸÑÿ™Ÿä ÿ™ÿπŸÖŸÑ ÿ®ÿßŸÑŸÑŸÖÿ≥
    function setupTouchDragAndDrop() {
      if ('ontouchstart' in window) {
        // ÿ•ÿ∂ÿßŸÅÿ© ÿØÿπŸÖ ÿßŸÑŸÑŸÖÿ≥ ŸÑŸÑÿπŸÜÿßÿµÿ± ÿßŸÑŸÇÿßÿ®ŸÑÿ© ŸÑŸÑÿ≥ÿ≠ÿ®
        document.addEventListener('DOMContentLoaded', function() {
          const draggables = document.querySelectorAll('[draggable="true"]');
          
          draggables.forEach(item => {
            item.addEventListener('touchstart', handleTouchStart, { passive: false });
            item.addEventListener('touchend', handleTouchEnd, { passive: false });
          });
          
          const dropZones = document.querySelectorAll('.title-slot, .blank-slot');
          dropZones.forEach(zone => {
            zone.addEventListener('touchmove', handleTouchMove, { passive: false });
            zone.addEventListener('touchend', handleTouchDrop, { passive: false });
          });
        });
      }
    }
    
    function handleTouchStart(e) {
      const item = e.target;
      if (item.getAttribute('draggable') === 'true') {
        e.preventDefault();
        const data = item.dataset.headingId || item.dataset.situationId || item.dataset.word;
        if (data) {
          item.classList.add('dragging');
          // ÿ™ŸÜŸÅŸäÿ∞ ÿßŸÑÿ≥ÿ≠ÿ® ÿπŸÜÿØ ÿßŸÑŸÑŸÖÿ≥
        }
      }
    }
    
    function handleTouchEnd(e) {
      const item = e.target;
      item.classList.remove('dragging');
    }
    
    function handleTouchMove(e) {
      e.preventDefault();
    }
    
    function handleTouchDrop(e) {
      e.preventDefault();
    }
    
    // ÿßÿ≥ÿ™ÿØÿπÿßÿ° ÿßŸÑÿØÿßŸÑÿ© ÿπŸÜÿØ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿµŸÅÿ≠ÿ©
    document.addEventListener('DOMContentLoaded', setupTouchDragAndDrop);
  </script>
</body>
</html>